#!/usr/bin/env bash
set -euo pipefail
IFS=$'\n\t'

# Bitwarden CLI wrapper to expose the session key.
# If it's prompting you for the master pw, rerun bw-unlock

session_file="${XDG_CACHE_HOME:-$HOME/.cache}/bw_session.gpg"

BW_SESSION=$(gpg --output - --quiet --decrypt "$session_file") ||
	(echo "You need to run bw-unlock" && exit 1)

export BW_SESSION
exec /usr/bin/bw "$@"
