!function(){function e(t,r,n){function o(i,s){if(!r[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(a)return a(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[i]={exports:{}};t[i][0].call(c.exports,function(e){return o(t[i][1][e]||e)},c,c.exports,e,t,r,n)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}return e}()({1:[function(e,t,r){"use strict";t.exports={top_bar:{top_offset_full:44,top_offset_mini:38},note_buffer_t_prefix:"note_t_",note_buffer_p_prefix:"note_p_"}},{}],2:[function(e,t,r){"use strict";var n=window,o=n.IstTooltip,a=window,i=a.IstComplete,s=window,l=s.Signals;window.CURRENT_ACTION_PERFOMED=null,r.get=function(){return window.CURRENT_ACTION_PERFOMED},r.mark=function(e){window.CURRENT_ACTION_PERFOMED=e,l.sendSignal("action_performed"),o.hide(),i.hide(),window.CURRENT_ACTION_PERFOMED=null}},{}],3:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.GB_hide,s=window,l=s.IstCompleteSelect,u=window,c=u.IstTooltip,d=function(){function e(){n(this,e),this.render=this.render.bind(this),this.showTooltip=this.showTooltip.bind(this),this.getDescription=this.getDescription.bind(this)}return o(e,[{key:"render",value:function(e,t,r,n){var o=void 0;o=r[e]?svgs.get(r[e]):"";var a=SPAN({c:"truncated e_name"},this.getDescription(e,t)),i=SPAN({c:"svg_select_arrow"},svgs.get("sm1/caret.svg")),s=A({href:"#",c:"event_select_item","data-track":"activity_log|filter_by_activity"},i,DIV(o,a));n.fixed_pos&&$addClass(s,"fixed_pos");var l=n.tooltip_txt||_("Filter by activity");return e&&(l=n.tooltip_txt_selected||_("Filtering by"),l+=" "+this.getDescription(e,t).toLowerCase()),c.showSimpleText(s,l),s.showTooltip=$p(this.showTooltip,s,i,e,t,r,n),$AEV(s,"click",s.showTooltip),s}},{key:"showTooltip",value:function(e,t,r,n,o,a){var s=this,u=a.selectedItem,c={selectedItem:u,collection:function(){return n},filterItem:function(e){var t=void 0;if(e){var r=SPAN({c:"truncated e_name"},e.name);return t=null!=o[e.value]?svgs.get(o[e.value]):SPAN({c:"blank_icon"}),DIV(DIV({c:"ist_complete_icon"},t),DIV({c:"ist_complete_content"},r))}},onSelect:function(t){if(track("activity_log","click","filter_by_activity_select"),i(),e.showTooltip=null,$swap(e,e=s.render(t.value,n,o,a)),$isFunction(a.onSelect))return a.onSelect(t.value)},wildcard_match:!0,placeholder:_("Search")},d=new l(c);return d.showTooltip({title:_("Filter by activity"),icon:t,top_offset:a.top_offset||25,left_offset:a.left_offset||205,arrow_left_offset:a.arrow_left_offset||-135,fn_on_hide:function(){return d=null}}),!1}},{key:"getDescription",value:function(e,t){var r=!0,n=!1,o=void 0;try{for(var a,i=t[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value;if(s.value===e)return s.name}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}}}]),e}();t.exports=new d},{}],4:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../../reducers/mainView"),s=e("../../reducers/notes/notesConstants"),l=window,u=l.Signals,c=window,d=c.DateUtils,f=window,p=f.DateistDateHelpers,m=window,h=m.Indicator,v=window,y=v.IstTooltip,g=window,b=g.getOfflineMessage,w=e("../agenda/RenderDayView"),E=e("../formatter/Formatter.js"),k=e("../items_utils/ItemDueDates.js"),S=e("../../models/ItemsModel"),j=e("../items_utils/ItemsRender"),T=e("../../models/ProjectsModel"),O=e("../notes/NotesUtils"),I=e("../notes/Notes"),P=e("../../models/Collaborators"),C=e("../avatars/Avatars"),D=e("../project_selecter/ProjectSelecter"),M=e("../people_assigner/PeopleAssigner"),x=e("./ActivityEvents"),R=e("../format_html/FormatHtml"),N=e("../../models/DateExt").default,L=e("../../stores/store").default,U=e("../themes/Themes"),V=e("../../models/SyncEngine"),F=function(){function e(){var t=this;n(this,e),this._resetState=this._resetState.bind(this),this.showActivity=this.showActivity.bind(this),this.changeLocation=this.changeLocation.bind(this),this.renderEvents=this.renderEvents.bind(this),this._renderEvents=this._renderEvents.bind(this),this._renderLoadMore=this._renderLoadMore.bind(this),this._renderEvent=this._renderEvent.bind(this),this._prepareContent=this._prepareContent.bind(this),this._renderBlankState=this._renderBlankState.bind(this),this._processReqData=this._processReqData.bind(this),this._resetState(),u.connect("activity_log.show",this.showActivity),u.connect("activity_log.show_completed",function(){return t.showActivity(null,null,"item:completed")})}return a(e,[{key:"_resetState",value:function(){return this.project_by_id={},this.item_by_id={},this.current_page=1,this.current_offset=0,this.event_icons={"item:added":"sm1/notification_assigned.svg","item:updated":"sm1/notification_updated.svg","item:completed":"sm1/notification_completed.svg","item:uncompleted":"sm1/notification_uncompleted.svg","item:deleted":"sm1/notification_deleted.svg","note:added":"sm1/notification_commented.svg"},this.no_events=!0,this.no_more_events=!1}},{key:"showActivity",value:function(e,t,r,n){var o=void 0,a=void 0,s=void 0,l=void 0;if(u.sendSignal("projects.reset"),this.current_page=0,this.current_offset=0,this.no_events=!0,this.no_more_events=!1,null==t){a=_("Activity: ");var c={support_all:!0,placeholder_txt:_("Search"),selectedItem:function(){return T.get(e)},onSelect:function(e){return 0!==e.id?u.sendSignal("activity_log.show",e.id,null,r,n):u.sendSignal("activity_log.show",null,null,r,n)},top_offset:35};s=D.render(e||0,c);var d=$gc(s,"img");$add(s,d)}else{a=_("Activity: ");var f=S.getById(parseInt(t)),p=E.format(f.content);p=p.replace(/^\*\s+/g,""),s=$setHTML(SPAN({c:"truncated item_header"}),p)}if(null==t){var m=void 0;if(o=DIV({c:"filters"}),void 0===n&&(n=window.User.id),null!=e){var h=T.get(e),v=T.getChildren(h,!0);m=function(){var e=[],t=!0,r=!1,n=void 0;try{for(var o,a=v[Symbol.iterator]();!(t=(o=a.next()).done);t=!0)l=o.value,e.push(l.id)}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return e}()}else m=function(){var e=[],t=!0,r=!1,n=void 0;try{for(var o,a=T.getAll()[Symbol.iterator]();!(t=(o=a.next()).done);t=!0)l=o.value,e.push(l.id)}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return e}();var y=function(t){return track("activity_log","click","filter_by_collaborator_select"),u.sendSignal("activity_log.show",e,null,r,t),null},g={unassigned_txt:_("Everyone"),unassigned_icon_disable:!0,tooltip_txt:_("Filter by collaborator"),title_txt:_("Filter by collaborator"),tooltip_txt_selected:_("Filtering by collaborator"),show_name:!0,responsible_uid:n,fn_on_select:y,placeholder_txt:_("Search"),project_id:m,never_hide:!0,left_offset:140,arrow_left_offset:-90,me_str:_x("activity_log","Me")},b=new M(g),w=SPAN({c:"select_user","data-track":"activity_log|filter_by_collaborator"},b.render(g));$add(o,w);var k=[{value:null,name:_("All actions")},{value:"item:added",name:_("Added tasks")},{value:"item:updated",name:_("Updated tasks")},{value:"item:completed",name:_("Completed tasks")},{value:"item:uncompleted",name:_("Uncompleted tasks")},{value:"item:deleted",name:_("Deleted tasks")},{value:"note:added",name:_("Added comments")}];null==r&&(r=null);var j={selectedItem:function(){return r},onSelect:function(t){return u.sendSignal("activity_log.show",e,null,t,n)}},O=SPAN({c:"select_event"},x.render(r,k,this.event_icons,j));$add(o,O)}var I=DIV({id:"activity_app"},H2({c:"project_header section_header"},a,s),o,DIV({id:"activity_show"}));return $replace($("editor"),I),L.dispatch((0,i.showActivityView)()),this.renderEvents(e,t,r,n),!1}},{key:"changeLocation",value:function(e,t,r,n){var o="undefined"!==n&&n!==window.User.id,a="activity";return(null!=e||null!=t||null!=r||o)&&(null!=e?a+="/project/"+e:null!=t?a+="/task/"+t:(null!=r||o)&&(a+="/null/null"),null!=r?a+="/"+r:o&&(a+="/null"),o&&(a+="/"+n)),u.sendSignal("change_location",a)}},{key:"renderEvents",value:function(e,t,r,n){var a=this;this._resetState();var i=$("activity_show");if(!window.User.is_premium)return void $replace(i,this._renderBlankState(0));$replace($("activity_show"),h.cssSpinner());var s=Array.from(this._createReq(e,t,r,n)),l=o(s,2),u=l[0],c=l[1];return u.addCallback(function(o){if(a._processReqData(o),$replace(i,null),a.changeLocation(e,t,r,n),0!==$values(c).length&&0===o.events.length){var s=void 0;return $add(i,s=A({c:"load_more no_results"})),a.current_page-1==1?$replace(s,_("No activity in the past week.")):$replace(s,R.format(_("No activity in the past {count} weeks."),{count:(a.current_page-1).toString()})),a._renderLoadMore(i,e,t,r,n)}return 0===o.events.length?$replace(i,a._renderBlankState()):(a.no_events&&(a.no_events=!1),a._renderEvents(i,o.events,e,t,r,n))}),this._renderLoadMore(i,e,t,r,n),u.addErrback(function(e,t){var r=$("activity_app");r&&$replace(r,b(t))}),u.sendReq(c)}},{key:"_renderEvents",value:function(e,t,r,n,o,a){var i=!0,s=!1,l=void 0;try{for(var u,c=t[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var d=u.value;if(void 0!==d.extra_data&&(void 0!==d.extra_data.name||void 0!==d.extra_data.content)){var f=d.event_date;f=p.date_max(f);var m=f.getFullYear()+"-"+f.getMonth()+"-"+f.getDate(),h="day_header_"+m,_="day_ul_"+m,v=$(h);v||(v=w._renderDayHeader(f,!1),v.id=h,$add(e,v));var y=$(_);y||(y=UL({c:"items",id:_}),$add(e,y)),null!=n&&"item"===d.object_type&&"added"===d.event_type&&(this.no_more_events=!0),this._renderEvent(e,y,d)}}}catch(e){s=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(s)throw l}}return $replaceClass($$("h2",$("activity_show")),"section_header","subsection_header"),this._renderLoadMore(e,r,n,o,a)}},{key:"_renderLoadMore",value:function(e,t,r,n,a){var i=this,s=void 0;return $add(e,s=A({c:"load_more",href:"#","data-track":"activity_log|load_more"})),!0===this.no_more_events?($addClass(s,"no_more_results"),void $replace(s,_("That's it. No more history to load."))):(1===this.current_page?$replace(s,_("Load more history from last week...")):$replace(s,R.format(_("Load more history from {count} weeks ago..."),{count:this.current_page.toString()})),$AEV(s,"click",function(){if(s.loading)return!1;s.loading=!0,$replace(s,h.cssSpinner());var l=Array.from(i._createReq(t,r,n,a)),u=o(l,2),c=u[0],d=u[1];return c.addCallback(function(o){return i._processReqData(o),0===o.events.length?($remove($$(".no_results")),i.no_events?($addClass(s,"no_results"),i.current_page-1==1?$replace(s,_("No activity in the past week.")):$replace(s,R.format(_("No activity in the past {count} weeks."),{count:(i.current_page-1).toString()}))):$remove(s),i._renderLoadMore(e,t,r,n,a)):(i.no_events&&(i.no_events=!1,$remove($$(".no_results"))),$remove($$(".activity_error")),$remove(s),i._renderEvents(e,o.events,t,r,n,a))}),c.addErrback(function(e,t){alert(b(t)),s.loading=!1}),c.sendReq(d),!1}))}},{key:"_renderEvent",value:function(e,t,r){var n=void 0,o=void 0,a=void 0,i=void 0,s=this._prepareContent(r);if(null!=s){var l=window.User;null!==r.initiator_id&&r.initiator_id!==l.id&&null!=(a=P.getUserById(r.initiator_id))&&(l=a),null!==r.initiator_id&&r.initiator_id!==l.id&&null==a?(n=null,o=SPAN()):(n=C.renderAvatar(l,"medium",U.theme),o=svgs.get(this.event_icons[r.object_type+":"+r.event_type]));var u=SPAN({c:"activity_time"},d.getHourAndMin(r.event_date));null!=r.extra_data.client&&y.showSimpleText(u,r.extra_data.client);var c=null;if("project"===r.object_type?i=r.object_id:"item"!==r.object_type&&"note"!==r.object_type||(i=r.parent_project_id),null!=i){var f=this.project_by_id[i]||T.get(i);f&&(this.project_by_id[i]||(this.project_by_id[i]=f),c=j.createProjectItem({project_id:f.id},f))}var p=LI({c:"event"},DIV({c:"avatar"},n,DIV({c:"avatar_event_icon"},o)),DIV({c:"text"},s,u,DIV({c:"project","data-track":"activity_log|select_project"},c)));return $add(t,p)}}},{key:"_prepareContent",value:function(e){var t=void 0,r={added_task:{you:_("{you} added a task: {task}"),user:_("{user} added a task: {task}"),someone:_("{someone} added a task: {task}")},deleted_task:{you:_("{you} deleted a task: {task}"),user:_("{user} deleted a task: {task}"),someone:_("{someone} deleted a task: {task}")},completed_task:{you:_("{you} completed a task: {task}"),user:_("{user} completed a task: {task}"),someone:_("{someone} completed a task: {task}")},uncompleted_task:{you:_("{you} uncompleted a task: {task}"),user:_("{user} uncompleted a task: {task}"),someone:_("{someone} uncompleted a task: {task}")},renamed_task:{you:_("{you} changed the name of {old} to {task}"),user:_("{user} changed the name of {old} to {task}"),someone:_("{someone} changed the name of {old} to {task}")},set_task_due_date:{you:_("{you} set the due date of {task} to {due_date}"),user:_("{user} set the due date of {task} to {due_date}"),someone:_("{someone} set the due date of {task} to {due_date}")},removed_task_due_date:{you:_("{you} removed the due date of {task}"),user:_("{user} removed the due date of {task}"),someone:_("{someone} removed the due date of {task}")},changed_task_due_date:{you:_("{you} changed the due date of {task} to {due_date}"),user:_("{user} changed the due date of {task} to {due_date}"),someone:_("{someone} changed the due date of {task} to {due_date}")},assigned_task:{you:{to_you:_("{you} assigned {task} to {to_yourself}"),to_user:_("{you} assigned {task} to {to_user}"),to_someone:_("{you} assigned {task} to {to_someone}")},user:{to_you:_("{user} assigned {task} to {to_you}"),to_user:_("{user} assigned {task} to {to_user}"),to_someone:_("{user} assigned {task} to {to_someone}")},someone:{to_you:_("{someone} assigned {task} to {to_you}"),to_user:_("{someone} assigned {task} to {to_user}"),to_someone:_("{someone} assigned {task} to {to_someone_else}")}},reassigned_task:{you:{to_you:_("{you} re-assigned {task} to {to_yourself}"),to_user:_("{you} re-assigned {task} to {to_user}"),to_someone:_("{you} re-assigned {task} to {to_someone}")},user:{to_you:_("{user} re-assigned {task} to {to_you}"),to_user:_("{user} re-assigned {task} to {to_user}"),to_someone:_("{user} re-assigned {task} to {to_someone}")},someone:{to_you:_("{someone} re-assigned {task} to {to_you}"),to_user:_("{someone} re-assigned {task} to {to_user}"),to_someone:_("{someone} re-assigned {task} to {to_someone_else}")}},unassigned_task:{you:_("{you} unnassigned {task}"),user:_("{user} unassigned {task}"),someone:_("{someone} unassigned {task}")},added_comment_to:{you:_("{you} added a comment to {task}: {comment}"),user:_("{user} added a comment to {task}: {comment}"),someone:_("{someone} added a comment to {task}: {comment}")},added_comment:{you:_("{you} added a comment: {comment}"),user:_("{user} added a comment: {comment}"),someone:_("{someone} added a comment: {comment}")},added_project_comment_to:{you:_("{you} added a project comment to {project}: {comment}"),user:_("{user} added a project comment to {project}: {comment}"),someone:_("{someone} added a project comment to {project}: {comment}")},added_project_comment:{you:_("{you} added a project comment: {comment}"),user:_("{user} added a project comment: {comment}"),someone:_("{someone} added a project comment: {comment}")}},n=null,o={},a="you";if(o.you=SPAN({c:"user"},_("You")),null!==e.initiator_id&&e.initiator_id!==window.User.id){var i=P.getUserById(e.initiator_id);null!=i?(a="user",o.user=SPAN({c:"user"},E.formatSimple(i.full_name.split(" ")[0]))):(a="someone",o.someone=SPAN({c:"user"},_("Someone")))}if("item"===e.object_type){if(null!=e.extra_data.content&&(t=E.format(e.extra_data.content),t=t.replace(/^\*\s+/g,""),o.task=$setHTML(SPAN({c:"object"}),t)),"added"===e.event_type)n=r.added_task[a];else if("deleted"===e.event_type)$setClass(o.task,"through"),n=r.deleted_task[a];else if("completed"===e.event_type)$setClass(o.task,"through"),n=r.completed_task[a];else if("uncompleted"===e.event_type)n=r.uncompleted_task[a];else if("updated"===e.event_type)if(void 0!==e.extra_data.last_content)t=E.format(e.extra_data.last_content),t=t.replace(/^\*\s+/g,""),o.old=$setHTML(SPAN({c:"through"}),t),n=r.renamed_task[a];else if(void 0!==e.extra_data.due_date)if(null===e.extra_data.due_date)n=r.removed_task_due_date[a];else{var l=N.fromDate(new Date(e.extra_data.due_date));o.due_date=k.create({due:l},!0),$setClass(o.due_date,"bold"),n=null===e.extra_data.last_due_date?r.set_task_due_date[a]:r.changed_task_due_date[a]}else if(void 0!==e.extra_data.responsible_uid)if(null===e.extra_data.responsible_uid)n=r.unassigned_task[a];else{var u=void 0,c=P.getUserById(e.extra_data.responsible_uid);null!=c?window.User.id===c.id?(u="to_you","you"===a?o.to_yourself=SPAN({c:"user"},_("yourself")):o.to_you=SPAN({c:"user"},_("you"))):(u="to_user",o.to_user=SPAN({c:"bold"},E.formatSimple(c.full_name.split(" ")[0]))):(u="to_someone","someone"===a?o.to_someone_else=SPAN({c:"user"},_("someone else")):o.to_someone=SPAN({c:"user"},_("someone"))),n=null===e.extra_data.last_responsible_uid?r.assigned_task[a][u]:r.reassigned_task[a][u]}}else if("note"===e.object_type&&(null!=e.extra_data.content&&(t=E.format('"'+$trim(e.extra_data.content,160)+'"'),t=t.replace(/^\*\s+/g,""),o.comment=$setHTML(DIV({c:"object"}),t)),"added"===e.event_type))if(null!=e.parent_item_id){var d=e.parent_item_id,f=this.item_by_id[d]||S.getById(d);f&&(this.item_by_id[d]||(this.item_by_id[d]=f),t=E.format(f.content),t=t.replace(/^\*\s+/g,""),o.task=$setHTML(SPAN({c:"object"}),t)),null!=o.task?($AEV(o.comment,"click",$p(I.showItemNotes,e.parent_item_id,null,null)),o.comment=A({href:"#"},o.comment),n=r.added_comment_to[a]):n=r.added_comment[a]}else if(null!=e.parent_project_id){var p=e.parent_project_id,m=this.project_by_id[p]||T.get(p);m&&(this.project_by_id[p]||(this.project_by_id[p]=m),t=E.format(m.name),t=t.replace(/^\*\s+/g,""),o.project=$setHTML(SPAN({c:"object"}),t)),null!=o.project?($AEV(o.comment,"click",$p(I.showProjectNotes,e.parent_project_id,null,null)),o.comment=A({href:"#"},o.comment),n=r.added_project_comment_to[a]):n=r.added_project_comment[a]}var h=R.format(n,o);if(null==h)return null;var v=DIV();if($add(v,h),"item"===e.object_type){var y=O.renderIcon({id:e.object_id},s.TYPE_ITEM_NOTE,e.extra_data.note_count);$add(v,y)}return v}},{key:"_renderBlankState",value:function(){var e=void 0;e=window.User.is_premium?_("You don't have any events"):_("The activity log is a premium feature");var t=DIV();$setHTML(t,_("See all changes that have been made in your account, by you or your collaborators.{next_line}Free users can still view their completed tasks inside any project.").replace("{next_line}","<br/>"));var r=DIV({c:"blank_state_text"},B(e),t);return window.User.is_premium||$add(r,DIV({c:"text"},$setHTML(SPAN(),_("<a>Upgrade to Todoist Premium</a> for instant access to this and a lot of other features.").replace("<a>",'<a href="/premium" target="_blank">')))),r}},{key:"_createReq",value:function(e,t,r,n){var o=$requestJSON("/API/"+V.api_version+"/activity/get");o.offline_message=!0;var a={token:window.User.token,annotate_notes:!0,limit:30};return null!=n&&(a.initiator_id=n,n===window.User.id&&(a.initiator_id_null=!0)),a.object_event_types=null!=r?'["'+r+'"]':'["item:", "note:added"]',null!=e?(a.parent_project_id=e,a.include_child_objects=!0):null!=t&&(a.parent_item_id=t,a.include_parent_object=!0),this.current_page>=2&&(a.page=this.current_page),0!==this.current_offset&&(a.offset=this.current_offset),[o,a]}},{key:"_processReqData",value:function(e){var t=!0,r=!1,n=void 0;try{for(var o,a=e.events[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;$isString(i.event_date)&&(i.event_date=new Date(i.event_date))}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}if(this.current_offset+=e.events.length,this.current_offset>=e.count)return this.current_page+=1,this.current_offset=0}}]),e}();t.exports=new F},{"../../models/Collaborators":160,"../../models/DateExt":164,"../../models/ItemsModel":167,"../../models/ProjectsModel":171,"../../models/SyncEngine":181,"../../reducers/mainView":426,"../../reducers/notes/notesConstants":430,"../../stores/store":456,"../agenda/RenderDayView":11,"../avatars/Avatars":17,"../format_html/FormatHtml":21,"../formatter/Formatter.js":22,"../items_utils/ItemDueDates.js":31,"../items_utils/ItemsRender":33,"../notes/Notes":46,"../notes/NotesUtils":49,"../people_assigner/PeopleAssigner":55,"../project_selecter/ProjectSelecter":68,"../themes/Themes":95,"./ActivityEvents":3}],5:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o,a=e("../../utils/fp"),i=e("../../models/DateExt"),s=n(i),l=e("../../stores/store"),u=n(l),c=e("../../stores/subscribeSelected"),d=n(c),f=e("../../reducers/counts"),p=e("../../constants/constants"),m=e("react"),h=n(m),v=e("react-dom"),y=n(v),g=e("../../reducers/filters"),b=e("../../react_components/emptyState"),w=e("../../reducers/tooltip"),E=window.Signals,k=window.IstComplete,S=window.ElementStore,j=e("../action_perfomed/ActionPerformed"),T=e("../items_utils/ItemAddEditForm"),O=e("../items_utils/ItemCommonEdits"),I=e("../items_utils/ItemsRender"),P=e("../items_utils/ItemCheckbox"),C=e("../generic_manager/GenericManagerUtils.js"),D=e("../generic_manager/GenericArrows.js"),A=e("../../menus/MenuAgendaEdit.js"),M=e("../left_menu/LeftMenu"),x=e("../project_editor/ProjectEditorManager"),R=e("../quick_find/QuickFind"),N=e("./AgendaUtils"),L=e("./AgendaRenderUtils"),U=e("./AgendaCurrentDays"),V=e("./CompletedToday"),F=e("../../models/ItemsModel"),B=e("../../models/Reminders").BufferedRemindersModel,H=e("../../filterist"),G=e("../../filterist/errors"),z=e("../../filterist/section"),q=e("../onboarding/Onboarding");r.get=function(){return o},r.init=function(){window.AgendaInstance=o=new K};var W="overdue & !assigned to: other, today & !assigned to: other",Y="overdue & !assigned to: other, 7 days & !assigned to: other",K=Class({name:"Agenda",init:function(){var e=this;$bindMethods(this),this.saved_collapse_state={},this.current_query="",this.current_view_type=null,this.genereateAgendaArrows(),U.reset(),E.connect("theme_changed",function(){e.currenty_query&&(V.reset(),e.renderCompletedTodayIfNeeded())});var t=this;E.connect("natural_language_project_updated",function(e){var r=t.current_form&&t.current_form[1]&&t.current_form[1].people_assigner;if(r){r.onProjectUpdated(e);var n=$gc(t.current_form[1],"td","people_assigner_holder");r.isShown()?$show(n):$hide(n)}}),(0,d.default)(u.default,function(e){return e.user.features.karma_vacation},function(e){return e.user.days_off},function(){V.reset(),e.renderCompletedTodayIfNeeded()}),(0,d.default)(u.default,function(e){return e.mainView},function(t){var r=t.type,n=t.id,o=u.default.getState();if(e.current_view_type=r,r===p.MAIN_VIEW_TYPE_LABEL){var i=(0,a.get)("labels."+n+".name",o);N.query("@"+i)}else if(r===p.MAIN_VIEW_TYPE_FILTER){var s=(0,a.get)("filters."+n+".query",o);N.query(s,!1)}else r===p.MAIN_VIEW_TYPE_TODAY?(window.scroll(0,0),N.query(W)):r===p.MAIN_VIEW_TYPE_7_DAYS&&(window.scroll(0,0),N.query(Y))})},query:function(e,t,r){return j.mark("Agenda/query"),window.AGENDA_LAST_SHOWN=null,t=void 0===t||t,r=void 0===r||r,E.sendSignal("agenda_query",e),this.current_query=e,0!=r&&R.setValue(""),this.clearEmptyStateIfNeeded(),M.hide(),this._runQuery(t),!1},reset:function(){R.setValue(""),R.setPlaceholder(null),this.current_query="",this.saved_collapse_state={},U.reset(),k.hide(),V.reset()},saveCurrentCollapseState:function(){this.saved_collapse_state={};var e=this.saved_collapse_state;$map($all("li","task_item"),function(t){t.json&&(e[t.json.id]=t._collapsed)})},refresh:function(e,t){if(this.current_form)return void setTimeout(this.refresh,300);if(this.current_query.length){if(e&&t){var r=!1;if(e.due&&t.due?r=e.due.isSameDate(t.due):e.due||t.due||(r=!0),r&&e.priority==t.priority)return!1}this.saveCurrentCollapseState(),this._runQuery()}},blur:function(){R.blur()},showFilterEmptyState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.badSymbol,r=e.queryString,n=DIV({id:"empty-state-holder"}),o=u.default.getState();y.default.render(h.default.createElement(b.EmptyStateFilterIncorrect,{query:r,symbol:t,onButtonClick:function(){E.sendSignal("filterlist_open_edit",o.mainView.id)}}),n);var a=$("editor");$replace(a,n);var i=(0,g.filterGetByID)(o,o.mainView.id);i&&$addToTop(a,DIV(H2({c:"section_header"},i.name)))},_runQuery:function(e){x.reset();var t=this;if(this.current_form=null,""===this.current_query)return!1;E.sendSignal("change_location","agenda/"+this.current_query);var r;try{r=H.filter(this.current_query)}catch(t){if(!(t instanceof G.UnrecognizedSymbolError))return console.log(t),this.showFilterEmptyState();if(!e)return this.showFilterEmptyState(t);try{var n="q:"+this.current_query;r=H.filter(n),this.current_query=n}catch(e){return this.showFilterEmptyState(t)}}U.reset();var o=DIV({id:"agenda_view"}),a=r.length>1;a&&(r=r.filter(function(e){return!(e.view===z.VIEW_TYPE_OVERDUE&&0==e.items.length)}),a=r.length>1);var i=this.current_query==W||this.current_query==Y;if(!this.current_view_type&&r.length>0){var s=r[0].name;s&&s.indexOf(" ")<0&&"@"===s[0]?this.current_view_type=p.MAIN_VIEW_TYPE_LABEL:this.current_view_type=p.MAIN_VIEW_TYPE_FILTER}var l=!1;if($map(r,function(e){e.items.length>0&&(l=!0),L.renderSection(t,o,e,i,e.orderable,a)}),l?this.clearEmptyStateIfNeeded():this.renderCompletedTodayIfNeeded(o),this.renderEmptyNext7DaysIfNeeded(o),(this.current_query==W||this.current_query==Y)&&r.length>1){var u;u=this.current_query==W?H2({c:"view_header"},_("Today")):H2({id:"next7days",c:"view_header"},_("Next 7 days")),$addToTop(o,u),$all("h2","section_header",o).forEach(function(e){$replaceClass(e,"section_header","subsection_header")})}this.cur_div=o,$replace($("editor"),o),E.sendSignal("rendered.queries"),this.renderOnboardingTipIfNeeded(),this.flashItem(),this.highlightItems()},flashItem:function(){if(this.flash_item){var e=$("item_"+this.flash_item);e&&($addClass(e,"item_flash"),window.scrollTo(0,$position(e).y-200)),this.flash_item=null}},highlightItems:function(){this.highlight_item_ids&&(this.highlight_item_ids.forEach(function(e){var t=$("item_"+e);t&&$addClass(t,"item_hightlight_flash")}),this.highlight_item_ids=null)},showAddItem:function(e){var t=this;return this.saveCurrentItem(function(){var r=$parent(e,"li"),n=$parent(e,"ul");t.clearEmptyStateIfNeeded();var o=function(){return $show(r),t.current_form_edit=null,T.genericCancelEdit(),t.renderCompletedTodayIfNeeded(),!1},a=DateUtils.dateistResultFromDate(n.day_date),i={cancel:C.genCancel("li",o,t,null,{"data-track":"task_form|cancel"}),action:function(r){track("task_form","click","add_from_agenda"),t._onAdd(r)&&t.showAddItem(e)},submit_val:_("Add Task"),name_val:"",due_date:s.default.fromDateist(a),no_indent:!0},l=T.generateForm(i);t.current_form=["add",l.form],$hide(r),$addBefore(l.li_item,r),l.textarea.proxyPlaceCursor()}),!1},_onAdd:function(e,t){var r=$parent(e,"ul"),n=this,o=$parent(e,"li"),a=T.parseFormData(e);if(!a)return!1;if(""==a.content)return $child(e,"a","cancel").onclick(),$isFunction(t)&&t(),!1;var i=1,s=o.previousSibling;s&&s.json&&s.json.day_order&&(i=s.json.day_order+1),a.day_order=i,T.genericAddItem(e,a),a.item_order=null;var l=F.add(a);if(B.reminders.length>0&&B.commitBuffered(l),l.due&&l.due.isSameDate(r.day_date)){var u=n.renderItem(l);$swap(o,u),this.displayArrows(u.json,u)}else $remove(o),this.current_form=null,this.flash_item=l.id,this.refresh(),O.notifyAddedTo(l);return this.current_form=null,$show($child(r,"li","agenda_add_task")),$isFunction(t)&&t(),!0},saveCurrentItem:function(e){if(this.current_form){var t;t="edit"==this.current_form[0]?this._onSave:this._onAdd,t(this.current_form[1],e)}else e()},editCurrentItem:function(e,t){var r=$parent($eventElm(t),"li");if(this.isClickAble(r)){A.get().hide(!0);var n=$p(this._initForm,r,e);return this.saveCurrentItem(n),!1}},_initForm:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this,n=function(){return $show(e),r.current_form=null,T.genericCancelEdit(),!1},o=e.json,a={cancel:C.genCancel("li",n,this,null,{"data-track":"task_form|cancel"}),action:r._onSave,submit_val:_("Save"),name_val:o.content,due_date:o.due,current_item:e,priority:e.json.priority,responsible_uid:e.json.responsible_uid,no_indent:!0,is_note:t.is_note};a.onKeyPress=function(t){if(13==t.keyAscii)return!k.isShown()&&(r.saveCurrentItem(),!1);if(t.ctrl&&38==t.keyAscii){var n=r.getPElement(e);if(n)return r.saveCurrentItem(function(){r._initForm(n)}),!1}if(t.ctrl&&40==t.keyAscii){var o=r.getNElement(e);return!!o&&(r.saveCurrentItem(function(){r._initForm(o)}),!1)}if(9==t.keyAscii){if(k.isShown())return!1;var a=$f(r.current_form[1],"due_date");if(a){var i=$eventElm(t);i&&!$hasClass(i,"due_date")&&($preventDefault(t),a.click())}}};var i=T.generateForm(a);return r.current_form=["edit",i.form],$hide(e),$addAfter(i.li_item,e),i.textarea.proxyPlaceCursor(),!1},_onSave:function(e,t){track("task_form","click","save");var r=this,n=$parent(e,"li"),o=n.previousSibling,a=$update({},o.json),i=T.genericSaveItem(o,e);if(i){i.item.indent=a.indent;var s=r.renderItem(i.item,o.render_opts||null);return $swap(o,s),this.displayArrows(s.json,s,!1),$map($all("li","item_"+o.json.id),function(e){if(e!=s){var t=r.renderItem(i.item,o.render_opts||null);$swap(e,t)}}),this.refresh(a,i.item),this.current_form=null,$isFunction(t)&&t(),!1}},renderItem:function(e,t){var r;r||(r={fn_toggle_menu:A.toggle,fn_complete_item:this.completeItem,fn_undo_complete_item:this.uncompleteItem,with_project:!0,with_time:!0,no_indent:!0}),t&&$update(r,t);var n=I.renderItem(e,r);n.render_opts.renderCls=this,$addClass(n,"agenda_item"),$addClass(n,"indent_1"),e.id in this.saved_collapse_state?n._collapsed=this.saved_collapse_state[e.id]:n._collapsed=!0;var o=!0;return t&&t.not_editable&&(o=!1),o&&(C.attachClick(n.td_time,$p(this.editCurrentItem,r)),C.attachClick(n.content,$p(this.editCurrentItem,r))),n},completeItem:function(e,t){var r=this;if(q.isFirstCompleteAction())return void q.showFirstCompleteAnimation(e,function(){r.completeItem(e,t)});var n=e.json.due&&e.json.due.isSameDate(new Date);j.mark("Agenda/complete");var o=!1;t&&t.shift&&(o=!0);var a=F.complete(e.json,o),i=!1,s=$first(a);s&&s.in_history&&(i=!0),$map(a,function(e){var t=$("item_"+e.id);t&&(!i&&$hasClass(t,"agenda_child_expanded")?P.update(t,1,r.uncompleteItem,!1):T.removeItemInList(t))}),r.arrows.updateArrows(),e.json.due&&e.json.due.is_recurring&&r.refresh(),n&&(V.reset(),setTimeout(r.renderCompletedTodayIfNeeded,150))},uncompleteItem:function(e){j.mark("Agenda/complete");var t=F.uncomplete(e.json);$update(e.json,t),P.update(e,0,this.completeItem),this.arrows.updateArrows(),this.renderCompletedTodayIfNeeded()},getSortableItems:function(){return $all("li","agenda_item").filter(function(e){if($hasClass(e,"reorder_item"))return!0;var t=e.json.due&&e.json.due.isLessThan(new Date);return!($isHidden(e)||$hasClass(e,"moved")||t)})},displayArrows:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2]
;F.getChildren(e).length>0&&(this.arrows.displayArrow(t),r&&this.fetchChildren(t))},genereateAgendaArrows:function(){var e=this;this.arrows=new D,this.arrows.list=this,this.arrows.getChildren=C.getChildren,this.arrows._hasChildren=function(e){return!(!e||!e.json)&&F.getChildren(e.json).length>0},this.arrows._getArrows=function(e){return $all("div","arrow",e)},this.arrows._switchState=function(t){return o.saveCurrentItem(function(){var r=t.host_item;r._collapsed=!r._collapsed,e.fetchChildren(r),$remove($all("div","arrow",r)),e.arrows.displayArrow(r),e.saveCurrentCollapseState()}),!1}},fetchChildren:function(e){var t=S.get(e,"children");if(e.fetched&&t)return void(e._collapsed?$map(t,function(e){$hide(e)}):$map(t,function(e){$show(e)}));e._collapsed||N.fetchChildren(e)},getNElement:function(e){for(var t=e.nextSibling;t;){if(!$isHidden(t)&&!$hasClass(t,"manager"))return t;t=t.nextSibling}},getPElement:function(e){for(var t=e.previousSibling;t;){if(!$isHidden(t)&&!$hasClass(t,"manager"))return t;t=t.previousSibling}},renderEmptyNext7DaysIfNeeded:function(e){if(this.current_query===Y){var t=$("empty-state-holder");if(t)return $addToTop(e,t);var r=DIV({id:"empty-state-holder"});(0,w.isScheduled)(w.TOOLTIP_EMPTY_STATE_NEXT_7DAYS,u.default.getState())&&(y.default.render(h.default.createElement(b.EmptyStateNext7Days,null),r),$addToTop(e,r))}},renderCompletedTodayIfNeeded:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$("agenda_view");if(this.current_query===W){var t=void 0;if(this.current_query===W){var r=u.default.getState();(0,f.countToday)(r)+(0,f.countOverdue)(r)===0?($add(e,t=DIV({id:"completed_today_holder"})),V.render(t,e,this)):this.clearEmptyStateIfNeeded()}}},renderOnboardingTipIfNeeded:function(){q.showCompleteTaskTooltipIfNeeded()},clearEmptyStateIfNeeded:function(){var e=$("empty-state-holder");e&&(y.default.unmountComponentAtNode(e),$remove($("completed_today_holder")),$remove(e))},isClickAble:function(e){return e&&!$isIn($nodeName(e),["a","img"])&&!$hasClass(e,"label")&&!$hasClass(e,"menu")}})},{"../../constants/constants":98,"../../filterist":133,"../../filterist/errors":130,"../../filterist/section":136,"../../menus/MenuAgendaEdit.js":146,"../../models/DateExt":164,"../../models/ItemsModel":167,"../../models/Reminders":173,"../../react_components/emptyState":241,"../../reducers/counts":408,"../../reducers/filters":412,"../../reducers/tooltip":448,"../../stores/store":456,"../../stores/subscribeSelected":457,"../../utils/fp":477,"../action_perfomed/ActionPerformed":2,"../generic_manager/GenericArrows.js":24,"../generic_manager/GenericManagerUtils.js":26,"../items_utils/ItemAddEditForm":28,"../items_utils/ItemCheckbox":29,"../items_utils/ItemCommonEdits":30,"../items_utils/ItemsRender":33,"../left_menu/LeftMenu":38,"../onboarding/Onboarding":52,"../project_editor/ProjectEditorManager":61,"../quick_find/QuickFind":76,"./AgendaCurrentDays":6,"./AgendaRenderUtils":7,"./AgendaUtils":8,"./CompletedToday":9,react:"react","react-dom":"react-dom"}],6:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.DateistDateHelpers,s=window,l=s.DateUtils,u=function(){function e(){n(this,e),this.reset=this.reset.bind(this),this.add=this.add.bind(this),this.isAdded=this.isAdded.bind(this),this.getNonOverdue=this.getNonOverdue.bind(this)}return o(e,[{key:"reset",value:function(){this.current_dates={},this.current_dates_list=[]}},{key:"add",value:function(e){e=i.date_max(e);var t=l.formatView(e);this.current_dates[t]=e,this.current_dates_list.push(e)}},{key:"isAdded",value:function(e){e=i.date_max(e);var t=l.formatView(e);return this.current_dates[t]}},{key:"getNonOverdue",value:function(){var e=i.date_min(new Date),t=[],r=!0,n=!1,o=void 0;try{for(var a,s=this.current_dates_list[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;i.is_overdue(e,l)||t.push(l)}}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}return t}}],[{key:"initClass",value:function(){this.prototype.current_dates={},this.prototype.current_dates_list=[]}}]),e}();u.initClass(),t.exports=new u},{}],7:[function(e,t,r){"use strict";var n=e("./RenderSearchView"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=e("../../models/ProjectsModel"),i=e("./RenderFlatListView"),s=e("./RenderDayView"),l=e("./RenderAllProjectsView"),u=e("./RenderMultiDayView"),c=e("./RenderOverdueView");r.renderSection=function(e,t,r,n,d,f){"flat_view"===r.view?i.render(e,t,r.items,r.name,!1,f):"day_view_fixed"===r.view?s.render(e,t,r.day_date,r.items,d):"day_view_span"===r.view?u.displayItems(e,t,r.items,d):"view_all"===r.view?l.render(e,t,a.getAll()):"search"===r.view&&o.default.render(e,t,r),"overdue"===r.view&&c.render(e,t,r.items,n)}},{"../../models/ProjectsModel":171,"./RenderAllProjectsView":10,"./RenderDayView":11,"./RenderFlatListView":12,"./RenderMultiDayView":13,"./RenderOverdueView":14,"./RenderSearchView":15}],8:[function(e,t,r){"use strict";var n=e("../../utils/deps"),o=e("../../reducers/items"),a=window,i=a.ElementStore,s=(0,n.defineDeps)("AgendaUtils",["Agenda","ItemsModel","store"]);r.query=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return s.Agenda.get().query(e,t,r)},r.blur=function(){return s.Agenda.get().blur()},r.reset=function(){return s.Agenda.get().reset()},r.refresh=function(){return s.Agenda.get().refresh()},r.getQuery=function(){return s.Agenda.get().current_query},r.renderItem=function(e,t){return s.Agenda.get().renderItem(e,t)},r.showAddItem=function(e){return s.Agenda.get().showAddItem(e)},r.fetchChildren=function(e){e.fetched=!0,e._collapsed=!1;var t={};e.render_opts&&$update(t,e.render_opts),t.no_indent=!1,t.no_drag_and_drop=!0;var r=e,n=[],a=!0,l=!1,u=void 0;try{for(var c,d=s.ItemsModel.getChildren(e.json,{sorted:!0})[Symbol.iterator]();!(a=(c=d.next()).done);a=!0){var f=c.value;f=(0,o.annotateWithIndent)(f,s.store.getState()),f.agenda_child_view=!0,f.dont_show_arrow=!0,f.collapsed=!1,e.json.indent>1&&(f.indent=f.indent-e.json.indent+1),f.in_history&&f.indent>1&&(t.no_checkbox=!0);var p=s.Agenda.get().renderItem(f,t);$addClass(p,"agenda_child_expanded"),$removeClass(p,"indent_1"),p.fetched=!0,$addAfter(p,r),r=p,n.push(p)}}catch(e){l=!0,u=e}finally{try{!a&&d.return&&d.return()}finally{if(l)throw u}}return i.set(e,"children",n),!1}},{"../../reducers/items":417,"../../utils/deps":470}],9:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=e("react"),a=n(o),i=e("react-redux"),s=e("react-dom"),l=n(s),u=e("../../stores/store"),c=n(u),d=e("../opener/WindowOpener.js"),f=n(d),p=e("../../reducers/stats"),m=e("../../reducers/user"),h=e("../../react_components/emptyState"),v=e("../../containers/ProductivityStat"),y=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(v),g=function(){var e=$("empty-state-holder");e&&(l.default.unmountComponentAtNode(e),$remove(e),$remove($("completed_today_holder")))},b=function(e,t,r){var n=c.default.getState(),o=(0,p.completedToday)(n),s=(0,p.totalCompleted)(n),u=void 0,d=$("empty-state-holder")||DIV({id:"empty-state-holder",c:"completed_today"});return $add(e,d),u=0===o?s<10?a.default.createElement(h.EmptyStateTodayNew,{onButtonClick:function(){var e=$gc($gc(t,"li","agenda_add_task"),"a");r.showAddItem(e)}}):n.user.features.karma_vacation?a.default.createElement(h.EmptyStateTodayVacation,{onButtonClick:function(){return f.default.showPrefs("karma")}}):(0,m.isDayOff)(n)?a.default.createElement(h.EmptyStateTodayDayOff,null):a.default.createElement(h.EmptyStateTodayDefault,{onButtonClick:function(){var e=$gc($gc(t,"li","agenda_add_task"),"a");r.showAddItem(e)}}):a.default.createElement(i.Provider,{store:c.default},a.default.createElement(h.EmptyStateTodayZero,{onFacebookClick:function(){w(function(e){e.facebook&&window.open(e.facebook)})},onProductivityClick:y.show,onTwitterClick:function(){w(function(e){e.twitter&&window.open(e.twitter)})}})),l.default.render(u,d),d},w=function(e){var t=$requestJSON("/API/v7/completed/get_tdzero_share_urls");t.addCallback(e),t.addErrback(function(){return alert(_("Something went wrong sharing your productive day. We still think you're awesome though! Please try again!"))}),t.sendReq({token:window.User.token})};r.render=b,r.reset=g},{"../../containers/ProductivityStat":110,"../../react_components/emptyState":241,"../../reducers/stats":446,"../../reducers/user":451,"../../stores/store":456,"../opener/WindowOpener.js":53,react:"react","react-dom":"react-dom","react-redux":"react-redux"}],10:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../project_editor/ProjectEditorManager"),i=function(){function e(){n(this,e),this.render=this.render.bind(this)}return o(e,[{key:"render",value:function(e,t,r){var n=[],o=!0,i=!1,s=void 0;try{for(var l,u=r[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;n.push(c.id)}}catch(e){i=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw s}}a.showProjects(n,null,{holder:t,update_location:!1,dont_replace_holder:!0,hideEmptyState:!0})}}]),e}();t.exports=new i},{"../project_editor/ProjectEditorManager":61}],11:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.DateistDateHelpers,s=window,l=s.DateUtils,u=e("./AgendaCurrentDays"),c=e("./AgendaUtils"),d=e("./sort"),f=d.dayViewSortFn,p=function(){function e(){n(this,e),this.render=this.render.bind(this)}return o(e,[{key:"getDefaultOpts",value:function(e){var t=new Date,r=i.date_max(t),n=e.getTime()<r.getTime();return{day_diff:Math.abs(i.day_diff(t,e)),cur_date:r,is_overdue:n}}},{key:"render",value:function(e,t,r,n){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=void 0;u.add(r),e.display_date=!0;var s=DIV(),l=this.getDefaultOpts(r);$add(s,this._renderDayHeader(i.date_max(r),!0,l)),$add(s,a=UL({class:"items day_list"})),a.day_date=r,0===l.day_diff&&$addClass(a,"ul_today"),n.sort(f),o||$addClass(a,"is_filtered");var d=LI({c:"agenda_item reorder_item",s:"font-size: 0; height: 0px; padding: 0;"});$add(a,d);var p=!0,m=!1,h=void 0;try{for(var v,y=n[Symbol.iterator]();!(p=(v=y.next()).done);p=!0){var g,b=v.value;$add(a,g=e.renderItem(b,{no_drag_and_drop:!o})),e.displayArrows(b,g)}}catch(e){m=!0,h=e}finally{try{!p&&y.return&&y.return()}finally{if(m)throw h}}if($add(t,DIV({c:"section_day"},s,a)),0===l.day_diff||!l.is_overdue){var w=void 0,E=void 0;$add(a,E=LI({c:"agenda_add_task"},w=A({href:"#",c:"action"},SPAN({c:"icon icon_add"},svgs.get("sm1/plus.svg")),_("Add Task")))),w.onclick=E.onclick=$p(c.showAddItem,w)}}},{key:"_renderDayHeader",value:function(e,t,r){var n=void 0;r||(r=this.getDefaultOpts(e));var o=i.is_same_date(e,r.cur_date),a=function(t){var r=A({href:"#"},t);return $AEV(r,"click",function(){var t=void 0,r=i.day_diff(new Date,e);return t=0===r?_("Today"):1===r?_("Tomorrow"):l.getWeekDay(e.getDay()),c.query(t),!1}),r};if(r.is_overdue&&!o)n=H2({c:"section_header"}),1===r.day_diff?($add(n,a(_("Yesterday"))),$add(n,SPAN({class:"subsection_header__date"},l.formatView(e,!0)))):($add(n,a(_("%s days ago").replace("%s",Math.abs(r.day_diff)))),$add(n,SPAN({class:"subsection_header__date"},l.formatView(e,!0)))),$addClass(n,"overdue");else{var s=void 0;0===r.day_diff?(n=H2(a(_("Today"))),s=!0):1===r.day_diff?(n=H2(a(_("Tomorrow"))),s=!0):(n=H2(a(l.getWeekDay(e.getDay()))),s=!1),$addClass(n,"section_header"),$add(n,SPAN({class:"subsection_header__date"},l.formatView(e,s)))}return n}}]),e}();t.exports=new p},{"./AgendaCurrentDays":6,"./AgendaUtils":8,"./sort":16}],12:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../../stores/store"),s=n(i),l=e("react"),u=n(l),c=e("react-dom"),d=n(c),f=e("../../reducers/stats"),p=e("../../constants/constants"),m=e("../../react_components/emptyState"),h=e("./sort"),_=h.createFlatListSort,v=function(){function e(){o(this,e),this.render=this.render.bind(this)}return a(e,[{key:"render",value:function(e,t,r,n){var o=(!(arguments.length>4&&void 0!==arguments[4])||arguments[4],arguments.length>5&&void 0!==arguments[5]&&arguments[5]);$add(t,DIV(H2({c:"section_header"},n)));var a=UL({class:"items section_separator",style:"margin-bottom: 9px;"});if(0===r.length&&!o){var i=$("empty-state-holder")||DIV({id:"empty-state-holder"}),l=(0,f.totalCompleted)(s.default.getState()),c=void 0;switch(e.current_view_type){case p.MAIN_VIEW_TYPE_LABEL:c=l<20?u.default.createElement(m.EmptyStateLabelNew,null):u.default.createElement(m.EmptyStateLabelZero,null);break;case p.MAIN_VIEW_TYPE_FILTER:c=l<20?u.default.createElement(m.EmptyStateFilterNew,null):u.default.createElement(m.EmptyStateFilterZero,null)}return d.default.render(c,i),void $add(t,i)}e.display_date=!1;var h=_(s.default.getState());r.sort(h);var v=!0,y=!1,g=void 0;try{for(var b,w=r[Symbol.iterator]();!(v=(b=w.next()).done);v=!0){var E=b.value,k=e.renderItem(E,{with_due_date:!0,with_time:!1,with_project:!0,no_indent:!0,no_drag_and_drop:!0});$add(a,k),e.displayArrows(E,k)}}catch(e){y=!0,g=e}finally{try{!v&&w.return&&w.return()}finally{if(y)throw g}}$add(t,a)}}]),e}();t.exports=new v},{"../../constants/constants":98,"../../react_components/emptyState":241,"../../reducers/stats":446,"../../stores/store":456,"./sort":16,react:"react","react-dom":"react-dom"}],13:[function(e,t,r){"use strict";var n=e("../../utils"),o=e("./AgendaCurrentDays"),a=e("./RenderDayView"),i={displayItems:function(e,t,r,i){var s=(0,n.groupBy)(r,function(e){return e.due.dateMin().getTime()}),l=!0,u=!1,c=void 0;try{for(var d,f=(0,n.keys)(s).sort()[Symbol.iterator]();!(l=(d=f.next()).done);l=!0){var p=d.value,m=s[p],h=m[0].due.toDate();o.add(h),a.render(e,t,h,m,i)}}catch(e){u=!0,c=e}finally{try{!l&&f.return&&f.return()}finally{if(u)throw c}}}};t.exports=i},{"../../utils":484,"./AgendaCurrentDays":6,"./RenderDayView":11}],14:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../../stores/store"),s=n(i),l=e("../../models/ItemsModel"),u=n(l),c=window,d=c.Signals,f=e("../../containers/SmartSchedule"),p=e("./sort"),m=p.createOverdueViewSort,h=e("../../menus/MenuReschedule"),v=function(){function e(){var t=this;o(this,e),this.render=this.render.bind(this),this.current_items=null,d.connect("menu_reschedule_hide",function(){t.current_items=null}),d.connect("menu_open_smart_schedule",function(){f.openSmartSchedule(t.current_items),h.get().hide()}),d.connect("menu_move_to_today",function(){var e=new Date,r=t.current_items.reduce(function(t,r){return t[r.id]=e,t},{});u.default.updateDue(r),h.get().hide()})}return a(e,[{key:"render",value:function(e,t,r,n){var o=this,a=void 0,i=DIV({c:"section_overdue"},a=H2({c:"section_header warning"},_("Overdue")));if(r.length>0&&n){var l=svgs.get("sm1/calendar.svg",{width:20,height:20,className:"icon"}),u=A({c:"smart_schedule_link menu"},_("Reschedule overdue"),l);$AEV(u,"click",function(){o.current_items=r,h.get().toggle(u)}),$add(a,u)}var c=UL({class:"items section_separator",style:"margin-bottom: 9px;"});if(0===r.length)$add(c,LI({c:"no_matches"},_("No tasks match your query")));else{e.display_date=!1,r.sort(m(s.default.getState()));var d=!0,f=!1,p=void 0;try{for(var v,y=r[Symbol.iterator]();!(d=(v=y.next()).done);d=!0){var g=v.value,b=e.renderItem(g,{with_due_date:!0,with_time:!1,with_project:!0,no_indent:!0,no_drag_and_drop:!1});$add(c,b),e.displayArrows(g,b)}}catch(e){f=!0,p=e}finally{try{!d&&y.return&&y.return()}finally{if(f)throw p}}}$add(i,c),$add(t,i)}}]),e}();t.exports=new v},{"../../containers/SmartSchedule":112,"../../menus/MenuReschedule":155,"../../models/ItemsModel":167,"../../stores/store":456,"./sort":16}],15:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("../../utils/fp"),c=e("../../utils"),d=e("../avatars/Avatars"),f=o(d),p=e("../notes/NoteMedia"),m=o(p),h=e("../notes/Notes"),v=o(h),y=e("../project_editor/ProjectEditorManager"),g=o(y),b=e("../../stores/store"),w=o(b),E=e("../../containers/premium_promo/PremiumOnlyModal"),k=n(E),S=e("react"),j=o(S),T=e("react-dom"),O=o(T),I=e("../../logger/Logger"),C=o(I),D=e("../../react_components/emptyState"),M=e("../../models/SyncEngine"),x=o(M),R=e("../../reducers/notes/notesSelectors"),N=n(R),L=e("../../reducers/items/utils"),U=e("../items_utils/ItemCheckbox"),V=o(U),F=window,B=F.Indicator,H=F.DateUtils,G=e("../../models/ItemsModel"),z=e("../../models/ProjectsModel"),q=e("./sort"),W=q.createSearchViewSort,Y=q.createNoteSearchViewSort,K=e("../../models/Collaborators"),J=e("../formatter/Formatter.js"),Q=e("../items_utils/ItemsRender"),X=e("../themes/Themes"),Z={render:function(e,t,r){new oe(e,r).render(t,r)}},ee=(0,u.get)(".file_attachment.file_name"),te=(0,u.get)(".file_attachment.title"),re=(0,u.sortBy)(["project_id","date_completed"]);r.default=Z;var ne=function(e){return new Promise(function(t,r){var n=$requestJSON("/API/"+x.default.api_version+"/completed/search");n.offline_message=!0,n.addCallback(function(e){e.items&&(e.items=e.items.map(L.deserializeItemFields)),t(e)}),n.addErrback(function(e){r(e)}),x.default.api_version>="v7.5"?n.sendReq({query:"search: "+e,only_history:!0,token:window.User.token}):n.sendReq({query:e,only_history:!0,token:window.User.token})})},oe=function(){function e(t,r){var n=this;i(this,e),this.unarchiveHistoryItem=function(e){G.unarchive(e.json),V.default.update(e,0,n.agenda.completeItem)},this.agenda=t,this.section=r,this.query=r.query,this.completedholder=null,this.handleFetchLink=this.handleFetchLink.bind(this),this.render=this.render.bind(this),this.renderItem=this.renderItem.bind(this),this.renderTabs=this.renderTabs.bind(this),this.notes=[],this.items=[]}return l(e,[{key:"getSearchResult",value:function(){var e=G.getAll(!1),t=N.getAllNotes(w.default.getState()),r=(0,c.looseMatch)(this.query),n=e.filter(function(e){return!e.in_history&&!(0,c.isSection)(e.content)&&r(e.content)}),o=function(e){return!(!ee(e)||!r(ee(e)))||!(!te(e)||!r(te(e)))},a=t.filter(function(e){return!!r(e.content)||!!o(e)});return this.sortItems(n),this.sortNotes(a),[n,a]}},{key:"sortItems",value:function(e){var t=W(w.default.getState());e.sort(t)}},{key:"sortNotes",value:function(e){var t=Y(w.default.getState());e.sort(t)}},{key:"renderTabs",value:function(e,t){var r=this,n=e.map(function(e){return LI(e[0])}),o=e.map(function(e){return DIV({c:"ist_tab_content"},e[1])}),i=UL.apply(void 0,[{c:"ist_tab_nav"}].concat(a(n))),s=DIV.apply(void 0,a(o));$addClass(n[0],"active"),$addClass(o[0],"active"),$add(t,i,s);for(var l=function(){for(var t=0;t<e.length;t++)$removeClass(n[t],"active"),$removeClass(o[t],"active")},u=0;u<e.length;u++)!function(t){var a=e[t][0],i=n[t],s=o[t];$AEV(i,"click",function(){l(),r.clearEmptyState(),$addClass(i,"active"),$addClass(s,"active"),a===_("Comments")&&0===r.notes.length?r.renderNoMatch(s,{with_action:!1,shouldFadeIn:!1}):a===_("Tasks")&&0===r.items.length&&r.renderNoMatch(s,{shouldFadeIn:!1})})}(u)}},{key:"render",value:function(e){var t=DIV({c:"search_holder section_separator"}),r=(0,c.format)(_("Results for \u201c{search_term}\u201d"),{search_term:this.query});$add(t,H2({c:"section_header"},r));var n=this.getSearchResult(),o=s(n,2),a=o[0],i=o[1];this.notes=i,this.items=a;var l=this.renderItemsResult(a),u=this.renderNotesResult(i);this.renderTabs([[_("Tasks"),l],[_("Comments"),u]],t),$add(e,t)}},{key:"addFetchLink",value:function(e){var t=DIV({c:"search_link_holder"}),r=A({c:"action search_completed"},_("Search completed tasks..."));$add(t,r);var n=G.getAll(!1),o=(0,c.looseMatch)(this.query),a=n.filter(function(e){return!e.in_history&&e.checked&&!(0,c.isSection)(e.content)&&o(e.content)}),i=$p(this.handleFetchLink,t,a);$AEV(r,"click",i),$add(e,t)}},{key:"handleFetchLink",value:function(e,t){var r=this;if(!window.User.is_premium)return void k.showCompletedTasksSearch();$replace(e,null),$add(e,B.cssSpinner());var n=void 0;ne(this.query).catch(function(e){throw n=C.default.captureError(e,{tags:{where:"complete_search"}}),e}).then(function(o){try{if($remove($("items_no_match")),$replace(e,null),o.projects){var i=!0,s=!1,l=void 0;try{for(var u,d=$values(o.projects)[Symbol.iterator]();!(i=(u=d.next()).done);i=!0){var f=u.value;z.archivedFeteched(f)}}catch(e){s=!0,l=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw l}}}if(0===o.items.length){var p=(0,c.format)(_('No completed tasks matching for "{search_term}"'),{search_term:r.query});r.renderNoMatch(r.completedholder,{alt_text:p,with_action:!1})}else{var m=UL({c:"items",style:"margin-bottom: 9px;"});r.sortItems(t);var h=re(o.items);[].concat(a(t),a(h)).forEach(function(e){r.renderItem(m,e)}),$add(r.completedholder,m)}}catch(e){throw n=C.default.captureError(e,{tags:{where:"complete_search"}}),e}}).catch(function(){$remove($("items_no_match")),$replace(e,null);var o=A({c:"action search_completed"},_("Search completed tasks..."));$AEV(o,"click",$p(r.handleFetchLink,e,t));var a=DIV(P({c:"error_msg"},_("An unknown error happened while searching. Please wait a few minutes and try again."),CODE("(ERROR_ID: "+n+")")),o);$add(e,a)})}},{key:"renderItemsResult",value:function(e){var t=this,r=UL({c:"items",style:"margin-bottom: 9px;"});if(this.completedholder=DIV({c:"completed_holder"}),0===e.length)return this.renderNoMatch(this.completedholder);e.map(function(e){t.renderItem(r,e)});var n=DIV(r);return this.addFetchLink(n),$add(n,this.completedholder),n}},{key:"renderItem",value:function(e,t){if(t=G.getById(t.id)||t){if(z.get(t.project_id)){var r=!t.in_history&&!t.checked,n={with_due_date:!0,with_time:!0,with_project:!0,no_indent:!0,no_drag_and_drop:!0,not_editable:!r};t.in_history&&(n.fn_undo_complete_item=this.unarchiveHistoryItem);var o=this.agenda.renderItem(t,n);$add(e,o),r&&this.agenda.displayArrows(t,o)}}}},{key:"renderNoMatch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.alt_text,n=t.with_action,o=void 0===n||n,a=t.shouldFadeIn,i=void 0===a||a,s=r||(0,c.format)(_("No matches for \u201c{search_term}\u201d"),{search_term:this.query}),l=DIV({id:"empty-state-holder"}),u=G.getAll(!1),d=(0,c.looseMatch)(this.query),f=u.filter(function(e){return!e.in_history&&e.checked&&!(0,c.isSection)(e.content)&&d(e.content)});return $add(e,l),O.default.render(j.default.createElement(D.EmptyStateSearchResults,{headerText:s,withAction:o,shouldFadeIn:i,onButtonClick:$p(this.handleFetchLink,e,f)}),l),e}},{key:"renderNotesResult",value:function(e){var t=this;if(0!==e.length){var r=UL({c:"note_search_list",style:"margin-bottom: 9px;"});e.map(function(e){var n=t.renderNote(e);$add(r,n)});return DIV(r)}}},{key:"renderNote",value:function(e){var t=e.posted_uid===window.User.id?window.User:K.getUserById(e.posted_uid),r=void 0,n=void 0,o=!e.item_id;if(o){if(!(n=z.get(e.project_id)))return null}else{var a=G.getById(e.item_id);if(!a)return null;n=z.get(a.project_id),r=H6({c:"task_title"}),$setHTML(r,J.format(a.content,{as_html:!0}))}var i=void 0;n&&(i=Q.createProjectItem(null,n),$AEV(i,"click",function(){g.default.showProjects([n.id])}));var s=t?f.default.renderAvatar(t,"medium",X.theme):f.default.renderAnonymous("medium"),l=DIV({c:"note_content"}),u=J.format(e.content,{as_html:!0});n.shared&&t&&(u=(0,c.firstName)(t.full_name)+": "+u),$setHTML(l,u);var d=m.default.render(e),p=SPAN({c:"time"},H.formatView(new Date(e.posted))),h=DIV({c:"content"},r||null,l,d,DIV({c:"meta_info"},p,i)),_=LI(s,h);return $AEV(_,"click",function(){o?v.default.showProjectNotes(e.project_id,e.id):v.default.showItemNotes(e.item_id,e.id)}),_}},{key:"clearEmptyState",value:function(){var e=$("empty-state-holder");e&&(O.default.unmountComponentAtNode(e),$remove(e))}}]),e}()},{"../../containers/premium_promo/PremiumOnlyModal":120,"../../logger/Logger":141,"../../models/Collaborators":160,"../../models/ItemsModel":167,"../../models/ProjectsModel":171,"../../models/SyncEngine":181,"../../react_components/emptyState":241,"../../reducers/items/utils":420,"../../reducers/notes/notesSelectors":432,"../../stores/store":456,"../../utils":484,"../../utils/fp":477,"../avatars/Avatars":17,"../formatter/Formatter.js":22,"../items_utils/ItemCheckbox":29,"../items_utils/ItemsRender":33,"../notes/NoteMedia":45,"../notes/Notes":46,"../project_editor/ProjectEditorManager":61,"../themes/Themes":95,"./sort":16,react:"react","react-dom":"react-dom"}],16:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.createNoteSearchViewSort=r.createSearchViewSort=r.createOverdueViewSort=r.createDayViewSortByProject=r.createFlatListSort=r.createByProjectAndItemOrderSort=r.createByResponsible=r.dayViewSortFn=r.byItemContent=r.byID=r.byChildOrder=r.byDateAdded=r.byProjectID=r.byDayOrder=r.byDueDate=r.byPriority=r.composeSortFunc=void 0;var o=e("reselect"),a=e("../../utils"),i=e("../formatter/Formatter"),s=n(i),l=e("../../logger/Logger"),u=n(l),c=r.composeSortFunc=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e,r){var n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value,u=l(e,r);if(0!=u)return u}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return 0}},d=r.byPriority=function(e,t){return t.priority-e.priority},f=r.byDueDate=function(e,t){return e=e.due,t=t.due,e||t?e&&!t?-1:!e&&t?1:e.isSameDate(t)?e.with_time||t.with_time?e.with_time&&!t.with_time?-1:!e.with_time&&t.with_time?1:e.getTime()-t.getTime():0:e.getTime()-t.getTime():0},p=r.byDayOrder=function(e,t){return e=e.day_order,t=t.day_order,$isNumber(e)&&$isNumber(t)?-1===e&&-1!==t?1:-1!==e&&-1===t?-1:e-t:$isNumber(e)&&!$isNumber(t)?-1:!$isNumber(e)&&$isNumber(t)?1:$isNumber(e)||$isNumber(t)?void 0:0},m=r.byProjectID=function(e,t){return e=e.project_id,t=t.project_id,(0,a.isRealID)(e)&&(0,a.isRealID)(t)?e-t:(0,a.isRealID)(e)&&(0,a.isTempID)(t)?-1:(0,a.isTempID)(e)&&(0,a.isRealID)(t)?1:(0,a.isTempID)(e)&&(0,a.isTempID)(t)?e.localeCompare(t):void 0},h=r.byDateAdded=function(e,t){return e=e.date_added,t=t.date_added,_(e)&&_(t)?e.getTime()-t.getTime():!_(e)&&_(t)?1:_(e)&&!_(t)?-1:_(e)||_(t)?void 0:0},_=(r.byChildOrder=function(e,t){return e.child_order-t.child_order},function(e){return e instanceof Date}),v=r.byID=function(e,t){return e=e.id,t=t.id,(0,a.isRealID)(e)&&(0,a.isRealID)(t)?e-t:(0,a.isRealID)(e)&&(0,a.isTempID)(t)?-1:(0,a.isTempID)(e)&&(0,a.isRealID)(t)?1:(0,a.isTempID)(e)&&(0,a.isTempID)(t)?e.localeCompare(t):void 0},y={only_text:!0,as_html:!1,with_links:!0},g=(r.byItemContent=function(e,t){return e=s.default.formatSimple(e.content,y),t=s.default.formatSimple(t.content,y),e===t?0:e<t?-1:1},r.dayViewSortFn=c(f,d,p,h,m,v),[Math.pow(10,12),Math.pow(10,10),Math.pow(10,7),Math.pow(10,4),Math.pow(10,2)]),b=(0,o.createSelector)(function(e){return e.projects},function(e){var t=(0,a.LMemoize)(function(t){var r=e[t];if(r.inbox_project)return 1e6;if(r.team_inbox)return 1000001;for(var n=[];;){if(n.push(r.child_order),!r.parent_id)break;r=e[r.parent_id]}n.reverse();for(var o=0,a=0;a<n.length;a++)o+=n[a]*g[a];return o});return function(e,r){return e=t(e.project_id),r=t(r.project_id),e-r}}),w=(r.createByResponsible=(0,o.createSelector)(function(e){return e.collaborators.all},function(e){return function(t,r){return t=e[t.responsible_uid],r=e[r.responsible_uid],t||r?t&&!r?-1:!t&&r?1:t&&r?t.full_name===r.full_name?0:t.full_name>r.full_name?-1:1:void 0:0}}),(0,o.createSelector)(function(e){return e.sections},function(e){return e.items},function(e,t){var r=(0,a.LMemoize)(function(r){for(var n=t[r],o=[];;){o.push(n.child_order);{if(!n.parent_id){var a=e[n.section_id],i=a?a.section_order+1:1;o.push(i);break}if(!t[n.parent_id])return u.default.captureMessage("visual_order_issue",{extra:{item:n}}),-1;n=t[n.parent_id]}}o.reverse();for(var s=0,l=0;l<o.length;l++)s+=o[l]*g[l];return s});return function(e,t){return e=r(e.id),t=r(t.id),e-t}})),E=r.createByProjectAndItemOrderSort=(0,o.createSelector)(b,w,function(e,t){return c(e,t)}),k=(r.createFlatListSort=(0,o.createSelector)(E,function(e){return c(d,f,e,v)}),r.createDayViewSortByProject=(0,o.createSelector)(E,function(e){return c(f,d,e,m,v)}),r.createOverdueViewSort=(0,o.createSelector)(E,function(e){return c(f,d,e,v)}),r.createSearchViewSort=(0,o.createSelector)(E,function(e){return c(e,v)}),function(e,t){return e.item_id&&t.item_id?0:!e.item_id&&t.item_id?-1:e.item_id&&!t.item_id?1:e.item_id||t.item_id?void 0:0}),S=function(e,t){return e.item_id&&t.item_id?e.item_id-t.item_id:0},j=(0,o.createSelector)(w,function(e,t){return function(r,n){var o=e[r.item_id],a=e[n.item_id];return o&&a?t(o,a):0}}),T=(0,o.createSelector)(b,function(e,t){return function(r,n){var o=e[r.item_id],a=e[n.item_id];return o&&a?t(o,a):0}});r.createNoteSearchViewSort=(0,o.createSelector)(T,j,function(e,t){return c(e,k,t,S,v)})},{"../../logger/Logger":141,"../../utils":484,"../formatter/Formatter":22,reselect:"reselect"}],17:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){
return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e),this.renderAvatar=this.renderAvatar.bind(this),this.renderAnonymous=this.renderAnonymous.bind(this)}return o(e,[{key:"renderAvatar",value:function(e,t,r){var n=void 0;if(e.image_id)n=""+this.base_url+e.image_id+"_"+t+".jpg";else{var o=50;"small"===t&&(o=18);var a="theme_dark"==r?"1f1f1f":"ffffff";n="https://avatars.doist.com/?"+$encode({fullName:e.full_name||e.email.split("@")[0],email:e.email,size:2*o,bg:a})}return IMG({src:n,c:"user_avatar "+t})}},{key:"renderAnonymous",value:function(e){return IMG({src:"https://d3ptyyxy2at9ui.cloudfront.net/circular_profile-4f3966.svg",c:"user_avatar "+e})}}],[{key:"initClass",value:function(){this.prototype.base_url="https://dcff1xvirvpfp.cloudfront.net/"}}]),e}();a.initClass();var i=new a;window.Avatars=i,void 0!==t&&null!==t&&(t.exports=i)},{}],18:[function(e,t,r){"use strict";var n=window,o=n.Signals,a=e("../../models/SyncEngine");r.init=function(){return window.COMET_TIMEOUT=null,o.connect("comet_td_sync",function(){window.COMET_TIMEOUT&&clearTimeout(window.COMET_TIMEOUT);var e=function(){return a.sync(null,!0)};window.COMET_TIMEOUT=setTimeout(e,200)})}},{"../../models/SyncEngine":181}],19:[function(e,t,r){"use strict";function n(){var e=INPUT({type:"text",value:""}),t=_("Copy to clipboard"),r=A({href:"#",c:"action"},t),n=DIV(e,r),o=FORM({c:"copy_to_clipboard"},n),a=function(){try{e.focus();try{e.setSelectionRange(0,9999)}catch(t){e.select()}if(!document.execCommand("Copy"))throw new Error("fail");$setHTML(r,_("Text copied!")),$addClass(r,"active"),setTimeout(function(){$setHTML(r,t),$removeClass(r,"active")},1500)}catch(e){alert(_("Could not copy the URL to the clipboard! Please copy manually."))}return!1};return $AEV(r,"click",a),$AEV(e,"keydown",function(e){return!(!e.ctrlKey&&!e.metaKey)||($preventDefault(e),!1)}),$AEV(e,"cut",function(e){return $preventDefault(e),!1}),{form:o,input:e,fn_copy_to_clipboard:a}}Object.defineProperty(r,"__esModule",{value:!0}),r.genereate=n},{}],20:[function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../../utils/deps"),s=window,l=s.MouseHover,u=window,c=u.ElementStore,d=e("../../components/project_editor/ProjectEditorManager"),f=e("../postpone/Postpone"),p=e("../sortable/Sortable.js"),m=e("../items_utils/ItemCommonEdits"),h=e("../../models/ItemsModel"),v=e("../../models/StateModel"),y=e("../../utils").intID,g=(0,i.defineDeps)("DragAndDrop",["Agenda","ProjectList"]),b=function(){function e(){o(this,e),this.attachHandler=this.attachHandler.bind(this),this.attach=this.attach.bind(this),this.agendaMakeSortable=this.agendaMakeSortable.bind(this),this.projectEditorMakeSortable=this.projectEditorMakeSortable.bind(this),this.projectListMakeSortable=this.projectListMakeSortable.bind(this),this.genericMouseDown=this.genericMouseDown.bind(this),this.genericOnEnd=this.genericOnEnd.bind(this),this.genericMakeSortable=this.genericMakeSortable.bind(this),this.agendaOnEnd=this.agendaOnEnd.bind(this),this.agendaOnDrag=this.agendaOnDrag.bind(this),this.agendaOnStart=this.agendaOnStart.bind(this),this.onDragToProject=this.onDragToProject.bind(this),this.onEndToProject=this.onEndToProject.bind(this),this.autoFocusInput=this.autoFocusInput.bind(this),this.scrollCustom=this.scrollCustom.bind(this),this.handler=DIV({c:"drag_and_drop_handler"},svgs.get("sm1/drag.svg")),this.handler.onmousedown=this.genericMouseDown,this.handler.reuseable=!0,this.current_li=null,v.set("drag_and_drop_mode",v.DragMode.waiting)}return a(e,[{key:"attachHandler",value:function(e){$gc(e,"div","drag_and_drop_handler")||(this.current_li=e,$child(e,"div","arrow")?$addClass(this.handler,"extra_arrow_marigin"):$removeClass(this.handler,"extra_arrow_marigin"),$ATT(e,this.handler))}},{key:"attach",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=function(){return v.get("drag_and_drop_mode")!==v.DragMode.reordering&&(l.clearCurrentTimeout(),t.attachHandler(e))},o=function(){return $remove(t.handler)};l.attach(e,"drag_and_drop_"+e.json.id,n,o,200),r.trigger_mouse_over&&n()}},{key:"agendaMakeSortable",value:function(e){return this.genericMakeSortable(g.Agenda.get(),e)}},{key:"projectEditorMakeSortable",value:function(e){return this.current_editor=d.current_editor,this.drag_section=c.get($parent(this.current_li,"div","section"),"SectionList"),this.genericMakeSortable(this.current_editor,e)}},{key:"projectListMakeSortable",value:function(e){return this.genericMakeSortable(g.ProjectList,e)}},{key:"genericMouseDown",value:function(e){if(e&&e.shiftKey)return!1;var t=this.current_li.json.manager_type,r=this.current_li.getAttribute("data-type");return $hasClass(this.current_li,"agenda_item")?this.agendaMakeSortable(e):$hasClass(this.current_li,"task_item")||"project_editor"===t?this.projectEditorMakeSortable(e):"project_list_item"===r?this.projectListMakeSortable(e):void 0}},{key:"genericOnEnd",value:function(){v.set("drag_and_drop_mode",v.DragMode.waiting),this.current_editor=null,this.sortable.onEnd(),this.autoFocusInput()}},{key:"genericMakeSortable",value:function(e,t){var r=this,n=void 0,o=void 0;e.save_indent=!1,this.handler.onmousedown=this.genericMouseDown;var a=$parent(this.handler,"li");if("ProjectEditor"===e.list_class){n=[];var i=!0,s=!1,l=void 0;try{for(var u,c=$all("li","task_item")[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var d=u.value;$hasClass(d,"history_item")||($hasClass(d,"reorder_item")||d.json&&!$isHidden(d))&&n.push(d)}}catch(e){s=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(s)throw l}}}else n=e===g.Agenda.get()?e.getSortableItems():e.getAllRenrededItems(!0);this.sortable=o=new p(n,e),this.project_items=null;var f=!1,m=o,h=m.onDrag,_=o,y=_.onEnd,b=o,w=b.onStart;return"ProjectEditor"===e.list_class?(this.project_items=this.calculateProjectListXY(),this.list_class=e,h=this.onDragToProject,y=this.onEndToProject,f=!0):e===g.ProjectList?(y=function(){r.genericOnEnd(),e.saveOrder()&&e.reRender()},e===g.ProjectList?f=!0:this.sortable.set_indent=!1):e===g.Agenda.get()&&(y=this.agendaOnEnd,w=this.agendaOnStart,h=this.agendaOnDrag,this.sortable.set_indent=!1),ICE.$dnd.dragAble(a,{handler:this.handler,move_x:f,on_start:w,on_drag:h,scroll_on_overflow:!0,scroll_custom:this.scrollCustom,on_end:y}),v.set("drag_and_drop_mode",v.DragMode.reordering),ICE.$dnd._start(this.handler,t),$preventDefault(t),!1}},{key:"agendaOnEnd",value:function(e){var t=ICE.$dnd.current_root,r=t.json;if(this.genericOnEnd(e),this.postpone_drop){var o=$hasClass(this.postpone_drop,"drop_background");if($remove(this.postpone_drop),o)return void f.postPoneUpdate(t.json,!0)}$removeClass(t,"moved");var a=$parent(t,"ul"),i=$hasClass(a,"is_filtered"),s={},l=1,u=!0,c=!1,d=void 0;try{for(var p,m=a.childNodes[Symbol.iterator]();!(u=(p=m.next()).done);u=!0){var _=p.value;$hasClass(_,"moved")||_.json&&_.json.id&&!_.is_manager&&(s[_.json.id]=l++)}}catch(e){c=!0,d=e}finally{try{!u&&m.return&&m.return()}finally{if(c)throw d}}var v=a.day_date;if(r.due&&v&&!r.due.isSameDate(v)){var y=r.due.inheritDate({year:v.getFullYear(),month:v.getMonth(),day:v.getDate()});h.updateDue(n({},r.id,y))}i||h.updateDayOrders(s),g.Agenda.get().refresh()}},{key:"agendaOnDrag",value:function(){if(this.sortable.onDrag(),this.postpone_drop){var e=$position(this.postpone_drop).y,t=ICE.$dnd.mouse_pos||$mousePos(),r=t.y,n=e-r;n<14&&n>-60?$addClass(this.postpone_drop,"drop_background"):$removeClass(this.postpone_drop,"drop_background")}}},{key:"agendaOnStart",value:function(){var e=ICE.$dnd.current_root,t=e.json,r=$parent(e,"ul"),n=void 0;try{var o=f.getPostponeDate(t),a=o.formated_due;n=a}catch(e){n="",console.log(e)}this.postpone_drop=DIV({id:"postpone_drop"},svgs.get("sm1/scheduler_postpone.svg"),$setHTML(SPAN(),_("Drop to postpone: <b>%s</b>").replace("%s",n))),$setOpacity(this.postpone_drop,0),$addAfter(this.postpone_drop,r),$fx.fadeIn(this.postpone_drop),this.sortable.onStart()}},{key:"calculateProjectListXY",value:function(){var e=[],t=g.ProjectList.getAllRenrededItems(!0,!1);t.push($("filter_inbox")),$("filter_team_inbox")&&t.push($("filter_team_inbox")),t=t.concat($$('#top_filters li[data-type="project_list_item"]'));var r=!0,n=!1,o=void 0;try{for(var a,i=t[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value,l=$position(s);l.x_max=l.x+s.offsetWidth,l.y_max=l.y+s.offsetHeight,l.dom=s,e.push(l)}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}return e}},{key:"onDragToProject",value:function(){if(this.sortable.onDrag(),!this.current_li.json.manager_type){var e=ICE.$dnd.mouse_pos||$mousePos(),t=e.x,r=e.y;r+=$("left_menu").scrollTop-$scrollTop(),this.drop_to_dom&&($removeClass(this.drop_to_dom,"drop_background"),this.drop_to_dom=null);var n=!0,o=!1,a=void 0;try{for(var i,s=this.project_items[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value,u=t>=l.x&&t<=l.x_max;if(u=u&&r>=l.y&&r<=l.y_max){$addClass(l.dom,"drop_background"),this.drop_to_dom=l.dom;break}}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}}}},{key:"onEndToProject",value:function(){var e=void 0;v.set("drag_and_drop_mode",v.DragMode.waiting);var t=!0,r=!1,n=void 0;try{for(var o,a=this.project_items[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;$removeClass(i.dom,"drop_background")}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}var s=ICE.$dnd.current_root,u=this.sortable.cur_child;this.sortable.onEnd();var d=$parent(s,"div","project_editor_instance");d&&(d=c.get(d,"editor"));var f=c.get($parent(s,"div","section"),"SectionList");if(f===this.drag_section?(this.drag_section.saveOrder(s),this.drag_section.arrows.updateArrows()):f&&f!==this.drag_section&&(this.drag_section.arrows.updateArrows(),f.arrows.updateArrows(),f.saveOrder(s)),this.drop_to_dom){var p=[s];u&&(p=p.concat(u));var h={},_=h[s.json.project_id]=[s.json.id],g=!0,b=!1,w=void 0;try{for(var E,k=u[Symbol.iterator]();!(g=(E=k.next()).done);g=!0)e=E.value,_.push(e.json.id)}catch(e){b=!0,w=e}finally{try{!g&&k.return&&k.return()}finally{if(b)throw w}}var S=void 0;S=this.drop_to_dom.json?this.drop_to_dom.json.id:y(this.drop_to_dom.getAttribute("data-id")),m.moveItems(h,S);var j=!0,T=!1,O=void 0;try{for(var I,P=p[Symbol.iterator]();!(j=(I=P.next()).done);j=!0){var C=I.value;$remove(C)}}catch(e){T=!0,O=e}finally{try{!j&&P.return&&P.return()}finally{if(T)throw O}}this.drop_to_dom=null}this.autoFocusInput(),l.clearCurrentTimeout(),this.attachHandler(s)}},{key:"autoFocusInput",value:function(){if(this.current_li.json.manager_type){var e=$child(this.current_li,null,"richtext_editor");e&&e.proxyFocus()}}},{key:"updateDayStyles",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,o=$all("h2","section_header")[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var a=n.value,i=a.parentNode,s=i.nextSibling,l=0,u=!0,c=!1,d=void 0;try{for(var f,p=s.childNodes[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var m=f.value;m.json&&m.json.id&&!m.is_manager&&(l+=1)}}catch(e){c=!0,d=e}finally{try{!u&&p.return&&p.return()}finally{if(c)throw d}}0===l?$hasClass(a,"overdue")&&($remove(i),$remove(s)):$removeClass(i,"no_matches")}}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}}},{key:"scrollCustom",value:function(e,t){var r=this.scrollObject(e);r.scrollBy?r.scrollBy(0,t):r.scrollTop+=t}},{key:"scrollObject",value:function(e){var t=$("left_menu"),r=$position(t);return e.x>=r.x-50&&e.x<=r.x+t.offsetWidth?t:window}}]),e}();window.DragAndDrop=new b,t.exports=window.DragAndDrop},{"../../components/project_editor/ProjectEditorManager":61,"../../models/ItemsModel":167,"../../models/StateModel":177,"../../utils":484,"../../utils/deps":470,"../items_utils/ItemCommonEdits":30,"../postpone/Postpone":58,"../sortable/Sortable.js":90}],21:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e),this.format=this.format.bind(this)}return o(e,[{key:"format",value:function(e,t){if(null==e)return null;for(var r=e.split(/[{}]/),n=1,o=r.length-1;n<=o;n+=2){if(null==t[r[n]])return["error: ",e];r[n]=t[r[n]]}return r}}]),e}();t.exports=new a},{}],22:[function(e,t,r){"use strict";function n(e){var t=e.getAttribute("href");if(t.length<50)return t;if("/"==e.pathname)return t.substring(0,50)+"...";var r=e.pathname;r.endsWith("/")&&(r=r.substring(0,r.length-1));var n=r.split("/");return n.length<3?t.substring(0,50)+"...":e.protocol+"//"+e.hostname+"/"+n[1]+"/.../"+n[n.length-1]}var o=window.DoistFormat,a={formatSimple:function(e,t){return t=this.setOpts(t),t.with_email=!1,o.formatSimple(e,t)},format:function(e,t){return t=this.setOpts(t),e=o.format(e,t),e=a.transformExternalServices(e,t)},setOpts:function(e){return e||(e={}),e.fn_generate_link=function(e,t,r){e=e.replace(/javascript:/gi,"");var n=r.attachment;if(t==e&&n&&n.title&&n.url==e){var o=$strip(n.title);o.length>0&&(t=o)}var i=250;e==t&&(i=50),t==e&&t.length>i&&(t=t.substring(0,i)+"\u2026"),t=-1!=t.indexOf("&lt;")||-1!=t.indexOf("&gt;")?$escapeHTML(t,{skip:["&"]}):$escapeHTML(t);var s='<a href="'+e+'" class="ex_link" target="_blank" rel="noopener noreferrer" onclick="return linkRedirecter(this)" onmouseover="Formatter.showLinkTooltip(this)" onmouseout="Formatter.hideLinkTooltip(this)">'+$strip(t)+"</a>";return s=a.handleExternalServices(e,s)},e.fn_handle_gmail=function(e,t,r){return'<a href="https://mail.google.com/mail/u/0/'+t+'" class="ex_link" target="_blank" rel="noopener noreferrer" onclick="return linkRedirecter(this)">'+a.generateServiceIcon("email")+$xssStrip($strip(r))+"</a>"},e.fn_handle_outlook=function(t,r,n){if(e.only_text)return $xssStrip($strip(n));var o=a.generateServiceIcon("email");return"<a href='#openOutlook/"+r.replace(/'/g,"")+'\' class="ex_link" onclick="return OutlookIntegration.openEmail(\''+r+"')\">"+o+$xssStrip($strip(n))+"</a>"},e.fn_handle_thunderbird=function(e,t,r){var n=a.generateServiceIcon("email");return"<a thunder_id='"+r.replace(/'/g,"")+'\' href="#openThunderbird" class="ex_link" onclick="return linkRedirecter(this)">'+n+$xssStrip($strip(t))+"</a>"},e},generateServiceIcon:function(e){var t=void 0;switch(e){case"attachment":t="sm1/attachment.svg";break;case"cal":t="sm1/calendar.svg";break;case"email":t="sm1/email.svg";break;case"evernote":t="sm1/evernote.svg";break;case"twist":t="sm1/twist.svg"}return svgs.getString(t,{className:"service_icon"})},handleExternalServices:function(e,t){return-1===e.indexOf("d1x0mwiac2rqwt.cloudfront.net")&&-1===e.indexOf("files.todoist.com")||(t=a.generateServiceIcon("attachment")+" "+t),-1!==e.indexOf("mail.google.com")&&(t=a.generateServiceIcon("email")+" "+t),-1===e.indexOf("twistapp.com/a/")&&-1===e.indexOf("twist.com/a/")||(t=a.generateServiceIcon("twist")+" "+t),-1===e.indexOf("evernote.com/Home.action")&&-1===e.indexOf("evernote.com/shard")&&-1===e.indexOf("evernote://")||(t=a.generateServiceIcon("evernote")+t),-1!==e.indexOf("google.com/calendar/event")&&(t=a.generateServiceIcon("cal")+t),t},transformExternalServices:function(e){if(-1!=e.indexOf('<a href="readdle-spark://')){var t=e.match(/(<a href="readdle-spark:\/\/[^>]+>)(.+)(<\/a>)/);t&&0==t[2].indexOf("readdle-spark:")&&(e=e.replace(t[0],"")||_("Open")+" Spark",t[1]=t[1].replace('target="_blank"','target="_self"'),e=a.generateServiceIcon("email")+" "+t[1]+e+t[3])}else if(-1!=e.indexOf('<a href="bear://')){var r=e.match(/(<a href="bear:\/\/[^>]+>)(.+)(<\/a>)/);r&&0==r[2].indexOf("bear:")&&(e=e.replace(r[0],"")||_("Open")+" Bear",r[1]=r[1].replace('target="_blank"','target="_self"'),e=a.generateServiceIcon("attachment")+" "+r[1]+e+r[3])}else if(-1!=e.indexOf('<a href="airmail://')){var n=e.match(/(<a href="airmail:\/\/[^>]+>)(.+)(<\/a>)/);n&&0==n[2].indexOf("airmail:")&&(e=e.replace(n[0],"")||_("Open")+" AirMail",n[1]=n[1].replace('target="_blank"','target="_self"'),e=a.generateServiceIcon("attachment")+" "+n[1]+e+n[3])}return e},tooltip_TO:null,showLinkTooltip:function(e){a.tooltip_TO&&clearTimeout(a.tooltip_TO),a.tooltip_TO=setTimeout(function(){var t=n(e);t=$trim(t,50),IstTooltip.show(e,DIV({c:"ist_tooltip_content"},t))},350)},hideLinkTooltip:function(){a.tooltip_TO&&clearTimeout(a.tooltip_TO),IstTooltip.hide()}};window.Formatter=t.exports=a},{}],23:[function(e,t,r){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("../../stores/store"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=e("../../reducers/mainView"),s=e("../../reducers/utils"),l=window,u=l.Signals,c=window,d=c.Alerts,f=window,p=f.MenuRightClick,m=e("../../menus/HelperColorsPriorities.js"),h=m.selectColor,v=e("../generic_manager/GenericManager.js"),y=e("../generic_manager/GenericManagerUtils.js"),g=e("../action_perfomed/ActionPerformed"),b=e("../formatter/Formatter.js"),w=e("../../mini/DimensionCalculator"),E=e("../../models/TemporaryIds"),k=v.extend({initWithData:function(e){var t={data_model:e.data_model,max_indent:4,undo_reorder_intent:e.undo_reorder_intent,markdown_support:!1};$update(t,e),this.opts=t,this.parent(t),this.event_name=e.event_name,this.current_list=null,this.current_item=null,this.empty_text=e.empty_text,this.move_x=!1,this.menu.hide_callbacks.push(function(e,t){if(t){var r=$eventElm(t);if($parent(r,"div","scheduler")||$parent(r,"div","dialog-timepicker")||$parent(r,"div","dialog-timezone"))return!0;$removeClass($all("li","on_menu_show"),"on_menu_show")}}),u.connect("color_selected",this.colorSelected),e.init&&e.init(),this.is_inited=!0},insertItems:function(e){var t=this.current_list;if(t){this.opts.with_indent&&(e=(0,s.annotateIndentOrder)(e));var r=this.opts.fn_get_selected();$replace(t,null);var n=window.User.team_inbox,o=!0,a=!1,i=void 0;try{for(var l,u=e[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(!c.inbox_project&&c.id!==n){var d=this.renderItem(c);$add(t,d),this.current_item&&E.getRealId(this.current_item.json.id)==c.id&&(this.menu.shown&&(this.menu.current_holder=d),this.current_item=d),r[c.id]&&$addClass(d,"current")}}}catch(e){a=!0,i=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}y.showHideChildren($AF(t.childNodes)),this.opts.with_arrows&&this.arrows.updateArrows(),this.checkEmpty(),w.recalculate()}},reRender:function(){if(this.current_form)return void setTimeout(this.reRender,200);this.insertItems(this.opts.fn_get_all())},renderEmpty:function(){return this.parent()},checkEmpty:function(){this.parent(),u.sendSignal("check_premium_promo")},getProjectById:function(e){var t=null,r=!0,n=!1,o=void 0;try{for(var a,i=$AF(this.current_list.childNodes)[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value;if(s.json&&s.json.id===e){t=s;break}}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}return t},deselectCurrent:function(){this.current_list&&$removeClass($all("li","current",this.current_list),"current"),this.current_item&&$removeClass(this.current_item,"current")},setCurrentVisually:function(e){var t=!0,r=!1,n=void 0;try{for(var o,a=$AF(this.current_list.childNodes)[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;if(i.json&&i.json.id===e){$removeClass($all("li","current"),"current"),$addClass(i,"current");break}}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}},setCurrentById:function(e,t,r,n){var o=void 0;if(this.flash_item=t,e===window.User.inbox_project||e===window.User.team_inbox)this.setCurrent(null,r,n),a.default.dispatch((0,i.showProjectView)([e]));else{var s=!1,l=!0,u=!1,c=void 0;try{for(var d,f=$AF(this.current_list.childNodes)[Symbol.iterator]();!(l=(d=f.next()).done);l=!0)if(o=d.value,o.json&&o.json.id===e){this.setCurrent(o,r,n),s=!0;break}}catch(e){u=!0,c=e}finally{try{!l&&f.return&&f.return()}finally{if(u)throw c}}s||this.opts.fn_show_items([e],r)}return!1},setCurrent:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.cancelCurrentEdit(),this.deselectCurrent(),e&&e.json){if(g.mark("GenericLeftList/setCurrent"),this.current_item=e,this.current_item_with_children=r,$addClass(e,"current"),this.opts.with_indent&&!1!==r){var n=y.getChildren(e,!0),o=!0,a=!1,i=void 0;try{for(var s,l=n[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value;$addClass(u,"current")}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}}this.opts.fn_show_items([e.json.id],r),this.opts.with_arrows&&this.arrows.updateArrows()}},editingDone:function(e){e&&(this.current_item=e),this.current_mode=null,this.current_form=null,this.current_cancel=null,this.opts.with_arrows&&this.arrows.updateArrows(),this.checkEmpty(),this.opts.fn_editing_done&&this.opts.fn_editing_done()},saveItem:function(e,t){var r=$parent(e,"li"),n=r.list_item;if(r&&n){var o=y.getChildren(n);$addAfter(n,r);var a=n.nextSibling,i=$gc(e,null,"richtext_editor").proxyGetValue();this.opts.with_indent&&y.normalizeIndent(r,r);var s=this.selected_color,l={name:""!==i?i:n.json.name};if(this.opts.fn_parse_form&&!1===(l=this.opts.fn_parse_form(e,l,!0)))return;null!==s&&(l.color=s);var u=this.opts.data_model.update(n.json.id,l),c=this.renderItem(u);if($hasClass(n,"current")&&$addClass(c,"current"),$addClass(c,"generic_left_list_updated"),$swap(n,c),this.opts.with_indent){var d=y.getIndent(r);y.setIndent(c,d),this.saveOrder()}$remove(r),this.opts.with_indent&&y.updateParentIds(c,this.opts.data_model,o),this.editingDone(c);a!==c.nextSibling&&this.saveOrder()}return $isFunction(t)&&t(),!1},editCurrentItem:function(){var e=this;this.parent();var t=function(){if($show(e.current_item),e.opts.with_arrows)return e.arrows.updateArrows()},r={cancel:y.genCancel("li",t,this,null,{"data-track":"Labels"===this.event_name?"labels|edit_cancel":"projects|edit_cancel"}),action:this.saveItem,submit_val:_("Save"),submit_attr:{"data-track":"Labels"===this.event_name?"labels|edit_confirm":"projects|edit_confirm"},name_val:this.current_item.json.name,indent_arrows:this.opts.with_indent,placeholder:this.opts.placeholder,fn_extend_form:this.opts.fn_extend_form,current_item:this.current_item.json,manager_type:this.manager_type,manager_reodering:this.manager_reodering};this.current_cancel=r.cancel;var n=this.generateAddEditForm(r);if(this.opts.with_color){this.selected_color=null;var o=this.createColorSelector(this.current_item.json.color);$ATT(n.text_box_holder,o)}else $addClass(n.form,"no_color");var a=n.li_item,i=n.textarea;a.list_item=this.current_item,this.current_form=n.form,this.opts.with_indent&&y.setIndent(a,this.current_item.json.indent),$addAfter(a,this.current_item),i.proxyPlaceCursor(),this.arrows&&this.arrows.updateArrows()},deleteCurrentItem:function(e){var t=this,r=void 0,n=void 0;g.mark("GenericLeftList/deleteCurrentItem");var o=y.getChildren(e,!1),a=[],i=!1;e.json.shared&&(i=!0);var s=function(e){return $escape(t.format(e,!0,!1))},l=null;if(this.opts.with_indent&&o&&o.length>0){var c=[],f=!0,p=!1,m=void 0;try{for(var h,v=o[Symbol.iterator]();!(f=(h=v.next()).done);f=!0){var b=h.value;n=b.json&&b.json.name,n&&(c.push(s(n)),a.push(b.json.id))}}catch(e){p=!0,m=e}finally{try{!f&&v.return&&v.return()}finally{if(p)throw m}}r=_("Following will be deleted as well: %s."),i&&(r=_("Following will be left as well: %s.")),l=SPAN(BR(),BR(),$setHTML(SPAN(),r.replace("%s","<b>"+c.join(", ")+"</b>")))}r=_("Are you sure you want to delete %s?");var w=_("Delete");i&&(r=_("Are you sure you want to leave %s?"),w=_("Leave"));var E=SPAN($setHTML(SPAN(),r.replace("%s","<b>"+s(e.json.name)+"</b>")),l);d.confirm(E,function(r){if(r)return o.splice(0,0,e),a.splice(0,0,e.json.id),t.opts.data_model.deleteMany(a),t.opts.fn_on_delete&&t.opts.fn_on_delete(o),t.editingDone(),u.sendSignal("instant_refresh_interface")},w)},addItem:function(e,t){var r=void 0,o=$parent(e,"li"),a=o.previousSibling,i=a?a.json.item_order+1:1;r=void 0!==e.color?e.color:this.opts.default_color,void 0!==this.selected_color&&(r=this.selected_color),this.opts.with_indent&&y.normalizeIndent(o,o);var s={name:$gc(e,null,"richtext_editor").proxyGetValue(),color:r};if(this.opts.with_indent||(s.item_order=i),this.opts.fn_parse_form&&(s=this.opts.fn_parse_form(e,s,!0)),""!==s.name&&!1!==s.is_changed){var l=this.opts.data_model.add(s);if(!l)return;if(this.opts.with_indent){y.normalizeIndent(o,o);var u=y.getIndent(o);l=n({},l,{indent:u})}var c=this.renderItem(l);$addClass(c,"generic_left_list_added"),$swap(o,c),this.setCurrent(c),window.scroll(0,0),this.editingDone(c),this.saveOrder({noUndo:!0}),$isFunction(t)&&t()}else this.current_item=o,$isFunction(t)&&t();return!1},showAddItem:function(e,t,r){var n=this;if(!this.fn_check_show_add_item||this.fn_check_show_add_item()){this.parent(e,t,r);var o=function(){if(n.checkEmpty(),n.opts.with_arrows)return n.arrows.updateArrows()},a=this.current_item,i=this.opts.default_color;!0===e&&a&&(i=a.json.color),this.selected_color=i;var s={cancel:y.genCancel("li",o,this,null,{"data-track":"Labels"===this.event_name?"labels|add_cancel":"projects|add_cancel"}),action:this.addItem,submit_val:this.opts.add_text,submit_attr:{"data-track":"Labels"===this.event_name?"labels|add_confirm":"projects|add_confirm"},name_val:"",indent_arrows:this.opts.with_indent,placeholder:this.opts.placeholder,fn_extend_form:this.opts.fn_extend_form,manager_type:this.manager_type,manager_reodering:this.manager_reodering};this.current_cancel=s.cancel;var l=this.generateAddEditForm(s);if(this.opts.with_color){var u=this.createColorSelector(i);$ATT(l.text_box_holder,u)}else $addClass(l.form,"no_color");if((this.current_form=l.form).color=i,!0===e&&this.opts.with_indent){var c=y.getIndent(a)||1,d=a&&a.nextSibling;d&&d.json&&d.indent===c+1&&(c+=1),y.setIndent(l.li_item,c)}this.insertForm(l.li_item,t),this.current_item=null,this.arrows&&this.arrows.updateArrows(),setTimeout(function(){return l.textarea.proxyFocus()},20)}},render:function(){var e=this,t=DIV({c:"left_list_man"});$addClass(t,"actions");var r=A({href:"",class:"action sel_add_project","data-track":"Labels"===this.event_name?"labels|add":"projects|add"},SPAN({c:"icon_add"},svgs.get("sm1/plus.svg")),this.opts.add_text);return this.add_item=r,r.onclick=function(){return e.saveCurrentItem(function(){return e.current_item=e.getItem($last),e.showAddItem()}),!1},$add(t,r),$add($(this.opts.list_holder),t)},renderItem:function(e,t){var r=this,o=void 0,a=TABLE({cellpadding:0,cellspacing:0,class:"item_table"}),i=TBODY();$add(a,i);var s={class:"clickable"};this.li_data_type&&(s["data-type"]=this.li_data_type),s["data-id"]=e.id;var l=LI(s,a);l.json=n({},e),$ATT(l,DIV({c:"invisible_space"}));var u=null;!0!==e.not_editable?(u=y.getMenuEditIcon(),l.menu_icon=u,new p(l,$p(this.toggleMenu,l,{id:e.id,menu_icon:u},e.id)),this.opts.with_ordering&&!0!==t&&!e.inbox_project&&this.opts.DragAndDrop.attach(l)):$addClass(l,"not_editable");var c=e.name,d=c.match(/[^ ]{20}.+?/g);if(d){var f=!0,m=!1,h=void 0;try{for(var _,v=d[Symbol.iterator]();!(f=(_=v.next()).done);f=!0){var g=_.value;c=c.replace(g,g.substr(0,21)+" [BREAK_SYMBOL]")}}catch(e){m=!0,h=e}finally{try{!f&&v.return&&v.return()}finally{if(m)throw h}}}var b=this.format(c,!1,!0);b=b.replace(/\[BREAK_SYMBOL\]/g,"<br />");var w=TD({class:"name"},$setHTML(SPAN(),b)),E=TD({class:"menu"},u);$AEV(E,["click","touchstart"],function(){return r.toggleMenu(l,u,e.id)}),o=this.opts.with_color?TD({class:"td_color"},this.opts.fn_create_color(e)):null,$add(w,this.opts.fn_create_counter(e));var k=function(t){var n=$eventElm(t);if(!n.is_menu_icon&&"svg"!==$nodeName(n)&&!$hasClass(n,"arrow"))return r.opts.fn_on_click(l,e,t)};return $AEV(l,"click",k),$add(i,TR(o,w,E)),this.opts.with_indent&&y.setIndent(l,e.indent,!0),l},colorSelected:function(e){var t=$("color_selector");if(t&&this.current_form){this.selected_color=e;var r=this.createColorSelector(e);$swap(t,r),IstTooltip.hide();var n=$child(this.current_list,"textarea");n&&n.proxyFocus(!0)}},createColorSelector:function(e){var t=this,r={color:e};this.current_item&&(r.id=this.current_item.json.id);var n=this.opts.fn_create_color(r,!0);return n.id="color_selector",$addClass([n,$child(n,"div")],"menu_icon"),n.setAttribute("data-track","Labels"===this.event_name?"labels|add_or_edit_color":"projects|add_or_edit_color"),$AEV(n,"click",function(e){return e.stopPropagation(),t.menu_colors.show(n,!0),!1}),n.change_y_pos=function(e){return e+=$scrollTop(),e-=$("left_menu").scrollTop},h(this.menu_colors,e),n},createColorDiv:function(e,t){var r=DIV({class:"div_color counter_color "+this.icon,id:e});return $setStyle(r,"color",t),r},toggleMenu:function(e,t,r,n){return this.opts.fn_on_show_menu&&this.opts.fn_on_show_menu(e),$removeClass($all("li","on_menu_show"),"on_menu_show"),$addClass(e,"on_menu_show"),t.change_y_pos=function(){var e=t.menu_icon||t,r=$position(e).y+15;return r-=$("left_menu").scrollTop,r+=$scrollTop()},this.menu.toggle(t,e,n),!1},getAllRenrededItems:function(e,t){void 0===t&&(t=!0);var r=this.parent(e),n=[],o=!0,a=!1,i=void 0;try{for(var s,l=r[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value;$hasClass(u,"not_editable")||(!0===t&&u.json&&u.json.inbox_project||!0===t&&u.json&&u.json.team_inbox||n.push(u))}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}return n},isEmpty:function(){return 0===this.getAllRenrededItems(!1,!1).length},format:function(e,t,r){this.opts.markdown_support||(r=!1);var n="g_l_"+t+r,o={only_text:t,as_html:r,with_links:!1,cache_prefix:n};return b.formatSimple(e,o)}});t.exports=k},{"../../menus/HelperColorsPriorities.js":142,"../../mini/DimensionCalculator":158,"../../models/TemporaryIds":184,"../../reducers/mainView":426,"../../reducers/utils":452,"../../stores/store":456,"../action_perfomed/ActionPerformed":2,"../formatter/Formatter.js":22,"../generic_manager/GenericManager.js":25,"../generic_manager/GenericManagerUtils.js":26}],24:[function(e,t,r){"use strict";var n=e("../generic_manager/GenericManagerUtils.js"),o=new Class({init:function(e){e&&$update(this,e),void 0!==this.x_off?this.x_off=this.x_off:this.x_off=0,$bindMethods(this),$isMozilla()&&(this.y_offset=4)},updateArrows:function(e){(e=e||this.list.current_list)&&(this.removeArrows(e),this._updateArrows(e),this.list.current_his_list&&this._updateArrows(this.list.current_his_list))},displayArrow:function(e,t){if(!(e.is_manager||e.json&&e.json.dont_show_arrow)){var r=this._hasChildren(e),n=e.json&&e.json.collapsed;if(!0===t&&(n=!0),void 0!==e._collapsed&&(n=!!e._collapsed),r){var o="down";n&&(o="right");var a=svgs.get("sm1/caret.svg"),i=DIV({c:"arrow "+o});return $add(i,a),$addToTop(e,i),i.host_item=e,e.arrow=i,i.onclick=$p(this._switchState,i),i}}},removeArrows:function(e){var t=this._getArrows(e);$map(t,function(e){e.host_item&&(e.host_item.arrow=null),$remove(e)})},setList:function(e){this.list=e},_updateArrows:function(e){for(var t=$first(e.childNodes),r=t;r;)$isHidden(r)||this._childEdited(r)||this.displayArrow(r),r=r.nextSibling},_saveState:function(e,t){this.data_model.update(e,{collapsed:t},!0)},_switchState:function(e){if(e){var t=e.host_item;if(t.json.collapsed){t.json.collapsed=0;var r=n.getChildren(t);n.showHideChildren(r,t),$map(r,function(e){$addClass(e,"task_expand_collapse")})}else t.json.collapsed=1,$map(n.getChildren(t),function(e){$hide(e)});this.updateArrows($parent(t,"ul")),
this._saveState(t.json.id,t.json.collapsed)}},_hasEdit:function(e,t){return e.is_manager&&n.getIndent(e),!0},_childEdited:function(e){var t=e.nextSibling;if(!t)return!1;var r;if(e.json)r=e.json.indent;else{if(!e.previousSibling||!e.previousSibling.json)return!1;r=e.previousSibling.json.indent}for(;t;){var n=t.json;if(n&&n.indent<=r)return!1;if(t.is_manager)return!0;if(n&&n.indent<=r)return!1;t=t.nextSibling}return!1},_getArrows:function(e){if(e){var t=$parent(e,"div");return $all("div","arrow",t)}return this.list_holder||(this.list_holder=$parent(this.list.current_list,"td")),$all("div","arrow",this.list_holder)},_hasChildren:function(e){if(!e||!e.json)return!1;var t=e.nextSibling;return!!(t&&t.json&&t.json.indent>e.json.indent)}});t.exports=o},{"../generic_manager/GenericManagerUtils.js":26}],25:[function(e,t,r){"use strict";function n(e){return 13==e.keyAscii&&e.ctrl&&!e.shift||y&&77==e.keyAscii&&e.ctrl&&!e.shift}var o=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("../../models/RealHierachy"),i=e("../../utils/fp"),s=window.IstButton,l=window.IstComplete,u=window.FocusElm,c=e("../misc/Util.js").attachKeyDown,d=e("../action_perfomed/ActionPerformed"),f=e("../drag_and_drop/DragAndDrop"),p=e("../richtext_editor/RichTextEditor"),m=e("./GenericManagerUtils.js"),h=e("../../utils/isCompositionEscEvent").default,_=0,v=Class({init:function(){},initWithData:function(e){this.state_manager=this,e&&$update(this,e)},getAllRenrededItems:function(e){var t=[];return $map(this.current_list.childNodes,function(r){if(r&&r.json&&!$hasClass(r,"reorder_item")){if(!0===e&&$isHidden(r))return;t.push(r)}}),t},isFormFirst:function(){var e=$first(this.current_list.childNodes);return $hasClass(e,"reorder_item")&&(e=e.nextSibling),e==$parent(this.state_manager.current_form,"li")},isFormLast:function(){return $last(this.current_list.childNodes)==$parent(this.state_manager.current_form,"li")},isAddFormOn:function(){return this.current_form&&"add"===this.current_mode},isEditFormOn:function(){return this.current_form&&"edit"===this.current_mode},getItem:function(e){e=e||$last;var t=e(this.current_list.childNodes);return t&&$hasClass(t,"reorder_item")?t.nextSibling:t&&t.is_manager?t.previousSibling:t&&t.json&&!t.is_empty?t:null},addIndentArrows:function(e,t,r){var n=DIV({"data-track":"projects|add_or_edit_project_indent_right"},svgs.get("sm1/indent.svg")),o=DIV({"data-track":"projects|add_or_edit_project_indent_left"},svgs.get("sm1/indent.svg",{className:"flipped"})),a=this,i=function(e,r){return a.incIndent(t,e),$all(null,"richtext_editor",t)[0].proxyFocus(!0),$preventDefault(r),!1};n.onclick=$p(i,1),o.onclick=$p(i,-1),!0===r?$add(e,o,n):$add(e,n,o)},generateAddEditForm:function(e){var t=LI({class:"manager indent_1"});t.is_manager=!0,this.li_data_type&&t.setAttribute("data-type",this.li_data_type);var r=FORM(),o=s.createButton(e.submit_val);if($addClass(o,"ist_button_red"),$addClass(o,"submit_btn"),e.submit_attr)for(var a in e.submit_attr)o.setAttribute(a,e.submit_attr[a]);r.onsubmit=function(){return!1},$add(t,r);var i={tabIndex:1,autocomplete:"off",generatePlaceholder:e.generatePlaceholder};e.placeholder&&(i.placeholder=e.placeholder);var u=p(i);u.proxySetValue(e.name_val,!0,!1);var d=$p(e.action,r);r.submit_fn=d,$AEV(o,["click","touchstart"],function(e){return d(e),!1}),void 0===e.with_esc_cancel&&(e.with_esc_cancel=!0);var m=this,v=function(o){if(o=o||window.event,ICE._setEventKey(o),h(o))return!1;if(o.ctrl&&77==o.keyAscii&&e.on_ctrl_m)return $preventDefault(o),e.on_ctrl_m(o),!1;if(e.with_esc_cancel&&27==o.keyAscii){if(window.IstComplete&&window.IstComplete.isShown())return!1;if(u.cancelInput&&u.cancelInput(o))return $preventDefault(o),!1;u.blur(),e.cancel&&e.cancel.onclick(),$preventDefault(o)}if(8==o.keyAscii&&u.cancelInput&&u.cancelInput(o))return $preventDefault(o),!1;if(e.onKeyPress)return e.onKeyPress(o,t);if(n(o))return $preventDefault(o),r.submit_fn(function(){u.blur(),m.showAddItem(!0,!0)},!0),!1;if(13==o.keyAscii&&o.shift&&!e.disable_shift_enter)return $preventDefault(o),r.submit_fn(function(){u.blur(),m.showAddItem(!0,!1)},!0),!1;if(13==o.keyAscii)return(!window.IstComplete||!window.IstComplete.isShown())&&($preventDefault(o),u.blur(),r.submit_fn(null,!0),!1);if(9==o.keyAscii&&!o.ctrl){var a=$f(r,"due_date");if(a&&!l.isShown()){var i=$eventElm(o);if(i&&!$hasClass(i,"due_date"))return $preventDefault(o),a.click(),!1}}if(o.ctrl&&37==o.keyAscii&&!o.shift)return!$gp($eventElm(o),"ul","items")||(!(!r.no_indent&&0!=m.with_indent)||($preventDefault(o),m.incIndent(t,-1),!1));if(o.ctrl&&39==o.keyAscii&&!o.shift)return!$gp($eventElm(o),"ul","items")||(!(!r.no_indent&&0!=m.with_indent)||($preventDefault(o),m.incIndent(t,1),!1));var s=function(e){"edit"==m.current_mode?m.saveItem(m.state_manager.current_form,e,!0):m.addItem(m.state_manager.current_form,e,!0)};return o.ctrl&&38==o.keyAscii&&!o.shift?($preventDefault(o),s(m.editPrevItem),!1):o.ctrl&&40==o.keyAscii&&!o.shift?($preventDefault(o),s(m.editNextItem),!1):void 0},y=TABLE({width:"100%"}),g=TBODY();$add(y,g);var b,w,E=TABLE(TBODY(b=TR(w=TD({c:"text_box_holder"},u))));$AEV(w,"click",function(e){var t=$eventElm(e);if(t&&"input"==$nodeName(t))return!0;u.proxyFocus()});var k=TD({colSpan:2,class:"form_content"},E),S=TR(k);if($add(g,S),e.indent_arrows){var j=TD({rowSpan:2,class:"indent_arrows"});$add(S,j),this.addIndentArrows(j,t)}var T=TD({align:"left",c:"td_submit"}),O=TD({align:"right",c:"td_extra"});$add(T,o,e.cancel),e.td_extra&&$add(O,e.td_extra),$add(r,y),$add(r,TABLE({c:"td_submit_area"},TBODY(TR(T,O)))),e.fn_extend_form&&(r=e.fn_extend_form(r,S,e));var I=[u];return I=I.concat($all("input",null,r)),e.inputs&&(I=I.concat(e.inputs)),$map(I,function(e){c(e,v)}),e.manager_reodering&&(t.json={id:_--,manager_type:e.manager_type,indent:1},f.attach(t,{trigger_mouse_over:!0})),{li_item:t,form:r,textarea:u,text_box_holder:w,duedate:$f(r,"due_date"),form_content:k,input_holders_tr:b}},insertForm:function(e,t){var r=this.current_item;if(r&&!0===t&&e)return $addBefore(e,r),void u.focus(e,null,35);if(this.current_item){for(var n=r.nextSibling;n&&$isHidden(n);)n=n.nextSibling;return n?$addAfter(e,n.previousSibling||r):$add(this.current_list,e),void u.focus(e,null,35)}$add(this.current_list,e),u.focus(e,null,35)},saveCurrentItem:function(e){var t=this.state_manager.current_form;t?""===$gc(t,null,"richtext_editor").proxyGetValue()?(this.cancelCurrentEdit(!0),e()):"add"==this.current_mode?this.addItem(t,e):this.saveItem(t,e):e()},setCurrentItem:function(e){this.current_item=e},editPrevItem:function(){d.mark("GenericManager/editPrevItem");for(var e=this.current_item.previousSibling;e&&$isHidden(e);)e=e.previousSibling;if($hasClass(e,"reorder_item")&&(e=null),e)this.setCurrentItem(e),this.editCurrentItem(!0);else try{this.isFormFirst()||this.showAddItem(!0,!0)}catch(e){this.showAddItem(!0,!0)}},editNextItem:function(){d.mark("GenericManager/editNextItem");for(var e=this.current_item.nextSibling;e&&$isHidden(e);)e=e.nextSibling;if(e)this.setCurrentItem(e),this.editCurrentItem(!0);else try{this.isFormLast()||this.showAddItem(!0,!1)}catch(e){this.showAddItem(!0,!1)}},showAddItem:function(){d.mark("GenericManager/showAddItem"),this.setCurrentItemViaMenu(),this.current_mode="add",this.removeEmpty(),this.cancelCurrentEdit()},editCurrentItem:function(){this.setCurrentItemViaMenu(),this.current_mode="edit",d.mark("GenericManager/editCurrentItem"),this.cancelCurrentEdit(),$hide(this.current_item)},incIndent:function(e,t){var r=m.getIndent(e)+t;r<1&&(r=1),r>this.max_indent&&(r=this.max_indent);var n;if(n="add"==this.current_mode?e.previousSibling:e.previousSibling.previousSibling,n&&$hasClass(n,"reorder_item")&&(n=null),n){var o=m.getIndent(n);r>o&&(r=o+1)}m.setIndent(e,r)},empty_text:"No items",isEmpty:function(){return 0===this.getAllRenrededItems().length},renderEmpty:function(){return LI({class:"empty"},this.empty_text)},checkEmpty:function(){if(this.isEmpty()){var e=this.renderEmpty();return e&&(m.attachClick(e,this.showAddItem),e.is_empty=!0,$add(this.current_list,e)),!0}return this.removeEmpty(),!1},removeEmpty:function(){$remove($all("li","empty",this.current_list))},getCurrentOrderIndent:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.as_list,n=void 0!==r&&r,o=$all("li",null,this.current_list),a=0,i={},s=[];return $map(o,function(t){t.json&&t.json.id&&!t.is_manager&&(a++,"project_list"===!e.manager_type&&(t.json.item_order=a),n?s.push({id:t.json.id,item_order:a,indent:t.json.indent}):i[t.json.id]=[a,t.json.indent])}),n?s:i},saveOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{noUndo:!1},t=e.noUndo;if(!this.isAddFormOn()){if(this.opts.with_indent){var r=this.getCurrentOrderIndent({as_list:!0}),n=(0,a.deriveParentChildOrder)(r).map((0,i.pick)(["id","parent_id","child_order"]));return this.data_model.moveAndReorder(n,{noUndo:t}),!0}var s=(0,i.mapValues)(function(e){return o(e,1)[0]},this.getCurrentOrderIndent());return this.data_model.updateOrders(s),!0}},incOrderAfterItem:function(e){if(e&&e.json)for(var t=e.json.item_order,r=e.nextSibling,n={};r;)r.json&&r.json.id&&!r.is_manager&&(t++,r.json.item_order=t,n[r.json.id]=[t,r.json.indent]),r=r.nextSibling},setCurrentItemViaMenu:function(){var e=this.menu;e.shown&&e.current_holder&&(this.setCurrentItem(e.current_holder),this.menu.hide())},cancelCurrentEdit:function(){var e=this.state_manager.current_cancel;e&&(e.onclick(),this.state_manager.current_cancel=null)}}),y=-1!=navigator.userAgent.indexOf("Macintosh")&&$isMozilla();t.exports=v},{"../../models/RealHierachy":172,"../../utils/fp":477,"../../utils/isCompositionEscEvent":486,"../action_perfomed/ActionPerformed":2,"../drag_and_drop/DragAndDrop":20,"../misc/Util.js":44,"../richtext_editor/RichTextEditor":86,"./GenericManagerUtils.js":26}],26:[function(e,t,r){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("../action_perfomed/ActionPerformed"),a={getChildren:function(e,t){for(var r=t&&[e]||[],n=e.json.indent,o=e.nextSibling,a=e.json.project_id;o;)if($hasClass(o,"manager")||$hasClass(o,"reorder_item"))o=o.nextSibling;else{if(!o.json||!o.json.indent||o.json.indent<=n)break;if(a!=o.json.project_id)break;r.push(o),o=o.nextSibling}return r},showHideChildren:function(e,t){var r=[];t&&t.json&&r.push(t),r=r.concat(e);for(var n={},o=0;o<r.length;o++){var a=r[o],i=a.json;if(i)for(var s=o+1;s<r.length;s++){var l=r[s],u=l.json;if(!u)break;if(u.indent<=i.indent)break;n[u.id]=i}}$map(r,function(e){var t=e.json;if(t){for(var r=!0,o=t;;){if(!(o=n[o.id]))break;if(o.collapsed){r=!1;break}}r?$show(e):$hide(e)}})},getParent:function(e,t){t||(t=e.json.indent);for(var r=e.previousSibling;r;)if(r.json&&r.json.id&&!r.is_manager){if(r.json.indent<t)return r;r=r.previousSibling}else r=r.previousSibling;return null},getParentChildOrder:function(e){for(var t=this.getParent(e),r=t&&t.json?t.json.id:null,n=e.previousSibling,o=1;n;){if(n.json&&n.json.id&&!n.is_manager){if(n.json.id===r)break;o++}n=n.previousSibling}return{parent_id:r,child_order:o}},imgOnMouseOver:function(e,t,r){$AEV(e,"mouseover",function(){$removeClass(e,t),$addClass(e,r)}),$AEV(e,"mouseout",function(){$removeClass(e,r),$addClass(e,t)})},getMenuEditIcon:function(){var e=DIV({class:"icon menu gear_menu"});return $add(e,svgs.get("sm1/more_small.svg")),e.is_menu_icon=!0,e},getIndent:function(e){if(!e)return 1;var t=e.className.match(/indent_(\d)/);return t?parseInt(t[1]):1},setIndent:function(e,t,r){r||(o.mark("GenericManagerUtils/setIndent"),$map([1,2,3,4,5],function(t){$removeClass(e,"indent_"+t)})),$addClass(e,"indent_"+t),e.json&&(e.indent=t,e.json.indent=t)},attachClick:function(e,t){if(window.PRINT_MODE)return!1;$AEV(e,"click",function(e){if(2==e.button)return!1;var r=$eventElm(e);if($hasClass(r,"clickable"))return!0;if(document.selection){if(document.selection.createRange().text)return!0}if("input"==$nodeName(r))return!0;if(e.ctrl||e.shift)return!0;if(e._propogated_from_note_icon)return!0;var n=r&&$gp(r,"a");return!(r&&!n&&!$hasClass(r,"label"))||t(e)})},genCancel:function(e,t,r,o,a){o=o||_("Cancel");var i=A(n({class:"cancel",href:"",tabIndex:4},a),o),s=function(n){var o=$parent(i,e);return $remove(o),r.current_form=null,r.current_cancel=null,$isFunction(t)&&t(n),!1};return i.onclick=s,i},openParents:function(e){var t=a;if(e)for(var r=t.getParent(e);r;){var n=r.json.collapsed;r.json.collapsed=0,n&&t.showHideChildren(a.getChildren(r),r),r=t.getParent(r)}},normalizeIndent:function(e,t){if(t){var r=t.previousSibling;r&&$hasClass(r,"reorder_item")&&(r=r.previousSibling),!r&&e.json&&e.json.indent>1&&a.setIndent(e,1)}},updateParentIds:function(e,t,r){var n=a.getParent(e),o=null;n&&(o=n.json.id),e.json.parent_id!=o&&t.update(e.json.id,{parent_id:o});var i=a.getChildren(e);a.normalizeChildren(e,r,t),a.normalizeChildren(e,i,t);var s=[];s=s.concat(r),s=s.concat(i);var l={};$map(s,function(e){if(!l[e.json.id]){l[e.json.id]=!0;var r=a.getParent(e),n=null;r&&(n=r.json.id);var o={};e.json.parent_id!=n&&(o.parent_id=n),!r&&e.json.indent>1?o.indent=1:r&&r.json.indent!=e.json.indent+1&&(o.indent=r.json.indent+1,o.indent>t.max_indent&&(o.indent=t.max_indent)),o.indent&&a.setIndent(e,o.indent),$keys(o).length>0&&t.update(e.json.id,o)}})},normalizeChildren:function(e,t,r){if(t.length>0){var n=t[0];if(n.json.indent!=e.json.indent+1){var o=e.json.indent+1-n.json.indent;$map(t,function(e){var t=e.json.indent+o;t>r.max_indent&&(t=r.max_indent),a.setIndent(e,t),r.update(n.json.id,{indent:t})})}}}};window.GenericManagerUtils=t.exports=a},{"../action_perfomed/ActionPerformed":2}],27:[function(e,t,r){"use strict";var n=e("../../utils"),o=e("../../react_components/scheduler/SchedulerWrapper"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=window.Signals,s=e("../../menus/MenuPriorities"),l=e("../../menus/MenuSelecterMore"),u=e("../items_utils/ItemCommonEdits"),c=e("../action_perfomed/ActionPerformed"),d=e("../project_selecter/ProjectSelecter"),f=e("../label_selecter/LabelSelecter"),p=e("../people_assigner/PeopleSelector"),m=e("../../models/ProjectsModel"),h=e("../../models/ItemsModel"),v={last_item_selected:null,highlighted_items:{},init:function(){$AEV(window,"resize",this.resize),i.connect("action_performed",function(){v.deselectAll()}),i.connect("menu_priority_changed",function(e){var t=$all("li","selected");0!==t.length&&($map(t,function(t){u.updatePriority(t,e)}),i.sendSignal("instant_refresh_interface"),v.hideSelecta(),s.get().hide())}),i.connect("menu_selecter_delete",function(){0!==$all("li","selected").length&&(v.deleteItems(),l.hide())}),i.connect("menu_selecter_duplicate",function(){0!==$all("li","selected").length&&(v.duplicate(),l.hide(),v.hideSelecta())}),i.connect("menu_selecter_to_history",function(){var e=$all("li","selected");if(0!==e.length){var t=e.map(function(e){return e.json.id});h.archive(t),i.sendSignal("instant_refresh_interface"),l.hide(),v.hideSelecta()}}),i.connect("menu_selecter_complete",function(){var e=$all("li","selected");0!==e.length&&($map(e,function(e){h.complete(e.json)}),i.sendSignal("instant_refresh_interface"),l.hide(),v.hideSelecta())});var e=function(e){var t=$all("li","selected");if(0!==t.length){l.hide();e($gc($("item_selecter"),"a","menu_item_more"),t)}};i.connect("menu_selecter_add_label",$p(e,v.showAddLabel)),i.connect("menu_selecter_remove_label",$p(e,v.showRemoveLabel)),i.connect("menu_item_assign",function(){l.hide();var e=function(e){$all("li","selected").forEach(function(t){var r=t.json;r&&h.update(r.id,{responsible_uid:e})}),i.sendSignal("instant_refresh_interface")},t=$gc($("item_selecter"),"a","menu_item_more"),r=$all("li","selected")[0].json.project_id,n={icon:t,fn_on_select:e,project_id:r,from_rendering:!0,top_offset:40,arrow_left_offset:10};(new p).showTooltip(t,n)}),l.init()},selectClick:function(e){$AEV(e,"contextmenu",function(e){if(e.shift)return!0;$isMac()?e.meta&&$preventDefault(e):e.ctrl&&$preventDefault(e)}),$AEV(e,"mousedown",function(e){var t=$eventElm(e);if(t&&($hasClass(t,"ist_checkbox")||$hasClass(t,"ist_checkbox_img"))&&e.shift)return!0;if($isMac()&&e.meta||!$isMac()&&e.ctrl||e.shift){if($preventDefault(e),t&&($hasClass(t,"ist_checkbox")||$hasClass(t,"ist_checkbox_img")))return!0;var r=$parent(t,"li");if(e.shift&&!$hasClass(r,"selected")){var n=v.last_item_selected;if(n){var o=$all("li","task_item"),a=$index(r,o),i=$index(n,o),s=a,l=i;s>l&&(s=i,l=a);var u=o.slice(s,l);$map(u,function(e){e!=n&&e!=r&&v._selectClick(e)})}}return v.last_item_selected=r,v._selectClick(r)}})},_selectClick:function(e){return v.toggle(e),document.selection&&document.selection.empty?document.selection.empty():$body().focus(),!1},showSelector:function(){0===$all("li","selected").length?this.hideSelecta():this.showSelecta()},hideSelecta:function(){$removeClass($all("li","selected"),"selected"),$fx.fadeOut($("item_selecter"),{duration:100,onComplete:function(){$remove($("item_selecter"))}}),this.highlighted_items={},this.last_item_selected=null},showSelecta:function(){if(!$("item_selecter")){var e,t,r,n,o;$addToTop($body(),DIV({id:"item_selecter"},this.scheldue=n=A({href:"#",c:"dp_icon fixed_pos menu_item_schedule"},svgs.get("sm1/calendar.svg"),SPAN(_("Schedule"))),r=A({href:"#",c:"fixed_pos menu_item_move"},svgs.get("sm1/move.svg"),SPAN(_("Move to project"))),this.priority=o=A({href:"#",c:"fixed_pos menu_icon menu_item_priority"},svgs.get("sm1/priority_flag.svg"),SPAN(_("Priority"))),t=A({href:"#",c:"fixed_pos menu_icon menu_item_more"},svgs.get("sm1/more.svg"),SPAN(_("More")+"\u2026")),e=A({href:"#",c:"deselect_items"},svgs.get("sm1/close_big.svg")))),$fx.fadeIn($("item_selecter"),{duration:100}),$AEV(e,"click",$b(this.deselectAll,this)),$AEV(n,"click",$b(this.showScheldue,this)),$AEV(t,"click",$b(this.moreOptions,this)),$AEV(r,"click",$p($b(this.moveItems,this),r)),$AEV(o,"click",$b(this.showChangePriority,this))}this.resize()},deselectAll:function(){var e=c.get();return"ItemSelecter/toggle"!=e&&"Agenda/_runQuery"!=e&&($removeClass($all("li","selected"),"selected"),this.hideSelecta()),!1},toggle:function(e){return c.mark("ItemSelecter/toggle"),$hasClass(e,"selected")?($removeClass(e,"selected"),v.highlighted_items[e.json.id]&&delete v.highlighted_items[e.json.id]):($addClass(e,"selected"),v.highlighted_items[e.json.id]=!0),this.showSelector(),!1},resize:function(){var e=$("item_selecter"),t=$("top_bar");e&&($setLeft(e,t.offsetLeft),$setWidth(e,t.offsetWidth))},getProjectItems:function(e){var t={},r={};return $map(e,function(e){if(e.json&&!t[e.json.id]){var n=e.json.project_id;r[n]||(r[n]=[]),r[n].push(e.json.id),$map(h.getChildren(e.json),function(e){t[e.id]||(r[n].push(e.id),t[e.id]=!0)})}}),r},moreOptions:function(t){var r=e("../project_editor/ProjectEditorManager"),o=!!r.getCurrentEditor(),a=(0,n.uniq)($all("li","selected").map(function(e){if(e.json&&e.json.project_id)return e.json.project_id})),i=1==a.length,u=m.get(a[0]).shared,c=o&&i&&u;return l.show($eventElm(t),t,{show_assign:c,arrow_y_offset:17}),s.get().hide(),!1},deleteItems:function(){var e=$all("li","selected");return u.deleteItems(e),v.deselectAll(),!1},moveItems:function(e,t){var r=$all("li","selected");return v.showMoveItems(e,r,t),!1},showMoveItems:function(e,t,r){var n=v.getProjectItems(t);return d.showTooltip(e,{no_swap:!0,left_offset:50,top_offset:28,onSelect:function(e){var t=e.id;return t&&u.moveItems(n,t),r&&$isFunction(r)&&r(),i.sendSignal("instant_refresh_interface"),!1}}),!1},showChangePriority:function(e){var t=s.get(),r=$eventElm(e);return t.show(r,e,{pos_y_offset:1}),l.hide(),!1},showAddLabel:function(e,t){v.geneircAddRemoveLabel(e,t,{title:_("Add label"),updateModel:function(e){$map(t,function(t){h.addLabel(t.json,e)})}})},showRemoveLabel:function(e,t){v.geneircAddRemoveLabel(e,t,{title:_("Remove label"),updateModel:function(e){$map(t,function(t){h.removeLabel(t.json,e)})}})},geneircAddRemoveLabel:function(e,t,r){var n=void 0;n=window.MINI_VERSION?185:50;var o={left_offset:n,top_offset:28,onSelect:function(e){return r.updateModel(e),i.sendSignal("instant_refresh_interface"),!1}};$update(o,r),f.showTooltip(e,o)},showScheldue:function(e){var t=$eventElm(e),r=$all("li","selected");if(0===r.length)return alert("You must select some tasks"),!1;var o=r.map(function(e){return e.json});return a.default.show({selectedItems:o,anchor:t,dialogClassName:"scheduler-item-selecter",holder:DIV({c:"scheduler_holder"}),isDialogFixed:!0,selectedDate:1===o.length?o[0].due:null,onDateSelect:function(e){var t=o.reduce(function(t,r,o){return t[r.id]=(0,n.isArray)(e)?e[o]:e,t},{});h.updateDue(t),0===$all("li","selected").length&&v.hideSelecta(),v.deselectAll(),v.hideSelecta()}}),!1},duplicate:function(){var e=$all("li","selected").map(function(e){return e.json.id});u.duplicate(e)}};window.ItemSelecter=v,t.exports=v},{"../../menus/MenuPriorities":148,"../../menus/MenuSelecterMore":156,"../../models/ItemsModel":167,"../../models/ProjectsModel":171,"../../react_components/scheduler/SchedulerWrapper":352,"../../utils":484,"../action_perfomed/ActionPerformed":2,"../items_utils/ItemCommonEdits":30,"../label_selecter/LabelSelecter":36,"../people_assigner/PeopleSelector":57,"../project_editor/ProjectEditorManager":61,"../project_selecter/ProjectSelecter":68}],28:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../../react_components/scheduler/SchedulerWrapper"),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=window,c=u.Signals,d=window,f=d.DateUtils,p=window,m=p.Alerts,h=window,v=h.IstTooltip,y=window,g=y.IstMenu,b=window,w=b.GB_getLast,E=e("../../components/people_assigner/PeopleAssigner"),k=e("../../components/project_editor/ProjectEditorManager"),S=e("../../components/labels/Labels.js"),j=e("../../components/reminders/Reminders.js"),T=e("../notes/NotesAddTooltip"),O=e("../notes/NotesUtils"),I=e("../../plugin_version/ContentTransformers"),P=I.ContentTransformers,C=e("../../components/project_selecter/ProjectAutoComplete.js"),D=e("../people_assigner/PeopleAutoComplete.js"),A=e("../misc/Misc.js"),M=A.isMacApp,x=e("../../models/ProjectsModel"),R=e("../../models/ItemsModel"),N=e("../../models/Reminders"),L=N.RemindersModel,U=e("../../models/Reminders"),V=U.BufferedRemindersModel,F=e("../../menus/MenuPriorities"),H=e("../../menus/MenuItemEditMore"),G=e("../../menus/HelperMenuAnnotations.js"),z=e("../generic_manager/GenericManagerUtils.js"),q=e("../drag_and_drop/DragAndDrop"),W=e("../richtext_editor/NatrualLanguageParsing"),Y=e("./ItemDueDates.js"),K=function(){function e(){n(this,e),this.generateForm=this.generateForm.bind(this),this.duedatePredictReqData=this.duedatePredictReqData.bind(this),this.onSaveContent=this.onSaveContent.bind(this),this.onShowContent=this.onShowContent.bind(this),this.genericCancelEdit=this.genericCancelEdit.bind(this),this.genericAddItem=this.genericAddItem.bind(this),this.genericSaveItem=this.genericSaveItem.bind(this),this.annotateReminderButton=this.annotateReminderButton.bind(this),this.annotatePrioirtyButton=this.annotatePrioirtyButton.bind(this),this.menuPriorityUpdated=this.menuPriorityUpdated.bind(this),this.annotateNoteButton=this.annotateNoteButton.bind(this),this.annotateMoreButton=this.annotateMoreButton.bind(this),this.menuIndentGeneric=this.menuIndentGeneric.bind(this),this.parseFormData=this.parseFormData.bind(this),this.addTasksViaPaste=this.addTasksViaPaste.bind(this),c.connect("menu_priority_changed",this.menuPriorityUpdated),c.connect("menu_indent_left",$p(this.menuIndentGeneric,-1)),c.connect("menu_indent_right",$p(this.menuIndentGeneric,1)),c.connect("focus_current_item_input",function(){var e=$$("#editor .richtext_editor");if(e.length>0)try{e[0].proxyFocus(!0)}catch(e){}if(e=$$(".quick_add_task .richtext_editor"),e.length>0)try{e[0].proxyFocus(!0)}catch(e){}})}return i(e,null,[{key:"initClass",value:function(){this.prototype.current_priority=4}}]),i(e,[{key:"generateForm",value:function(e,t){var r=this,n=void 0,o=void 0,a=void 0,i=void 0,s=void 0,u=void 0,c=void 0,d=null!=e.current_item?e.current_item.json:void 0;e.name_val&&(P.setupByContent(e.name_val),P.type&&(e.name_val=P.onContentShow(e.name_val)));var p=INPUT({type:"text",c:"input_due_date",name:"due_date",tabIndex:2,placeholder:_("Schedule"),readonly:!0});e.inputs=[p],e.td_extra=SPAN({c:"form_icon_holder"},s=SPAN(),n=SPAN(),u=SPAN(),i=SPAN(),a=SPAN(),o=SPAN());var h=void 0,v=k.current_editor;k.current_section_list?h=k.current_section_list.generateAddEditForm(e):(v=k.createEditorInstance(),h=v.generateAddEditForm(e)),e.generatePlaceholder=!0,P.type&&!$hasClass(h.text_box_holder,"has_content_icon")&&P.annotateWithIcon(h.textarea),e.name_val?W.truncate_links=!0:W.truncate_links=!1;var y=!1;e.name_val&&e.name_val.length>0&&(y=!0),W.attach(h.textarea,y),$add(h.input_holders_tr,c=TD({c:"due_date_holder"},p)),h.duedate=p,e.due_date&&(e.due_date.is_recurring?p.value=e.due_date.string:p.value=f.format(e.due_date),p.result=e.due_date),d||(h.textarea.onsubmit=$p(e.action,h.form),h.textarea.onMultilinePaste=function(e,t){var n=t.split("\n");return!((e=r.getEditorTextarea())&&n.length>1)||(m.confirm(_("Do you want to add %s tasks?").replace("%s",n.length),function(o){o?r.addTasksViaPaste(e,n):(e.proxyFocus(),document.execCommand("insertHTML",!1,t),e.onchanged&&e.onchanged())},_("Add tasks")),!1)});var g=(null!=d?d.project_id:void 0)||v.project_id;if(V.current_project_id=g,x.get(g)||x.getInbox()){h.form.responsible_uid=e.responsible_uid||void 0;var b=new E({from_rendering:!1,project_id:g,responsible_uid:h.form.responsible_uid,fn_on_select:function(e){h.form.responsible_uid=e},arrow_left_offset:5});h.form.people_assigner=b;var w=TD({c:"people_assigner_holder"},b.render());b.isShown()||$hide(w),$add(h.input_holders_tr,w)}else $add(h.input_holders_tr,TD({c:"people_assigner_holder"}));e.no_indent&&(h.form.no_indent=!0);var j=h.textarea;if(e.current_item){j.proxySetValue(S.textFormat(e.name_val,e.current_item.json.labels),!0,!1);var T=z.getIndent(e.current_item);z.setIndent(h.li_item,T)}$AEV(c,"click",function(){var t=r.duedatePredictReqData(h.form,d),n=void 0;e.is_quick_add?n="scheduler-quick-add":e.is_note&&(n="scheduler-note-item"),l.default.show({dialogClassName:n,selectedDate:p.result,align:"top",anchor:c,holder:DIV({c:"scheduler_holder"}),selectedItems:[t],onHide:function(){j.proxyFocus(!0)},onDateSelect:function(e){e?(p.value=e.string,p.result=e,j.dateist_disabled=!0):(p.value="",p.result=null,j.dateist_disabled=!1),j.onchanged&&j.onchanged()}})}),S.annotateFormArea(j,n),!1===e.with_project_button&&($swap(s,null),s=null),C.annotateFormArea(j,s),V.reset(),u=this.annotateReminderButton(u,e),this.annotateNoteButton(a,e,g),this.note_button&&(e.on_ctrl_m=function(){d||r.note_button.onclick()}),e.no_indent?$remove(o):this.annotateMoreButton(o,e,h.li_item);var O=4;return e.priority&&(O=5-e.priority),this.current_priority=O,i=this.annotatePrioirtyButton(i,O),D.annotateFormArea(j),t&&t.fixed_pos&&$addClass([j,i,u,n,o],"fixed_pos"),h.form.old_date=p.value,h}},{key:"duedatePredictReqData",value:function(e,t){var r=this.parseFormData(e,null,!1),n={id:t?t.id:null,due:t?t.due:null,date_string:t&&t.due?t.due.string:null,postpone_count:t?t.postpone_count:0,content:r.content,priority:r.priority,project_id:r.project_id,labels:t?t.labels:[]};return n.project_id||(n.project_id=x.getInbox().id),n}},{key:"onSaveContent",value:function(e){return P.type?P.onContentSave(e):e}},{key:"onShowContent",value:function(e){return P.type?P.onContentShow(e):e}},{key:"genericCancelEdit",value:function(){T.reset(),P.onContollerHide()}},{key:"genericAddItem",value:function(e,t){var r=P;r.type&&(t.content=r.onContentSave(t.content),r.onContollerHide()),void 0!==e.responsible_uid&&(t.responsible_uid=e.responsible_uid,e.people_assigner=null)}},{key:"genericSaveItem",value:function(e,t){var r=$parent(t,"li"),n=$f(t,"due_date"),i=e.json,s=void 0;if(!1===(s=i.due&&t.old_date===n.value&&n.result&&n.result.date===i.due.date?i.due:!i.due&&n.result||i.due&&n.result&&n.result.date!==i.due.date?n.result:Y.parseDueDate(n)))return!1;var l=5-this.current_priority,u={id:i.id,content:this.onSaveContent($gc(t,null,"richtext_editor").proxyGetValue()),priority:l,due:s},d=void 0;if(!0!==t.no_indent){z.normalizeIndent(r,e),d=z.getIndent(r);var f=k.current_editor;f||(f=k.createEditorInstance());var p=z.getParent(e,d),m=null;p&&p.json&&p.json.id&&!p.is_manager&&(m=p.json.id),i.parent_id!==m&&(u.parent_id=m)}$addAfter(e,r),$remove(r);var h=$gc(t,null,"richtext_editor");u=W.annotateFormData(h,u),u.due&&i.due&&u.due.getTime()===i.due.getTime()&&u.due.string===t.old_date&&t.old_date===n.value&&delete u.due,""===u.content&&(u.content=i.content),u.responsible_uid||(void 0!==t.responsible_uid&&i.responsible_uid!==t.responsible_uid&&(u.responsible_uid=t.responsible_uid,u.assigned_by_uid=window.User.id),t.people_assigner=null),u.item_order||delete u.item_order;var _=Array.from(R.update(i.id,u)),v=a(_,2),y=v[0],g=v[1];return d&&(y=o({},y,{indent:d})),this.current_priority=4,this.priority_button=null,P.type&&P.onContollerHide(),w()&&c.sendSignal("instant_refresh_interface"),{item:y,is_updated:g}}},{key:"annotateReminderButton",value:function(e,t){var r=void 0;if(!M()||window.User.is_premium){var n=t.current_item;n&&L.hasReminders(n.json.id)&&$addClass(e.parentNode,"force_form_show");var o=SPAN({c:"icon_reminder"},svgs.get("sm1/reminder.svg"));return o.id="reminders_icon",$addClass(o,"form_action_icon menu_icon"),o.setAttribute("data-track","task_form|reminders"),$AEV(o,"click",function(e){return v.hide(),g.hide(),$addClass(o.parentNode,"force_form_show"),j.showTooltip(n,o,e,{pos_y_offset:40}),!1}),r=window.User.is_premium?DIV(B(_("Reminders")),BR(),_("Add a due date & time")):DIV(B(_("Reminders"))),v.showSimpleText(o,r,null,4,4),$swap(e,o),o}}},{key:"annotatePrioirtyButton",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=void 0;switch(r){case 1:n="sm1/priority_1.svg";break;case 2:n="sm1/priority_2.svg";break;case 3:n="sm1/priority_3.svg";break;default:n="sm1/priority_flag.svg"}var o=SPAN({c:"icon_priority"},svgs.get(n));o.setAttribute("data-track","task_form|priority"),4!==r&&($addClass(e.parentNode,"force_form_show"),$addClass(o,"active")),$AEV(o,"click",function(e){v.hide();var r=F.get();return r.toggle(o,o,e,{pos_y_offset:5,arrow_y_offset:21}),G.selectPriority(r,5-t.current_priority),$addClass(o.parentNode,"force_form_show"),!1});var a=DIV(B(_("Priority")),BR(),_("Add by typing p1, p2, p3, p4"));return v.showSimpleText(o,a,null,4,4),$addClass(o,"form_action_icon menu_icon"),$swap(e,o),this.priority_button=o,o}},{key:"menuPriorityUpdated",value:function(e){if(this.priority_button){e=5-e,this.current_priority=e,
F.get().hide(),this.annotatePrioirtyButton(this.priority_button,e);var t=$gp(this.priority_button,"form");W.deselectPriority(t),c.sendSignal("focus_current_item_input")}return!1}},{key:"annotateNoteButton",value:function(e,t,r){if(t.current_item||!O.isPremium(r))return void $remove(e);var n=SPAN({c:"icon_comments"},svgs.get("sm1/comments.svg"));n.setAttribute("data-track","task_form|quick_comment");var o=function(e){return v.hide(),g.hide(),$addClass(n.parentNode,"force_form_show"),T.showTooltip(n,e),!1};n.onclick=o;var a=DIV(B(_("Quick Comment")),BR(),_("Add notes, thoughts..."));return v.showSimpleText(n,a,null,5,4),$addClass(n,"form_action_icon menu_icon"),$swap(e,n),this.note_button=n,n}},{key:"annotateMoreButton",value:function(e,t,r){var n=SPAN({c:"icon_more"},svgs.get("sm1/more_small.svg"));return n.setAttribute("data-track","task_form|more"),$AEV(n,"click",function(e){return H.get().toggle(n,n,e,{arrow_y_offset:12}),!1}),$addClass(n,"form_action_icon menu_icon"),$swap(e,n),this.more_button=n,this.more_button.li_item=r,n}},{key:"menuIndentGeneric",value:function(e){var t=k.current_editor;t&&this.more_button&&t.incIndent(this.more_button.li_item,e),H.get().hide(),c.sendSignal("focus_current_item_input")}},{key:"parseFormData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=void 0,o=$parent(e,"li");if(o){var a=o.previousSibling;n=a&&a.json&&a.json.item_order+1||1}else n=null;var i=$f(e,"due_date"),s=i.result,l=5-this.current_priority,u=$gc(e,null,"richtext_editor"),c=$strip(u.proxyGetValue());z.normalizeIndent(o,o);var d={content:c,project_id:t||k.current_project_id||window.User.inbox_project,indent:o&&z.getIndent(o)||1,priority:l,due:s};n&&(d.order=n);var f=T.getValue();return f.length>0&&(d.note=f,r&&T.reset()),d=W.annotateFormData(u,d)}},{key:"removeItemInList",value:function(e){for(var t=e.nextSibling;;){if(!t)break;if($isShown(t))break;t=t.nextSibling}if($addClass(e,"checked"),$addClass(e,"complete_animation"),setTimeout($p($remove,e),140),t&&$hasClass(t,"task_item")){!!$prevSibling(t,"li","reorder_item")&&q.attachHandler(t)}}},{key:"addTasksViaPaste",value:function(e,t){var r=this;this.paste_timeout&&(clearTimeout(this.paste_timeout),this.paste_timeout=null),this.paste_last_ta=null,this.paste_tries=0;var n=function(){if(r.paste_tries>10)return r.paste_tries=0,r.paste_last_ta=null,void clearTimeout(r.paste_timeout);if((e=r.getEditorTextarea())&&e!==r.paste_last_ta){for(var n=void 0;;){if(void 0===(n=t.shift()))break;if(n=$strip(n),n=n.replace(/^[-*] /g,""),n.length>0)break}n&&(null===r.paste_last_ta&&(n=e.proxyGetValue()+" "+n),n.length>0&&(e.proxySetValue(n,!1),e.onchanged(),e.onsubmit())),r.paste_last_ta=e}else r.paste_tries+=1};this.paste_timeout=setInterval(n,50)}},{key:"getEditorTextarea",value:function(){var e=$("editor");return e?$child(e,null,"richtext_editor"):null}}]),e}();K.initClass(),t.exports=new K},{"../../components/labels/Labels.js":37,"../../components/people_assigner/PeopleAssigner":55,"../../components/project_editor/ProjectEditorManager":61,"../../components/project_selecter/ProjectAutoComplete.js":67,"../../components/reminders/Reminders.js":78,"../../menus/HelperMenuAnnotations.js":143,"../../menus/MenuItemEditMore":147,"../../menus/MenuPriorities":148,"../../models/ItemsModel":167,"../../models/ProjectsModel":171,"../../models/Reminders":173,"../../plugin_version/ContentTransformers":190,"../../react_components/scheduler/SchedulerWrapper":352,"../drag_and_drop/DragAndDrop":20,"../generic_manager/GenericManagerUtils.js":26,"../misc/Misc.js":43,"../notes/NotesAddTooltip":47,"../notes/NotesUtils":49,"../people_assigner/PeopleAutoComplete.js":56,"../richtext_editor/NatrualLanguageParsing":85,"./ItemDueDates.js":31}],29:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../../utils"),s=window,l=s.IstCheckbox,u=window,c=u.Signals,d=e("../../models/StateModel"),f=function(){function e(){n(this,e)}return a(e,[{key:"create",value:function(e,t,r){void 0===r&&(r=e.json.checked);var n=l.genereate();return window.PRINT_MODE||$AEV(n,"click",function(r){return c.sendSignal("hide_editor_menu"),!n.disabled&&!r.ctrl&&d.get("drag_and_drop_mode")!==d.DragMode.reordering&&t(e,r)}),(0,i.isSection)(e.json.content)||l.setChecked(n,r),n}},{key:"update",value:function(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e){var a=e.json;t?(n&&(e.json=o({},a,{checked:1})),$addClass(e,"checked"),$addClass(e,"with_check_animation")):(n&&(e.json=o({},a,{checked:0})),$removeClass(e,"checked"),$removeClass(e,"with_check_animation"));var i=$all("div","ist_checkbox",e)[0],s=this.create(e,r,t);return $swap(i,s),s}}}]),e}();t.exports=new f},{"../../models/StateModel":177,"../../utils":484}],30:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../../utils"),s=e("../../utils/fp"),l=e("../../stores/store"),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=e("../../reducers/undo"),d=window,f=d.Signals,p=window,m=p.Alerts,h=window,v=h.DateUtils,y=e("../../components/agenda/AgendaUtils"),g=e("../../models/ItemsModel"),b=e("../action_perfomed/ActionPerformed"),w=function(){function t(){n(this,t),this.updatePriority=this.updatePriority.bind(this),this.updateItems=this.updateItems.bind(this)}return a(t,[{key:"updatePriority",value:function(e,t){if(b.mark("ItemCommonEdits/updatePriority"),f.sendSignal("update_priority",e,t),e.json){var r=g.update(e.json.id,{priority:t}),n=o(r,1),a=n[0],i=!0,s=!1,l=void 0;try{for(var u,c=$all("li","item_"+a.id)[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var d=u.value;$update(d.json,a),this._setPriority(d)}}catch(e){s=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(s)throw l}}}}},{key:"_setPriority",value:function(e){for(var t=[1,2,3,4],r=0;r<t.length;r++){var n=t[r];$removeClass(e,"priority_"+n)}$addClass(e,"priority_"+e.json.priority)}},{key:"deleteItems",value:function(e,t){var r=void 0,n=void 0,o={},a={},s=0,l=function(e){if(!o[e.id]){var t=a[e.project_id];t||(t=a[e.project_id]=[]),s+=1,t.push(e.id),o[e.id]=e}},u=[];e.forEach(function(e){if(e.json){var t=g.getById(e.json.id);n=g.getChildren(t,{with_parent:!0}),n.forEach(function(e){l(e)}),u.push(e)}}),0!==s&&(1===s?(r=_("Are you sure you want to delete {item_name}?"),r=(0,i.format)(r,{item_name:"`"+$xssStrip($trim(n[0].content,50))+"`"})):(r=_n("Are you sure you want to delete this task?","Are you sure you want to delete {num_of_task} tasks?",s),r=(0,i.format)(r,{num_of_task:s})),m.confirm(r,function(e){if(e){for(var r in a){var n=a[r];g.deleteItem(n,parseInt(r))}u.forEach(function(e){return $remove(e)}),f.sendSignal("instant_refresh_interface")}t&&t(e)},_("Delete")))}},{key:"updateItems",value:function(e,t,r){var n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value;if(l.json){var u=!0,c=!1,d=void 0;try{for(var f,p=$all("li","item_"+l.json.id)[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var m,h=f.value;m=h.render_opts.renderCls?h.render_opts.renderCls.renderItem(h.json,h.render_opts):y.renderItem(h.json,h.render_opts),m.disabled=!1,r?($ATT($parent(h,"ul"),m),$remove(h)):$swap(h,m)}}catch(e){c=!0,d=e}finally{try{!u&&p.return&&p.return()}finally{if(c)throw d}}}}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}}},{key:"moveItems",value:function(e,t){b.mark("ItemCommonEdits/moveItems");var r=(0,s.compose)(s.flatten,i.values)(e);g.moveMultiple(r,t,!0);var n=$keys(e);n.push(t),f.sendSignal("projects.rerender",n),f.sendSignal("instant_refresh_interface"),f.sendSignal("hide_editor_menu")}},{key:"notifyAddedTo",value:function(e){if((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&e.due&&e.due.string&&e.due.string.length>0){var t=e.due.string+" ("+v.getWeekDay(e.due.getDay())+")",r=(0,i.format)(_("Task added for {task_due_date}"),{task_due_date:t});u.default.dispatch((0,c.undoPushMessage)(r))}else u.default.dispatch((0,c.notifyAddToProject)(e.id,e.project_id))}},{key:"duplicate",value:function(t){var r=e("../../containers/premium_promo/PremiumOnlyModal");if(!window.User.is_premium)return void r.showTaskDuplication();t.length>0&&g.duplicate(t)}}]),t}();t.exports=new w},{"../../components/agenda/AgendaUtils":8,"../../containers/premium_promo/PremiumOnlyModal":120,"../../models/ItemsModel":167,"../../reducers/undo":449,"../../stores/store":456,"../../utils":484,"../../utils/fp":477,"../action_perfomed/ActionPerformed":2}],31:[function(e,t,r){"use strict";var n=window.DateistDateHelpers,o=window.DateUtils,a=window.IstTooltip,i=e("../../models/Reminders").RemindersModel,s=e("..//smart_scheduler/QuickDayShow"),l=e("../reminders/RemindersViewer"),u=e("../../models/DateExt").default,c={createDueInput:function(e){var t=INPUT({type:"text",c:"input_due_date dp_icon",name:"due_date",tabIndex:2,autocomplete:"off",placeholder:_("Schedule"),readonly:!0}),r=function(e,t){var r,n=$gp(e,"table");n&&(r=$gc(n,"div","richtext_editor")),r&&(""===e.value?r.dateist_disabled=!1:r.dateist_disabled=!0,r.save_position=!1,r.onchanged&&r.onchanged(),t&&e.focus())};return e&&e.due_date?function(a){if(a){a=n.has_time(e.due_date)?n.inherit_date(a,e.due_date):n.date_max(a);var i={};n.is_overdue(new Date,a)&&(i.with_year=!0),t.value=o.format(a,!1,i),t.date_string=o.jsonFormat(a)}else t.value="",t.date_string="";t.no_date=!1,t.use_custom=!1,r(t,!1),$isIe()&&t.value&&$removeClass(t,"dummy_text"),window.SHOULD_HIDE=!0,setTimeout(function(){window.SHOULD_HIDE=!1},15);try{t.focus()}catch(e){}try{$remove($all("span","error",$f($parent(t,"form"))))}catch(e){}}(e.due_date):function(){t.date_string="",t.no_date=!0,t.value=""}(),t},parseDueDate:function(e){var t=null;if(""!==e.value){if(t=o.parse(e.value),t.error||!t.due_date){var r=$request("/API/v7/mark_invalid_date");return r.addErrback(function(){}),r.sendReq({date_string:e.value,lang:window.LANG,translated:"dateist"}),!1}return u.fromDateist(t)}return null},create:function(e){if(e.due){var t=SPAN({class:"date"}),r=new Date,s=new Date;s.setDate(s.getDate()+1);var l=e.due.isLessThan(r),u=n.day_diff(r,e.due.toDate()),d=o.humanizeDayDiff(u,e.due.toDate());return u<=7&&u>=-7&&$addClass(t,"date_future"),a.showTooltip(t,$p(c.createTooltipContent,e)),$add(t,d),l?$addClass(t,"date_overdue"):e.due.isSameDate(r)?$addClass(t,"date_today"):e.due.isSameDate(s)&&$addClass(t,"date_tom"),e.due.is_recurring&&$ATT(t,svgs.get("sm1/recurring.svg")),this.updateAlarmIcon(t,i.hasReminders(e.id)),t}var f=SPAN({class:"date empty"}),p=this.updateAlarmIcon(f,i.hasReminders(e.id));return p&&(p.style.marginRight="0px"),a.showTooltip(f,$p(c.createTooltipContent,e)),f},createTooltipContent:function(e){var t="";if(e.due){var r=new Date,a=n.is_overdue(r,e.due),u=n.day_diff(new Date,e.due),c=u<=7&&u>=-7;t=o.formatView(e.due,!c||a),_n("1 day left","{num} days left"),_n("1 day ago","{num} days ago");var d;if(u>0?d=(1==u||-1==u)&&_("day left")||_("days left"):u<0&&(u=Math.abs(u),d=(1==u||-1==u)&&_("day ago")||_("days ago")),0!==u){t+="<br /><small>"+("<span>"+u+"</span> ")+d+"</small>"}if(e.due.is_recurring){t+="<br /><small> "+e.due.string+"</small>"}}t=$setHTML(SPAN({c:"date_tooltip"}),t);var f=i.getRemindersByItemId(e.id);if(f.length>0){var p=l.renderRaw(e,f,{delete_possible:!1});$add(t,p)}if(window.User.is_premium&&e.due){var m=s.show(e.due);$add(t,m)}return t},updateAlarmIcon:function(e,t){var r=$all("svg","alarm_icon",e);r.length>0&&$remove(r[0]);var n;return t&&$addToTop(e,n=svgs.get("sm1/reminder_small.svg",{className:"alarm_icon"})),n},updateDueDate:function(e){var t=$all("td","td_due_date",e)[0];if(t){var r=c.create(e.json);$replace(t,r),$fx.highlight($gc(e,"span","date"),{duration:600})}},showDateInsert:function(){return window.open("/Help/DatesTimes"),!1}};t.exports=c},{"../../models/DateExt":164,"../../models/Reminders":173,"..//smart_scheduler/QuickDayShow":88,"../reminders/RemindersViewer":83}],32:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t={id:e.id};return e.sync_id&&(t.sync_id=e.sync_id),"https://todoist.com/showTask?"+$encode(t)}var a=e("clipboard"),i=n(a),s=e("../../stores/store"),l=n(s),u=e("../../reducers/undo"),c=window.Indicator,d=window.GB_showHTML,f=e("../../models/SyncEngine"),p=e("../../models/ItemsModel"),m=e("../../models/ProjectsModel"),h=e("../../models/TemporaryIds"),v=e("../copy_to_clipboard/CopyForm");r.show=function(e){e=p.getById(e.id);var t=void 0;if(i.default.isSupported())t=function(e){var t=o(e),r=document.createElement("div");new i.default(r,{text:function(){return t}}).on("success",function(e){l.default.dispatch((0,u.undoPushMessage)(_("Link copied!"))),e.clearSelection()}),r.click()};else{var r=DIV(c.cssSpinner());d(_("Link to task"),r,200,400),t=function(e){var t=o(e),n=v.genereate();n.input.value=t,$replace(r,n.form),n.input.select(),n.fn_copy_to_clipboard()}}var n=function(e){e=p.getById(e.id);var r=m.get(e.project_id);if(r&&r.shared&&!e.sync_id){var n=$requestJSON("/API/"+f.api_version+"/get_item");n.addCallback(function(e){t(e.item)}),n.sendReq({item_id:e.id,token:window.User.token})}else t(e)};return h.isTemporary(e.id)?f.sync({onSuccess:$p(n,e)},!0):n(e),!1}},{"../../models/ItemsModel":167,"../../models/ProjectsModel":171,"../../models/SyncEngine":181,"../../models/TemporaryIds":184,"../../reducers/undo":449,"../../stores/store":456,"../copy_to_clipboard/CopyForm":19,clipboard:"clipboard"}],33:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../agenda/AgendaUtils"),l=n(s),u=e("../../utils"),c=e("../../react_components/scheduler/SchedulerWrapper"),d=n(c),f=e("../notes/Notes"),p=n(f),m=window,h=m.DateUtils,v=m.MenuRightClick,y=m.Signals,g=m.IstTooltip,b=m.svgs,w=e("../people_assigner/PeopleAssigner"),E=e("../labels/Labels.js"),k=e("../notes/NotesUtils"),S=e("../item_selecter/ItemSelecter.js"),j=e("../drag_and_drop/DragAndDrop"),T=e("../generic_manager/GenericManagerUtils.js"),O=e("../projects_list/ProjectListUtils"),I=e("../formatter/Formatter.js");S=e("../item_selecter/ItemSelecter.js");var P=e("../../models/ItemsModel"),C=e("../../models/ProjectsModel"),D=e("../../models/Colors"),A=e("../../models/Reminders"),M=A.RemindersModel,x=e("../../models/Collaborators"),R=e("./ItemCheckbox"),N=e("./ItemDueDates.js"),$=function(){function e(){a(this,e),this.renderItem=this.renderItem.bind(this),this.getMenuEditIcon=this.getMenuEditIcon.bind(this),this.createProjectItem=this.createProjectItem.bind(this)}return i(e,[{key:"renderItem",value:function(e,t){var r=void 0,n=void 0,o=void 0,a=void 0,i=void 0,s=C.get(e.project_id),l=LI({c:"task_item item_"+e.id,id:"item_"+e.id});if(l.json=e,e.checked&&$addClass(l,"checked"),$add(l,TABLE({cellpadding:0,cellspacing:0},o=TBODY())),S.highlighted_items[e.id]&&$addClass(l,"selected"),l.td_checker=a=TD({c:"checker sel_checkbox_td"}),(0,u.isSection)(e.content)||!0===t.no_checkbox)l.td_checker=a=TD();else{var c=void 0;c=e.is_archived?function(){return alert(_("This project is archived. Unarchive it to be able to edit it.")),R.update(l,e.checked,c),!0}:e.checked?t.fn_undo_complete_item:t.fn_complete_item,$add(a,R.create(l,c))}var d=null;if(t.with_time&&e.due&&e.due.with_time){var f="40px";window.Settings.AMPM&&(f="67px");var p=DIV({class:"agenda_item__time"},SPAN(h.getHourAndMin(e.due)));p.style.minWidth=f,e.due.isLessThan(new Date)&&$addClass(p,"agenda_item__time_overdue"),d=TD({class:"column_time task_content_item"},p)}var m=null;if(t.with_project){if(l.td_project=m=TD({class:"column_project task_content_item"},this.createProjectItem(e)),!t.with_due_date){var O=void 0;$ATT(m,O=SPAN({c:"sm_icon_holder"},N.updateAlarmIcon(m,M.hasReminders(e.id)))),g.showTooltip(O,$p(N.createTooltipContent,e),3,5)}if(!t.with_due_date&&e.due&&e.due.is_recurring){var D=void 0;$ATT(m,D=SPAN({c:"sm_icon_holder"},b.get("sm1/recurring.svg",{className:"recurring_icon"}))),g.showTooltip(D,$p(N.createTooltipContent,e),3,5)}}var A=null;if(s&&x.isProjectShared(s.id)){var $=function(t){return P.update(e.id,{responsible_uid:t}),y.sendSignal("people_assigner_person_changed"),e},L={fn_on_select:$,responsible_uid:e.responsible_uid,project_id:s.id,from_rendering:!0,arrow_left_offset:5},U=new w(L);A=TD({c:"assign_user task_content_item","data-track":"project|assign_person"},U.render(L))}else $addClass(l,"not_shared");$ATT(l,DIV({c:"invisible_space"}));var V=null,F=null,B=null;t.with_due_date&&(V=TD({c:"td_due_date",nowrap:!0},F=DIV({c:"due_date_controls"},B=N.create(e))));var H=I.format(e.content);H=H.replace(/^\*\s+/g,"");var G=$setHTML(SPAN({c:"text sel_item_content"}),H);k.annotate(e,G,l),$add(G,$setHTML(DIV(),E.format("",e))),l.content=r=TD({c:"text_cursor content task_content_item"},G),l.td_menu=n=null;var z=!0;if((e.is_archived||e.in_history||t.not_editable)&&(z=!1),window.PRINT_MODE&&(z=!1),l.td_menu=n=TD({c:"menu"}),z){$add(n,this.getMenuEditIcon(l,t.fn_toggle_menu,l.td_menu)),new v(l,$p(t.fn_toggle_menu,l,{id:e.id},e.id)),t.no_selecter_attach||S.selectClick(l),t.no_drag_and_drop||j.attach(l);var q=SPAN({c:"scheduler_action"},b.get("sm1/scheduler.svg")),W=void 0;t.with_due_date?e.due?W=B:($addToTop(F,q),W=q):(l.td_scheduler=i=TD({c:"td_scheduler task_content_item"},q),W=q),$AEV(W,"click",$p(this.onSchedulerClick,l,e,W,t.is_note))}else{var Y=T.getMenuEditIcon();$addClass(Y,"is_hidden"),$add(n,Y)}return t.no_indent||T.setIndent(l,e.indent,!0),$addClass(l,"priority_"+e.priority),d?($add(o,TR(a,d,r,i,V,m,A,n)),l.td_time=d):$add(o,TR(a,r,i,V,m,A,n)),l.render_opts=t,l}},{key:"getMenuEditIcon",value:function(e,t,r){var n=T.getMenuEditIcon();return $AEV(r,"click",$p(t,e,n,e.json.id)),e.menu_icon=n,n}},{key:"createProjectItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t||(t=C.get(e.project_id)),t||(t={name:_("Undefined"),id:null,color:null});var r=t,n=r.name;n=n.replace(/^-\s*/,""),n=$trim(n,30);var o=SPAN({c:"project_item__color"},""),a=SPAN({c:"clickable project_item"});$add(a,$setHTML(SPAN({c:"project_item__name"}),I.format(n))),$add(a,o);var i=t.color||0;return t.inbox_project&&(i=7),i=D.getHex("project",t.color),o.style.backgroundColor=i,o.style.color=i,window.PRINT_MODE||$AEV(a,"click",function(r){if(r.ctrl||r.shift)return!1;if(t.id){var n=e?e.id:null;O.setCurrentById(t.id,n)}return!1}),a}},{key:"onSchedulerClick",value:function(e,t,r,n){var a=$all("li","selected");a=a.indexOf(e)>-1?a:[e];var i=a.map(function(e){return e.json}),s=n?"scheduler-note-item":"scheduler-item";d.default.show({anchor:r,dialogClassName:s,selectedItems:i,holder:DIV({c:"scheduler_holder"}),selectedDate:i.length>1?null:t.due,onDateSelect:function(e){P.updateDue(o({},t.id,e)),l.default.refresh(),n&&p.default.reRenderCurrentItem()},onHide:function(){$removeClass(e,"on_scheduler_show")}}),$addClass(e,"on_scheduler_show")}}]),e}();t.exports=new $},{"../../models/Collaborators":160,"../../models/Colors":161,"../../models/ItemsModel":167,"../../models/ProjectsModel":171,"../../models/Reminders":173,"../../react_components/scheduler/SchedulerWrapper":352,"../../utils":484,"../agenda/AgendaUtils":8,"../drag_and_drop/DragAndDrop":20,"../formatter/Formatter.js":22,"../generic_manager/GenericManagerUtils.js":26,"../item_selecter/ItemSelecter.js":27,"../labels/Labels.js":37,"../notes/Notes":46,"../notes/NotesUtils":49,"../people_assigner/PeopleAssigner":55,"../projects_list/ProjectListUtils":71,"./ItemCheckbox":29,"./ItemDueDates.js":31}],34:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=e("../project_editor/ProjectEditorManager"),a=n(o),i=e("../../stores/store"),s=n(i),l=e("../../filterist"),u=e("../agenda/sort"),c=e("../../reducers/items"),d=e("../../components/agenda/sort"),f=window.Signals,p={sortByDate:function(){p.applySort((0,d.composeSortFunc)(d.byDueDate,d.byPriority,d.byChildOrder))},sortByPriority:function(){p.applySort((0,d.composeSortFunc)((0,d.composeSortFunc)(d.byPriority,d.byChildOrder)))},sortByResponsible:function(){var e=(0,d.createByResponsible)(s.default.getState());p.applySort((0,d.composeSortFunc)((0,d.composeSortFunc)(e,d.byPriority,d.byChildOrder)))},sortByName:function(){p.applySort((0,d.composeSortFunc)(d.byItemContent,d.byPriority,d.byChildOrder))},applySort:function(e){var t=a.default.current_editor;if(!t)return!1;s.default.dispatch((0,c.itemSortProjectItems)(t.project_id,e)),f.sendSignal("sort_by_done"),f.sendSignal("instant_refresh_interface")},sortToday:function(){var e=(0,l.filter)("today")[0].items;if(0!==e.length){var t=(0,u.createDayViewSortByProject)(s.default.getState());e.sort(t);var r=e.reduce(function(e,t,r){return e[t.id]=r+1,e},{});s.default.dispatch((0,c.itemUpdateDayOrder)(r,{withUndo:!0})),f.sendSignal("instant_refresh_interface")}}};t.exports=p},{"../../components/agenda/sort":16,"../../filterist":133,"../../reducers/items":417,"../../stores/store":456,"../agenda/sort":16,"../project_editor/ProjectEditorManager":61}],35:[function(e,t,r){"use strict";function n(e){var t=e.target||e.srcElement;if(t){var r=$nodeName(t);if("textarea"==r||"input"==r||"select"==r)return!0;if($hasClass(t,"ist_button")||$hasClass(t,"richtext_editor")||$hasClass(t,"t_date")||$hasClass(t,"t_label"))return!0}return!1}function o(e){if(n(e))return!0;if(l())return!0;var t=e.keyAscii,r=c.current_section_list;if($isIn(t,[97,65,1092,1060])){var o=$isIn(t,[65,1060]);if(r)r.addNewItem(o);else{var a=$$("li.agenda_add_task");if(a.length>0){var i=$child(a[0],"a");i.onclick(i)}}return $preventDefault(e),!1}return!e.ctrl&&$isIn(t,[47,102,1072])?(f.focus(),f.select(),$preventDefault(e),!1):!e.ctrl&&$isIn(t,[81,113,1081,1049])?($preventDefault(e),d.toggle(),!1):!e.ctrl&&$isIn(t,[115,1099])?("today"===s.default.getState().mainView.type&&p.sortToday(),"project"===s.default.getState().mainView.type&&p.sortByDate(),$preventDefault(e),!1):!e.ctrl&&$isIn(t,[114,1082])?(p.sortByResponsible(),$preventDefault(e),!1):!e.ctrl&&$isIn(t,[112,1079])?(p.sortByPriority(),$preventDefault(e),!1):e.ctrl&&$isIn(t,[38,40])?(r&&!c.current_form&&(r.addNewItem(40==t),$preventDefault(e)),!1):63!=t||m.showKeyboardShortcuts()}function a(e){if(n(e))return!0;var t=e.keyAscii;if(27==t){if(l()||u.current_input)return!0;if($all("li","selected").length>0)return _.deselectAll(),!1;top.postMessage(JSON.stringify({type:"todoist_close_window"}),"*")}else if(e.ctrl&&90==t)return $preventDefault(e),h.undo(),!1;return!0}var i=e("../../stores/store"),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=window.GB_getLast,u=window.IstComplete,c=e("../project_editor/ProjectEditorManager"),d=e("../quick_add/QuickAdd"),f=e("../quick_find/QuickFind"),p=e("../items_utils/ItemsSortBy.js"),m=e("../opener/WindowOpener.js"),h=e("../items_utils/ItemCommonEdits"),_=e("../item_selecter/ItemSelecter.js");r.init=function(){$AEV(document,"keypress",o),$AEV(document,"keydown",a)}},{"../../stores/store":456,"../item_selecter/ItemSelecter.js":27,"../items_utils/ItemCommonEdits":30,"../items_utils/ItemsSortBy.js":34,"../opener/WindowOpener.js":53,"../project_editor/ProjectEditorManager":61,"../quick_add/QuickAdd":73,"../quick_find/QuickFind":76}],36:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.GB_hide,s=window,l=s.IstCompleteSelect,u=e("../labels/Labels.js"),c=e("../../models/LabelsModel"),d=function(){function e(){n(this,e),this.showTooltip=this.showTooltip.bind(this)}return o(e,[{key:"showTooltip",value:function(e,t){var r=this,n={selectedItem:t.selectedItem,collection:function(){return r.getCompletionLabels()},filterItem:function(e){if(e){var t=DIV(r.renderLItem(e));return e.indent>1&&$addClass(t,"indent_"+e.indent),t}},onSelect:function(e){i(),$isFunction(t.onSelect)&&t.onSelect(e)},wildcard_match:!0,placeholder:t.placeholder_txt||""},o=new l(n);return o.showTooltip({title:t.title||_("Select a label"),icon:e,arrow_left_offset:t.arrow_left_offset||0,top_offset:t.top_offset||25,left_offset:t.left_offset||25,fn_on_hide:function(){o=null}}),!1}},{key:"renderLItem",value:function(e){var t=e.name.replace(/\*\s*/,"");return DIV({c:"ist_complete_content",s:u.getCssColor(e)},t)}},{key:"getCompletionLabels",value:function(){return c.getAll(!0)}}]),e}();t.exports=new d},{"../../models/LabelsModel":168,"../labels/Labels.js":37}],37:[function(e,t,r){"use strict";var n=window.Signals,o=window.LibEdit,a=window.IstTooltip,i=window.IstComplete,s=e("../../models/LabelsModel"),l=e("../../models/Colors"),u=e("../../containers/premium_promo/PremiumOnlyModal"),c=e("../richtext_editor/NatrualLanguageParsing"),d=e("../../stores/store").default,f=e("../../reducers/mainView"),p=f.showLabelView,m={re_labels:/(^|\s+)@([^\s,]+)/g,init:function(){},getLabels:function(e){var t=[];return e=e.replace(m.re_labels,function(e,r,n){n=n.toLowerCase();var o=s.get(n);return o?t.push(o.id):t.push(n),""}),[e,t]},queryLabel:function(e){d.dispatch(p(e)),n.sendSignal("select_labels_tab",e)},format:function(e,t){if(!t.labels)return e;var r={},n=[],o=function(e){r[e.id]||(n.push(e),r[e.id]=!0)};$map(t.labels,function(t){var r=s.getById(t);r&&(o(r),e=e.replace(new RegExp("(^|s)@"+r),"$1"))});var a=m.getLabels(e)[1];return $map(a,function(t){(t=s.getById(t))&&(o(t),e=e.replace(new RegExp("(^|s)@"+t),"$1"))}),m._format(e,n)},_format:function(e,t){if(!t||0===t.length)return e;t.sort(function(e,t){return e.item_order-t.item_order});var r=[];return $map(t,function(n,o){var a=t[o+1],i=a?"margin-right: 5px;":"";if(n){var s=m.getCssColor(n),l=$xssStrip(n.name);r.push('<a class="label" onclick="Labels.queryLabel('+n.id+')" style="'+i+s+'">'+l+"</a>"),e=e.replace(new RegExp("(^|s)@"+n,"ig"),"")}}),t=r.join(""),e+'<div class="labels_holder">'+t+"</div>"},getCssColor:function(e){return"color: "+l.getHex("label",e.color)+";"},formatByContent:function(e){var t=m.getLabels(e);e=t[0];var r=t[1];if(0===r.length)return e;var n=[];return $map(r,function(e){var t;(t=$isNumber(e)?s.getById(e):{name:e,color:0})&&n.push(t)}),m._format(e,n)},jsonFormat:function(e){return e=e.replace(m.re_labels,function(e,t,r){var n=function(e){return"\\"+e};return r=r.replace(/\*|\+/g,n),e.replace(new RegExp(t+"@"+r,"g"),"")}),$strip(e)},textFormat:function(e,t){var r={},n=[];return t&&$map(t,function(t){var o=s.getById(t);if(o&&!r[o.id]){var a="@"+o.name,l=new RegExp("(^|s)@"+i.escapeReqExpSepcails(o.name),"ig");null==e.match(l)&&(n.push(a),r[o.id]=!0)}}),n=n.join(" "),n.length>0&&(n+=" "),n+$strip(e)},getCompletionLabels:function(){var e=[];return $map(s.getAll(!0),function(t){e.push({name:t.name})}),e},annotateFormArea:function(e,t){window.User.is_premium&&(i.attach(e,s.complete_data={collection:function(e){return s.getByName(e.replace("@",""))},filterItem:function(e){var t=DIV({c:"div_color counter_color",s:m.getCssColor(e)},svgs.get("sm1/label.svg")),r=SPAN({c:"label_name"},e.name);return DIV(DIV({c:"ist_complete_icon"},t),DIV({c:"ist_complete_content"},r))},position_item:$parent(e,"td","text_box_holder"),extra_width:1,support_paste:!1,wildcard_match:!0,onNoMatches:function(e,t,r){if(0==r.length&&0!=m.getCompletionLabels().length)return i.hide(),!1;if(r.length>0){r=r.replace(/\\/g,"");var n;$add(e,TR(n=TD({c:"ist_complete_item"},SPAN({c:"ist_complete_content"},_("Label not found.")," ",B(_("Create")+" "+r))))),n.onmouseover=$p(i.onMouseOver,n,{}),n.onmousedown=$p(m._createLabel,r,t)}return!0},preOnSelect:function(e){m.old_support_labels=null,e.is_content_editable&&c&&(m.old_support_labels=c.highlight_labels,c.highlight_labels=!1)},postOnSelect:function(e){e.is_content_editable&&setTimeout(function(){c.highlight_labels=m.old_support_labels,e.input.onchanged()},5)}}),$AEV(e,"keydown",function(e){return!(13==e.keyAscii&&!e.shift&&i.isShown())&&((27!=e.keyAscii||!i.isShown())&&void 0)}),$swap(t,this._crateLabelButton(e)))},showPremiumPromotion:function(){u.showLabel()},_createLabel:function(e,t){return i.hide(),s.add({name:e}),window.LibEdit.insertAtCursor(t,i.CHAR_FORCED_WHITESPACE),!1},_crateLabelButton:function(e){var t=SPAN(svgs.get("sm1/label_outline.svg"));$addClass(t,"form_action_icon"),t.setAttribute("data-track","task_form|label"),$AEV(t,"click",function(){return a.hide(),window.User.is_premium?(o.placeCaretAtEnd(e),i.forceShow(e,!0,s.complete_data)):m.showPremiumPromotion(),!1});var r=DIV(B(_("Label")),BR(),_("Add by typing @"));return a.showSimpleText(t,r,null,6,4),t}};window.Labels=m,t.exports=m},{"../../containers/premium_promo/PremiumOnlyModal":120,"../../models/Colors":161,"../../models/LabelsModel":168,"../../reducers/mainView":426,"../../stores/store":456,"../richtext_editor/NatrualLanguageParsing":85}],38:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.IstComplete,s=function(){function e(){n(this,e),this.render=this.render.bind(this),this.toggleIcon=this.toggleIcon.bind(this),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.toggle=this.toggle.bind(this),this.resizeOverlay=this.resizeOverlay.bind(this),this.resizeLeftMenu=this.resizeLeftMenu.bind(this),$AEV(window,"resize",this.resizeLeftMenu)}return o(e,null,[{key:"initClass",value:function(){this.prototype.offset_top=50}}]),o(e,[{key:"render",value:function(){$ATT($("top_bar_inner"),this.toggleIcon())}},{key:"toggleIcon",value:function(){var e=this.icon_menu_toggle=A({href:"#",c:"left_menu_toggle"},svgs.get("sm1/menu.svg"));return $AEV(e,"click",this.toggle),e}},{key:"isShown",value:function(){return $hasClass($html(),"left_menu_show")}},{key:"show",value:function(){var e=$body();return $addClass($html(),"left_menu_show"),this.resizeLeftMenu(),$add(e,this.overlay=DIV({c:"left_menu_overlay"})),$AEV(this.overlay,"click",this.hide),$AEV(window,"resize",this.resizeOverlay),this.resizeOverlay(),$removeClass(this.icon_menu_toggle,"menu_toggle"),
$addClass(this.icon_menu_toggle,"menu_close"),$replace(this.icon_menu_toggle,svgs.get("sm1/close_big.svg")),!1}},{key:"hide",value:function(){return $removeClass($html(),"left_menu_show"),$remove($all("div","left_menu_overlay")),$REV(window,"resize",this.resizeOverlay),$removeClass(this.icon_menu_toggle,"menu_close"),$addClass(this.icon_menu_toggle,"menu_toggle"),$replace(this.icon_menu_toggle,svgs.get("sm1/menu.svg")),!1}},{key:"toggle",value:function(){return i.hide(),$hasClass($body(),"mini_version")&&(this.isShown()?this.hide():this.show()),!1}},{key:"resizeOverlay",value:function(){var e=this.overlay,t=$("left_menu"),r=$winSize().w-t.offsetWidth;$setWidth(e,r),$setHeight(e,t.offsetHeight),$setLeft(e,t.offsetWidth)}},{key:"resizeLeftMenu",value:function(){var e=$("left_menu");e&&($hasClass($body(),"mini_version")?e.style.height=$winSize().h+"px":e.style.height=$winSize().h-this.offset_top+"px",this.resizeOverlay())}}]),e}();s.initClass(),t.exports=new s},{}],39:[function(e,t,r){"use strict";var n=e("../../constants/themes"),o=e("../themes/Themes"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i={show:function(){var e=localStorage.getItem("User");if(e){var t=void 0,r=localStorage.getItem("LocalSettings.theme");if(r)t=parseInt(r);else{t=JSON.parse(e).theme}t===n.THEME_DARK&&a.default.changeThemeClass(t)}},hide:function(){var e=$("loading");if(e){var t=function(){e&&($remove(e),e=null)};$AEV(e,"animationend",t),$addClass(e,"fade_out"),setTimeout(t,700)}}};window.Loading=i,t.exports=i},{"../../constants/themes":99,"../themes/Themes":95}],40:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=window,s=i.Signals,l=window,u=(l.$static_path,e("../../models/Storage")),c=u.$storage,d=e("../notifications/Notifications"),f=function(){function e(){n(this,e),this.connected=!1,this.connect=this.connect.bind(this),window.Notification&&this.connect()}return a(e,[{key:"connect",value:function(){var e=this;this.connected||(s.connect("notify",function(t){var r=void 0,n=void 0,a=void 0,i=void 0,l=void 0;if(window.MacBridge&&window.MacBridge.bridge);else if("denied"===c("LocalNotifications").get())return;try{var u=d.renderNotification(t,0),f=o(u,5);l=f[0],i=f[1],n=f[2],a=f[3],r=f[4]}catch(e){return}if(i){var p=$setHTML(SPAN(),i);return p=p.textContent||p.innerText,n&&(n=$trim(n,200)),window.MacBridge&&window.MacBridge.bridge?s.sendSignal("mac_notify",p,n,r):e.notify(p,n,a,l.avatar_big,t.notification_key)}}),this.connected=!0)}},{key:"notify",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;n||(n="https://d3ptyyxy2at9ui.cloudfront.net/notification_icon-6ce261.png");var a=function(){var a={icon:n};t&&(a.body=t),o&&(a.tag=o);try{new window.Notification(e,a).onclick=function(){if(window.focus(),r)return r()}}catch(e){}};return"granted"===window.Notification.permission?a():"denied"!==window.Notification.permission?window.Notification.requestPermission(function(e){var t=!1;try{t=window.Notification.includes("permission")}catch(e){}if(t||(window.Notification.permission=e),"granted"===e)return a()}):void 0}}]),e}();t.exports=new f},{"../../models/Storage":179,"../notifications/Notifications":51}],41:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Signals,s=e("../notes/NotesUtils"),l=e("../../models/ItemsModel"),u=e("../../models/Reminders"),c=u.RemindersModel,d=e("../local_notifications/LocalNotifications"),f=e("../formatter/Formatter.js"),p=function(){function e(){n(this,e),this.connect=this.connect.bind(this),this.loopReminders=this.loopReminders.bind(this),window.Notification&&this.connect()}return o(e,null,[{key:"initClass",value:function(){this.prototype.connected=!1}}]),o(e,[{key:"connect",value:function(){this.connected||(i.connect("remind",function(e){var t=l.getById(e.item_id);if(t&&!(t.is_deleted||t.checked||t.in_history)){var r=!0;if(0==window.User.features.reminder_desktop&&(r=!1),r)if(window.MacBridge&&window.MacBridge.bridge)i.sendSignal("mac_remind",t);else if(window.Notification){var n=f.format(t.content,{only_text:!0,as_html:!1});d.notify(n,_("Todoist Reminder"),function(){s.show(t.id)},"reminder_"+t.id)}}}),setInterval(this.loopReminders,1e4),this.connected=!0)}},{key:"loopReminders",value:function(){var e=(new Date).getTime(),t=!1,r=!0,n=!1,o=void 0;try{for(var a,s=c.getAllReminders()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(!u.lprocessed&&!u.is_deleted){var d=null;if("relative"===u.type){var f=l.getById(u.item_id);f&&f.due&&(d=f.due.getTime()-60*u.minute_offset*1e3)}if("absolute"===u.type&&(d=u.due.getTime()),d){var p=u.notify_uid;if(!p||p===window.User.id){var m=(e-d)/1e3;m>=0&&m<60&&(u.lprocessed=!0,i.sendSignal("remind",u),t=!0)}}}}}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}c.loaded&&t&&c.syncCachedData()}}]),e}();p.initClass(),t.exports=new p},{"../../models/ItemsModel":167,"../../models/Reminders":173,"../formatter/Formatter.js":22,"../local_notifications/LocalNotifications":40,"../notes/NotesUtils":49}],42:[function(e,t,r){"use strict";var n=e("../../stores/store"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=e("../../reducers/mainView"),i=window.Signals,s=e("../../components/projects_list/ProjectListUtils"),l=e("../../components/project_editor/ProjectExtraActions"),u=e("../../components/activity_log/ActivityLog"),c=e("../../components/quick_add/QuickAdd"),d=e("../../components/agenda/AgendaUtils"),f=e("../../components/notes/Notes.js"),p=e("../../models/TemporaryIds"),m=e("../../models/SyncEngine"),h=e("../../models/ItemsModel"),_=e("../../models/ProjectsModel"),v=e("../opener/WindowOpener.js"),y={init:function(){setInterval(this.locationPolling,400),p.listenAll(function(e,t){var r=y;r.cur_location&&-1!=r.cur_location.indexOf(e)&&r.updateLocation(r.cur_location.replace(e,""+t))}),i.connect("change_location",function(e){y.updateLocation(e)}),p.listenAll(function(e,t){var r=y.getHash();-1!=r.indexOf(e)&&(r=r.replace(e,t),y.updateLocation(r))})},getHash:function(){var e=window.location.hash.substring(1);return $urldecode(e)},getCurrentLocation:function(){return y.cur_location},setHash:function(e){window.location.hash=$urlencode(e)},updateLocation:function(e){var t=y;t.cur_location!=e&&(y.setHash(e),t.cur_location=e)},refreshView:function(){return y.updateView(y.setHash()),!1},updateView:function(e,t){if(window.isEditingOn())return void setTimeout($p(y.updateView,e),400);if(0===e.indexOf("project/")){var r=e.split("/"),n=parseInt(r[1]),i=3==r.length&&"full"===r[2];o.default.dispatch((0,a.showProjectView)([n],{withChildren:i}))}if(0===e.indexOf("project_comments/")){var p,g=e.split("/"),b=parseInt(g[1]);if(g[2]&&(p=parseInt(g[2])),1==t){var w=_.get(b);w?s.setCurrentById(w.id,!1):d.query("today")}f.showProjectNotes(b,p)}else if(0===e.indexOf("task/")){var E,k=e.split("/"),S=parseInt(k[1]);if(k[2]&&(E=parseInt(k[2])),S){if(1==t){var j;j=E?h.getBySyncId(E):h.getById(S),j?s.setCurrentById(j.project_id,!1):d.query("today")}f.showItemNotes(S,null,E)}}else if(0===e.indexOf("email_tasks/")){var T=parseInt(e.split("/")[1]);T&&(s.setCurrentById(T,!1),l.showEmails(T))}else if(0===e.indexOf("agenda/")){var O=e.split("/");O.shift(),O.length>0&&d.query(O.join("/"))}else if(0===e.indexOf("activity")){var I=null,P=null,C=null,D=void 0,A=e.split("/");A.length>1&&("project"==A[1]?I=parseInt(A[2]):"task"==A[1]&&(P=parseInt(A[2])),"null"!=A[3]&&(C=A[3]),"undefined"!==A[4]&&A[4]!=window.User.id.toString()&&(D="null"==A[4]?null:A[4])),u.showActivity(I,P,C,D)}else-1!=e.indexOf("quickAdd")?(c.toggle(),e=y.cur_location,y.setHash(e)):-1!=e.indexOf("updateCount")?(e=y.cur_location,-1!=e.indexOf("#updateCount")?y.setHash("#start"):y.setHash(e)):-1!=e.indexOf("sync")?(m.sync(null,!0),e=y.cur_location,y.setHash(e)):-1!=e.indexOf("openOutlook")||-1!=e.indexOf("openThunderbird")||("upgrade_to_premium"==e&&(e="windowPref/premium"),"invite_friends"==e&&(e="windowPref/invite_friends"),0===e.indexOf("windowPref/")&&v.showPrefs($last(e.split("/"))))},locationPolling:function(){var e=y,t=e.getHash();e.cur_location&&e.cur_location!=t&&(y.setHash(t),e.updateView(t),e.cur_location=t)}};window.LocationManager=y,t.exports=y},{"../../components/activity_log/ActivityLog":4,"../../components/agenda/AgendaUtils":8,"../../components/notes/Notes.js":46,"../../components/project_editor/ProjectExtraActions":63,"../../components/projects_list/ProjectListUtils":71,"../../components/quick_add/QuickAdd":73,"../../models/ItemsModel":167,"../../models/ProjectsModel":171,"../../models/SyncEngine":181,"../../models/TemporaryIds":184,"../../reducers/mainView":426,"../../stores/store":456,"../opener/WindowOpener.js":53}],43:[function(e,t,r){"use strict";function n(){return null!=navigator.userAgent.match(/Todoist for macOS|TDMacApp/)}function o(){var e=navigator.userAgent.match(/Todoist for macOS \((.+)\)/);return e?parseFloat(e[1]):null}function a(){return"ja"==window.LANG||"ko"==window.LANG||0===window.LANG.indexOf("zh")}function i(){var e,t=window.location.href,r=!(s.isWindowApp||s.isOutlookApp||s.isChromeApp);r&&(e=window.open());var n={onSuccess:function(){-1!=t.indexOf("?")?t=t.replace("?","?print_mode=1&"):-1!=t.indexOf("#")&&(t=t.replace("#","?print_mode=1#")),-1!=t.indexOf("#")&&(t=t.split("#")[0]+window.location.hash),t=t.replace("mini=1","minip=0"),e?e.location=t:window.open(t)}};return l.sync(n,!0),!1}var s=e("../../utils/Env"),l=e("../../models/SyncEngine");Signals=window.Signals,Signals.connect("open_print_mode",i),t.exports={isMacApp:n,getMacAppVersion:o,isAsianLang:a}},{"../../models/SyncEngine":181,"../../utils/Env":460}],44:[function(e,t,r){"use strict";function n(e,t){e(t.shift()),t.length>0&&window.setTimeout($partial(n,e,t),5)}function o(e,t){$isIe()||$isSafari(!0)?$AEV(e,"keydown",t):$AEV(e,"keypress",t)}function a(e,t,r){var n=u[e];n&&clearTimeout(n),u[e]=setTimeout(r,t)}function i(e,t){try{e.postMessage(t,"*")}catch(e){}}function s(e){return-1!=e.indexOf("@")&&-1!=e.indexOf(".")}function l(){function e(e){return t(Math.random()*(1<<(e<<2))^Date.now()).slice(-e)}function t(e){return(0|e).toString(16)}return[e(4)+e(4),e(4),"4"+e(3),t(8|4*Math.random())+e(3),Date.now().toString(16).slice(-10)+e(2)].join("-")}var u={};t.exports={forceLiveRendering:n,attachKeyDown:o,delayAjaxUpdate:a,checkEmail:s,postMessageToWindow:i,UUID:l}},{}],45:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=window,s=i.GB_showImage,l=window,u=l.GB_show,c=window,d=c.GB_getLast,f=window,p=f.GB_CURRENT,m=window,h=m.PlayManager,v=e("../formatter/Formatter.js"),y=function(){function e(){n(this,e),this.render=this.render.bind(this),this.iconAttachment=this.iconAttachment.bind(this),this.audioAttachment=this.audioAttachment.bind(this)}return a(e,[{key:"canPlayAudio",value:function(e){var t=document.createElement("audio");return!(!t.canPlayType||!t.canPlayType(e).replace(/no/,""))}},{key:"calculateOptimalDimension",value:function(e,t,r,n){var o=void 0;return e/t>r/n?e<=r?[e,t]:(o=r/e,[r,Math.floor(t*o)]):t<=n?[e,t]:(o=n/t,[Math.floor(e*o),n])}},{key:"render",value:function(e){var t=e.file_attachment;if(t&&!e.is_buffer_obj){var r=void 0,n=void 0,a=void 0,i=void 0,s=t.file_underlying_type||t.file_type||"",l=(null!=t.file_name?t.file_name.toLowerCase():void 0)||"",c=(null!=t.file_url?t.file_url.toLowerCase():void 0)||"",d=t.resource_type||"file";if(("website"===d||"rich"===d)&&t.title&&t.url){var f=void 0,m=void 0;m=t.title?DIV({c:"text"},$trim(t.title,65)):null,f=t.description?DIV({c:"desc_text"},$trim(t.description,200)):null;var h=null;if(t.image){var v=Array.from(this.calculateOptimalDimension(t.image_width,t.image_height,120,90)),y=o(v,2);i=y[0],r=y[1],a=-1===t.image.indexOf("resizeist")?"https://image-resize.todoist.com/?url="+encodeURIComponent(t.image)+"&width="+i+"&height="+r+"&fallback=true":t.image,h=DIV({c:"image_holder"},IMG({src:a}))}var g=DIV({c:"content_holder"},m,f);return t.image&&-1!==t.image.indexOf(".gif")&&(g=null),n=DIV({c:"file_attachment"},A({href:t.url,target:"_blank"},h,g)),g&&$addClass(n,"has_content"),h&&$addClass(n,"has_image"),n}if((t.file_url||t.url)&&(t.image||t.tn_m)){var b=void 0;if(!(b="image/svg+xml"===t.file_type?t.file_url:t.image?t.image:t.tn_m[0]))return;var w=Array.from(this.calculateOptimalDimension(t.image_width||300,t.image_height||200,300,200)),E=o(w,2);i=E[0],r=E[1];var k=b;-1===b.indexOf("image-resize")&&"image/svg+xml"!==t.file_type&&(k="https://image-resize.todoist.com/?url="+encodeURIComponent(b)+"&width="+i+"&height="+r+"&fallback=true");var S=t.file_url||t.url,j=A({c:"file_attachment_download",target:"_blank",href:S},svgs.get("sm1/download.svg"));return IstTooltip.showTooltip(j,_("Download")),j.addEventListener("click",function(e){e.stopPropagation()}),n=A({href:t.file_url||t.url,target:"_blank",c:"file_attachment with_preview"},IMG({src:k,width:i,height:r,c:"preview"}),j),$AEV(n,"click",$p(this.showImage,n.href,n.href,n)),n}return"outlook/mail"===d?this.iconAttachment(t,"ft_outlook_mail"):0===s.indexOf("td/hyperlink")?this.iconAttachment(t,"ft_link"):0===s.indexOf("td/")?this.iconAttachment(t,"ft_email"):t.file_url&&(-1!==t.file_url.indexOf("cloudfront.net")||-1!==t.file_url.indexOf("files.todoist.com"))&&-1!==s.indexOf("audio/")&&this.canPlayAudio(s)?this.audioAttachment(t):-1!==s.indexOf("pdf")?this.iconAttachment(t,"ft_pdf"):-1!==l.indexOf(".xl")||-1!==s.indexOf("spreadsheet")?this.iconAttachment(t,"ft_excel"):-1!==l.indexOf(".doc")||-1!==s.indexOf("document")?this.iconAttachment(t,"ft_word"):-1!==l.indexOf(".pp")?this.iconAttachment(t,"ft_pp"):-1!==l.indexOf(".zip")?this.iconAttachment(t,"ft_zip"):-1!==l.indexOf(".psd")?this.iconAttachment(t,"ft_psd"):-1!==l.indexOf(".sketch")?this.iconAttachment(t,"ft_sketch"):-1!==l.indexOf(".aep")?this.iconAttachment(t,"ft_aep"):-1!==l.indexOf(".ai")?this.iconAttachment(t,"ft_ai"):-1!==l.indexOf(".py")||-1!==l.indexOf(".php")||-1!==l.indexOf(".java")||-1!==l.indexOf(".rb")||-1!==l.indexOf(".js")?this.iconAttachment(t,"ft_code"):-1!==s.indexOf("/extemail")||-1!==c.indexOf(".email.")||"email"===t.resource_type?this.iconAttachment(t,"ft_extemail",function(){u(t.file_name,t.file_url,500,800);var e=DIV({c:"orginal_link"},A({href:t.file_url,target:"_blank"},_("View in another window"))),r=$last(p);return $addAfter(e,r.iframe),!1}):0===s.indexOf("text/")?this.iconAttachment(t,"ft_text"):this.iconAttachment(t,"ft_generic")}}},{key:"iconAttachment",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=void 0,o=void 0,a=void 0,i=void 0;if("ft_outlook_mail"===t)return n=DIV({c:"file_attachment"},SPAN({c:"text"},$trim(e.file_name||"",50)));if("ft_email"===t){n=DIV({c:"file_attachment link_attachment"});var s=v.format(e.file_url);return $setHTML(n,s),n}var l=null;"pending"===e.upload_state&&(l=_("Pending")),"canceled"===e.upload_state&&(l=_("Canceled")),l&&(l=SPAN({c:"status"},l)),"ft_link"===t?(o="file_attachment link_attachment",a=svgs.get("sm1/link.svg",{className:"link_icon"})):(o="file_attachment",a=svgs.get("ft/"+t+".svg",{className:"file_icon"}));var u=DIV({c:o},i=A({href:e.file_url,target:"_blank"},a,SPAN({c:"text"},$trim(e.file_name||"",50)),l));return l?($addClass(i,"no_action"),i.onclick=function(){return!1}):r&&(i.onclick=r),u}},{key:"showImage",value:function(e,t,r,n){if(-1!==t.indexOf("dropbox.com"))return!0;if(window.MINI_VERSION)return!0;-1===e.indexOf("resizeist")&&(e="https://image-resize.todoist.com/?url="+encodeURIComponent(e)+"&maxheight=800&maxwidth=800&fallback=true"),$preventDefault(n),s("",e),d().setZindex(1e7);var o=$last(p),a=t;a.length>40&&(a=a.substring(0,40)+"...");var i=DIV({c:"orginal_link"},A({href:t,target:"_blank"},_("View full size in another window")));return $addAfter(i,o.iframe),!1}},{key:"audioAttachment",value:function(e){var t=void 0,r=document.createElement("audio");r.controls=!1,r.src=e.file_url,r.volume=1,$AEV(r,"error",function(){r.error_loading=!0});var n=A({href:"#",c:"play_control"},svgs.get("sm1/audio_play.svg",{className:"icon_play"}),svgs.get("sm1/audio_stop.svg",{className:"icon_stop"})),o=A({href:e.file_url,target:"_blank",c:"audio_link"},svgs.get("sm1/link.svg")),a=DIV({c:"audio_player"},r,n,t=SPAN({c:"timer"},"00:00"),o),i=r.duration||e.file_duration;return i&&h.timerFormat(t,i),h.attach(n,r,t,function(e){"play"===e?$addClass(n,"on"):"stop"===e&&$removeClass(n,"on")}),a}}]),e}();t.exports=new y},{"../formatter/Formatter.js":22}],46:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("../../utils/fp"),s=e("../../logger/Logger"),l=o(s),u=e("react"),c=o(u),d=e("react-dom"),f=o(d),p=e("../../stores/store"),m=o(p),h=e("../../stores/subscribeSelected"),v=o(h),y=e("../../react_components/emptyState"),g=e("../items_utils/ItemDueDates"),b=o(g),w=e("../../reducers/notes/notesSelectors"),E=n(w),k=e("../../reducers/notes/notesConstants"),S=e("../../reducers/notes/notesActions"),j=n(S),T=e("../../utils/deps"),O=window.Signals,I=window.LibEdit,C=window.PlayManager,D=window.FilesManager,M=window.RecordManager,x=window.GFile,R=window.GFileView,N=window.GB_hide,L=window.GB_showHTML,U=window.GB_getLast,V=window.Indicator,F=window.Alerts,H=window.IstButton,G=window.IstTooltip,z=window.DateUtils,q=window.ElementStore,W=window.Emoticons,Y=window.TextAreaHolder,K=window.FocusElm,J=window.$isTouchDeviceOnly,Q=e("../Constants.js"),X=e("../resizing_text_area/ResizingTextArea.js"),Z=e("../items_utils/ItemCheckbox"),ee=e("../agenda/AgendaUtils"),te=e("../project_editor/ProjectEditorManager"),re=e("../projects_list/ProjectListUtils"),ne=e("../avatars/Avatars"),oe=e("../../plugin_version/ContentTransformers").ContentTransformers,ae=e("../formatter/Formatter.js"),ie=e("../action_perfomed/ActionPerformed"),se=e("../project_editor/ProjectExtraActions"),le=e("../../models/TemporaryIds"),ue=e("../../models/Collaborators"),ce=e("../../models/ItemsModel"),de=e("../../models/ProjectsModel"),fe=e("../../models/NotificationsModel"),pe=e("./WhoToNotify"),me=e("./NoteMedia"),he=e("./NotesBuffer"),_e=e("./NotesUtils"),ve=e("../../containers/premium_promo/PremiumOnlyModal"),ye=e("../misc/Misc.js").getMacAppVersion,ge=e("../../menus/MenuReactions"),be=window.DoistFormat,we=e("../format_html/FormatHtml"),Ee=e("../themes/Themes"),ke=(0,T.defineDeps)("Notes",["Agenda"]),Se={current_task:null,current_project:null,current_note:null,restore_project:null,restore_items:null,init:function(){var e=this;$AEV(window,"load",function(){le.listenAll(function(e,t){var r=$("note_"+e);r&&(r.id="note_"+t)})}),O.connect("notes_updated",function(e){if("play"==C.state)return void setTimeout(function(){O.sendSignal("notes_updated",e)},1e3);Se.current_task?$map(e,function(e){e.item_id==Se.current_task.id&&Se.renderNotes(Se.current_task,k.TYPE_ITEM_NOTE,Se.notes_list,Se.holder)}):Se.current_project&&$map(e,function(e){e.item_id||e.project_id!=Se.current_project.id||Se.renderNotes(Se.current_project,k.TYPE_PROJECT_NOTE,Se.notes_list,Se.holder)})}),O.connect("external_service_annotation",this.externalServicesAnnotation),O.connect("upload_error",function(e,t){var r=Se.current_task;if(r&&r.id==e.item_id)return!0;var n=_('Uploading "%s" failed.').replace("%s",t.file.name);F.confirm(n,function(t){if(t){null===e.item_id||void 0===e.item_id?Se.showProjectNotes(e.project_id,e.id):Se.showItemNotes(e.item_id,e.id)}},_("View upload"))}),O.connect("note_buffer_commit",function(e,t){var r=$("note_"+e.id);r&&$swap(r,Se.renderNote(t))}),O.connect("people_assigner_person_changed",function(){Se.current_task&&O.sendSignal("instant_refresh_interface")}),O.connect("reaction_added",this.reactionAddedMenu),(0,v.default)(m.default,function(e){return e.items},function(t){var r=$$(".note_item form").length>0;if(t&&e.current_task&&!r&&!ke.Agenda.get().current_form){var n=t[e.current_task.id];n&&e.current_task!==n&&e.reRenderCurrentItem()}})},isReadOnly:function(){return Se.current_task?Se.current_task.is_archived:Se.current_project?Se.current_project.is_archived:void 0},annotate:function(e,t){var r=_e.renderIcon(e,k.TYPE_ITEM_NOTE);$add(t,r)},showProjectNotes:function(e,t){if(!m.default.getState().notes){var r=(0,v.default)(m.default,function(e){return e.notes},function(n){n&&(Se.showProjectNotes(e,t),r())});return!1}if(Se.is_currently_in_edit())return Se.close_currently_edit(function(){Se.showProjectNotes(e,t)}),!1;var n=Se.openGBWindow(!0),o=de.get(e);return t&&(Se.note_to_focus=t),o?Se.renderHolder(o,k.TYPE_PROJECT_NOTE,n):Se.renderProjectNotesAjax(n,e),!1},showItemNotes:function(e,t,r){if(!m.default.getState().notes){var n=(0,v.default)(m.default,function(e){return e.notes},function(o){o&&(Se.showItemNotes(e,t,r),n())});return!1}if(Se.is_currently_in_edit())return Se.close_currently_edit(function(){Se.showItemNotes(e,t,r)}),!1;var o,a=Se.openGBWindow(!1);return r&&(o=ce.getBySyncId(r)),o||(o=ce.getById(e)),t&&(Se.note_to_focus=t),o&&!o.in_history?Se.renderHolder(o,k.TYPE_ITEM_NOTE,a):Se.renderItemNotesAjax(a,e,r),!1},is_currently_in_edit:function(){return Se.current_task||Se.current_project||te.current_form},close_currently_edit:function(e){if(Se.current_task)return void N(function(){te.current_editor?te.current_editor.saveCurrentItem(e):e()});te.current_form&&te.current_editor&&te.current_editor.saveCurrentItem(e)},openGBWindow:function(e){var t=e?_("Project Comments"):_("Comments"),r=document.title,n=Se.getDimension(),o=DIV({c:"notes_holder notes_loading"},V.cssSpinner());ie.mark("Notes/open");var a=L(t,o,n.height,n.width,{close_validator_fn:function(){Se.clearEmpty();var e=$("note_textarea");if(!e)return!0;var t=function(){pe.reset(),Se.holder=null,Se.current_task=null,Se.current_project=null,Se.submit_fn=null,Se.attach_button=null,Se.files_view=null,D.reset(),M.reset(),C.reset(),document.title=r};return 0!==$strip(e.value).length?(N(null,!1),t(),!1):(t(),!0)}});return $addClass(a.g_window,"notes_gb_window"),o},renderProjectNotesAjax:function(e,t,r){m.default.dispatch(j.fetchNotesFromProject(t)).then(function(t){Se.current_project=t.project,Se.temp_project=t.project,Se.renderHolder(t.project,k.TYPE_PROJECT_NOTE,e),de.get(Se.temp_project.id)&&O.sendSignal("instant_refresh_interface"),r&&r()}).catch(function(e){l.default.captureError(e),N(),(0,i.get)("error_tag",e)?alert(_("The project was not found, could be deleted or moved.")):alert(_("An unknown error happened")+". "+_("Please try again later. We're sorry for the trouble."))})},renderItemNotesAjax:function(e,t,r,n){var o=this;m.default.dispatch(j.fetchNotesFromItem(t,r)).then(function(t){if(null==t.item||null==t.project)return N(),void alert(_("This task couldn\u2019t be found. It may have been moved or deleted."));Se.current_project=t.project,Se.temp_project=t.project,Se.renderHolder(t.item,k.TYPE_ITEM_NOTE,e),de.get(Se.temp_project.id)&&!o.isInSearchView()&&O.sendSignal("instant_refresh_interface"),$isFunction(n)&&n(t.item)}).catch(function(e){N(),l.default.captureError(e),(0,i.get)("error_tag",e)?alert(_("This task couldn\u2019t be found. It may have been moved or deleted.")):alert(_("An unknown error happened")+". "+_("Please try again later. We're sorry for the trouble."))})},renderHolder:function(e,t,r){var n,o,a;if(t===k.TYPE_ITEM_NOTE){var i=ae.format(e.content,{only_text:!0,as_html:!1});if(document.title=$strip(i)+": Todoist",O.sendSignal("change_location","task/"+e.id),Se.current_task=e,Se.current_project=Se.getProject(e.project_id),!Se.current_project)return void Se.renderProjectNotesAjax(r,e.project_id);a=DIV({c:"note_item"},UL({c:"items"},Se.renderItem(e)),Se.renderExtraItemInfo(e))}else{var s=ae.format(e.name,{only_text:!0,as_html:!1});document.title=$strip(s)+": Todoist",O.sendSignal("change_location","project_comments/"+e.id),Se.current_task=null,Se.current_project=e,a=DIV({c:"note_item"},Se.renderExtraProjectInfo(e))}var l=pe.render(e,t),u=H.createButton(_("Add Comment"),null,"red sel_submit_note",{"data-track":"comments|add_comment"}),c=ue.isProjectShared(this.current_project.id),d=Se.renderTextareaHolder(!1),f=DIV({c:"notes_holder"},a,this.notes_list=o=DIV({c:"notes_list",id:"current_notes"}),DIV({c:"note_submit"},n=FORM(d.holder,DIV({c:"btn_area"},TABLE({width:"100%"},TBODY(TR(TD({width:"30%"},u),TD({s:"text-align: right"},l))))))));if($add(o,V.cssSpinner()),c&&$addClass(f,"notes_shared"),Se.isReadOnly())$addClass(f,"notes_readonly");else{var p=$p(Se.addNote,e,t,n);n.submit_fn=p,$AEV(n,"submit",p),$AEV(u,"click",p),Se.submit_fn=p}Se.holder=f,Se.externalServicesAnnotation(window.CURRENT_EXERNAL_SERVICE),$swap(r,f),Se.renderNotes(e,t,Se.notes_list,f);var m=$("note_textarea");return J()||setTimeout(function(){m.focus()},50),Se.attachNoteKeyboardShortcuts(m),!1},renderExtraProjectInfo:function(e){var t=DIV({c:"note_extra_info"});return $add(t,Se.renderProjectLink(e)),Se.renderNoteEmail(t,function(){return se.showProjectCommentEmail(e.id),!1}),Se.renderNoteActivity(t,function(){return window.User.is_premium?(N(),O.sendSignal("activity_log.show",e.id),!1):(ve.showProjectActivityLog(),!1)}),t},renderExtraItemInfo:function(e){if(!e.date_added)return null;var t=DIV({c:"note_extra_info"});if(e.date_added){Se.resolveDate(e,"date_added");var r=SPAN(z.formatView(e.date_added)),n=function(e){var r=Se.renderProjectLink(e);$add(t,SPAN({c:"sep"}," \u2022 "),r)},o=this.current_project;if(o&&ue.isProjectShared(o.id)){var a=ue.getUserById(e.assigned_by_uid||e.user_id);if(a)if(null!=e.assigned_by_uid){var i=null==e.responsible_uid?_("Added by"):_("Assigned by"),s=SPAN(i," ",_e.shortName(a));$add(t,s),G.showSimpleText(s,SPAN(_("Time added")," ",r));var l=ne.renderAvatar(a,"small",Ee.theme);$ATT(s,l)}else G.showSimpleText(r,_("Time added")),$add(t,r);n(o)}else o&&(G.showSimpleText(r,_("Time added")),$add(t,r),n(o));Se.renderNoteEmail(t,function(){return se.showItemEmail(e.id),!1}),Se.renderNoteActivity(t,function(){return window.User.is_premium?(N(),O.sendSignal("activity_log.show",null,e.id),!1):(ve.showTaskActivityLog(),!1)})}return t},renderNoteEmail:function(e,t){var r;$add(e,SPAN({c:"sep"}," \u2022 "),r=SPAN({c:"icon","data-track":"comments|add_comments_via_email"},svgs.get("sm1/mail.svg"))),r.onclick=t,G.showSimpleText(r,_("Add comments via email"))},renderNoteActivity:function(e,t){var r;$add(e,SPAN({c:"sep"}," \u2022 "),r=SPAN({c:"icon","data-track":"comments|view_activity_log"},svgs.get("sm1/activity_log.svg"))),r.onclick=t,G.showSimpleText(r,_("View activity log"))},reRenderCurrentItem:function(){if(this.current_task){var e=$$("li.task_item",Se.holder)[0];this.current_task=ce.getById(this.current_task.id),$swap(e,Se.renderItem(this.current_task))}},renderItem:function(e){var t=ee.renderItem(e,{with_due_date:!0,with_time:!1,no_drag_and_drop:!0,no_selecter_attach:!0,with_project:!1,not_editable:Se.isReadOnly(),fn_complete_item:this.completeItem,fn_undo_complete_item:this.uncompleteItem,is_note:!0});return $addClass(t,"note_task"),t},renderTextareaHolder:function(e){function t(){return!!window.User.is_premium||(ve.showSharedProjectFileUpload(),!1)}var r=_("Write a comment"),n=TEXTAREA({placeholder:r,id:"note_textarea"});e||he.initDraft(Se.getCurrentDraftId,n),new X(n,!1),Se.attachNoteKeyboardShortcuts(n);var o,a,i,s;e||(s=D.generateUploadView(),D.attachClipboardPasting(n),Se.files_view=s,o=H.createMiniButton(svgs.get("sm1/attachment.svg"),"upload_btn",{"data-track":"comments|attach_file"}),$AEV(o,"click",function(){return D.showDropArea(!0,{on_computer_click:function(e){if(t()||e.preventDefault(),-1!=navigator.userAgent.indexOf("Mac OS X 10_11")){var r=ye();if(r&&r>=6.4){e.preventDefault();var n=DIV(B(_("Select file from computer isn\u2019t working\u2026")),P(_("To upload files, please drag-and-drop them into your comment instead.")),P(_("Apple has fixed this issue in macOS 10.12. Apologies for the inconvenience!")));alert(n)}}}}),G.hide(),!1}),i=H.createMiniButton(svgs.get("sm1/microphone.svg"),"upload_btn",{"data-track":"comments|record"}),i.addEventListener("click",function(){if(!window.User.is_premium)return ve.showAudioRecording(),!1;M.show()}),a=this.attach_button=H.createMiniButton(svgs.get("sm1/ext_attachment.svg"),"attach_btn"),G.showSimpleText(a,function(){return a.tooltip_text},null,0,10));var l=[o,i,a];l.push(W.getButton(n,null,null,{"data-track":"comments|add_emoji"}));var u=Y.create({text_area:n,buttons:l});return e||($addAfter(s,n),D.setDropArea(s,u,function(){return t()})),{holder:u,textarea:n}},completeItem:function(e){ce.complete(e.json),b.default.updateDueDate(e),Se._genericUpdateCheckbox(e,!0)},uncompleteItem:function(e){var t=e.json;e.json.in_history?ce.unarchive(t):ce.uncomplete(t),Se._genericUpdateCheckbox(e,!1);var r=$all("li","item_"+t.id);$map(r,function(e){$hasClass(e,"history_item")&&$remove(e)})},_genericUpdateCheckbox:function(e,t){Z.update(e,t,function(){var r;r=t?$p(Se.completeItem,e):$p(Se.uncompleteItem,e),Z.update(e,!t,r),b.default.updateDueDate(e)},!1),Se.getProject(e.json.project_id)&&!this.isInSearchView()&&O.sendSignal("instant_refresh_interface")},isInSearchView:function(){return $$(".search_holder").length>0},renderNote:function(e){var t=ae.format(e.content,{as_html:!0,attachment:e.file_attachment}),r=SPAN(svgs.get("sm1/trash.svg")),n=SPAN(svgs.get("sm1/edit.svg")),o=SPAN(svgs.get("sm1/emoji.svg"));G.showTooltip(r,_("Delete"),this.scrollOffset,5),G.showTooltip(n,_("Edit"),this.scrollOffset,5),G.showTooltip(o,_("Add reaction"),this.scrollOffset,5);var a="";e.posted instanceof Date&&(a=z.formatView(e.posted)),e.posted_uid||(e.posted_uid=window.User.id);var i=DIV({c:"note_actions force_form_show"});e.posted_uid==window.User.id&&(e.is_buffer_obj?$add(i,r," "):Se.isReadOnly()||$add(i,n," ",r," ")),$addClass(o,"menu_icon"),$add(i,o," "),$add(i,Se.usersNotified(e)," ");var s=SPAN({c:"time"},a);ge.get().shown&&Se.current_note==e&&$addClass(i,s,"reactions_sticky");var l,u=DIV({c:"note_meta"},s,i),c=DIV({
c:"note_text",id:"note_"+e.id},u,$setHTML(SPAN({c:"note_content"}),t));if(l=e.posted_uid==window.User.id?window.User:ue.getUserById(e.posted_uid)){var d=ne.renderAvatar(l,"medium",Ee.theme);$addClass(c,"has_avatar"),$ATT(c,d),$ATT(u,SPAN({c:"user_name"},_e.shortName(l)))}else{var f=ne.renderAnonymous("medium");$addClass(c,"has_avatar"),$ATT(c,f),$ATT(u,SPAN({c:"user_name"},_("Someone")))}var p=me.render(e);p&&$add(c,p),$AEV(r,"click",$p(Se.deleteNote,e,c)),$AEV(n,"click",$p(Se.showEditNote,e,c)),$AEV(o,"click",function(t){track("comments","click","add_reaction"),Se.current_note=e;var r;G.hide(),r=ge.get();var n=Se.scrollOffset();r.toggle(o,o,t,{pos_y_offset:n+10,arrow_y_offset:n+23,arrow_x_offset:3});var a=$("note_"+e.id);return $addClass($$(".note_actions",a),$$(".time",a),"reactions_sticky"),!1});var m=q.get(e,"file");if(e.is_buffer_obj&&m){$setOpacity(c,.6);var h=new R(m);$add(c,DIV({c:"files_view"},h.render(!1)))}var v=DIV({c:"reactions_line no_reactions",id:"reactions_"+e.id});return Se.renderReactions(e,v),$add(c,v),c},renderReactions:function(e,t){if(null!=e.reactions){$removeClass(t,"no_reactions");for(var r,n,o=window.User.id,a=Object.keys(e.reactions).sort(),i=0;i<a.length;i++)r=a[i],n=SPAN({c:"reaction_holder"}),$add(n,$setHTML(SPAN(),be.formatSimple(r,{as_html:!0}))),$add(n,SPAN({c:"reactions_count"},e.reactions[r].length)),$add(t,n),G.showTooltip(n,function(e){return function(){var t=DIV({c:"people_holder reacted_people"});if($map(e,function(e){var r;if(r=e==o?window.User:ue.getUserById(e)){var n=ne.renderAvatar(r,"small",Ee.theme),a=DIV({c:"user"},n,SPAN(_e.shortName(r)));$add(t,a,BR())}},0,Math.min(e.length,10)),e.length>10){var r=e.length-10,n=DIV({c:"user"});$add(n,we.format(_("+ {count} others"),{count:r.toString()})),$add(t,n,BR())}return t}}(e.reactions[r]),this.scrollOffset,0),$isIn(o,e.reactions[r])?($addClass(n,"reacted"),$AEV(n,"click",$p(Se.reactionRemovedIcon,e,r))):$AEV(n,"click",$p(Se.reactionAddedIcon,e,r));var s=SPAN({c:"reaction_holder reaction_plus"},"+");return $addClass(s,"form_action_icon menu_icon"),$AEV(s,"click",function(t){Se.current_note=e;var r;G.hide(),r=ge.get();var n=Se.scrollOffset();r.toggle(s,s,t,{pos_y_offset:n+13,arrow_y_offset:n+28,arrow_x_offset:8});var o=$("note_"+e.id);return $addClass($$(".note_actions",o),$$(".time",o),"reactions_sticky"),!1}),G.showTooltip(s,_("Add reaction"),this.scrollOffset,9),$add(t,s),t}},clearEmpty:function(){var e=$("current_notes");$gc(e,"div","empty-state")&&f.default.unmountComponentAtNode(e)},focusLatest:function(e){var t=$("current_notes");t&&(t.scrollTop=e.offsetTop)},usersNotified:function(e){var t=e.uids_to_notify;if(t&&t.length>0){var r=SPAN({c:"clickable"},svgs.get("sm1/bell.svg"));return G.showTooltip(r,function(){var e=DIV({c:"people_holder notified_people"},B(_("People notified")),BR());return $map(t,function(t){var r=ue.getUserById(t);if(r){var n=ne.renderAvatar(r,"small",Ee.theme),o=DIV({c:"user"},n,SPAN(_e.shortName(r)));$add(e,o,BR())}}),e},this.scrollOffset,0),r}},showEditNote:function(e,t){track("comments","click","edit_previous_comment"),Se.current_note=e,Se.edit_note_saved=!1;var r,n=Se.getDimension();r=H.createButton(_("Update"),null,"red");var o,a=Se.renderTextareaHolder(!0);t=DIV({c:"note_submit note_edit"},o=FORM(a.holder,DIV({c:"btn_area"},r)));var i=$p(Se.saveNote,r,e,a.textarea);return o.submit_fn=i,$AEV(r,"click",i),a.textarea.value=e.content,L(_("Edit"),t,n.height,n.width,{close_validator_fn:function(){var t=a.textarea;return!t||(Se.edit_note_saved?(Se.edit_note_saved=!1,!0):t.value==e.content||(F.confirmYesNo(_("Are you sure you want to cancel your current input?"),function(e){e?N(null,!1):t.focus()}),!1))}}),I.placeCursor(a.textarea,a.textarea.value.length),!1},saveNote:function(e,t,r){var n=$strip(r.value);if(""==n)return!1;$hide(e),$addAfter(V.cssSpinner(),e),m.default.dispatch(j.update(Se.current_note.id,n));var o,a=Se.current_note;if(a){a.content=n;var i=$("note_"+t.id);i&&(o=Se.renderNote(t),$addClass(o,"note_updated"),$swap(i,o))}return Se.edit_note_saved=!0,N(),!1},renderNotes:function(e,t,r,n){var o=E.getNotesSorted(m.default.getState(),e.id,t);$replace(r,null);var a,i=Se.note_to_focus,s=_("Fetch older comments");if(0!==o.length||e.has_more_notes){var l,u=!1;if(e.has_more_notes&&(u=!0),u){var d;$add(r,d=A({c:"fetch_old",href:"#"},s)),$AEV(d,"click",function(){return $replace(d,V.cssSpinner()),t===k.TYPE_ITEM_NOTE?Se.renderItemNotesAjax(n,e.id,e.sync_id,function(){var e=$child(n,"div","note_text");e&&Se.focusLatest(e)}):Se.renderProjectNotesAjax(n,e.id,function(){var e=$child(n,"div","note_text");e&&Se.focusLatest(e)}),!1})}if($map(o,function(e){$add(r,l=Se.renderNote(e)),i&&e.id==i&&(a=l)}),setTimeout(function(){fe.markNotesAsRead(o)},200),a){Se.note_to_focus=null;var p=$("current_notes");p&&(p.scrollTop=a.offsetTop-120),$addClass(a,"note_added active"),setTimeout(function(){$removeClass(a,"active")},1500)}else 0!=Se.note_to_focus&&l&&Se.focusLatest(l)}else{var h=t===k.TYPE_ITEM_NOTE?c.default.createElement(y.EmptyStateTaskComments,null):c.default.createElement(y.EmptyStateProjectComments,null);f.default.render(h,r)}},addNote:function(e,t,r){if(t==k.TYPE_ITEM_NOTE&&!_e.isPremium(e.project_id))return _e.showPromo(k.TYPE_ITEM_NOTE),!1;if(t==k.TYPE_PROJECT_NOTE&&!_e.isPremium(e.id))return _e.showPromo(k.TYPE_PROJECT_NOTE),!1;var n=$child(r,"textarea"),o=$strip(n.value),a=D.getFiles(Se.files_view);if(0===o.length&&0===a.length)return!1;var i=null;Se.current_project&&ue.isProjectShared(Se.current_project.id)&&(i=pe.getUidsToNotify());var s=he.addNotes(e.id,t,n.value,i,a);he.wipeDraft(Se.getCurrentDraftId,n),n.value="",J()?n.blur():n.focus(),Se.files_view&&D.resetView(Se.files_view),M.reset(),n.resize_textarea&&n.resize_textarea(),Se.clearEmpty();var l;return $map(s,function(e){l=Se.renderNote(e),$addClass(l,"note_added"),$add($("current_notes"),l)}),Se.focusLatest(l),O.sendSignal("instant_refresh_interface"),!1},deleteNote:function(e,t){return track("comments","click","delete_previous_comment"),F.confirm(_("Are you sure you want to delete this?"),function(r){r&&(Se.note_to_focus=!1,m.default.dispatch(j.remove(e.id)),$remove(t),O.sendSignal("instant_refresh_interface"))},_("Delete")),!1},getDimension:function(){var e=$winSize();return{width:Math.min(e.w-100,600),height:Math.min(e.h-30,560)}},resolveDate:function(e,t){if(!e[t])return null;e.ntime?e[t]=new Date(e.ntime):$isString(e[t])?e[t]=new Date(e[t]):e.ntime=e[t].getTime()},attachNoteKeyboardShortcuts:function(e){e.note_keys_attached||($AEV(e,"keydown",function(t){var r=$parent(e,"form"),n=$child(r,"a","ist_button_red");if(n&&setTimeout(function(){K.focus(n)},5),t.ctrl&&13==t.keyAscii)return r.submit_fn(),$preventDefault(t),!1}),e.note_keys_attached=!0)},externalServicesAnnotation:function(e){var t=Se.attach_button;if(e&&t){var r=e.annotate_fn;e.annotate_attach_text?t.tooltip_text=e.annotate_attach_text:e.is_email?t.tooltip_text=_("Attach email to comment"):t.tooltip_text=_("Attach website to comment"),t.onclick=function(){var e=new x,n=new TEXTAREA;r(n);var o,a=n.value,i=oe.onContentSave(a),s=oe.type;if("gmail_new"==s)o="td/gmail";else if("outlook"==s)o="td/outlook";else if("thunderbird"==s)o="td/thunderbird";else{o="td/hyperlink";var l=window.PluginVersion.getTitleAndUrl();a=l[0],i=l[1]}e.setUploadContent({file_url:i,file_name:a,file_type:o});var u=new R(e);return $add(Se.files_view,u.render()),G.hide(),$hide(t),setTimeout(function(){$show(t)},20),oe.onContollerHide(),!1},$show(t)}else $hide(t)},getProject:function(e){var t=de.get(e);if(t)return t;var r=Se.temp_project;return r&&r.id==e?r:void 0},getCurrentDraftId:function(){return Se.current_task?Q.note_buffer_t_prefix+Se.current_task.id:Q.note_buffer_p_prefix+Se.current_project.id},renderProjectLink:function(e){var t=ae.format(e.name,{only_text:!0}),r=$setHTML(A({c:"project_link",href:"#project/"+e.id}),t);return $AEV(r,"click",function(){var t=null;return Se.current_task&&(t=Se.current_task.id),N(),U()&&N(),re.setCurrentById(e.id,t),!1}),r.id="notes_project_link",r},scrollOffset:function(){return-$("current_notes").scrollTop||0},reactionAddedMenu:function(e){ge.get().hide();var t=ge.getReactions()[e];m.default.dispatch(j.addReaction(Se.current_note.id,t));var r=(0,w.getNoteById)(m.default.getState(),Se.current_note.id);Se.refreshReactions(a({},r,{id:Se.current_note.id}))},reactionAddedIcon:function(e,t){G.hide(),m.default.dispatch(j.addReaction(e.id,t));var r=(0,w.getNoteById)(m.default.getState(),e.id);Se.refreshReactions(a({},r,{id:e.id}))},reactionRemovedIcon:function(e,t){G.hide(),m.default.dispatch(j.removeReaction(e.id,t));var r=(0,w.getNoteById)(m.default.getState(),e.id);Se.refreshReactions(a({},r,{id:e.id}))},refreshReactions:function(e){var t=$("reactions_"+e.id);if(t){var r=DIV({c:"reactions_line no_reactions",id:"reactions_"+e.id});Se.renderReactions(e,r),$swap(t,r)}}};window.Notes=Se,t.exports=Se},{"../../containers/premium_promo/PremiumOnlyModal":120,"../../logger/Logger":141,"../../menus/MenuReactions":153,"../../models/Collaborators":160,"../../models/ItemsModel":167,"../../models/NotificationsModel":170,"../../models/ProjectsModel":171,"../../models/TemporaryIds":184,"../../plugin_version/ContentTransformers":190,"../../react_components/emptyState":241,"../../reducers/notes/notesActions":429,"../../reducers/notes/notesConstants":430,"../../reducers/notes/notesSelectors":432,"../../stores/store":456,"../../stores/subscribeSelected":457,"../../utils/deps":470,"../../utils/fp":477,"../Constants.js":1,"../action_perfomed/ActionPerformed":2,"../agenda/AgendaUtils":8,"../avatars/Avatars":17,"../format_html/FormatHtml":21,"../formatter/Formatter.js":22,"../items_utils/ItemCheckbox":29,"../items_utils/ItemDueDates":31,"../misc/Misc.js":43,"../project_editor/ProjectEditorManager":61,"../project_editor/ProjectExtraActions":63,"../projects_list/ProjectListUtils":71,"../resizing_text_area/ResizingTextArea.js":84,"../themes/Themes":95,"./NoteMedia":45,"./NotesBuffer":48,"./NotesUtils":49,"./WhoToNotify":50,react:"react","react-dom":"react-dom"}],47:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Signals,s=window,l=s.TooptipWin,u=function(){function e(){n(this,e),this.reset=this.reset.bind(this),this.getValue=this.getValue.bind(this)}return o(e,[{key:"reset",value:function(){this.current_note=""}},{key:"getValue",value:function(){return $strip(this.current_note)}},{key:"showTooltip",value:function(e){var t=this,r=void 0;if($isHidden(e))return!1;var n=DIV(r=TEXTAREA({placeholder:_("Write a comment")}));this.current_note&&(r.value=this.current_note),$AEV(r,"keyup",function(){t.current_note=r.value,t.current_note.length>0?$addClass(e,"active"):$removeClass(e,"active")}),$AEV(r,"keydown",function(e){e.ctrlKey&&13===e.keyCode&&t.win.hide()});var o=$position(e),a={fn_left_offset:function(){return o.x-255},fn_top_offset:function(){return o.y+35},fn_arrow_left:function(){return o.x+10},fixed_pos:$hasClass(e,"fixed_pos"),fn_on_hide:function(){i.sendSignal("focus_current_item_input")}};return this.win=l.show(_("Quick Comment"),n,210,300,a),$addClass(this.win.g_window,"notes_add_tooltip"),r.focus(),!1}}],[{key:"initClass",value:function(){this.prototype.current_note=""}}]),e}();u.initClass(),t.exports=new u},{}],48:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../../stores/store"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=e("../../reducers/notes/notesActions"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),u=window,c=u.Signals,d=window,f=d.ElementStore,p=e("../Constants.js"),m=e("../../models/Storage"),h=m.$storage,_=function(){function e(){n(this,e),this.getNoteUploads=this.getNoteUploads.bind(this),this.addNotes=this.addNotes.bind(this),this.fileStatusChange=this.fileStatusChange.bind(this),c.connect("resolve_temp.item",function(e,t){var r=h(""+p.note_buffer_t_prefix+e).get();r&&h(""+p.note_buffer_t_prefix+t).set(r)}),c.connect("resolve_temp.project",function(e,t){var r=h(""+p.note_buffer_p_prefix+e).get();r&&h(""+p.note_buffer_p_prefix+t).set(r)})}return o(e,null,[{key:"initClass",value:function(){this.prototype.note_uploads=[]}}]),o(e,[{key:"getNoteUploads",value:function(){return this.note_uploads}},{key:"addNotes",value:function(e,t,r,n,o){if(0===o.length)return[i.default.dispatch(l.add({parentId:e,content:r,type:t,usersToNotify:n}))];for(var a=[];;){var s=o.shift();if(!s)break;0!==a.length&&(r="");var u=function(r,o){var a=void 0,s={};r.file_server_info?(s.file_server_info=r.file_server_info,a=!1):(s.file_server_info={file_name:r.file.name,file_type:r.file.type,file_size:r.file.size,upload_state:"pending"},a=!0);var u=i.default.dispatch(l.add({parentId:e,content:o,type:t,usersToNotify:n,file:s}));return u.is_buffer_obj=a,f.set(u,"file",r),u}(s,r);this.note_uploads.push(u),s.addCallback($p(this.fileStatusChange,u)),a.push(u)}return a}},{key:"fileStatusChange",value:function(e,t){if(t.file)if(t.success){if(!t.instant){var r=t.file_server_info;r.upload_state="completed",e=i.default.dispatch(l.update(e.id,null,r))}c.sendSignal("refresh_interface"),this.note_uploads=$arrayRemove(this.note_uploads,e),f.remove(e,"file"),e.is_buffer_obj&&delete e.is_buffer_obj}else c.sendSignal("upload_error",e,t);else this.note_uploads=$arrayRemove(this.note_uploads,e),f.remove(e,"file")}},{key:"initDraft",value:function(e,t){var r=h(e()).get();r&&(t.value=r),$AEV(t,"keyup",function(){$log("Storing in "+e()),h(e()).set(t.value)})}},{key:"wipeDraft",value:function(e){h(e()).clear()}}]),e}();_.initClass(),t.exports=new _},{"../../models/Storage":179,"../../reducers/notes/notesActions":429,"../../stores/store":456,"../Constants.js":1}],49:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var o=e("../../stores/store"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=e("../../utils/deps"),s=e("../../reducers/notes/notesConstants"),l=e("../../reducers/notes/notesActions"),u=n(l),c=e("../../reducers/notes/notesSelectors"),d=n(c),f=e("../../reducers/detailView"),p=e("../../reducers/user"),m=window,h=m.GB_hide,_=e("../../containers/premium_promo/PremiumOnlyModal"),v=e("../../models/Collaborators"),y=e("../misc/Misc.js"),g=y.isMacApp,b=(0,i.defineDeps)("NotesUtils",["Notes"]);r.show=function(e,t,r){return b.Notes.showItemNotes(e,t,r)},r.annotate=function(e,t){return b.Notes.annotate(e,t)},r.shortName=function(e){var t=e.full_name.split(" ");return t.length>1?t[0]+" "+t[1].substring(0,1)+".":t[0]};var w=r.showPromo=function(e){return e===s.TYPE_ITEM_NOTE?_.showTaskComment():_.showProjectComment(),!1},E=r.isPremium=function(e){return!!window.User.is_premium||(2===window.User.features.restriction||!(!e||!v.isProjectShared(e)))};r.renderIcon=function(e,t,r){var n=E(e.project_id||e.id);if(0===r&&g()&&!n)return null;e.notes&&$map(e.notes,function(e){a.default.dispatch(u.insert(e))});var o=d.getNotes(a.default.getState(),e.id,t);r||(r=o.length);var i=SPAN({c:"clickable note_icon","data-track":"comments|open"},svgs.get("sm1/comments.svg"));if(i.setAttribute("data-note-type",t),i.setAttribute("data-note-parent-id",e.id),i.setAttribute("data-track",t===s.TYPE_PROJECT_NOTE?"project|comments":"task|comments"),r>0){var l=SPAN({c:"clickable note_count sel_note_count"});r=""+r,e&&e.has_more_notes&&(r+="+"),$setHTML(l,r),$add(i,l)}else t===s.TYPE_ITEM_NOTE&&$addClass(i,"note_icon_hidden");return i.addEventListener("click",function(o){if(!o.ctrl){if(o.altKey)return(0,p.isDoistUser)(a.default.getState())&&(t===s.TYPE_ITEM_NOTE&&a.default.dispatch((0,f.detailViewShowItem)(e.id)),t===s.TYPE_PROJECT_NOTE&&a.default.dispatch((0,f.detailViewShowProject)(e.id))),void(o._propogated_from_note_icon=!0);if(r<=0&&!n)return h(),void w(t);t===s.TYPE_ITEM_NOTE?b.Notes.showItemNotes(e.id,null,e.sync_id):b.Notes.showProjectNotes(e.id),o._propogated_from_note_icon=!0}}),i}},{"../../containers/premium_promo/PremiumOnlyModal":120,"../../models/Collaborators":160,"../../reducers/detailView":410,"../../reducers/notes/notesActions":429,"../../reducers/notes/notesConstants":430,"../../reducers/notes/notesSelectors":432,"../../reducers/user":451,"../../stores/store":456,"../../utils/deps":470,"../misc/Misc.js":43}],50:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../../stores/store"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=e("../../reducers/notes/notesSelectors"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(s),u=e("../../reducers/notes/notesConstants"),c=e("../../models/Collaborators"),d=e("../avatars/Avatars"),f=e("../notes/NotesUtils"),p=e("../themes/Themes"),m=function(){function e(){n(this,e),this.reset=this.reset.bind(this),this.is_project_note=this.is_project_note.bind(this),this.current_project_id=this.current_project_id.bind(this),this.render=this.render.bind(this),this.getUidsToNotify=this.getUidsToNotify.bind(this),this.renderCheckmarkSelector=this.renderCheckmarkSelector.bind(this),this.setInitialSelected=this.setInitialSelected.bind(this),this.reRender=this.reRender.bind(this),this.renderMultiSelecter=this.renderMultiSelecter.bind(this)}return o(e,[{key:"reset",value:function(){this.task=null,this.project=null,this.note_type=null,this.other_collaborators=null,this.thread_uids=null,this.current_selected=null,this.holder=null}},{key:"is_project_note",value:function(){return this.note_type===u.TYPE_PROJECT_NOTE}},{key:"current_project_id",value:function(){return this.is_project_note()?this.project.id:this.task.project_id}},{key:"render",value:function(e,t){this.reset(),this.note_type=t,this.note_type===u.TYPE_PROJECT_NOTE?this.project=e:this.task=e;var r=l.getNotesSorted(i.default.getState(),e.id,t),n=window.User.id;this.other_collaborators=c.getAll(this.current_project_id()).filter(function(e){return e.id!==n}),this.thread_uids={};var o=!0,a=!1,s=void 0;try{for(var d,f=r[Symbol.iterator]();!(o=(d=f.next()).done);o=!0){var p=d.value;p.posted_uid!==n&&(this.thread_uids[p.posted_uid]=p.posted_uid)}}catch(e){a=!0,s=e}finally{try{!o&&f.return&&f.return()}finally{if(a)throw s}}return this.holder=DIV({c:"who_to_notify"}),this.setInitialSelected(r),1===this.other_collaborators.length?$add(this.holder,this.renderCheckmarkSelector()):this.other_collaborators.length>1&&$add(this.holder,this.renderMultiSelecter()),this.holder}},{key:"getUidsToNotify",value:function(){return $values(this.current_selected)}},{key:"renderCheckmarkSelector",value:function(){var e=this,t=this.other_collaborators[0],r=t.full_name.split(" ")[0],n=LABEL({for:"notify_person"},_("Notify %s about my comment").replace("%s",r)),o=INPUT({type:"checkbox",value:"notify_person",id:"notify_person"});return this.current_selected[t.id]&&(o.checked=!0),$AEV(o,"change",function(){o.checked?(track("comments","click","notify_collaborators_on"),e.current_selected[t.id]=t.id):(track("comments","click","notify_collaborators_off"),delete e.current_selected[t.id])}),SPAN(o,n)}},{key:"setInitialSelected",value:function(e){var t=this,r=window.User.id;this.current_selected={};var n=function(e){var n=t.other_collaborators.map(function(e){return e.id});e&&e!==r&&n.includes(e)&&(t.current_selected[e]=e)};if(0!==e.length){var o=$last(e);n(o.posted_uid);var a=o.uids_to_notify;if(a){$isString(a)&&(a=$eval(a));var i=!0,s=!1,l=void 0;try{for(var u,c=a[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){n(u.value)}}catch(e){s=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(s)throw l}}}}else if(this.is_project_note()){var d=!0,f=!1,p=void 0;try{for(var m,h=this.other_collaborators[Symbol.iterator]();!(d=(m=h.next()).done);d=!0){var _=m.value;n(_.id)}}catch(e){f=!0,p=e}finally{try{!d&&h.return&&h.return()}finally{if(f)throw p}}}else n(this.task.assigned_by_uid),n(this.task.responsible_uid)}},{key:"reRender",value:function(){this.getUidsToNotify().length>0?track("comments","click","notify_collaborators_on"):track("comments","click","notify_collaborators_off");var e=this.mutli_selecter,t=this.renderMultiSelecter();$swap(e,t)}},{key:"renderMultiSelecter",value:function(){var e=this,t=void 0,r=void 0,n=void 0,o=void 0,a=void 0,i=$values(this.current_selected);if(0===i.length)n=_("Notify <b>Nobody</b> about my comment");else if(i.length===this.other_collaborators.length)n=_("Notify <b>Everybody</b> about my comment");else if(1===i.length){o=c.getUserById(i[0]);var s=f.shortName(o);n=_("Notify <b>%s</b> about my comment").replace("%s",s)}else n=_("Notify <b>%s people</b> about my comment").replace("%s",i.length),a=!0;var l=A({href:"#",c:"change"},_("Change"));$AEV(l,"click",function(){return $addClass(e.holder,"expanded"),!1});var u=LABEL({for:"notify_toggle"},_("Notify the following people"),":"),m=INPUT({type:"checkbox",value:"notify_toggle",id:"notify_toggle"});i.length>0&&(m.checked=!0),$AEV(m,"change",function(){if($keys(e.current_selected).length===e.other_collaborators.length)e.current_selected={};else{var t=!0,r=!1,n=void 0;try{for(var a,i=e.other_collaborators[Symbol.iterator]();!(t=(a=i.next()).done);t=!0)o=a.value,e.current_selected[o.id]=o.id}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}}e.reRender()});var h=DIV({c:"people people_holder"}),v=!0,y=!1,g=void 0;try{for(var b,w=this.other_collaborators[Symbol.iterator]();!(v=(b=w.next()).done);v=!0){o=b.value;var E,k="notify_"+o.id,S=d.renderAvatar(o,"small",p.theme),j=LABEL(S,SPAN({c:"truncated"},f.shortName(o))),T=INPUT({type:"checkbox",value:k}),O=function(t,r){e.current_selected[r]?delete e.current_selected[r]:e.current_selected[r]=r,e.reRender()};this.current_selected[o.id]&&(T.checked=!0),$add(h,E=DIV({c:"user"},T,j));var I=$p(O,T,o.id);$AEV(E,"click",I)}}catch(e){y=!0,g=e}finally{try{!v&&w.return&&w.return()}finally{if(y)throw g}}var P=DIV({c:"selecter"},SPAN({c:"top_selecter"},m,u),h),C=DIV({c:"save_holder"},r=A({href:"#"},_("Hide")));$AEV(r,"click",function(){return $removeClass(e.holder,"expanded"),!1});var D=$setHTML(SPAN({c:"desc_text"}),n);if(a){var M=$gc(D,"b");IstTooltip.showTooltip(M,function(){var e=UL({c:"who_to_notify_tooltip"}),t=!0,r=!1,n=void 0;try{for(var o,a=i[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var s=o.value,l=c.getUserById(s);l&&$add(e,LI(d.renderAvatar(l,"small",p.theme),SPAN({c:"truncated"},f.shortName(l))))}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return e})}return this.mutli_selecter=t=DIV({c:"mutli_selecter"},C,D,l,P),t}}]),e}();t.exports=new m},{"../../models/Collaborators":160,"../../reducers/notes/notesConstants":430,"../../reducers/notes/notesSelectors":432,"../../stores/store":456,"../avatars/Avatars":17,"../notes/NotesUtils":49,"../themes/Themes":95}],51:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../../utils"),l=e("react"),u=n(l),c=e("react-dom"),d=n(c),f=e("../../react_components/emptyState"),p=window,m=p.Signals,h=window,v=h.IstTooltip,y=window,g=y.ForcedScroll,b=window,w=b.Indicator,E=window,k=E.TooptipWin,S=window,j=S.GB_hide,T=window,O=T.DoistFormat,I=window,P=I.format,C=window,D=(C.$static_path,C.DateUtils),M=e("../avatars/Avatars"),x=e("../notes/Notes.js"),R=e("../projects_list/ProjectListUtils"),N=e("../../containers/KarmaPromotion"),L=e("../themes/Themes"),U=e("../Constants.js"),V=e("../../models/NotificationsModel"),F=e("../../models/Collaborators"),B=e("../../models/ProjectsModel"),H=e("../formatter/Formatter.js"),G=function(){function e(t){var r=this;o(this,e),this._ns=function(e,t,n){var o=1===r.allUsers().length?e:t;return(0,s.format)(o,n)},this.showIndicator=this.showIndicator.bind(this),this.hideIndicator=this.hideIndicator.bind(this),this.createCollapseTaskItem=this.createCollapseTaskItem.bind(this),this.createCollapseNoteItem=this.createCollapseNoteItem.bind(this),this.onlyText=this.onlyText.bind(this),this.markBoxRead=this.markBoxRead.bind(this),this.markItemRead=this.markItemRead.bind(this),this.markBoxUnread=this.markBoxUnread.bind(this),this.isBoxUnread=this.isBoxUnread.bind(this),this.render=this.render.bind(this),this.notification_type=t.notification_type,this.notifications=[t]}return i(e,[{key:"push",value:function(e){if(e.notification_type!==this.notification_type)throw new Error("Programming error: Cannot push notification of different type");return this.notifications.push(e),this.notifications.sort(function(e,t){return t.id-e.id})}},{key:"sortKey",value:function(){return this.notifications[0].id}},{key:"isAggregated",value:function(){return this.notifications.length>1}},{key:"count",value:function(){return this.notifications.length}},{key:"timeString",value:function(){return D.prettyDate(this.notifications[0].created)}},{key:"allUsers",value:function(){var e=[],t=[],r=!0,n=!1,o=void 0;try{for(var a,i=this.notifications[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value,l=F.getUserById(s.from_uid);l||(l=s.from_user),l&&!t.includes(l.id)&&(e.push(l),t.push(l.id))}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}return e}},{key:"hasMultipleUsers",value:function(){return this.allUsers().length>1}},{key:"subject",value:function(){var e=this.allUsers();return 1===e.length?"<b>"+$xssStrip(e[0].full_name)+"</b>":2===e.length?P(_("<b>%s</b> and <b>%s</b>"),$xssStrip(e[0].full_name),$xssStrip(e[1].full_name)):3===e.length?P(_("<b>%s</b>, <b>%s</b> and <b>%d</b> other"),$xssStrip(e[0].full_name),$xssStrip(e[1].full_name),e.length-2):e.length>=4?P(_("<b>%s</b>, <b>%s</b> and <b>%d</b> others"),$xssStrip(e[0].full_name),$xssStrip(e[1].full_name),e.length-2):"X"}},{key:"genericAccept",value:function(e,t,r,n,o){var a=this,i=void 0,s=void 0,l=void 0,u=void 0,c=$setHTML(SPAN(),t),d=DIV({c:"actions"},i=A({href:"#",c:"accept"},_("Accept")),u=A({href:"#",c:"reject"},svgs.get("sm1/close_tiny.svg")));return $AEV(i,"click",function(){return a.showIndicator(d),s=function(){return o()},l=function(e){return alert(e),a.hideIndicator(d)},r(e,s,l),!1}),$AEV(u,"click",function(){return v.hide(),a.showIndicator(d),s=function(){return $remove($parent(d,"li"))},l=function(e){return alert(e),a.hideIndicator(d)},n(e,s,l),!1}),v.showSimpleText(u,_("Reject"),null,0,10),[c,d]}},{key:"showIndicator",value:function(e){return $hide($all("a",null,e)),w.addToElm(e)}},{key:"hideIndicator",value:function(e){return w.removeFromElm(e),$show($all("a",null,e))}},{key:"createCollapseTaskItem",value:function(e){var t=this,r=DIV({c:"collapsed_list_item"},this.onlyText(e.item_content));return e.is_unread&&$addClass(r,"unread"),$AEV(r,"click",function(n){return t.markItemRead(e,r),x.showItemNotes(e.item_id),n.stopPropagation(),!1}),r}},{key:"createCollapseNoteItem",value:function(e){var t=this,r=void 0,n=F.getUserById(e.from_uid),o=H.format(e.note_content);if(o=o.replace(/^\*\s+/g,""),this.hasMultipleUsers()&&n&&n.full_name){var a=$strip(n.full_name).split(" ");r=$setHTML(DIV({c:"collapsed_list_item"}),"<b>"+a[0]+":</b> "+this.onlyText(o))}else r=$setHTML(DIV({c:"collapsed_list_item"}),""+this.onlyText(o));e.is_unread&&$addClass(r,"unread");var i=null===e.item_id;return $AEV(r,"click",function(r){return t.markBoxRead(),i?x.showProjectNotes(e.project_id,e.note_id):x.showItemNotes(e.item_id,e.note_id),r.stopPropagation(),!1}),r}},{key:"onlyText",value:function(e){return O.formatSimple(e,{only_text:!0,as_html:!1,cache_prefix:"noti:"})}},{key:"markBoxRead",value:function(){var e=this.notifications.map(function(e){return e.id}),t=!0,r=!1,n=void 0;try{for(var o,a=this.notifications[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){o.value.is_unread=0}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}var i=$("noti_"+this.notifications[0].notification_key);return i&&($removeClass(i,"unread"),$removeClass($$(".collapsed_list_item",i),"unread"),$replace($$(".unread_icon_wrap",i)[0],svgs.get("sm1/notification_read.svg"))),V.markRead(e)}},{key:"markItemRead",value:function(e,t){e.is_unread=0,$removeClass(t,"unread");var r=!0,n=!0,o=!1,a=void 0;try{for(var i,s=this.notifications[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){if(1===i.value.is_unread){r=!1;break}}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}if(r){var l=$("noti_"+this.notifications[0].notification_key);l&&($removeClass(l,"unread"),$replace($$(".unread_icon_wrap",l)[0],svgs.get("sm1/notification_read.svg")))}return V.markRead([e.id])}},{key:"markBoxUnread",value:function(){var e=this.notifications.map(function(e){return e.id}),t=!0,r=!1,n=void 0;try{for(var o,a=this.notifications[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){o.value.is_unread=1}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}var i=$("noti_"+this.notifications[0].notification_key);return i&&($hasClass(i,"unread")||($addClass(i,"unread"),$addClass($$(".collapsed_list_item",i),"unread")),$replace($$(".unread_icon_wrap",i)[0],svgs.get("sm1/notification_unread.svg"))),V.markUnread(e)}},{key:"isBoxUnread",value:function(){var e=void 0;return e=1,this.notifications.map(function(e){return e.is_unread}).includes(e)}},{key:"render",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=void 0,n=void 0,o=void 0,i=void 0,l=void 0,u=void 0,c=void 0,d=void 0,f=void 0,p=this.notifications[0],m=F.getUserById(p.from_uid),h=p.notification_type;if(m||(m=p.from_user),!m)if(-1!==h.indexOf("biz_"))m={};else{if(-1===h.indexOf("karma_"))return;m={}}r=m.full_name?M.renderAvatar(m,"medium",L.theme):null;var y=null,g=null,b=null,w=null,E=!1,k=!1,S=!1,T=!1;!1===t&&(l=LI(),l.id="noti_"+p.notification_key,this.isAggregated()&&$addClass(l,"collapsible_box"));var O=p.project_name,I=m.full_name;I="<b>"+$xssStrip(I)+"</b>",O="<b>"+$xssStrip(O)+"</b>";var C=null,D="",A=null,$=null;if("note_added"===h){if($=svgs.get("sm1/notification_commented.svg"),p.item_id)C=this._ns(_n("{user} added a comment to {task}","{user} added {n} comments to {task}",this.count()),_n("{multiple} added a comment to {task}","{multiple} added {n} comments to {task}",this.count()),{user:this.subject(),multiple:this.subject(),n:this.count(),
task:"<b>"+this.onlyText(p.item_content)+"</b>"});else{var U=B.get(p.project_id);C=this._ns(_n("{user} added a project comment to {project}","{user} added {n} project comments to {project}",this.count()),_n("{multiple} added a project comment to {project}","{multiple} added {n} project comments to {project}",this.count()),{user:this.subject(),multiple:this.subject(),n:this.count(),project:U?"<b>"+this.onlyText(U.name)+"</b>":_("a shared project")})}if(p.note_content&&(A=this.onlyText(p.note_content)),null!==this.notifications[0].item_id?b=!0:w=!0,!1===t)if(this.isAggregated()){T=!0,D=$setHTML(DIV(),C),n=DIV({c:"collapsed_list"});var H=!0,G=!1,z=void 0;try{for(var W,Y=this.notifications[Symbol.iterator]();!(H=(W=Y.next()).done);H=!0)c=W.value,u=this.createCollapseNoteItem(c),$add(n,u)}catch(e){G=!0,z=e}finally{try{!H&&Y.return&&Y.return()}finally{if(G)throw z}}$add(D,n)}else D=$setHTML(SPAN(),C+"<br>"),p.note_content&&$add(D,DIV({c:"desc"},"\u201c"+this.onlyText(p.note_content)+"\u201d"))}else if(-1!==h.indexOf("item_")){var K=null,J=B.get(p.project_id);if("item_assigned"===h?($=svgs.get("sm1/notification_assigned.svg"),C=this._ns(_n("{user} assigned a task in {project}","{user} assigned {n} tasks in {project}",this.count()),_n("{multiple} assigned a task in {project}","{multiple} assigned {n} tasks in {project}",this.count()),{user:this.subject(),multiple:this.subject(),n:this.count(),project:J?"<b>"+this.onlyText(J.name)+"</b>":_("a shared project")}),this.isAggregated()?g=p.project_id:b=!0):"item_completed"===h?($=svgs.get("sm1/notification_completed.svg"),C=this._ns(_n("{user} completed a task in {project}","{user} completed {n} tasks in {project}",this.count()),_n("{multiple} completed a task in {project}","{multiple} completed {n} tasks in {project}",this.count()),{user:this.subject(),multiple:this.subject(),n:this.count(),project:J?"<b>"+this.onlyText(J.name)+"</b>":_("a shared project")}),this.isAggregated()?g=p.project_id:b=!0,K="completed"):"item_uncompleted"===h&&($=svgs.get("sm1/notification_uncompleted.svg"),C=this._ns(_n("{user} uncompleted a task in {project}","{user} uncompleted {n} tasks in {project}",this.count()),_n("{multiple} uncompleted a task in {project}","{multiple} uncompleted {n} tasks in {project}",this.count()),{user:this.subject(),multiple:this.subject(),n:this.count(),project:J?"<b>"+this.onlyText(J.name)+"</b>":_("a shared project")}),this.isAggregated()?g=p.project_id:b=!0),p.item_content&&(A=this.onlyText(p.item_content)),!1===t)if(this.isAggregated()){T=!0,D=$setHTML(DIV(),C),n=DIV({c:"collapsed_list"});var Q=!0,X=!1,Z=void 0;try{for(var ee,te=this.notifications[Symbol.iterator]();!(Q=(ee=te.next()).done);Q=!0)c=ee.value,u=this.createCollapseTaskItem(c),K&&$addClass(u,K),$add(n,u)}catch(e){X=!0,Z=e}finally{try{!Q&&te.return&&te.return()}finally{if(X)throw Z}}$add(D,n)}else if(D=$setHTML(SPAN(),C),p.item_content){var re=void 0;$add(D,BR(),re=DIV({c:"desc"},this.onlyText(p.item_content))),K&&$addClass(re,K)}}else if("share_invitation_sent"===h){if("accepted"===p.state)r=M.renderAvatar(window.User,"medium",L.theme),C=(0,s.format)(_("You joined {project}"),{project:O}),g=p.project_id,!1===t&&(D=$setHTML(SPAN(),C));else if("rejected"===p.state)r=M.renderAvatar(window.User,"medium",L.theme),C=(0,s.format)(_("You declined invitation from {user} to {project}"),{user:m,project:O}),g=null,!1===t&&(D=$setHTML(SPAN(),C));else if(C=(0,s.format)(_("{user} invited you to {project}"),{user:I,project:O}),!1===t){d=function(){var e=(0,s.format)(_("Start collaborating on {project}"),{project:O}),t=$$(".text_holder",l)[0];return $replace(t,DIV({c:"accepted"},_("Invitation accepted!"),BR(),$setHTML(SPAN(),e),f)),$AEV(l,"click",function(){j();var e=null,t=!0,r=!1,n=void 0;try{for(var o,a=B.getAll()[Symbol.iterator]();!(t=(o=a.next()).done);t=!0)if(O=o.value,O.name===p.name){e=O.id;break}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return e&&R.setCurrentById(e),!1})};var ne=Array.from(this.genericAccept(p,C,V.acceptInvitation,V.rejectInvitation,d)),oe=a(ne,2);D=oe[0],y=oe[1]}}else if("share_invitation_accepted"===h)C=this._ns(_("{user} joined {project}"),_("{multiple} joined {project}"),{user:this.subject(),multiple:this.subject(),project:O}),$=svgs.get("sm1/notification_user_added.svg"),g=p.project_id,!1===t&&(D=$setHTML(SPAN(),C));else if("share_invitation_rejected"===h)C=(0,s.format)(_("{user} rejected your invitation to {project}"),{user:I,project:O}),$=svgs.get("sm1/notification_user_removed.svg"),g=p.project_id,!1===t&&(D=$setHTML(SPAN(),C));else if("user_left_project"===h)C=this._ns(_("{user} left {project}"),_("{multiple} left {project}"),{user:this.subject(),multiple:this.subject(),project:O}),$=svgs.get("sm1/notification_user_removed.svg"),g=p.project_id,!1===t&&(D=$setHTML(SPAN(),C));else if("user_removed_from_project"===h){if($=svgs.get("sm1/notification_user_removed.svg"),p.removed_uid===window.User.id)C=(0,s.format)(_("{user} removed you from {project}"),{user:I,project:O});else{var ae=F.getUserById(p.removed_uid)||{},ie=ae.full_name||"";ie=ie.split(" ")[0],C=(0,s.format)(_("{user} removed {user_2} from {project}"),{user:I,user_2:ie,project:O})}g=p.project_id,!1===t&&(D=$setHTML(SPAN(),C))}else if("owner_left_project"===h)$=svgs.get("sm1/notification_user_removed.svg"),C=(0,s.format)(_("{user} (owner) left {project}"),{user:I,project:O}),g=p.project_id,!1===t&&(D=$setHTML(SPAN(),C));else if("karma_level"===h)i=p.karma_level,C=D=function(){switch(i){case 1:return _("Your journey towards higher productivity begins today! You're now a Todoist Karma Novice.");case 2:return _("Congrats! Reaching 2,500 points makes you a Todoist Karma Intermediate.");case 3:return _("You're a Pro! High five on reaching the Professional level of Todoist Karma!");case 4:return _("Pat yourself on the back\u2013 you're now an impressive Todoist Karma Expert!");case 5:return _("Outstanding work! Achieving 10,000 points makes you a Todoist Karma Master.");case 6:return _("One more level to go! You're now a revered Todoist Karma Grand Master!");case 7:return _("You did it! With over 50,000 points you've reached the top\u2013 Todoist Karma Enlightenment!")}}(),S=!0,!1===t&&(o=q(i),r=SPAN({c:"karma-icon"},o));else if("biz_invitation_created"===h)if("invited"===p.state){if(d=function(){return $swap(l,l=LI({c:"accepted"},_("Invitation accepted!")))},C=(0,s.format)(_("{user} invited you to the {team_name} account"),{user:I,team_name:p.account_name}),C=_("Todoist Business")+": "+C,!1===t){var se=Array.from(this.genericAccept(p,C,V.acceptInvitationBiz,V.rejectInvitationBiz,d)),le=a(se,2);D=le[0],y=le[1]}}else"accepted"===p.state?(r=null,C=(0,s.format)(_("You joined the {team_name} account"),{team_name:p.account_name}),C=_("Todoist Business")+": "+C,!1===t&&(D=$setHTML(SPAN(),C))):(r=null,C=(0,s.format)(_("You rejected invitation from {user} to the {team_name} account"),{user:I,team_name:p.account_name}),C=_("Todoist Business")+": "+C,!1===t&&(D=$setHTML(SPAN(),C)));else"biz_invitation_accepted"===h?($=svgs.get("sm1/notification_user_added.svg"),C=(0,s.format)(_("{user} joined the {team_name} account"),{user:I,team_name:p.account_name}),C=_("Todoist Business")+": "+C,E=!0,!1===t&&(D=$setHTML(SPAN(),C))):"biz_invitation_rejected"===h?($=svgs.get("sm1/notification_user_removed.svg"),C=(0,s.format)(_("{user} rejected your invitation to the {team_name} account"),{user:I,team_name:p.account_name}),C=_("Todoist Business")+": "+C,E=!0,!1===t&&(D=$setHTML(SPAN(),C))):"biz_policy_disallowed_invitation"===h?(C=P(_("Team's permission settings don't allow you to share projects outside of your team. Add %s to your team or change the permission settings"),I),C=_("Todoist Business")+": "+C,g=p.project_id,!1===t&&(D=$setHTML(SPAN(),C))):"biz_policy_rejected_invitation"===h?(C=P(_("Team's permission don't allow user to join projects outside of their team. Ask %s to add yourself to their team or to change the permission settings"),I),C=_("Todoist Business")+": "+C,g=p.project_id,!1===t&&(D=$setHTML(SPAN(),C))):"biz_trial_will_end"===h?(C=_("This is a reminder that your trial will end in a few days. At that time, we will process your first payment to ensure uninterrupted service."),C=_("Todoist Business")+": "+C,k=!0,!1===t&&(D=$setHTML(SPAN(),C))):"biz_trial_enter_cc"===h?($=svgs.get("sm1/notification_payment.svg"),C=_("This is a reminder that your trial will end in a few days. Update your credit card information to keep using our service."),C=_("Todoist Business")+": "+C,k=!0,!1===t&&(D=$setHTML(SPAN(),C))):"biz_payment_failed"===h?($=svgs.get("sm1/notification_payment.svg"),C=_("We failed to charge you. Please review and update your credit card information to avoid any disruption in service."),C=_("Todoist Business")+": "+C,k=!0,!1===t&&(D=$setHTML(SPAN(),C))):"biz_account_disabled"===h&&(C=_("Your business account was disabled. Upgrade now to continue using account."),C=_("Todoist Business")+": "+C,k=!0,!1===t&&(D=$setHTML(SPAN(),C)));var ue=null,ce=null;if(g)ue=function(){return j(),T?e.markBoxRead():e.markItemRead(p,u),R.setCurrentById(g),!1},ce={text:_("View"),action:"view_project",project_id:g,put_in_focus:!0};else if(w){var de=this.notifications[0].note_id;ue=function(){return T?e.markBoxRead():e.markItemRead(p,u),x.showProjectNotes(p.project_id,de),!1},ce={text:_("View"),action:"view_project_note",project_id:p.project_id,note_id:de,put_in_focus:!0}}else b?(ue=function(){return T?e.markBoxRead():e.markItemRead(p,u),x.showItemNotes(p.item_id,p.note_id),!1},ce={text:_("View"),action:"view_task",item_id:p.item_id,note_id:p.note_id,put_in_focus:!0}):E?(ue=function(){return window.open("/business/users"),!1},ce={text:_("View"),action:"view_business_users"}):k?(ue=function(){return window.open("/business/accountAndBilling"),!1},ce={text:_("View"),action:"view_business_billing"}):S&&(ue=function(){return N.show(i,p),!1},ce={text:_("View"),action:"view_karma"});if(t)return[m,C,A,ue,ce];$addClass($,"type_icon"),$add(l,DIV({c:"left_container","data-track":"navigation|nofications_single_notification"},DIV({c:"avatar_holder"},r,$),DIV({c:"text_holder"},D,y,f=DIV({c:"time_holder"},this.timeString()))));var fe=DIV({c:"right_container"});if(T){var pe=DIV({c:"collapse_icon_wrap"},svgs.get("sm1/caret.svg"));$AEV(pe,"click",function(e){return $hasClass(l,"is_uncollapsed")?(track("navigation","click","notifications_expand_collapsed"),$removeClass(l,"is_uncollapsed")):$addClass(l,"is_uncollapsed"),e.stopPropagation(),!1}),$add(fe,pe)}o=this.isBoxUnread()?svgs.get("sm1/notification_unread.svg"):svgs.get("sm1/notification_read.svg");var me=DIV({c:"unread_icon_wrap fixed_pos"},o);return v.showTooltip(me,function(){return e.isBoxUnread()?_("Mark as Read"):_("Mark as Unread")},function(){return-($gp(me,"div","GB_iframe_html").scrollTop-50)},5,null,!0),$AEV(me,"click",function(t){return v.hide(),e.isBoxUnread()?(track("navigation","click","notifications_mark_as_read"),e.markBoxRead()):(track("navigation","click","notifications_mark_as_unread"),e.markBoxUnread()),t.stopPropagation(),!1}),$add(fe,me),$add(l,fe),ue&&$AEV(l,"click",ue),y&&$addClass(l,"has_actions"),this.isBoxUnread()&&$addClass(l,"unread"),l}},{key:"isMultiUser",get:function(){return this.allUsers().legnth>1}}]),e}(),z=function(){function e(){var t=this;o(this,e),this._renderImageCount=this._renderImageCount.bind(this),this.updateIcon=this.updateIcon.bind(this),this.showDropdown=this.showDropdown.bind(this),this.markRead=this.markRead.bind(this),this.markUnread=this.markUnread.bind(this),this.markReadAll=this.markReadAll.bind(this),this.fetchData=this.fetchData.bind(this),this.aggregated=this.aggregated.bind(this),this.renderNotifications=this.renderNotifications.bind(this),this.renderNotification=this.renderNotification.bind(this),m.connect("notifications_updated",function(){return t.updateIcon(V.getUnreadCount())}),m.connect("theme_changed",function(){return t.updateIcon(V.getUnreadCount())}),m.connect("noti_updated",function(e){if(0===e.is_unread){var t=$("noti_"+e.notification_key);if(t&&$hasClass(t,"unread"))return $removeClass(t,"unread")}})}return i(e,[{key:"renderIcon",value:function(){var e=this,t=this._renderImageCount(null),r=SPAN({id:"notifications_counter"},t);return $AEV(r,"click",function(){return track("navigation","click","notifications"),e.updateIcon(0),e.showDropdown(r)}),r}},{key:"_renderImageCount",value:function(e){return e>0?svgs.get("sm1/notifications_unread.svg"):svgs.get("sm1/notifications.svg")}},{key:"updateIcon",value:function(e){var t=this,r=$("notifications_counter");return!r||this.cur_window?this.timeout=setTimeout(function(){return t.timeout=null,t.updateIcon(e)},500):$replace(r,this._renderImageCount(e))}},{key:"showDropdown",value:function(e){var t=this,r=V.getNotifications(),n={no_side_padding:!0,fn_left_offset:function(){var t=$position(e),r=t.x;return window.MINI_VERSION?r-300:r-340},fn_top_offset:function(){return window.MINI_VERSION?U.top_bar.top_offset_mini:U.top_bar.top_offset_full},fn_arrow_left:function(){return $position(e).x+9},fn_on_hide:function(){return t.empty_state_holder&&(d.default.unmountComponentAtNode(t.empty_state_holder),t.empty_state_holder=null),t.cur_window=null,g.removeListener()},fixed_pos:!0,show_close_img:!1,show_custom_text:r.length>0?A({c:"mark_all_as_read","data-track":"navigation|notifications_mark_all_as_read"},_("Mark all as Read")):"",show_custom_fn:$p(this.markReadAll)},o=DIV({id:"notifications_holder"},DIV({c:"indicator"},w.cssSpinner()));return $AEV(o,"scroll",function(){return v.hide()}),g.attachListener(o,"notifications"),window.MINI_VERSION?this.cur_window=k.show(_("Notifications"),o,200,350,n):this.cur_window=k.show(_("Notifications"),o,200,390,n),$addClass(this.cur_window.g_window,"notifications"),this.fetchData(o,r)}},{key:"markRead",value:function(e){var t=$("noti_"+e.notification_key);if(t&&$hasClass(t,"unread"))return $removeClass(t,"unread")}},{key:"markUnread",value:function(e){var t=$("noti_"+e.notification_key);if(t&&!$hasClass(t,"unread"))return $addClass(t,"unread")}},{key:"markReadAll",value:function(){$removeClass($$(".collapsed_list_item"),"unread");var e=!0,t=!1,r=void 0;try{for(var n,o=$$(".unread_icon_wrap")[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var a=n.value;$replace(a,svgs.get("sm1/notification_read.svg"))}}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}return $removeClass($$("li"),"unread"),V.markReadAll()}},{key:"fetchData",value:function(e,t){var r=$first(t);r&&V.markAsRead(r);var n=!1,o=!0,a=!1,i=void 0;try{for(var s,l=t[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value;if(Date.now()/1e3-c.created<=7776e3){n=!0;break}}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}if(0!==t.length&&n)this.renderNotifications(e,t);else{var p=void 0;p="https://d3ptyyxy2at9ui.cloudfront.net/no_notifications-410ecd.png";var m=IMG({src:p,width:150,height:250,c:"illustration"});if(0!==F.getCount())return $removeClass(e,"no_scrollbar"),$replace(e,CENTER(DIV({c:"empty"},m,H3(_("No recent notifications")),DIV({c:"final"},_("There hasn\u2019t been any activity in your shared projects recently.")))));$addClass(e,"no_scrollbar"),d.default.render(u.default.createElement(f.EmptyStateNotifications,null),e),this.empty_state_holder=e}}},{key:"aggregated",value:function(e){var t={},r=!0,n=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s,l=a.value,u=Math.floor(l.created/14400);if(["item_completed","item_uncompleted","item_assigned"].includes(l.notification_type))s=l.notification_type+":"+l.project_id+":"+l.from_uid+":"+u;else if(["share_invitation_accepted","user_left_project"].includes(l.notification_type))s=l.notification_type+":"+l.project_id+":"+u;else if("note_added"===l.notification_type){var c=null===l.item_id;s=c?"project_note_added:"+l.project_id+":"+u:"item_note_added:"+l.item_id+":"+u}else s=l.id;void 0===t[s]?t[s]=new G(l):t[s].push(l)}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}var d=[];for(var f in t){var p=t[f];d.push(p)}return d.sort(function(e,t){return t.sortKey()-e.sortKey()}),d}},{key:"renderNotifications",value:function(e,t){$remove($all("div","indicator",e)),$("more_button_noti")&&$remove($("more_button_noti"));var r=this.aggregated(t),n=UL(),o=!0,a=!1,i=void 0;try{for(var s,l=r[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value;$add(n,u.render(!1))}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}return $add(e,n)}},{key:"renderNotification",value:function(e){return new G(e).render(!0)}}]),e}(),q=function(e){switch(e){case 1:return svgs.get("sm1/karma_1.svg");case 2:return svgs.get("sm1/karma_2.svg");case 3:return svgs.get("sm1/karma_3.svg");case 4:return svgs.get("sm1/karma_4.svg");case 5:return svgs.get("sm1/karma_5.svg");case 6:return svgs.get("sm1/karma_6.svg");case 7:return svgs.get("sm1/karma_7.svg")}};t.exports=new z},{"../../containers/KarmaPromotion":106,"../../models/Collaborators":160,"../../models/NotificationsModel":170,"../../models/ProjectsModel":171,"../../react_components/emptyState":241,"../../utils":484,"../Constants.js":1,"../avatars/Avatars":17,"../formatter/Formatter.js":22,"../notes/Notes.js":46,"../projects_list/ProjectListUtils":71,"../themes/Themes":95,react:"react","react-dom":"react-dom"}],52:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.enableCompleteAnimation=r.isCompleteAnimationInProgress=r.showFirstCompleteAnimation=r.isFirstCompleteAction=r.showCompleteTaskTooltipIfNeeded=void 0;var o=e("../../stores/store"),a=n(o),i=e("../../reducers/tooltip"),s=e("../../utils/format"),l=n(s),u=e("../../logger/Logger"),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(u),d=e("../opener/WindowOpener.js"),f=n(d),p=e("../../reducers/user"),m=e("../../models/ItemsModel"),h=n(m),v=void 0,y=function(e){var t=(_("Mark tasks complete every day to reach Todoist Zero and boost your {link_tag_start}Karma{link_tag_end} points."),(0,l.default)(_("Mark tasks completed every day to reach Todoist Zero and boost your {link_tag_start}Karma{link_tag_end} points."),{link_tag_start:'<a id="karma_info_link">',link_tag_end:"</a>"})),r=DIV({c:"onboarding_tooltip"});$setHTML(r,t);var n=TooptipWin.show(_("Is this done?"),r,300,350,{fn_left_offset:function(){return $position(e).x-40},fn_arrow_left:function(){return $position(e).x+2},fn_top_offset:function(){return $position(e).y+50},close_validator_fn:function(){return!0},fixed_pos:!0});$AEV($$("#karma_info_link",r),"click",function(){f.default.showKarmaInfo(),n.hide()}),$fx.fadeIn(r)},g=(r.showCompleteTaskTooltipIfNeeded=function e(){try{var t=(0,p.daysSinceJoin)(a.default.getState());if(t<1||t>7||(0,i.hasSeen)(i.TOOLTIP_COMPLETE_FIRST_TASK,a.default.getState())||h.default.getTotalCompletedCount()>0)return;if(!$isShown($("app_holder"))&&!v)return void(v=setTimeout(e,1e3));if(!$isShown($("app_holder"))||$$("#GB_window .timezone_alert").length>0)return v&&clearTimeout(v),void(v=setTimeout(e,1e3));if($$(".onboarding_tooltip").length>0)return;var r=$$("#editor ul.items li.task_item:not(.reorder_item)");if(0==r.length)return;y(r[0]),a.default.dispatch((0,i.markSeen)(i.TOOLTIP_COMPLETE_FIRST_TASK))}catch(e){c.captureError(e)}},!1),b=!1,w=(r.isFirstCompleteAction=function(){return!(g||(0,i.hasSeen)(i.TOOLTIP_FIRST_TASK_COMPLETED,a.default.getState())||h.default.getTotalCompletedCount()>0)&&(a.default.dispatch((0,i.markSeen)(i.TOOLTIP_FIRST_TASK_COMPLETED)),g=!0,!0)},r.showFirstCompleteAnimation=function(e,t){try{var r=document.createElement("div");r.innerHTML=w;var n=DIV({c:"onboarding_complete_overlay"},DIV({c:"grey_background"}),DIV({c:"maincontent"},r,P(_("You completed your first task. Nice work! \ud83d\ude4c"))),DIV({c:"white_block"}));$setStyle(e,{position:"relative"}),$add(e,n),b=!0,setTimeout(function(){b=!1,t&&t()},2e3)}catch(e){b=!1,t()}},r.isCompleteAnimationInProgress=function(){return b},r.enableCompleteAnimation=function(){g=!1},'<svg width="30px" height="30px" viewBox="0 0 30 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> \x3c!-- Generator: Sketch 46.2 (44496) - http://www.bohemiancoding.com/sketch --\x3e <title>ist_checkbox_on</title> <desc>Created with Sketch.</desc> <defs></defs> <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g id="ist_checkbox_on" fill-rule="nonzero" fill="#6B6B6B"> <g transform="translate(5.000000, 7.000000)" id="Shape"> <path d="M17.6416667,0.6 C18.4416667,1.325 19.2166667,2.06666667 20,2.80833333 C16.05,6.96666667 11.9416667,11.0166667 7.825,15.0166667 C5.51666667,12.65 3.16666667,10.3166667 0.816666667,7.99166667 C1.6,7.2 2.38333333,6.40833333 3.16666667,5.61666667 C4.71666667,7.15 6.275,8.675 7.775,10.2666667 C11.225,7.225 14.2916667,3.75 17.6416667,0.6 Z"></path> </g> </g> </g> </svg>')},{"../../logger/Logger":141,"../../models/ItemsModel":167,"../../reducers/tooltip":448,"../../reducers/user":451,"../../stores/store":456,"../../utils/format":474,"../opener/WindowOpener.js":53}],53:[function(e,t,r){"use strict";var n=window.GB_show,o={en:"https://get.todoist.help/hc/en-us/articles/205063212",de:"https://get.todoist.help/hc/de/articles/205063212",es:"https://get.todoist.help/hc/es/articles/205063212",fr:"https://get.todoist.help/hc/fr/articles/205063212",it:"https://get.todoist.help/hc/fr/articles/205063212",ja:"https://get.todoist.help/hc/ja/articles/205063212",ko:"https://get.todoist.help/hc/ko/articles/205063212",pl:"https://get.todoist.help/hc/pl/articles/205063212",pt_BR:"https://get.todoist.help/hc/pt-br/articles/205063212",pt_PT:"https://get.todoist.help/hc/pt-br/articles/205063212",ru:"https://get.todoist.help/hc/ru/articles/205063212",zh_TW:"https://get.todoist.help/hc/zh-tw/articles/205063212",zh_CN:"https://get.todoist.help/hc/zh-cn/articles/205063212"},a={showKeyboardShortcuts:function(){return window.open(o[window.LANG]||"/Help/KeyboardShortcuts"),!1},showPrefs:function(e){if(!navigator.onLine)return void alert(window.getOfflineMessage({status:-1}));var t="/prefs/";return t+=e||"account",window.location=t,!1},showKarmaInfo:function(){var e=500;return window.MINI_VERSION&&(e=390),n(_("More about Todoist Karma"),"/Karma/showInfo",550,e)}};t.exports=a},{}],54:[function(e,t,r){"use strict";function n(){var e=5-parseInt($queryArgument("priority")||4),t=$urldecode($queryArgument("content")||""),r={cancel:null,action:o,submit_val:_("Add Task"),name_val:t,indent_arrows:!1,with_esc_cancel:!1,priority:e,no_indent:!0,due_date_focus:function(){var e=function(){n.textarea&&n.textarea.proxyFocus(!0)},t=n.form.people_assigner;t&&t.isShown()?(t.opts.onExitFocus=function(){e()},t.showTooltip()):e()}},n=i.generateForm(r),a=$urldecode($queryArgument("date")||"");return a&&(n.duedate.value=a),n.form}function o(e){var t=i.parseFormData(e);if(!t||""==t.content)return $gc(e,null,"richtext_editor").proxyFocus(!0),!1;track("task_form","click","quick_task_add"),d.type&&(t.content=d.onContentSave(t.content)),t.item_order=parseInt((new Date).getTime()/1e3);var r=s.add(t);c.reminders.length>0&&c.commitBuffered(r);var n="https://todoist.com/app#project/"+r.project_id,o=u.get(r.project_id)||u.getInbox(),f=A({c:"action",href:n,target:"_blank"},o.name),p=_("Task successfully added to"),m=A({href:n,c:"ist_button ist_button_red"},_("Close"));$AEV(m,"click",function(){top.postMessage(JSON.stringify({type:"todoist_close_window"}),"*"),window.close()}),$replace($("editor"),DIV(CENTER(a.cssSpinner())));var h={onSuccess:function(){$queryArgument("no_chrome")?(top.postMessage(JSON.stringify({type:"todoist_close_window"}),"*"),$replace($("editor"),null)):$replace($("editor"),DIV(H2({c:"section_header"},_("Quick Add Task")),DIV({c:"confirm"},p," ",f,DIV(m))))}};return l.sync(h,!0),!1}var a=window.Indicator,i=e("../items_utils/ItemAddEditForm"),s=e("../../models/ItemsModel"),l=e("../../models/SyncEngine"),u=e("../../models/ProjectsModel"),c=e("../../models/Reminders").BufferedRemindersModel,d=e("../../plugin_version/ContentTransformers").ContentTransformers,f=!1;r.isShown=function(){return f},r.show=function(){f=!0,$remove($("loading"));var e=n();$replace($("editor"),DIV(H2({c:"section_header"},_("Quick Add Task")),e)),$$(".richtext_editor")[0].proxyFocus(!0)}},{"../../models/ItemsModel":167,"../../models/ProjectsModel":171,"../../models/Reminders":173,"../../models/SyncEngine":181,"../../plugin_version/ContentTransformers":190,"../items_utils/ItemAddEditForm":28}],55:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.IstTooltip,s=window,l=s.IstCompleteSelect,u=window,c=u.GB_hide,d=e("../../models/Collaborators"),f=e("../notes/NotesUtils"),p=e("../avatars/Avatars"),m=e("../richtext_editor/NatrualLanguageParsing"),h=e("../themes/Themes"),v=function(){function e(t){n(this,e),this.render=this.render.bind(this),this.isShown=this.isShown.bind(this),this.onProjectUpdated=this.onProjectUpdated.bind(this),this.showTooltip=this.showTooltip.bind(this),this.opts=t,t.responsible_uid&&(this.responsible_uid=t.responsible_uid),t.orginal_project_id||(t.orginal_project_id=t.project_id),t.left_offset||(t.left_offset=205)}return o(e,[{key:"render",value:function(){var e=this,t=void 0,r=void 0;this.opts.unassigned_icon_disable?this.avatar=null:this.avatar=SPAN({c:"form_action_icon menu_icon"},svgs.get("sm1/add_member_small.svg"));var n=DIV(B(_("Assign to someone")),BR(),_("Select by typing +")),o=this.opts.tooltip_txt?SPAN(this.opts.tooltip_txt):n;if(this.responsible_uid){var a=void 0;if(t=2,a=this.responsible_uid===window.User.id?window.User:d.getUserById(this.responsible_uid)){this.avatar=p.renderAvatar(a,"small",h.theme);var s=this.opts.tooltip_txt_selected||_("Assigned to");if(o=SPAN(s+" ",B(f.shortName(a))),a.id===window.User.id){r=(this.opts.me_str||_x("task_assignment","Me"))+" ("+a.full_name.split(" ")[0]+")"}else r=a.full_name}}else t=8,r=this.opts.unassigned_txt||_("Unassigned");if($addClass(this.avatar,"assign_icon"),null!=this.opts.show_name?(this.icon=SPAN({c:"svg_select_arrow"},svgs.get("sm1/caret.svg")),this.user_select=A({href:"#",c:"user_select_item"},this.icon,this.avatar,SPAN({c:"truncated u_name"},r))):(this.icon=this.avatar,this.user_select=this.avatar),i.showTooltip(this.user_select,o,4,t),!window.PRINT_MODE){var l=function(){return $addClass(e.user_select,"always_show"),e.showTooltip(),!1};$AEV(this.user_select,"click",l)}return this.opts.never_hide||d.isProjectShared(this.opts.project_id)||$hide(this.user_select),this.user_select}},{key:"isShown",value:function(){return $isShown(this.icon)}},{key:"onProjectUpdated",value:function(e){this.opts.project_id,this.responsible_uid=void 0,this.opts.project_id=e||this.opts.orginal_project_id,$swap(this.icon,this.render())}},{key:"showTooltip",value:function(){var e=this,t={collection:function(){var t=void 0,r=[];if(!1!==e.opts.support_unassigned){var n={name:e.opts.unassigned_txt||_("Unassigned"),id:null,email:""};n.full_name=n.name,r.push(n)}t=$isArray(e.opts.project_id)?e.opts.project_id:[e.opts.project_id];var o=!0,a=!1,i=void 0;try{for(var s,l=t[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value,c=!0,f=!1,p=void 0;try{for(var m,h=d.getAll(u)[Symbol.iterator]();!(c=(m=h.next()).done);c=!0){var v=m.value,y={};$update(y,v),-1===$index(v,r,function(e){return e.id===v.id})&&(y.id===window.User.id?y.name=_x("task_assignment","Me")+" ("+v.full_name.split(" ")[0]+")":y.name=v.full_name,r.push(y))}}catch(e){f=!0,p=e}finally{try{!c&&h.return&&h.return()}finally{if(f)throw p}}}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}return r},filterItem:function(t,r){var n=void 0;return null===(null!=t?t.id:void 0)?(e.opts.unassigned_icon_disable?e.avatar=null:e.avatar=svgs.get("sm1/add_member_small.svg"),n=SPAN({c:"name_email"},t.full_name)):(n=$setHTML(SPAN({c:"name_email truncated"}),r),e.avatar=p.renderAvatar(t,"small",h.theme)),DIV(DIV({c:"ist_complete_icon"},e.avatar),DIV({c:"ist_complete_content"},n))},onSelect:function(t){if(e.responsible_uid=t.id,e.responsible_uid=null!=t?t.id:void 0,$isFunction(e.opts.fn_on_select)&&e.opts.fn_on_select(t.id),$swap(e.user_select,e.render()),c(),e.opts.onExitFocus)e.opts.onExitFocus();else{var r=$parent(e.user_select,"form");if(r){m.setCurrentPerson(null);var n=$gc(r,null,"richtext_editor");n.onchanged(),n.proxyFocus(!0)}}},wildcard_match:!0,placeholder:this.opts.placeholder_txt||""},r=new l(t),n=r.showTooltip({title:this.opts.title_txt||_("Assign a person"),icon:this.icon,top_offset:27,left_offset:this.opts.left_offset,arrow_left_offset:this.opts.arrow_left_offset,fn_on_hide:function(){r=null}});$addClass(n.g_window,"person_selecter")}}]),e}();t.exports=v},{"../../models/Collaborators":160,"../avatars/Avatars":17,"../notes/NotesUtils":49,"../richtext_editor/NatrualLanguageParsing":85,"../themes/Themes":95}],56:[function(e,t,r){"use strict";var n=e("../richtext_editor/NatrualLanguageParsing"),o=e("../project_editor/ProjectEditorManager"),a=e("../notes/NotesUtils"),i=e("../avatars/Avatars"),s=e("../../models/ProjectsModel"),l=e("../agenda/Agenda"),u=e("../../models/Collaborators"),c=e("../themes/Themes"),d={annotateFormArea:function(e){IstComplete.attach(e,{trigger:"+",collection:function(){return d.getCompletionPeople()},filterItem:function(e){if(!e)return null;var t=i.renderAvatar(e,"medium",c.theme),r=SPAN({c:"collaborator_name"},e.name);return DIV(DIV({c:"ist_complete_icon"},t),DIV({c:"ist_complete_content"},r))},onNoMatches:function(){return IstComplete.hide(),!1},position_item:$parent(e,"td","text_box_holder"),extra_width:1,support_paste:!1,wildcard_match:!0,preOnSelect:function(e){var t=e.completion_item;n.setCurrentPerson(t.id,"+"+t.name)}}),$AEV(e,"keydown",function(e){if((13==e.keyAscii&&!e.shift||27==e.keyAscii)&&IstComplete.isShown())return!1})},getCompletionProjectId:function(){var e,t=n.highlight_project;if(t){var r=s.get(t[0]);r&&r.shared&&(e=r.id)}else{var a=o.getCurrentEditor();if(a)e=a.project_id;else{var i=l.get();if(i.current_form){e=i.current_form[1].people_assigner.opts.project_id}}var u=s.get(e);e=u&&u.shared?u.id:null}return e},getCompletionPeople:function(){var e=[],t=d.getCompletionProjectId();if(t){var r=u.getAll(t);$map(r,function(t){var r={};$update(r,t),r.name=a.shortName(r),r.name||(r.name=r.email),r.name=r.name.replace(/[_*!]+/g,""),e.push(r)})}return e}};t.exports=d},{"../../models/Collaborators":160,"../../models/ProjectsModel":171,"../agenda/Agenda":5,"../avatars/Avatars":17,"../notes/NotesUtils":49,"../project_editor/ProjectEditorManager":61,"../richtext_editor/NatrualLanguageParsing":85,"../themes/Themes":95}],57:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.IstCompleteSelect,s=window,l=s.GB_hide,u=e("../../models/Collaborators"),c=e("../avatars/Avatars"),d=e("../themes/Themes"),f=function(){function e(){n(this,e),this.showTooltip=this.showTooltip.bind(this)}return o(e,[{key:"showTooltip",value:function(e,t){var r=this;t.orginal_project_id=t.project_id;var n={collection:function(){var e=void 0,r=[];if(!1!==t.support_unassigned){var n={name:t.unassigned_txt||_("Unassigned"),id:null,email:""};n.full_name=n.name,r.push(n)}
e=$isArray(t.project_id)?t.project_id:[t.project_id];var o=!0,a=!1,i=void 0;try{for(var s,l=e[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value,d=!0,f=!1,p=void 0;try{for(var m,h=u.getAll(c)[Symbol.iterator]();!(d=(m=h.next()).done);d=!0){var v=m.value,y={};$update(y,v),-1===$index(v,r,function(e){return e.id===v.id})&&(y.id===window.User.id?y.name=_("Me")+" ("+v.full_name.split(" ")[0]+")":y.name=v.full_name,r.push(y))}}catch(e){f=!0,p=e}finally{try{!d&&h.return&&h.return()}finally{if(f)throw p}}}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}return r},filterItem:function(e,n){var o=void 0;return null===(null!=e?e.id:void 0)?(t.unassigned_icon_disable?r.avatar=null:r.avatar=svgs.get("sm1/add_member_small.svg"),o=SPAN({c:"name_email"},e.full_name)):(o=$setHTML(SPAN({c:"name_email truncated"}),n),r.avatar=c.renderAvatar(e,"small",d.theme)),DIV(DIV({c:"ist_complete_icon"},r.avatar),DIV({c:"ist_complete_content"},o))},onSelect:function(e){$isFunction(t.fn_on_select)&&t.fn_on_select(e.id),l()},wildcard_match:!0,placeholder:t.placeholder_txt||""},o=new i(n),a=o.showTooltip({title:t.title_txt||_("Assign a person"),icon:e,top_offset:t.top_offset,left_offset:t.left_offset,arrow_left_offset:t.arrow_left_offset,fn_on_hide:function(){o=null}});$addClass(a.g_window,"person_selecter")}}]),e}();t.exports=f},{"../../models/Collaborators":160,"../avatars/Avatars":17,"../themes/Themes":95}],58:[function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=window,s=i.Signals,l=window,u=l.IstTooltip,c=e("../../models/ItemsModel"),d=function(){function e(){o(this,e),this.postPoneUpdate=this.postPoneUpdate.bind(this)}return a(e,[{key:"postPoneUpdate",value:function(e){return this.postPoneModel(e),u.hide(),s.sendSignal("instant_refresh_interface"),!1}},{key:"getPostponeDate",value:function(e){var t=e.due;if(!t)throw"Cannot getPostponeDate() with item with no due date";var r=t.postpone();if("END_REACHED"===r)return{new_due:r,formated_due:""};var n=DateistDateHelpers.day_diff(new Date,r);return{new_due:r,formated_due:DateUtils.humanizeDayDiff(n,r)}}},{key:"postPoneModel",value:function(e){if(!e.due)throw"Cannot getPostponeDate() with item with no due date";try{var t=this.getPostponeDate(e),r=t.new_due;"END_REACHED"==r&&c.complete(e.id,!0),c.updateDue(n({},e.id,r))}catch(e){alert(""+e)}}}]),e}();t.exports=new d},{"../../models/ItemsModel":167}],59:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("./SectionList"),s=n(i),l=e("../../utils/fp"),u=e("react"),c=n(u),d=e("react-dom"),f=n(d),p=e("../../components/projects_list/ProjectArchive"),m=n(p),h=e("../../reducers/mainView"),v=e("../../react_components/emptyState"),y=e("../../reducers/tooltip"),g=e("../../reducers/stats"),b=e("../../stores/store"),w=n(b),E=e("../../reducers/notes/notesConstants"),k=window.ElementStore,S=window.Indicator,j=window.IstTooltip,T=window.IstCheckbox,O=e("../projects_list/ProjectListUtils"),I=e("../notes/Notes.js"),P=e("../notes/NotesUtils"),C=e("../labels/Labels.js"),D=e("../project_editor/ProjectEditorManager"),M=e("../project_editor/ProjectEditorDragAndDropFiles"),x=e("../agenda/AgendaUtils"),R=e("../left_menu/LeftMenu"),N=e("../sharing/SharingManager"),L=e("../action_perfomed/ActionPerformed"),U=e("../items_utils/ItemCheckbox"),V=e("../generic_manager/GenericManager.js"),F=e("../generic_manager/GenericManagerUtils.js"),B=e("../generic_manager/GenericArrows.js"),H=e("../formatter/Formatter.js"),G=e("../../models/TemporaryIds"),z=e("../../models/ProjectsModel"),q=e("../../models/SectionsModel").default,W=e("../../models/ItemsModel"),Y=e("../../models/Collaborators"),K=e("../../models/SyncEngine"),J=e("../../menus/MenuProjectGear.js"),Q=e("../../menus/MenuProjectEditor.js"),X=e("../../menus/MenuPriorities"),Z=e("../../menus/MenuReactions"),ee=e("./ProjectEditorUtils"),te={init:function(){J.init(D),Q.init(D),X.init(D),Z.init(D),G.listenAll(function(e,t){var r="item_"+t,n="item_"+e,o=$(n);o&&(o.id=r,$removeClass(o,n),$addClass(o,r));var a=D.getEditorById(e);a&&(a.project_id=t,$values(a.section_list_by_sid).forEach(function(e){e.project_id=t})),D.current_project_id==e&&(D.current_project_id=t)})}},re=V.extend({initWithData:function(e){var t={list_class:"ProjectEditor",data_model:W,max_indent:5,arrows:new B({data_model:W}),state_manager:D,empty_text:_("This project has no tasks. Add some now!")};t.arrows.setList(this),this.parent(t),this.project_id=e,this.current_limit=0,this.history_fetch_count=0,this.menu=Q.get(),this.current_add_section_li=null,this.section_list_by_sid={},this.editor_instance_div=null,this.list_editor=null,$bindMethods(this)},remove:function(){this.editor_instance_div&&(this.removeEditorContent(),$remove(this.editor_instance_div),k.remove(this.editor_instance_div))},removeEditorContent:function(){$replace(this.list_editor,null),this.current_list=null},isArchived:function(){var e=z.get(this.project_id);return!e||e.is_archived},showProject:function(){x.reset();var e=$("editor");this.list_editor=DIV({c:"list_editor"}),$add(e,this.editor_instance_div=DIV({c:"project_editor_instance","data-project-id":this.project_id},this.list_editor)),k.set(this.editor_instance_div,"editor",this),D.current_project_id==this.project_id&&$addClass(this.editor_instance_div,"current_editor"),D.attachMouseMove(this),M.attach(this),this.renderEditorContent(),O.flashItemIfNeeded(),R.hide();var t=z.get(this.project_id);window.User.karma>=100&&t&&!t.inbox_project&&N.promoCheck()},setTopSectionAsCurrent:function(){var e=this.section_list_by_sid[null];D.setCurrentSectionList(e)},renderEditorContent:function(){var e=this;if(this.current_list=UL({c:"section_list"}),this.isArchived()){var t=S.ringSpinner();return $add(this.list_editor,t),void z.fetchArchivedProject(this.project_id).then(function(r){var n=z.get(e.project_id);$add(e.list_editor,e.renderProjectHeader(n),e.current_list),$remove(t),r.project.has_more_notes=!0,z.archivedFeteched(r.project);var o=e.renderSectionItem(null,r.items);$add(e.current_list,o)}).catch(function(e){e instanceof Response?404==e.status?alert(_("Project not found")):e.json().then(function(e){return alert(e.error)}):alert(e.message)})}var r=z.get(this.project_id);$add(this.list_editor,this.renderProjectHeader(r),this.current_list);var n=W.itemGetSectionGroups(this.project_id);[null].concat(o(q.getByPID(this.project_id).map(function(e){return e.id}))).forEach(function(t){var r=n[t],o=e.renderSectionItem(t,r);$add(e.current_list,o)}),this.history_editor||this.renderHistoryEditor(),this.checkEmpty()},renderSectionItem:function(e,t){var r=this,n=new s.default;return n.initWithData({section_id:e,project_id:this.project_id,items:t,on_show_add_item:function(){r.clearEmptyStateIfNeeded()},on_add_form_cancel:function(){r.checkEmpty()}}),this.section_list_by_sid[e]=n,n.render()},renderProjectHeader:function(e){var t=ee.generateLink(e);this.project_header_link=t;var r=H2({c:"project_header section_header"},t,this.renderHeaderActions(e));return this.h2_title=r,this.isArchived()&&$add(t,SPAN({c:"desc"},_("Archived"))),r},renderHistoryEditor:function(){this.fetch_history=A({href:"#",c:"action"},_("Fetch more"),"..."),$AEV(this.fetch_history,["click","touchstart"],this.getMoreHistory),this.current_his_list=UL({c:"items project_history"}),this.history_controller=DIV({c:"controller actions controller_history"},this.fetch_history),this.history_editor=DIV({c:"list_editor history"},this.current_his_list,this.history_controller),$hide(this.history_controller),$add(this.editor_instance_div,this.history_editor)},setProjectTitle:function(e){$setHTML($gc(this.project_header_link,"span"),H.formatSimple(e))},showSectionAddForm:function(){var e=this;this.clearEmptyStateIfNeeded();var t=(0,i.renderSectionForm)({onSubmit:this.onSectionAdd,onCancel:function(){e.checkEmpty(),$remove(e.current_add_section_li)}});this.current_add_section_li=LI(DIV({c:"section"},DIV({c:"secton_head_holder"},t))),$add(this.current_list,this.current_add_section_li),t._focus()},onSectionAdd:function(e){var t=q.getByPID(this.project_id),r=0==t.length?1:(0,l.last)(t).section_order+1,n=q.add({name:e,project_id:this.project_id,section_order:r});$add(this.current_list,this.renderSectionItem(n.id,[])),$remove(this.current_add_section_li)},showHistory:function(){$show(this.history_editor,this.history_controller),this.history_editor.scrollIntoView(),this.getMoreHistory()},getMoreHistory:function(){var e=this;L.mark("ProjectEditor/getMoreHistory");var t=this.fetch_history;$hide(t),this.history_fetch_count++,S.addToElm(t.parentNode);var r=$requestJSON("/API/"+K.api_version+"/items/get_completed");r.offline_message=!0,r.addCallback(function(r){r=(0,l.compose)((0,l.map)(function(e){return a({},e,{parent_id:null,section_id:null})}),(0,l.sortBy)(["date_completed","id"]))(r),r.reverse();var n=e.current_his_list;$remove($all("li","empty",n)),S.removeFromElm(t.parentNode);var o=!0,i=!1,s=void 0;try{for(var u,c=r[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value;if(!$("item_"+d.id)){var f=e.renderHistoryItem(d);$add(n,f)}}}catch(e){i=!0,s=e}finally{try{!o&&c.return&&c.return()}finally{if(i)throw s}}var p=e.history_fetch_count,m=r.length;if(1==p&&m<10&&m>0);else if(r.length<10){var h,v;v=p>1?_("No more completed tasks"):_("No completed tasks"),$add(n,h=LI({c:"empty"},v)),$fx.fadeOut(h,{duration:3e3,onComplete:function(){$remove(h)}})}else $show(t);e.arrows&&e.arrows.updateArrows(),e.current_limit+=r.length}),r.addErrback(function(){S.removeFromElm(t.parentNode)}),0===this.current_limit&&(this.current_limit=this.current_his_list.childNodes.length);var n={onSuccess:function(){r.sendReq({offset:e.current_limit,project_id:e.project_id})}};return K.sync(n),!1},renderHistoryItem:function(e){var t=H.format(e.content),r=TBODY(),n=TABLE(r),o=TD({c:"checker"}),a=TD({c:"content"});$add(r,TR(o,a));var i=SPAN({c:"text"});$setHTML(i,t),$add(a,i);var s=LI({c:"task_item history_item checked",id:"item_"+e.id},n);$addClass(s,"item_"+e.id),s.json=e,I.annotate(e,i,s),$add(a,$setHTML(DIV(),C.format("",e)));var l=U.create(s,this.unarchiveHistoryItem);return $add(o,DIV({c:"div_checker"},l)),T.setChecked(l,1),F.setIndent(s,1),s},unarchiveHistoryItem:function(e){W.unarchive(e.json),$remove(e),this.reRender()},reRender:function(){this.removeEditorContent(),this.renderEditorContent()},editingDone:function(e){D.current_cancel=null,D.current_form=null,this.arrows.updateArrows(),this.current_item=e},checkEmpty:function(){var e=W.itemGetSectionGroups(this.project_id);1===(0,l.keys)(e).length&&0===e[null].length&&this.renderEmpty()},showAddItemForm:function(){this.section_list_by_sid[null].showAddItem(!1,!0,!0)},renderEmpty:function(){var e=this;if(D.hideEmptyState)return null;var t=$("empty-state-holder");t||(t=DIV({id:"empty-state-holder"}),$add($("editor"),t));var r=z.get(this.project_id),n=void 0;return n=r.inbox_project?(0,y.isScheduled)(y.TOOLTIP_EMPTY_STATE_INBOX,w.default.getState())?c.default.createElement(v.EmptyStateInboxNew,{onButtonClick:this.showAddItemForm}):c.default.createElement(v.EmptyStateInboxZero,{onButtonClick:this.showAddItemForm}):(0,g.totalCompleted)(w.default.getState())<20?c.default.createElement(v.EmptyStateProjectNew,null):this.last_task_completed?c.default.createElement(v.EmptyStateProjectCelebration,{onButtonClick:this.addNewItem,onLinkClick:function(){var t=$gc($("projects_list"),"li","current");t&&(e.last_task_completed=!1,m.default.archive(t),w.default.dispatch((0,h.showProjectView)([window.User.inbox_project])))}}):c.default.createElement(v.EmptyStateProjectZero,{onButtonClick:this.showAddItemForm}),f.default.render(n,t),null},renderHeaderActions:function(e){var t,r=this;if(!e.inbox_project){var n=Y.getAll(this.project_id),o=n.length>1?svgs.get("sm1/member_small.svg"):svgs.get("sm1/add_member_small.svg");t=A({c:"share_icon",href:"#","data-track":"project|share"},o),$AEV(t,["click","touchstart"],function(){return N.show(r.project_id),!1}),j.showSimpleText(t,_("Share options")),n&&n.length>1&&$add(t,SPAN({c:"share_count"},""+n.length))}var a=A({c:"gear_icon icon",href:"#"},svgs.get("sm1/more.svg"));j.showSimpleText(a,_("Project actions"),null,null,5),$AEV(a,["click","touchstart"],function(t){return J.get().toggle(a,a,t,{hide_filter:function(t){return!(!e.inbox_project||!$hasClass(t,"sort_responsible"))}})});var i;return i=P.renderIcon(e,E.TYPE_PROJECT_NOTE),j.showSimpleText(i,_("Project comments"),null,null,7),e.is_archived?DIV({c:"top_right_actions"},i):DIV({c:"top_right_actions"},i,t,a)},clearEmptyStateIfNeeded:function(){var e=$("empty-state-holder");e&&(f.default.unmountComponentAtNode(e),$remove(e))},getCurrentOrder:function(){var e=$$(".section_list > li",null,this.editor_instance_div),t=1,r=[];return $map(e,function(e){e.json&&r.push({id:e.json.id,section_order:t++})}),r},saveOrder:function(){var e=this.getCurrentOrder({as_list:!0});q.reorder(e)}});t.exports={ProjectEditorGeneric:te,ProjectEditor:re}},{"../../components/projects_list/ProjectArchive":69,"../../menus/MenuPriorities":148,"../../menus/MenuProjectEditor.js":150,"../../menus/MenuProjectGear.js":151,"../../menus/MenuReactions":153,"../../models/Collaborators":160,"../../models/ItemsModel":167,"../../models/ProjectsModel":171,"../../models/SectionsModel":175,"../../models/SyncEngine":181,"../../models/TemporaryIds":184,"../../react_components/emptyState":241,"../../reducers/mainView":426,"../../reducers/notes/notesConstants":430,"../../reducers/stats":446,"../../reducers/tooltip":448,"../../stores/store":456,"../../utils/fp":477,"../action_perfomed/ActionPerformed":2,"../agenda/AgendaUtils":8,"../formatter/Formatter.js":22,"../generic_manager/GenericArrows.js":24,"../generic_manager/GenericManager.js":25,"../generic_manager/GenericManagerUtils.js":26,"../items_utils/ItemCheckbox":29,"../labels/Labels.js":37,"../left_menu/LeftMenu":38,"../notes/Notes.js":46,"../notes/NotesUtils":49,"../project_editor/ProjectEditorDragAndDropFiles":60,"../project_editor/ProjectEditorManager":61,"../projects_list/ProjectListUtils":71,"../sharing/SharingManager":87,"./ProjectEditorUtils":62,"./SectionList":65,react:"react","react-dom":"react-dom"}],60:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Signals,s=e("../../models/ItemsModel"),l=e("../notes/Notes.js"),u=e("../templates/Templates"),c=function(){function e(){n(this,e),this.attach=this.attach.bind(this),this.addOverlay=this.addOverlay.bind(this),this.removeOverlay=this.removeOverlay.bind(this)}return o(e,[{key:"attach",value:function(e){var t=this;if(window.User.is_premium){var r=e.editor_instance_div;r.addEventListener("dragleave",function(e){$preventDefault(e),t.removeOverlay(e,r)},!0),r.addEventListener("dragenter",function(e){$preventDefault(e),t.addOverlay(e,r)},!0),r.addEventListener("dragover",function(e){$preventDefault(e),t.addOverlay(e,r)},!0),r.addEventListener("drop",function(n){$preventDefault(n),t.removeOverlay(n,r);var o=t._getFile(n);if(o){var a=e.project_id;if(-1!==o.name.indexOf(".csv")||-1!==o.name.indexOf(".txt"))u.showImport(a);else{var c=s.add({project_id:a,content:o.name});i.sendSignal("instant_refresh_interface"),l.showItemNotes(c.id),setTimeout(function(){l.submit_fn&&l.submit_fn()},50)}}},!0)}}},{key:"addOverlay",value:function(e,t){this.clearTimeout(t);var r=!1;if(e.dataTransfer.types){var n=!0,o=!1,a=void 0;try{for(var i,s=e.dataTransfer.types[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){if("Files"===i.value){r=!0;break}}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}}if(r&&!t.attach_overlay){var l=void 0;$addClass(t,"drop_over");var u=_("Add file as task / Import from template");$add($body(),l=DIV({c:"attach_overlay"},SPAN(u)));var c=$position(t);$setWidth(l,t.offsetWidth),$setHeight(l,t.offsetHeight),$setTop(l,c.y),$setLeft(l,c.x),t.attach_overlay=l}}},{key:"removeOverlay",value:function(e,t){var r=this;this.clearTimeout(t),t.attach_timeout=setTimeout(function(){$removeClass(t,"drop_over"),t.attach_overlay&&($remove(t.attach_overlay),t.attach_overlay=null),r.clearTimeout(t)},100)}},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){e.attach_timeout&&(clearTimeout(e.attach_timeout),e.attach_timeout=null)})},{key:"_getFile",value:function(e){var t=e.dataTransfer&&e.dataTransfer.files;if(t){var r=$first(t);if(r)return r}return null}}]),e}();t.exports=new c},{"../../models/ItemsModel":167,"../notes/Notes.js":46,"../templates/Templates":94}],61:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("react-dom"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=e("../../utils/deps"),l=window,u=l.Signals,c=e("../../models/ProjectsModel"),d=e("../../menus/MenuProjectEditor.js"),f=e("../onboarding/Onboarding"),p=(0,s.defineDeps)("ProjectEditorManager",["ProjectEditor"]),m=function(){function e(){var t=this;n(this,e),this.setCurrentSectionList=function(e){t.current_form||d.get().shown||(t.current_section_list=e,t.externalServicesAnnotation(window.CURRENT_EXERNAL_SERVICE))},this.getCurrentSectionList=function(){return t.current_section_list};var r=void 0;this.reset=this.reset.bind(this),this.getCurrentEditor=this.getCurrentEditor.bind(this),this.getEditorById=this.getEditorById.bind(this),this.getEditorsById=this.getEditorsById.bind(this),this.createEditorInstance=this.createEditorInstance.bind(this),this.getCurrentProjectId=this.getCurrentProjectId.bind(this),this.showProjects=this.showProjects.bind(this),this.toggleProject=this.toggleProject.bind(this),this.setAsActive=this.setAsActive.bind(this),this.externalServicesAnnotation=this.externalServicesAnnotation.bind(this),this.attachMouseMove=this.attachMouseMove.bind(this),this.editors=[],this.current_section_list=null,this.current_cancel=null,this.current_form=null,this.current_holder=null,this.hideEmptyState=!1,u.connect("projects.rerender",function(e){var n={},o=!0,a=!1,i=void 0;try{for(var s,l=t.editors[Symbol.iterator]();!(o=(s=l.next()).done);o=!0)r=s.value,n[r.project_id]=r}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}var u=!0,c=!1,d=void 0;try{for(var f,p=e[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var m=f.value;r=n[parseInt(m)],r&&r.reRender()}}catch(e){c=!0,d=e}finally{try{!u&&p.return&&p.return()}finally{if(c)throw d}}n=null}),u.connect("projects.rerender.all",function(){t.reRender()}),u.connect("projects.reset",function(){t.reset()}),u.connect("project.name.changed",function(e){(r=t.getEditorById(e.id))&&r.setProjectTitle(e.name)}),u.connect("external_service_annotation",this.externalServicesAnnotation)}return o(e,null,[{key:"initClass",value:function(){this.prototype.DepProjectEditor=null}}]),o(e,[{key:"reset",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.current_section_list=null,this.current_cancel=null,this.current_form=null,this.current_editor=null,this.current_project_id=null,this.current_holder=null,this.hideEmptyState=!1,e){var t=!0,r=!1,n=void 0;try{for(var o,a=this.editors[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){o.value.remove()}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}this.editors=[]}this.removeEmptyState(),u.sendSignal("project_editor_manager_reset")}},{key:"getCurrentEditor",value:function(){return this.current_editor}},{key:"getEditorById",value:function(e){var t=!0,r=!1,n=void 0;try{for(var o,a=this.editors[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;if(i.project_id===e)return i}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return null}},{key:"getEditorsById",value:function(){var e={},t=!0,r=!1,n=void 0;try{for(var o,a=this.editors[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){e[o.value.project_id]=!0}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return e}},{key:"createEditorInstance",value:function(e){var t=new p.ProjectEditor;return t.initWithData(e),this.editors.push(t),t}},{key:"getCurrentProjectId",value:function(){return this.current_project_id}},{key:"isShowing",value:function(e){return!!this.getEditorById(e)}},{key:"showProjects",value:function(e,t,r){if(r||(r={}),this.removeEmptyState(),r.holder||(r.holder=$("editor")),window.MINI_VERSION){var n=$("blank_state_projects_list");n&&$remove(n)}this.reset(),!0!==r.dont_replace_holder&&$replace(r.holder,null),this.current_holder=r.holder,this.hideEmptyState=r.hideEmptyState,e.length>1?$addClass(r.holder,"project_editors_multiple"):$removeClass(r.holder,"project_editors_multiple"),window.scroll(0,0);var o=!0,a=!1,i=void 0;try{for(var s,l=e[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value,d=this.createEditorInstance(c);d.holder=r.holder,d.showProject()}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}var p=this.editors[0];p&&(!1!==r.update_location&&u.sendSignal("change_location","project/"+p.project_id),this.setAsActive(p,!0)),this.externalServicesAnnotation(window.CURRENT_EXERNAL_SERVICE),$isFunction(t)&&t(),setTimeout(function(){f.showCompleteTaskTooltipIfNeeded(),u.sendSignal("rendered.projects")},50)}},{key:"removeEmptyState",value:function(){var e=$("empty-state-holder");e&&i.default.unmountComponentAtNode(e)}},{key:"toggleProject",value:function(e){var t=null,r=[],n=!0,o=!1,a=void 0;try{for(var i,s=this.editors[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value;l.project_id===e?t=l:r.push(l)}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}if($addClass(this.current_holder,"project_editors_multiple"),t)return this.current_editor===t&&this.reset(!1),this.editors=r,t.remove(),!1;var u=this.createEditorInstance(e);return u.holder=this.current_holder,u.showProject(),!0}},{key:"setAsActive",value:function(e){!1===(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&this.current_form||d.get().shown||(this.current_project_id=e.project_id,this.current_editor=e,this.current_editor.setTopSectionAsCurrent(),$removeClass($all("div","project_editor_instance"),"current_editor"),$addClass(e.editor_instance_div,"current_editor"))}},{key:"externalServicesAnnotation",value:function(e){var t=this;if(this.current_section_list){var r=$("add_link");if(r&&$remove(r),e){var n=this.current_section_list.controller;if(!n)return;var o=e.annotate_add_text,a=e.annotate_fn;r=A({href:"#",class:"action",id:"add_link"},o),$add(n,r),$addClass($$(".action_add_item",n),"inlined-button"),r.onclick=function(){return t.current_section_list.addNewItem(!1,function(){var e=$gc(t.current_form,null,"richtext_editor");e&&a&&a(e)}),!1}}}}},{key:"attachMouseMove",value:function(e){var t=this;$AEV(e.editor_instance_div,"mouseover",function(){t.current_project_id!==e.project_id&&t.setAsActive(e)})}},{key:"checkEmpty",value:function(){this.current_editor&&this.current_editor.checkEmpty()}},{key:"removeEmpty",value:function(){this.current_editor&&this.current_editor.removeEmpty()}},{key:"reRender",value:function(){var e=[],t=!0,r=!1,n=void 0;try{for(var o,a=this.editors[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;c.get(i.project_id)?(i.reRender(),e.push(i)):i.remove()}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}this.editors=e,this.setAsActive(this.editors[0])}}]),e}();m.initClass(),window.ProjectEditorManager=new m,t.exports=window.ProjectEditorManager},{"../../menus/MenuProjectEditor.js":150,"../../models/ProjectsModel":171,"../../utils/deps":470,"../onboarding/Onboarding":52,"react-dom":"react-dom"}],62:[function(e,t,r){"use strict";var n=e("../projects_list/ProjectListUtils"),o=e("../formatter/Formatter.js");r.generateLink=function(e){var t=$setHTML(SPAN(),o.formatSimple(e.name,{with_links:!1})),r=A({href:"#",c:"project_link"},t);return $AEV(r,"click",function(){return n.setCurrentById(e.id,null,null,!1),window.scroll(0,0),!1}),r}},{"../formatter/Formatter.js":22,"../projects_list/ProjectListUtils":71}],63:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.GB_show,s=e("../../containers/premium_promo/PremiumOnlyModal"),l=e("../../models/TemporaryIds"),u=function(){function e(){n(this,e),this.showProjectEmail=this.showProjectEmail.bind(this),this.showProjectCommentEmail=this.showProjectCommentEmail.bind(this),this.showItemEmail=this.showItemEmail.bind(this),this.genericShowEmail=this.genericShowEmail.bind(this),this.showCalFeed=this.showCalFeed.bind(this)}return o(e,[{key:"showProjectEmail",value:function(e){this.genericShowEmail("project",e,_("Add tasks via email"))}},{key:"showProjectCommentEmail",value:function(e){this.genericShowEmail("project_comments",e,_("Add comments via email"))}},{key:"showItemEmail",value:function(e){this.genericShowEmail("item",e,_("Add comments via email"))}},{key:"genericShowEmail",value:function(e,t,r){if(!window.User.is_premium)return s.showEmailForwarding();var n=function(){i(r,"/Emails/view?obj_type="+e+"&obj_id="+t,500,500)};this.customShowGb(t,n)}},{key:"showCalFeed",value:function(e){if(!window.User.is_premium)return s.showProjectCalendarFeed();var t=function(e){var t="/Calendar/view_project_feed_url?project_id="+e;i(_("Project calendar feed"),t,230,450)};this.customShowGb(e,t)}},{key:"customShowGb",value:function(e,t){l.waitToResolve(e,function(e){t(e)})}}]),e}();t.exports=new u},{"../../containers/premium_promo/PremiumOnlyModal":120,"../../models/TemporaryIds":184}],64:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../projects_list/ProjectList"),s=n(i),l=e("../../utils"),u=e("../../models/SectionsModel"),c=n(u),d=window,f=d.ElementStore,p=e("../sortable/Sortable.js"),m=e("../../models/StateModel"),h=function(){function e(){var t=this;o(this,e),this.detectDropOnProject=function(){var e=ICE.$dnd.mouse_pos||$mousePos(),r=e.x,n=e.y;n+=$("left_menu").scrollTop-$scrollTop(),t.project_drop_target&&($removeClass(t.project_drop_target,"drop_background"),t.project_drop_target=null);var o=!0,a=!1,i=void 0;try{for(var s,l=t.project_list_offset[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value,c=r>=u.x&&r<=u.x_max;if(c=c&&n>=u.y&&n<=u.y_max){$addClass(u.dom,"drop_background"),t.project_drop_target=u.dom;break}}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}},this.onDrag=function(){t.sortable.onDrag(),t.detectDropOnProject()},this.onHandlerMouseDown=function(e){t.current_li=$parent(t.current_handler,"li");var r=$parent(t.current_li,".project_editor_instance"),n=$$(".section_list li[data-id]",r);t.sortable=new p(n,"section");var o=t.sortable.onStart;return ICE.$dnd.dragAble(t.current_li,{handler:t.current_handler,move_x:!0,on_start:o,on_drag:t.onDrag,on_end:t.onEnd,scroll_on_overflow:!0,scroll_custom:t.scrollCustom}),m.set("drag_and_drop_mode",m.DragMode.reordering),t.project_list_offset=t.projectListOffsetSnapshot(),ICE.$dnd._start(t.current_handler,e),$preventDefault(e),!1},this.onEnd=function(){m.set("drag_and_drop_mode",m.DragMode.waiting),t.sortable.onEnd();var e=ICE.$dnd.current_root;if(t.project_drop_target){$removeClass(t.project_drop_target,"drop_background");var r=(0,l.intID)(t.project_drop_target.getAttribute("data-id")),n=(0,l.intID)(e.getAttribute("data-id"));return void c.default.move({id:n,project_id:r})}var o=$parent(e,"div","project_editor_instance");o&&(o=f.get(o,"editor"),o.saveOrder())},this.current_li=null,this.current_handler=null,this.sortable=null,this.project_list_offset=null,m.set("drag_and_drop_mode",m.DragMode.waiting)}return a(e,[{key:"attach",value:function(e){var t=this;e.onmousedown=function(r){t.current_handler=e,t.onHandlerMouseDown(r)}}},{key:"projectListOffsetSnapshot",value:function(){var e=[],t=s.default.getAllRenrededItems(!0,!1);t.push($("filter_inbox")),$("filter_team_inbox")&&t.push($("filter_team_inbox")),t=t.concat($$('#top_filters li[data-type="project_list_item"]'));var r=!0,n=!1,o=void 0;try{for(var a,i=t[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var l=a.value,u=$position(l);u.x_max=u.x+l.offsetWidth,u.y_max=u.y+l.offsetHeight,u.dom=l,e.push(u)}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}return e}},{key:"scrollCustom",value:function(e,t){var r=this.scrollObject(e);r.scrollBy?r.scrollBy(0,t):r.scrollTop+=t}},{key:"scrollObject",value:function(e){var t=$("left_menu"),r=$position(t);return e.x>=r.x-50&&e.x<=r.x+t.offsetWidth?t:window}}]),e}();r.default=new h},{"../../models/SectionsModel":175,"../../models/StateModel":177,"../../utils":484,"../projects_list/ProjectList":70,"../sortable/Sortable.js":90}],65:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t,r){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,r);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",r),n.moveStart("character",t),n.select()}}function i(e,t){a(e,t,t)}Object.defineProperty(r,"__esModule",{value:!0}),r.renderSectionForm=void 0;var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e
},l=e("./SectionMenu"),u=n(l),c=e("../../models/SectionsModel"),d=n(c),f=e("../../models/RealHierachy"),p=e("../../utils"),m=e("../../utils/fp"),h=e("../../stores/store"),v=n(h),y=e("../../reducers/undo"),g=e("../../reducers/items"),b=e("./SectionDragAndDrop"),w=n(b),E=window.ElementStore,k=window.IstTooltip,S=e("../project_editor/ProjectEditorManager"),j=e("../sharing/SharingManager"),T=e("../action_perfomed/ActionPerformed"),O=e("../items_utils/ItemAddEditForm"),I=e("../items_utils/ItemsRender"),P=e("../items_utils/ItemCheckbox"),C=e("../items_utils/ItemDueDates.js"),D=e("../items_utils/ItemCommonEdits"),M=e("../generic_manager/GenericManager.js"),x=e("../generic_manager/GenericManagerUtils.js"),R=e("../generic_manager/GenericArrows.js"),N=e("../../models/ProjectsModel"),L=e("../../models/ItemsModel"),U=e("../../models/Collaborators"),V=e("../../models/Reminders").BufferedRemindersModel,F=e("../../menus/MenuProjectEditor.js"),B=e("../onboarding/Onboarding"),H=M.extend({initWithData:function(e){var t=this,r=e.project_id,n=e.section_id,o=e.items,a=e.on_show_add_item,i=e.on_add_form_cancel,s={list_class:"SectionList",data_model:L,max_indent:5,undo_reorder_intent:"reorder_section",arrows:new R({data_model:L}),state_manager:S,manager_type:"section",project_id:r,section_id:n,items:o,on_show_add_item:a,on_add_form_cancel:i};if(s.arrows.setList(this),void 0===r||void 0===n)throw new Error("SectionList argument missing error");this.parent(s),this.is_top_section=!this.section_id,this.current_limit=0,this.section_div=null,this.menu=F.get(),Object.defineProperty(this,"section",{get:function(){return t.is_top_section?null:d.default.getByID(t.section_id)}}),$bindMethods(this)},remove:function(){this.section_div&&($remove(this.current_list,this.section_div,this.top_right_actions_div),E.remove(this.section_div),this.state_manager=null,this.current_list=null,this.menu=null,this.arrows.data_model=null,this.arrows=null,this.section_div=null,this.project_header_link=null)},setCurrentItem:function(e){this.current_item=e,S.current_item=e},isArchived:function(){var e=N.get(this.project_id);return!!e&&e.is_archived},render:function(){var e=this,t=this;if(this.header_holder=DIV({c:"secton_head_holder"}),!this.is_top_section){var r=SPAN({c:"drag_and_drop_handler"},svgs.get("sm1/drag.svg"));w.default.attach(r),$add(this.header_holder,r,this.renderHeader())}this.isArchived()?this.controller=null:(this.add_item=A({c:"action action_add_item"},SPAN({c:"icon icon_add"},svgs.get("sm1/plus.svg")),_("Add Task")),this.add_item.onclick=this.addNewItem,this.controller=DIV({c:"controller actions task_actions"},this.add_item)),this.list_holder=DIV({c:"list_holder"});var n={c:"section"};if(this.section_id&&(n["data-id"]=this.section_id),!this.is_top_section&&this.section.collapsed&&(n.c+=" section__collapsed"),this.section_div=DIV(n,this.header_holder,this.list_holder,this.controller),this.current_list=UL({c:"items"}),$add(this.current_list,LI({c:"reorder_item task_item"})),$map(this.items,function(e){var r=t.renderItem(e);$add(t.current_list,r)}),x.showHideChildren($AF(this.current_list.childNodes)),$add(this.list_holder,this.current_list),this.edit_on_load){var a=this.edit_on_load;$map($AF(this.current_list.childNodes),function(e){e.json.id==a&&(t.setCurrentItem(e),t.editCurrentItem())}),this.edit_on_load=null}this.arrows.updateArrows(),E.set(this.section_div,"SectionList",this),$AEV(this.section_div,"mouseover",function(){S.current_section_list!==e&&S.setCurrentSectionList(e)});var i=void 0;if(this.is_top_section)i=LI(o({},"data-type","section"),this.section_div);else{var s;i=LI((s={},o(s,"data-type","section"),o(s,"data-id",this.section_id),s),this.section_div),i.json={id:this.section_id}}return i},renderEmpty:function(){return null},renderItem:function(e,t){var r=this;t||(t={fn_toggle_menu:F.toggle,fn_complete_item:this.completeItem,fn_undo_complete_item:this.uncompleteItem,with_due_date:!0});var n=N.get(e.project_id),o=!0;(e.in_history||t.not_editable||!n||n.is_archived)&&(o=!1),o||(t.no_checkbox=!0,t.no_drag_and_drop=!0,t.not_editable=!0);var a=I.renderItem(e,t);return a.render_opts.renderCls=r,o&&x.attachClick(a.content,function(){return r.saveCurrentItem(function(){r.setCurrentItem(a),r.editCurrentItem()}),!0}),a},renderHeader:function(){var e=this,t=DIV({c:"collapser"},svgs.get("sm1/caret.svg")),r=DIV({c:"menu icon"},svgs.get("sm1/more.svg"));$AEV(r,"click",function(t){u.default.toggle({section:e.section,anchor:r,event:t,onAddTaskSelected:function(){e.section.collapsed&&e.toggleCollapse(),e.addNewItem()},onRenameSelected:e.showHeaderForm,onArchiveSelected:function(){var t=void 0;t=0===e.items.length?(0,p.format)(_("Are you sure you want to archive {section}?"),{section:"<b>"+e.section.name+"</b>"}):(0,p.format)(_n("Archive {section} with its 1 task?","Archive {section} with its {n} tasks?",e.items.length),{section:"<b>"+e.section.name+"</b>",n:e.items.length}),t=$setHTML(SPAN(),t);var r=_("Archive");Alerts.confirm(t,function(t){t&&d.default.archive(e.section_id)},r)},onDeleteSelected:function(){var t=void 0;t=0===e.items.length?(0,p.format)(_("Are you sure you want to delete {section}?"),{section:"<b>"+e.section.name+"</b>"}):(0,p.format)(_n("Delete {section} with its 1 task?","Delete {section} with its {n} tasks?",e.items.length),{section:"<b>"+e.section.name+"</b>",n:e.items.length}),t=$setHTML(SPAN(),t);var r=_("Delete");Alerts.confirm(t,function(t){t&&d.default.remove(e.section_id)},r)},onMoveToProject:function(t){d.default.move({id:e.section_id,project_id:t})}}),t.stopPropagation()});var n=DIV({c:"section_head"},t,H4(this.section.name),r);return n.addEventListener("click",function(){return e.toggleCollapse()}),n},toggleCollapse:function(){this.section.collapsed?(d.default.update({id:this.section_id,collapsed:!1}),$removeClass(this.section_div,"section__collapsed")):(d.default.update({id:this.section_id,collapsed:!0}),$addClass(this.section_div,"section__collapsed"))},collapseOn:function(){},collapseOff:function(){},showHeaderForm:function(){var e=d.default.getByID(this.section_id),t=G({section:e,onCancel:this.onHeaderFormCancel.bind(this),onSubmit:this.onHeaderFormSubmit});$replace(this.header_holder,t),i($$("input.name",t)[0],1e5)},onHeaderFormCancel:function(){$replace(this.header_holder,this.renderHeader())},onHeaderFormSubmit:function(e){var t=d.default.getByID(this.section_id);d.default.update({id:t.id,name:e}),$replace(this.header_holder,this.renderHeader())},onAddItem:function(e,t){track("task_form","click","add_from_project");var r=this,n=$parent(e,"li"),o=O.parseFormData(e);if(!o)return!1;if(O.genericAddItem(e,o),""!==o.content){if(o.project_id===this.project_id){var a=this.getParentChildOrder(n);o=s({},o,a,{section_id:this.section_id})}else{var i=(0,g.itemGetMaxTopLevelChildOrder)({project_id:o.project_id,section_id:null},v.default.getState());o=s({},o,{section_id:null,parent_id:null,child_order:i})}var l=o,u=l.item_order,c=l.indent;o=(0,p.omit)(o,["item_order","indent","order"]);var d=L.add(o);if(!d)return;d=s({},d,{item_order:u,indent:c}),V.reminders.length>0&&V.commitBuffered(d);var f,m=N.get(d.project_id);d.project_id!=this.project_id?(v.default.dispatch((0,y.notifyAddToProject)(d.id,m.id)),f=n.previousSibling,$swap(n,null)):(f=r.renderItem(d),$addClass(f,"item_added"),$swap(n,f)),this.editingDone(f);var h={};if(m&&U.isProjectShared(m.id)&&0!=o.inherit_asignee?h.responsible_uid=d.responsible_uid:h.responsible_uid=void 0,$isFunction(t)?t(d):n.has_reordered||S.current_section_list.showAddItem(!0,!1,!1,h),f){var _=$parent(f,".section"),b=E.get(_,"SectionList");b&&b.saveOrder(f,{allow_undo:!1})}return!1}this.setCurrentItem(n),$isFunction(t)&&t(!0);var w=$gc(e,null,"richtext_editor");return w&&w.proxyFocus(),!1},showAddItem:function(e,t,r,n){var o=this,a=this;this.on_show_add_item&&this.on_show_add_item(this),j.promo_shown&&j.promoRemove(),this.parent(e,t,r),F.get().hide();var i=function(){o.on_add_form_cancel&&o.on_add_form_cancel(o),V.reset(),a.checkEmpty(),a.arrows.updateArrows(),O.genericCancelEdit()},s={cancel:x.genCancel("li",i,S,null,{"data-track":"task_form|cancel"}),action:a.onAddItem,submit_val:_("Add Task"),submit_icon:"cmp_add",name_val:"",manager_reodering:!0,manager_type:"project_editor",disable_shift_enter:!0};n&&n.responsible_uid&&(s.responsible_uid=n.responsible_uid);var l=O.generateForm(s);S.current_cancel=s.cancel,S.current_form=l.form;var u=l.li_item;if(!0===e){var c=x.getIndent(this.current_item)||1,d=this.current_item.nextSibling;!t&&d&&d.json&&d.indent==c+1&&(c+=1),x.setIndent(u,c)}else u.indent=x.getIndent(u);return u.priority=1,this.insertForm(l.li_item,t),this.arrows.updateArrows(),l.textarea.proxyFocus(),!1},addNewItem:function(e,t){var r=this;T.mark("ProjectEditor/addNewItem");var n=function(){!0===e?r.setCurrentItem(r.getItem($first)):r.setCurrentItem(r.getItem($last)),r.showAddItem(!1,!0===e,!0),$isFunction(t)&&t()};return S.current_editor.saveCurrentItem(n),!1},saveItem:function(e,t){track("task_form","click","save");var r=this,n=$parent(e,"li"),o=S.current_form,a=S.current_item,i=x.getChildren(a),s=O.genericSaveItem(a,o);if(s){var l;if(s.item.project_id!=this.project_id?(l=a.previousSibling,$map(x.getChildren(a,!0),function(e){$swap(e,null)})):(l=r.renderItem(s.item),$addClass(l,"item_updated"),$swap(a,l),x.updateParentIds(l,L,i)),this.editingDone(l),l&&n.has_reordered){var u=$parent(l,".section"),c=E.get(u,"SectionList");c&&c.saveOrder(l,{allow_undo:!1})}return $isFunction(t)&&t(),!1}},editCurrentItem:function(){j.promo_shown&&j.promoRemove();var e=this;this.parent(),F.get().hide();var t=this.current_item;k.hide();var r=function(){$show(t),e.arrows.updateArrows(),O.genericCancelEdit()},n={cancel:x.genCancel("li",r,S,null,{"data-track":"task_form|cancel"}),action:e.saveItem,submit_val:_("Save"),name_val:t.json.content,due_date:t.json.due,current_item:t,priority:t.json.priority,responsible_uid:t.json.responsible_uid,manager_reodering:!0,manager_type:"project_editor"},o=O.generateForm(n);S.current_cancel=n.cancel,S.current_form=o.form,$addAfter(o.li_item,t),this.arrows.updateArrows(),setTimeout(function(){o.textarea.proxyPlaceCursor()},1)},archiveItem:function(e){var t=L.archive(e.json.id);0!==t.length&&(t.forEach(function(e){var t=$("item_"+e.id);t&&$remove(t)}),this.arrows.updateArrows(),this.checkEmpty())},completeItem:function(e,t,r){var n=this;if(B.isFirstCompleteAction())return void B.showFirstCompleteAnimation(e,function(){n.completeItem(e,t)});T.mark("ProjectEditor/completeItem"),t&&t.shift&&(r=!0);var o=L.complete(e.json,r);if(o){var a=$first(o);$rmap(o,function(e){var t=$("item_"+e.id);t&&(a.in_history?O.removeItemInList(t):e.checked?P.update(t,1,n.uncompleteItem):($update(t.json,e),P.update(t,0,n.completeItem),C.updateDueDate(t)))}),this.arrows.updateArrows(),this.checkEmpty()}},uncompleteItem:function(e){var t=this;T.mark("ProjectEditor/uncompleteItem");var r=L.uncomplete(e.json);$update(e.json,r),P.update(e,0,this.completeItem);for(var n=e;;){var o=x.getParent(n);if(!o)break;P.update(o,0,this.completeItem),n=o}t.arrows.updateArrows(),t.checkEmpty()},editingDone:function(e){S.current_cancel=null,S.current_form=null,this.arrows.updateArrows(),this.setCurrentItem(e)},deleteCurrentItem:function(e){var t=x.getChildren(e,!0);return D.deleteItems(t)},checkEmpty:function(){this.parent()},saveOrder:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.allow_undo,n=void 0===r||r;if(e.is_manager)return void(e.has_reordered=!0);var o=e.json,a=this.getCurrentOrderIndent({as_list:!0}),i=(0,f.deriveTaskParentChild)(a),s=i.find(function(e){return e.id===o.id}).parent_id,l=(0,m.compose)((0,m.map)((0,m.pick)(["id","child_order"])),(0,m.filter)(function(e){return e.parent_id===s}))(i),u={id:o.id,parent_id:s,section_id:this.section_id,project_id:this.project_id};L.moveAndReorder(u,l,{allowUndo:n})},getParentChildOrder:function(e){var t=null,r=x.getParent(e);r&&(t=(0,m.get)("json.id",r));for(var n=e.previousSibling,o=1;n;){if(n.json&&n.json.id&&!n.is_manager){if(n.json.id===t)break;o++}n=n.previousSibling}return{parent_id:t,child_order:o}}});r.default=H;var G=r.renderSectionForm=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.section,r=e.onSubmit,n=e.onCancel,o=t?t.name:"",a=INPUT({c:"name",type:"text",value:o}),i=A({c:"ist_button ist_button_red"},t?_("Save"):_("Add Section")),s=A({c:"cancel_link"},_("Cancel")),l=FORM({c:"section_form"},a,DIV({c:"actions"},i,s));l.onsubmit=function(e){return e.preventDefault()},l._focus=function(){return a.focus()};var u=function(){var e=a.value.trim();""!==e&&r(e)};return a.addEventListener("keydown",function(e){return"Escape"===e.key?void n():"Enter"===e.key?void u():void 0}),s.addEventListener("click",function(){n()}),i.addEventListener("click",function(){u()}),l}},{"../../menus/MenuProjectEditor.js":150,"../../models/Collaborators":160,"../../models/ItemsModel":167,"../../models/ProjectsModel":171,"../../models/RealHierachy":172,"../../models/Reminders":173,"../../models/SectionsModel":175,"../../reducers/items":417,"../../reducers/undo":449,"../../stores/store":456,"../../utils":484,"../../utils/fp":477,"../action_perfomed/ActionPerformed":2,"../generic_manager/GenericArrows.js":24,"../generic_manager/GenericManager.js":25,"../generic_manager/GenericManagerUtils.js":26,"../items_utils/ItemAddEditForm":28,"../items_utils/ItemCheckbox":29,"../items_utils/ItemCommonEdits":30,"../items_utils/ItemDueDates.js":31,"../items_utils/ItemsRender":33,"../onboarding/Onboarding":52,"../project_editor/ProjectEditorManager":61,"../sharing/SharingManager":87,"./SectionDragAndDrop":64,"./SectionMenu":66}],66:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../../components/project_selecter/ProjectSelecter"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a={init:function(){var e=this;this.menu=new IstMenu,this.menu.addItems(IstMenu.createItem(_("Add task"),function(){e.onAddTaskSelected(),e._clearState(),e.menu.hide()},{icon:svgs.get("sm1/plus.svg")}),IstMenu.createItem(_("Rename section"),function(){e.onRenameSelected(),e._clearState(),e.menu.hide()},{icon:svgs.get("sm1/edit.svg")}),IstMenu.createItem(_("Move to project"),function(){e.showMoveTo()},{icon:svgs.get("sm1/move.svg")}),IstMenu.createItem(_("Archive section"),function(){e.onArchiveSelected()},{icon:svgs.get("sm1/archive.svg")}),IstMenu.createItem(_("Delete section"),function(){e.onDeleteSelected(),e._clearState(),e.menu.hide()},{extra_class:"sel_delete_task danger",icon:svgs.get("sm1/trash.svg")})),$AEV(document,"click",this.menu.hide)},_initIfNotExit:function(){this.menu||this.init()},_clearState:function(){this.onAddTaskSelected=function(){},this.onRenameSelected=function(){},this.onDeleteSelected=function(){},this.onMoveToProject=function(){},this.onArchiveSelected=function(){}},toggle:function(e){var t=e.event,r=e.anchor,n=e.onAddTaskSelected,o=e.onRenameSelected,a=e.onDeleteSelected,i=e.onArchiveSelected,s=e.onMoveToProject;this._initIfNotExit()&&this.init(),this._clearState(),this.onAddTaskSelected=n,this.onRenameSelected=o,this.onDeleteSelected=a,this.onMoveToProject=s,this.onArchiveSelected=i,this.menu.toggle(r,r,t)},showMoveTo:function(e){var t=this,r=$eventElm(e);return o.default.showTooltip(r,{no_swap:!0,left_offset:50,top_offset:28,onSelect:function(e){t.onMoveToProject(e.id),t._clearState(),t.menu.hide()}}),!1}};r.default=a},{"../../components/project_selecter/ProjectSelecter":68}],67:[function(e,t,r){"use strict";var n=window.IstTooltip,o=e("../../models/ProjectsModel"),a=e("../richtext_editor/NatrualLanguageParsing"),i=e("./ProjectSelecter"),s={annotateFormArea:function(e,t){IstComplete.attach(e,s.complete_data={trigger:"#",collection:function(){return i.getCompletionProjects()},filterItem:function(e){if(!e)return null;var t=i.renderPItem(e);return e.indent>1&&IstComplete.getCurrentWord().length<=1&&$addClass(t,"indent_"+e.indent),t},wildcard_match:!0,position_item:$parent(e,"td","text_box_holder"),extra_width:1,support_paste:!1,onNoMatches:function(e,t,r){var n;return $add(e,TR(n=TD({c:"ist_complete_item"},DIV(SPAN({c:"ist_complete_content"},_("Project not found.")," ",B(_("Create")+" "+r)))))),n.onmouseover=$p(IstComplete.onMouseOver,n,{}),n.onmousedown=$p(s._createProject,r,t),!0},preOnSelect:function(e){var t=e.completion_item;a.setCurrentProject(t.id,"#"+t.name)}}),$AEV(e,"keydown",function(e){return!(13==e.keyAscii&&!e.shift&&IstComplete.isShown())&&((27!=e.keyAscii||!IstComplete.isShown())&&void 0)}),t&&$swap(t,this._crateButton(e))},_createProject:function(e,t){IstComplete.hide();var r=o.add({name:e});return a.highlight_project=[r.id,"#"+e],window.LibEdit.insertAtCursor(t,IstComplete.CHAR_FORCED_WHITESPACE),!1},_crateButton:function(e){var t=SPAN(svgs.get("sm1/project.svg"));$addClass(t,"form_action_icon"),t.setAttribute("data-track","task_form|project"),$AEV(t,"click",function(){return n.hide(),LibEdit.placeCaretAtEnd(e),IstComplete.forceShow(e,!0,s.complete_data),!1});var r=DIV(B(_("Project")),BR(),_("Select by typing #"));return n.showSimpleText(t,r,null,5,4),t}};t.exports=s},{"../../models/ProjectsModel":171,"../richtext_editor/NatrualLanguageParsing":85,"./ProjectSelecter":68}],68:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=window,s=i.GB_hide,l=window,u=l.IstCompleteSelect,c=e("../formatter/Formatter.js"),d=e("../../models/ProjectsModel"),f=e("../projects_list/ProjectListUtils"),p=function(){function e(){n(this,e),this.render=this.render.bind(this),this.showTooltip=this.showTooltip.bind(this),this.renderPItem=this.renderPItem.bind(this),this.getCompletionProjects=this.getCompletionProjects.bind(this)}return a(e,[{key:"render",value:function(e,t){var r=void 0;r=null!=t.support_all&&0===e?{id:0,name:t.all_txt||_("All projects")}:d.get(e);var n=this.renderPItem(r,t),o=A({href:"#",c:"activity_selector"},n,SPAN({c:"icon"},svgs.get("sm1/caret.svg")));return t.fixed_pos&&$addClass(o,"fixed_pos"),o.showTooltip=$p(this.showTooltip,o,t),$AEV(o,"click",o.showTooltip),this.current=o,o}},{key:"showTooltip",value:function(e,t){var r=this,n={selectedItem:t.selectedItem,collection:function(){var e=r.getCompletionProjects();return null!=t.support_all&&e.splice(0,0,{id:0,name:t.all_txt||_("All projects")}),e},filterItem:function(e){if(e){var n=r.renderPItem(e,t);return e.indent>1&&$addClass(n,"indent_"+e.indent),n}},onSelect:function(n){return s(),t.no_swap||(e.showTooltip=null,$swap(e,e=r.render(n.id,t)),r.current=e),$isFunction(t.onSelect)&&t.onSelect(n,e),n.name},wildcard_match:!0,placeholder:t.placeholder_txt||""},o=new u(n);return o.showTooltip({title:_("Select a project"),icon:e,arrow_left_offset:t.arrow_left_offset||0,top_offset:t.top_offset||25,left_offset:t.left_offset||25,fn_on_hide:function(){o=null}}),!1}},{key:"renderPItem",value:function(e){var t=void 0,r=e.name;return 0!==e.id?(t=f.createColor(e),r=c.formatSimple(r,{only_text:!0,as_html:!1,cache_prefix:"document"})):t=SPAN({c:"blank_color"}),DIV(DIV({c:"ist_complete_icon"},t),DIV({c:"ist_complete_content"},SPAN({c:"truncated p_name"},r)))}},{key:"getCompletionProjects",value:function(){return d.getAll({with_indent:!0}).map(function(e){return o({},e)})}}]),e}();t.exports=new p},{"../../models/ProjectsModel":171,"../formatter/Formatter.js":22,"../projects_list/ProjectListUtils":71}],69:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../../utils/deps"),i=window,s=i.Indicator,l=window,u=l.Signals,c=e("../../mini/DimensionCalculator"),d=e("../../models/ProjectsModel"),f=e("../../models/SyncEngine"),p=e("../generic_manager/GenericManagerUtils.js"),m=(0,a.defineDeps)("ProjectsArchive",["ProjectList"]),h=function(){function e(){n(this,e),this.projectsIds=[],this.render=this.render.bind(this),this.getArchived=this.getArchived.bind(this),this.showHideArchived=this.showHideArchived.bind(this),this.hideArchived=this.hideArchived.bind(this),this.archive=this.archive.bind(this),this.delete=this.delete.bind(this)}return o(e,[{key:"render",value:function(){var e=void 0,t=void 0;$add($("projects_list_manager"),DIV({c:"controller actions controller_history",id:"projects_archived_holder"},e=A({href:"#",id:"show_archived_link","data-track":"projects|show_archived"},_("Archived projects")),t=A({href:"#",id:"hide_archived_link","data-track":"projects|hide_archived",style:"display:none"},_("Hide Archived"))),UL({id:"projects_archived_ul",c:"items generic_left_list"})),$AEV(e,"click",$p(this.getArchived,e)),$AEV(t,"click",$p(this.hideArchived,t))}},{key:"getArchived",value:function(e){var t=this;$hide(e);var r=$("projects_archived_holder"),n=$("projects_archived_ul");s.addToElm(r.parentNode);var o=$requestJSON("/API/"+f.api_version+"/projects/get_archived");o.offline_message=!0,o.addCallback(function(o){s.removeFromElm(r.parentNode),$replace(n,null),d.archivedFeteched(o),t.projectsIds=[];var a=!0,i=!1,l=void 0;try{for(var u,f=o[Symbol.iterator]();!(a=(u=f.next()).done);a=!0){var p=u.value;t.projectsIds.push(p.id),p.indent=1,$add(n,m.ProjectList.renderItem(p,!0))}}catch(e){i=!0,l=e}finally{try{!a&&f.return&&f.return()}finally{if(i)throw l}}if(c.recalculate(),0===o.length){var h=void 0;$add(n,h=LI({c:"empty"},_("No archived projects")));var v=function(){$remove(h),$show(e)};$fx.fadeOut(h,{duration:3e3,onComplete:v})}else t.showHideArchived()}),o.addErrback(function(){s.removeFromElm(r.parentNode)});var a={onSuccess:function(){o.sendReq({token:window.User.token})}};return f.sync(a),!1}},{key:"showHideArchived",value:function(){var e=$("show_archived_link"),t=$("hide_archived_link");e&&($hide(e),$show(t))}},{key:"hideArchived",value:function(){var e=$("show_archived_link"),t=$("hide_archived_link");t&&($replace($("projects_archived_ul"),null),$hide(t),$show(e))}},{key:"archive",value:function(e){var t=p.getChildren(e,!0);t.reverse();var r=!0,n=!1,o=void 0;try{for(var a,i=t[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value;d.archive(s.json.id),u.sendSignal("project_archived",s.json.id),$remove(s)}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}u.sendSignal("instant_refresh_interface"),this.hideArchived()}},{key:"unarchive",value:function(e){d.unarchive(e.json);var t=!0,r=!1,n=void 0;try{for(var o,a=p.getChildren(e,!0)[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;$arrayRemove(this.projectsIds,i.json.id),$remove(i)}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}u.sendSignal("project_unarchived",e.json.id);var s={onSuccess:function(){u.sendSignal("instant_refresh_interface")}};f.sync(s,!0)}},{key:"delete",value:function(e){if(!(this.projectsIds.indexOf(e.json.id)<0)){var t=$("projects_archived_ul"),r=!0,n=!1,o=void 0;try{for(var a,i=p.getChildren(e,!0)[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value;$arrayRemove(this.projectsIds,s.json.id),$remove(s)}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}if(0===this.projectsIds.length){var l=$("hide_archived_link"),u=$("show_archived_link");$hide(l);var c=void 0;$add(t,c=LI({c:"empty"},_("No archived projects")));var d=function(){$remove(c),$show(u)};$fx.fadeOut(c,{duration:3e3,onComplete:d})}}}}]),e}();t.exports=new h},{"../../mini/DimensionCalculator":158,"../../models/ProjectsModel":171,"../../models/SyncEngine":181,"../../utils/deps":470,"../generic_manager/GenericManagerUtils.js":26}],70:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Signals,s=e("../../mini/DimensionCalculator"),l=e("../../menus/MenuProjctColors"),u=e("../../menus/MenuProjectList.js"),c=e("../../models/ProjectsModel"),d=e("../../models/Collaborators"),f=e("../../models/TemporaryIds"),p=e("../../models/Colors"),m=e("../generic_left_list/GenericLeftList"),h=e("../generic_manager/GenericArrows.js"),v=e("../drag_and_drop/DragAndDrop"),y=e("./ProjectArchive"),g=e("../project_editor/ProjectEditorManager"),b=e("../../stores/store").default,w=e("../../reducers/mainView"),E=w.showProjectView,k=e("../../reducers/counts"),S=k.countByProject,j=e("../../stores/subscribeSelected").default,T=m.extend({name:"ProjectList",initWithData:function(){var e=this,t={event_name:"Projects",li_data_type:"project_list_item",data_model:c,fn_get_all:function(){return c.getAll()},icon:"project",markdown_support:!0,max_indent:4,default_color:7,empty_text:_("You have no projects"),add_text:_("Add Project"),placeholder:_("Name your project"),list_holder:"projects_list_manager",DragAndDrop:v,with_color:!0,with_arrows:!0,with_indent:!0,with_ordering:!0,manager_reodering:!0,manager_type:"project_list",empty_screen_only_with_activity:!0,fn_on_click:function(t,r,n){if(u.get().hide(n),n.shift||n.ctrl){if($preventDefault(n),g.current_editor){g.toggleProject(r.id)?$addClass(t,"current"):$removeClass(t,"current")}else e.setCurrent(t);return!1}var o=void 0;o=e.current_item!==t||!e.current_item_with_children,e.setCurrent(t,null,o)},fn_show_items:function(e,t){b.dispatch(E(e,{bottomListSelected:!0,withChildren:!!t}))},fn_on_delete:function(e){var t=!1,r=!0,n=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;y.delete(l),i.sendSignal("project_deleted",l),t=t||g.isShowing(l.json.id)}}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}t&&g.reset()},fn_create_counter:I.createCounter,fn_get_selected:function(){var e=b.getState();return"project"!==e.type?[]:e.bottomListSelected?[]:e.ids},fn_on_show_menu:function(t){if(t.json.inbox_project)return void $hide($all("tr","project_inbox_action",e.menu.menu_holder));$show($all("tr","project_inbox_action",e.menu.menu_holder));var r=$("menu_archive_text"),n=$parent(r,".menu_wrapper"),o=n.querySelector(".menu_icon");t.json.is_archived?($setHTML(r,_("Unarchive")),$replace(o,svgs.get("sm1/unarchive.svg")),$hide($all("tr","project_archive_action",e.menu.menu_holder))):($setHTML(r,_("Archive")),$replace(o,svgs.get("sm1/archive.svg")),$show($all("tr","project_archive_action",e.menu.menu_holder)));var a=d.isProjectShared(t.json.id),i=$("menu_delete_text"),s=$parent(i,".menu_wrapper"),l=s.querySelector(".menu_icon");a?($setHTML(i,_("Leave project")),$replace(l,svgs.get("sm1/leave.svg"))):($setHTML(i,_("Delete project")),$replace(l,svgs.get("sm1/trash.svg"))),t.json.is_favorite?$hide($all("tr","project_add_favorite_action",e.menu.menu_holder)):$show($all("tr","project_add_favorite_action",e.menu.menu_holder))}},r=t.arrows=new h({data_model:t.data_model,x_off:-6});r.setList(this);var n=r._switchState,o=function(e,t){return n(e,t),I.updateCount(e.host_item.json),s.recalculate()};r._switchState=o,t.arrows=r,$bindMethods(this),t.fn_create_color=this.createColor,t.menu=u.init(this),t.menu_colors=l.init(),i.connect("project_editor_manager_reset",function(){e.current_selected&&(e.deselectCurrent(),e.current_selected=null)}),i.connect("projects.reset",function(){e.deselectCurrent()}),this.parent(t)},createColor:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.createColorDiv("project_color_"+e.id,p.getHex("project",e.color));return!0!==t&&d.isProjectShared(e.id)&&($removeClass(r,"project"),$addClass(r,"project_shared"),$add(r,svgs.get("sm1/project_shared.svg"))),r},projectDeleted:function(){var e=this;i.connect("project_deleted",function(t){t===e.current_selected&&(g.reset(),$replace($("editor"),null),e.current_selected=null),$remove(t)})}}),O=function(){function e(){var t=this;n(this,e),this.updateCount=this.updateCount.bind(this),this.updateColor=this.updateColor.bind(this),this.createCounter=this.createCounter.bind(this),$AEV(window,"load",function(){f.listenAll(function(e,t){var r=$("project_count_"+e);r&&(r.id="project_count_"+t),(r=$("project_color_"+e))&&(r.id="project_color_"+t)})}),i.connect("update_project_color",this.updateColor),i.connect("app_data_loaded",function(){j(b,S,function(){$values(b.getState().projects).forEach(function(e){t.updateCount(e)})})})}return o(e,[{key:"updateCount",value:function(e){var t=$("project_count_"+e.id);t&&$swap(t,this.createCounter(e))}},{key:"updateColor",value:function(e){var t=$("project_color_"+e.id);t&&$swap(t,P.createColor(e))}},{key:"createCounter",value:function(e){var t=S(b.getState()),r=t[e.id]||0;if(e.collapsed){var n=!0,o=!1,a=void 0;try{for(var i,s=c.getChildren(e)[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){r+=t[i.value.id]||0}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}}return 0===r&&(r=""),DIV({c:"counter_count",id:"project_count_"+e.id},""+r)}}]),e}(),I=new O,P=new T;window.ProjectList=t.exports=P},{"../../menus/MenuProjctColors":149,"../../menus/MenuProjectList.js":152,"../../mini/DimensionCalculator":158,"../../models/Collaborators":160,"../../models/Colors":161,"../../models/ProjectsModel":171,"../../models/TemporaryIds":184,"../../reducers/counts":408,"../../reducers/mainView":426,"../../stores/store":456,"../../stores/subscribeSelected":457,"../drag_and_drop/DragAndDrop":20,"../generic_left_list/GenericLeftList":23,"../generic_manager/GenericArrows.js":24,"../project_editor/ProjectEditorManager":61,"./ProjectArchive":69}],71:[function(e,t,r){"use strict";var n=e("../../utils/deps"),o=e("../generic_manager/GenericManagerUtils.js"),a=(0,n.defineDeps)("ProjectListUtils",["ProjectList"]);r.setCurrentById=function(e,t,r,n){return a.ProjectList.setCurrentById(e,t,r,n)},r.createColor=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return a.ProjectList.createColor(e,t)},r.deselectCurrent=function(){return a.ProjectList.deselectCurrent()},r.flashItemIfNeeded=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(void 0===e&&(e=a.ProjectList.flash_item),e){a.ProjectList.flash_item=null;var t=$("item_"+e);t&&(o.openParents(t),$isHidden(t)||($fx.highlight(t,{duration:1e3}),window.scrollTo(0,$position(t).y-200)))}}},{"../../utils/deps":470,"../generic_manager/GenericManagerUtils.js":26}],72:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../../stores/store"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=e("../../reducers/settings"),i={init:function(){},show:function(){var e=void 0,t=void 0,r=(0,a.getTheme)(o.default.getState()),n=DIV({c:"promotion_modal promotion_modal--new_checkbox"},H1(_("Google Assistant Lists in Todoist")),H2(_("Todoist now syncs with your Google Assistant lists and tasks. Tasks imported from Google are easy to spot with the label \u201cAssistant\u201d.")),IMG({src:11===r?"https://d3ptyyxy2at9ui.cloudfront.net/google_assistant_dark%402x-2915ec.png":"https://d3ptyyxy2at9ui.cloudfront.net/google_assistant%402x-f09e90.png"}),DIV({c:"promo_actions"},e=A({c:"ist_button ist_button_red",href:"https://get.todoist.help/hc/en-us/signin?return_to=https%3A%2F%2Fget.todoist.help%2Fhc%2Fen-us%2Farticles%2F360003223800"},_("Learn more")),t=A({c:"got_it"
},_("Got it")))),i=GB_showHTML(null,n,500,550,{close_validator_fn:function(){return!0}});$AEV([e,t],"click",function(){i.hide()})}};r.default=i,window.AssistantPromo=i},{"../../reducers/settings":445,"../../stores/store":456}],73:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../../models/DateExt"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=e("../../utils"),l=window,u=l.Signals,c=window,d=c.IstTooltip,f=window,p=f.IstComplete,m=window,h=m.GB_hide,v=window,y=v.GB_showHTML,g=window,b=g.DateUtils,w=window,E=w.Alerts,k=e("../agenda/Agenda.js"),S=e("../agenda/AgendaCurrentDays"),j=e("../projects_list/ProjectListUtils"),T=e("../project_editor/ProjectEditorManager"),O=e("../items_utils/ItemAddEditForm"),I=e("../items_utils/ItemCommonEdits"),P=e("../generic_manager/GenericManagerUtils.js"),C=e("../misc/Misc.js"),D=C.getMacAppVersion,M=e("../../models/ItemsModel"),x=e("../../models/Reminders"),R=x.BufferedRemindersModel,N=e("./SmartPrefilling"),L=function(){function e(){var t=this;n(this,e),this.toggle=this.toggle.bind(this),this._show=this._show.bind(this),this.addTask=this.addTask.bind(this),this.hide=this.hide.bind(this),this.externalServicesAnnotation=this.externalServicesAnnotation.bind(this),$AEV(document,["keydown","keypress"],function(e){if(!e.meta&&!e.alt&&81===e.keyAscii&&e.ctrl)return t.toggle(),$preventDefault(e),!1}),u.connect("external_service_annotation",this.externalServicesAnnotation),u.connect("natural_language_project_updated",function(e){if(t.shown&&t.form_data&&t.form_data.form.people_assigner){t.form_data.form.people_assigner.onProjectUpdated(e);var r=$gc(t.form_data.form,"td","people_assigner_holder");t.form_data.form.people_assigner.isShown()?$show(r):$hide(r)}})}return o(e,null,[{key:"initClass",value:function(){this.prototype.shown=!1,this.prototype.support_annotation=!0}}]),o(e,[{key:"toggle",value:function(){if(this.shown)return!1;var e=T.current_editor;e?e.saveCurrentItem(this._show):this._show()}},{key:"_show",value:function(){var e=this,t=void 0;d.hide();var r=D();if(r&&r>=6.4)return void u.sendSignal("show_quick_add");var n=$("quick_add_task_holder");$addClass($body(),"body_quick_add_task"),this.shown=!0;var o={cancel:P.genCancel("li",this.hide,this," "),action:this.addTask,submit_val:_("Add Task"),name_val:"",indent_arrows:!1,with_esc_cancel:!1,no_indent:!0,is_quick_add:!0,due_date_focus:function(){var e=function(){t.textarea&&t.textarea.proxyFocus(!0)},r=t.form.people_assigner;r&&r.isShown()?(r.opts.onExitFocus=function(){e()},r.showTooltip()):e()}},a=S.getNonOverdue();if(a.length>0){var s=a[0],l=b.dateistResultFromDate(s);o.due_date=i.default.fromDateist(l)}this.form_data=t=O.generateForm(o);var c=N.prefillLabel();c&&""===t.textarea.proxyGetValue()&&t.textarea.proxySetValue("@"+c+" "),$setHeight(t.textarea,19),this.holder=DIV({c:"quick_add_task manager",id:"quick_add_task"},t.form),$add(this.holder,this.quick_add_annotate=DIV({id:"quick_add_annotate"},this.quick_annotate_link=A({href:"#",class:"action",id:"quick_annotate_link"},this.quick_annotate_icon=null,this.quick_annotate_add_text=SPAN(_("Attach email to task"))))),$hide(this.quick_add_annotate),$setOpacity(this.quick_add_annotate,0);this.task_added=!1,y(_("Quick Add Task"),this.holder,210,550,{fn_arrow_left:function(){return $position(n).x+5},close_validator_fn:function(){var r=t.textarea;return!!e.task_added||(0!==$strip(r.proxyGetValue()).length?(E.confirm(_("Are you sure you want to discard your current task?"),function(t){return t?(e.hide(),R.reset()):r.proxyFocus(!0)},_("Discard task")),!1):(e.hide(),R.reset(),!0))},fn_left_offset:function(e,t){var r=$position(n);return $winSize().w<380?10:r.x-t.width/2-25},fn_top_offset:function(){return 40}}),t.textarea.proxyPlaceCursor();var f=$child(t.form,"a","submit_btn");return $AEV(f,"keydown",function(e){if(9===e.key)return t.textarea.proxyFocus(!0),!1}),this.externalServicesAnnotation(window.CURRENT_EXERNAL_SERVICE),!1}},{key:"addTask",value:function(e){track("task_form","click","add_from_quick_add");var t=O.parseFormData(e,this.current_pid);if(!t||""===t.content)return $gc(e,null,"richtext_editor").proxyFocus(!0),!1;O.genericAddItem(e,t),t=(0,s.omit)(t,["item_order","indent","order"]);var r=M.add(t);if(!r)return $gc(e,null,"richtext_editor").proxyFocus(!0),!1;R.reminders.length>0&&R.commitBuffered(r);var n=T.getEditorById(r.project_id);if(r.labels&&r.labels.length>0&&N.prefillLabel())u.sendSignal("instant_refresh_interface");else if(r.due&&!n){k.get().flash_item=r.id;var o=r.due.toDate();o.setHours(23,59,59,999),S.isAdded(o)?u.sendSignal("instant_refresh_interface"):I.notifyAddedTo(r,!0)}else n?(n.reRender(),j.flashItemIfNeeded(r.id)):I.notifyAddedTo(r,!1);return this.task_added=!0,this.hide(),!1}},{key:"hide",value:function(){return this.interval_set&&(clearTimeout(this.interval_set),this.interval_set=null),O.genericCancelEdit(),$remove(this.holder),$remove(this.sprite),this.support_annotation=!0,this.holder=this.sprite=this.shown=this.form_data=!1,$removeClass($body(),"body_quick_add_task"),p.hide(),$all("div","manage_reminders").length>0&&h(null,!1),h(null,!1),!0}},{key:"externalServicesAnnotation",value:function(e){var t=this;if(this.quick_annotate_link&&this.support_annotation&&this.support_annotation)if(e){$isHidden(this.quick_add_annotate)&&($show(this.quick_add_annotate),setTimeout(function(){return $setOpacity(t.quick_add_annotate,1)},10));var r=$child($("quick_add_task"),null,"richtext_editor");this.quick_annotate_link.onclick=$p(e.annotate_fn,r),$setHTML(this.quick_annotate_add_text,e.annotate_add_text)}else $setOpacity(this.quick_add_annotate,0),$hide(this.quick_add_annotate)}}]),e}();L.initClass(),t.exports=new L},{"../../models/DateExt":164,"../../models/ItemsModel":167,"../../models/Reminders":173,"../../utils":484,"../agenda/Agenda.js":5,"../agenda/AgendaCurrentDays":6,"../generic_manager/GenericManagerUtils.js":26,"../items_utils/ItemAddEditForm":28,"../items_utils/ItemCommonEdits":30,"../misc/Misc.js":43,"../project_editor/ProjectEditorManager":61,"../projects_list/ProjectListUtils":71,"./SmartPrefilling":74}],74:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../../stores/store"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=e("../../constants/constants"),l=e("../../reducers/labels"),u=e("../project_editor/ProjectEditorManager"),c=function(){function e(){n(this,e)}return o(e,[{key:"prefillProject",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=u.current_project_id;return e&&(t||(t=window.User.inbox_project)),t}},{key:"prefillLabel",value:function(){var e=i.default.getState(),t=e.mainView;if(t.type===s.MAIN_VIEW_TYPE_LABEL){return(0,l.labelGetByID)(i.default.getState(),t.id).name}}}]),e}();t.exports=new c},{"../../constants/constants":98,"../../reducers/labels":422,"../../stores/store":456,"../project_editor/ProjectEditorManager":61}],75:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){var r=DIV({class:"div_color counter_color",id:e});return $setStyle(r,"color",t),r}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../../reducers/mainView"),s=window,l=s.IstComplete,u=s.svgs,c=e("../projects_list/ProjectListUtils"),d=e("../notes/Notes.js"),f=e("../agenda/AgendaUtils"),p=e("../formatter/Formatter.js"),m=e("../../models/ProjectsModel"),h=e("../../models/ItemsModel"),v=e("../../models/LabelsModel"),y=e("../../models/FiltersModel"),g=e("../../models/Colors"),b=e("../../stores/store").default,w=function(e){var t=o("filter_color_"+e.id,g.getHex("filter",e.color));return $add(t,u.get("sm1/filter.svg")),t},E=function(e){var t=o("label_color_"+e.id,g.getHex("label",e.color));return $add(t,u.get("sm1/label.svg")),t},k=function(){function e(){n(this,e),this.attach=this.attach.bind(this)}return a(e,[{key:"attach",value:function(e){var t=this,r=void 0,n=function(e,t){var r=!0,n=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value;s.name||(s.name=s.content),s.name=s.name.replace(/[*!]+/g,""),s.type=t}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}return e},o=function(e){e=e.toLowerCase();var o=n(m.getByName(e),"project"),a=n(v.getByName(e),"label"),i=n(h.getByName(e,6),"item"),s=!1;if(window.User.is_premium)if("@"===e)t.complete_data.trigger="@",a=n(v.getAll(),"label"),s=!0;else if(0===e.indexOf("@")){t.complete_data.trigger="@";var l=e.slice(1);a=n(v.getByName(l).slice(0,6),"label")}if("#"===e)t.complete_data.trigger="#",s=!0,o=n(m.getAll(),"project");else if(0===e.indexOf("#")){t.complete_data.trigger="#";var u=e.slice(1);o=n(m.getByName(u).slice(0,6),"project")}var c=n(y.getByName(e).slice(0,6),"filter");c=c.concat(t.getByFilters(e));var d=!1;return!1===s&&o.length+a.length+i.length+c.length>=10&&(d=!0),d&&(o=o.slice(0,3),a=a.slice(0,3),i=i.slice(0,3),c=c.slice(0,3)),r=[],r=r.concat(o),r=r.concat(a),r=r.concat(i),r=r.concat(c),r=r.map(function(e){return e=Object.assign({},e),e.name&&(e.name=e.name.replace(/\s*:[^:]+:\s*/g,"")),e.forced=!0,e}),r.push({name:_("Show more results"),forced:!0,fixed_bottom:!0,type:"search"}),r},a=function(e,t){var n=void 0;switch(r=DIV(),$add(r,n=$setHTML(SPAN({c:"ist_complete_content"}),"<span>"+t+"</span>")),e.type){case"project":$ATT(r,DIV({c:"ist_complete_icon"},c.createColor(e,!1)));var o=m.getParent(e);o&&$add(n,I({c:"auto_complete_parent"},o.name));break;case"label":$ATT(r,DIV({c:"ist_complete_icon"},E(e)));break;case"filter":$ATT(r,DIV({c:"ist_complete_icon"},w(e)));break;case"item":var a=p.formatSimple(e.content);a=a.replace(/\[\[(?:outlook|gmail|thunderbird)=(.+?),\s*(.+?)\]\]/,"$2"),a=a.replace(/<[^>]+>/g,""),$setHTML(n,a),$ATT(n,DIV({c:"auto_complete_task"}));break;case"search":$addClass(r,"auto_complete_search"),$ATT(r,DIV({c:"ist_complete_icon"},u.get("sm2/magnifying_glass.svg")));break;default:$ATT(n,DIV())}return r},s=function(t,r){switch(r.type){case"project":c.setCurrentById(r.id,r.id,null,!0);break;case"item":window.User.is_premium?d.showItemNotes(r.id):c.setCurrentById(r.project_id,r.id);break;case"label":b.dispatch((0,i.showLabelView)(r.id,{bottomListSelected:!0}));break;case"filter":b.dispatch((0,i.showFilterView)(r.id,{bottomListSelected:!0}));break;case"search":var n="q:"+e.value;b.dispatch((0,i.showQueryView)(n));break;case"today":b.dispatch((0,i.showTodayView)());break;case"seven_days":b.dispatch((0,i.show7DaysView)())}return l.hide(),f.blur(),!1},g=function(e,t,r){t.istcomplete_word||(t.istcomplete_word=t.value,r.require_trigger=!1,r.wildcard_match=!0,r.omni_match=!0,r.onNoMatches=function(){return l.hide(),!1},r.collection=o,r.filterItem=a,r.onclick=s)};this.complete_data={preselect_match:!1,sort_results:!1,keyPressListener:g,collection:o,filterItem:a,onclick:s,var_height:"40vh",offset_top:6},l.attach(e,this.complete_data);var k=function(){0===e.value.length&&l.hide()};return $AEV(e,"focus",function(){track("navigation","tapped","quick_find")}),$AEV(e,"blur",function(){setTimeout(k,10)}),$AEV(e,"keyup",k),$AEV(e,"keydown",function(t){if(13===t.keyAscii){if(!$child(document,"td","current_match"))return track("navigation","enter","quick_find"),b.dispatch((0,i.showQueryView)(e.value)),e.blur(),!1}return!(13===t.keyAscii&&!t.shift&&l.isShown())&&((27!==t.keyAscii||!l.isShown())&&void 0)})}},{key:"getByFilters",value:function(e){var t=[],r=_("Today");-1!==r.toLowerCase().indexOf(e)&&t.push({name:r,type:"today"});var n=_("Next 7 days");return-1!==n.toLowerCase().indexOf(e)&&t.push({name:n,type:"seven_days"}),t}}]),e}();t.exports=new k},{"../../models/Colors":161,"../../models/FiltersModel":166,"../../models/ItemsModel":167,"../../models/LabelsModel":168,"../../models/ProjectsModel":171,"../../reducers/mainView":426,"../../stores/store":456,"../agenda/AgendaUtils":8,"../formatter/Formatter.js":22,"../notes/Notes.js":46,"../projects_list/ProjectListUtils":71}],76:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.IstComplete,s=window,l=s.IstTooltip,u=e("./AutoComplete"),c=function(){function e(){n(this,e),this.getValue=this.getValue.bind(this),this.setValue=this.setValue.bind(this),this.setPlaceholder=this.setPlaceholder.bind(this),this.focus=this.focus.bind(this),this.select=this.select.bind(this),this.blur=this.blur.bind(this),this.render=this.render.bind(this),this.renderSearchIcon=this.renderSearchIcon.bind(this),this.renderHelpIcon=this.renderHelpIcon.bind(this)}return o(e,[{key:"getValue",value:function(){return this.input.value}},{key:"setValue",value:function(e){this.input.value=e}},{key:"setPlaceholder",value:function(e){e||(e=_("Quick Find")),this.input_placeholder=e,this.input.placeholder=e}},{key:"focus",value:function(){this.input.focus()}},{key:"select",value:function(){this.input.select()}},{key:"blur",value:function(){this.input.placeholder=this.input_placeholder,this.input.value="",this.input.istcomplete_word="";try{this.input.blur()}catch(e){}}},{key:"render",value:function(){this.input_placeholder=_("Quick Find"),this.input=INPUT({class:"quick_find fixed_pos",type:"text text_box",placeholder:this.input_placeholder,autocomplete:"off",autocorrect:"off",spellcheck:"false"}),u.attach(this.input);var e=DIV();$add(e,this.renderSearchIcon()),$AEV(this.icon_search,"click",this.focus),$add(e,this.input);var t=this.renderHelpIcon();$add(e,t),$add($("quick_find"),e)}},{key:"renderSearchIcon",value:function(){return this.icon_search=svgs.get("sm1/search.svg",{className:"search_icon"}),this.icon_search}},{key:"renderHelpIcon",value:function(){var e=this,t=void 0;return this.icon_help=t=A({href:"/Help/Filtering",c:"help_icon",target:"_blank","data-track":"navigation|quick_find_help"},this.icon_help_sprite=svgs.get("sm1/question.svg")),$AEV(this.icon_help_sprite,"click",function(){return!0}),l.showSimpleText(t,SPAN(_("Open Quick Find by typing f"),BR(),_("Press here for more help")),null,10,-23),$hide(t),$AEV(this.input,"keydown",function(t){if(t.key&&"Escape"===t.key||27===t.keyCode)return i.isShown()?i.hide():e.input.blur(),!1}),$AEV(this.input,"focus",function(){$addClass(e.input,"quick_find_focused"),$addClass($("quick_find"),"is_focused"),$show(t)}),$AEV(this.input,"blur",function(){setTimeout(function(){$removeClass(e.input,"quick_find_focused"),$removeClass($("quick_find"),"is_focused"),$hide(t)},200),setTimeout(i.hide,300)}),t}}]),e}();t.exports=new c},{"./AutoComplete":75}],77:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=e("../../logger/Logger"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o),i=e("../../stores/store"),s=n(i),l=e("../../stores/subscribeSelected"),u=n(l),c=void 0,d=void 0,f=window,p=f.GB_getLast,m=window,h=m.Signals,_=e("../agenda/Agenda.js"),v=e("../../components/project_editor/ProjectEditorManager"),y=e("../../components/projects_list/ProjectList"),g=e("../../models/StateModel"),b=e("../../menus/MenuProjectList.js"),w=e("../../menus/MenuProjectEditor.js"),E=e("../../menus/MenuAgendaEdit.js"),k=e("../../components/onboarding/Onboarding"),S=window.isEditingOn=function(){var e=b.get()||{},t=w.get()||{},r=E.get()||{},n=!1;n=n||p(),n=n||g.get("drag_and_drop_mode")===g.DragMode.reordering,(v.current_form||t.shown||r.shown)&&(n=!0);var o=v.getCurrentEditor();return o&&o.isArchived()&&(n=!0),e.shown&&(n=!0),$all("form","section_form").length>0&&(n=!0),$all("li","manager").length>0&&(n=!0),$all("div","drag_and_drop_handler").length>0&&(n=!0),$all("li","selected").length>0&&(n=!0),$all("div","scheduler").length>0&&(n=!0),k.isCompleteAnimationInProgress()&&(n=!0),n},j=function(){return $$(".search_holder").length>0};r.refreshInterface=d=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(S()||j())&&!0!==e?(window.refresh_to&&(clearTimeout(window.refresh_to),window.refresh_to=null),window.refresh_to=setTimeout($p(d,e),500)):(window.refresh_real&&(clearTimeout(window.refresh_real),window.refresh_real=null),window.refresh_real=setTimeout($p(T,e),50))},r.instantRefreshInterface=c=function(){window.refresh_to&&(clearTimeout(window.refresh_to),window.refresh_to=null),window.refresh_real&&(clearTimeout(window.refresh_real),window.refresh_real=null),T(!0)};var T=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{if(!1===e&&S())return d(e),!1;var t=_.get();y.is_inited&&y.reRender();var r=v.getCurrentEditor();if(r&&r.isArchived())return d(!1),!1;v.current_editor?h.sendSignal("projects.rerender.all"):$("agenda_view")&&t.refresh&&t.refresh()}catch(e){a.captureError(e,{tags:{where:"RefreshInterface"}})}};h.connect("refresh_interface",d),h.connect("instant_refresh_interface",c),(0,u.default)(s.default,function(e){return e.clock},function(){c()}),document.addEventListener("visibilitychange",function(){"visible"===document.visibilityState&&d()})},{"../../components/onboarding/Onboarding":52,"../../components/project_editor/ProjectEditorManager":61,"../../components/projects_list/ProjectList":70,"../../logger/Logger":141,"../../menus/MenuAgendaEdit.js":146,"../../menus/MenuProjectEditor.js":150,"../../menus/MenuProjectList.js":152,"../../models/StateModel":177,"../../stores/store":456,"../../stores/subscribeSelected":457,"../agenda/Agenda.js":5}],78:[function(e,t,r){"use strict";var n=window.Signals,o=window.TooptipWin,a=window.GB_showHTML,i=e("./RemindersManager"),s=e("../../containers/premium_promo/PremiumOnlyModal"),l=e("../../models/Reminders").RemindersModel,u={current_manager:null,renderHolder:function(e){var t=DIV();return this.current_manager=new i(e,t),this.current_manager.render(),t},showTooltip:function(e,t){if(!l.featureEnabled())return s.showReminder();var r=$position(t),a=u.renderHolder(e),i={fn_left_offset:function(){return window.MINI_VERSION?r.x-220:r.x-180},fn_top_offset:function(){return r.y+35},fn_arrow_left:function(){return r.x+8},fixed_pos:$hasClass(t,"fixed_pos"),fn_on_hide:function(){var e=u.current_manager;e&&(e.clean(),u.current_manager=null),n.sendSignal("focus_current_item_input")}},c=o.show(_("Reminders"),a,210,300,i);$addClass(c.g_window,"manage_reminders")},show:function(e){if(!l.featureEnabled())return s.showReminder();var t=u.renderHolder(e);return a(_("Reminders"),t,350,300),!1}};t.exports=u},{"../../containers/premium_promo/PremiumOnlyModal":120,"../../models/Reminders":173,"./RemindersManager":82}],79:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../../utils"),i=window,s=i.DateUtils,l=window,u=l.DateistDateHelpers,c=window,d=c.IstButton,f=window,p=f.GB_hide,m=window,h=m.IstCompleteSelect,v=e("../avatars/Avatars"),y=e("../opener/WindowOpener.js"),g=e("../../models/Reminders"),b=g.BufferedRemindersModel,w=e("../../models/Reminders"),E=w.RemindersModel,k=e("../../models/Collaborators"),S=e("../../menus/MenuRemindersTypes"),j=e("./RemindersLocation"),T=e("./RemindersConst.js"),O=e("../../containers/premium_promo/PremiumOnlyModal"),I=e("../../models/DateExt").default,P=e("../themes/Themes"),C=_x("reminder_notify","Me"),D=function(){function e(t,r){n(this,e),this.onChangeInterface=this.onChangeInterface.bind(this),this.reRender=this.reRender.bind(this),this.render=this.render.bind(this),this.renderAbsolute=this.renderAbsolute.bind(this),this.renderRelative=this.renderRelative.bind(this),this.addReminder=this.addReminder.bind(this),this.generateSharedServices=this.generateSharedServices.bind(this),this.renderServiceSelector=this.renderServiceSelector.bind(this),this.clean=this.clean.bind(this),this.manager=t,r&&r.due&&r.due.with_time?this.current_interface="relative":this.current_interface="absolute";var o=window.User.auto_reminder;void 0!==o&&-1!==o||(o=30),this.relative_items=[];for(var a in T.min_to_words){var i=T.min_to_words[a];a=parseInt(a);var s={id:a,name:i};a===o&&(this.current_relative_select=s),this.relative_items.push(s)}S.init()}return o(e,[{key:"onChangeInterface",value:function(e){return"location"===e&&!window.User.is_premium&&$all("li","reminder").length>=1?O.showReminder():(this.current_interface=e,this.reRender(),S.get().hide(),!1)}},{key:"reRender",value:function(){var e=this.adder;$swap(e,this.render()),$remove(e)}},{key:"render",value:function(){var e=this,t=void 0;this.adder_below=DIV({c:"adder_below"}),t="absolute"===this.current_interface?this.renderAbsolute():"relative"===this.current_interface?this.renderRelative():j.render(this.adder_below);var r=d.createButton(_("Add reminder"),null,"red");return $AEV(r,"click",function(){return e.addReminder(),!1}),this.adder=DIV(DIV({c:"adder"},this.renderSwitcher(),t),this.adder_below,DIV(A({href:"/Help/Reminders",target:"_blank",c:"help"},svgs.get("sm1/question.svg")),r)),this.adder}},{key:"renderAbsolute",value:function(){var e=this,t=_("today at 2pm"),r=this.absolute_input=INPUT({placeholder:t});return $AEV(r,"keydown",function(t){if(13===t.keyAscii)return e.addReminder(),!1}),setTimeout(function(){return r.focus()},150),DIV({c:"absolute"},this.renderServiceSelector(),r)}},{key:"renderRelative",value:function(){var e=this,t=void 0,r=function(){return _("%s before").replace("%s",e.current_relative_select.name)},n=A({href:"#",c:"icon relative_selector"},t=SPAN(r()),svgs.get("sm1/caret.svg"));return $AEV(n,"click",function(){var o={selectedItem:function(){return e.current_relative_select},collection:function(){return e.relative_items},filterItem:function(e){return DIV({c:"complete_item"},e.name)},onSelect:function(n){return e.current_relative_select=n,$replace(t,r()),p()},wildcard_match:!0},a=new h(o);return a.showTooltip({icon:n,title:_("Remind me"),arrow_left_offset:5,top_offset:35,left_offset:30,fn_on_hide:function(){return a=null}}),!1}),DIV({c:"relative"},this.renderServiceSelector(),n)}},{key:"checkReminderLimit",value:function(){return"location"===this.current_interface&&E.hasExceededMaxLimitForLocRmd()?(alert(_("You\u2019ve reached the location-based reminder limit.")+"\n\n"+(0,a.format)(_("We limit the number of location-based reminders to {n} per account to keep the app fast and stable. Delete old reminders to make room for more."),{n:300})),!1):"location"===this.current_interface||!E.hasExceededMaxLimitForTimeRmd()||(alert(_("You\u2019ve reached the reminder limit.")+"\n\n"+(0,a.format)(_("We limit the number of reminders to {n} per account to keep the app fast and stable. Delete old reminders to make room for more."),{n:700})),!1)}},{key:"addReminder",value:function(){var e=this;if(!window.User.is_premium&&$all("li","reminder").length>=1)return O.showReminder();if(this.checkReminderLimit()){var t=function(t){return b.add(t),e.manager.viewer.reRender(),e.absolute_input&&(e.absolute_input.value=""),e.manager.updateParentItem(!0)};if("location"===this.current_interface)j.getPlaceResolved(function(e){if(!e)return alert(_("Please select a location first"),function(){return j.input.focus()}),!1;var r={item_id:b.getCurItem().id,type:"location"};return $update(r,e),j.reset(),j.input.focus(),t(r)});else{var r={item_id:b.getCurItem().id,service:"default"};if("absolute"===this.current_interface){var n=this.parseDate(this.absolute_input.value);if(n.error)return alert(n.error,function(){var t=function(){return e.absolute_input.focus()};return setTimeout(t,200)}),!1;r.due=I.fromDateist(n),r.type="absolute"}else r.minute_offset=this.current_relative_select.id,r.type="relative";this.current_service_select&&this.current_service_select.notify_uid&&(r.notify_uid=this.current_service_select.notify_uid),t(r)}return!1}}},{key:"renderSwitcher",value:function(){var e=this.getReminderTypeIcon(this.current_interface),t=svgs.get("sm1/caret.svg");$addClass(t,"menu_icon");var r=A({href:"#",c:"switcher menu"},e,t);return $AEV(r,"click",function(e){return S.get().toggle(r,r,e),!1}),r}},{key:"generateSharedServices",value:function(e){var t=[],r={notify_uid:window.User.id,name:C+" ("+window.User.full_name+")"};$update(r,window.User),t.push(r);var n=!0,o=!1,a=void 0;try{for(var i,s=k.getAll(e)[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value,u={notify_uid:l.id};$update(u,l),l.id!==window.User.id&&(u.name=l.full_name.split(" ")[0],t.push(u))}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return t}},{key:"renderServiceSelector",value:function(){var e=this,t=b.getCurItem();if(k.isProjectShared(t.project_id)){var r=_("Who to notify"),n=function(){var t=e.current_service_select;return v.renderAvatar(t,"small",P.theme)};this.current_service_select=window.User;var o=o=SPAN(n()),a=A({href:"#",c:"service_selector"},o,svgs.get("sm1/caret.svg")),i=this.generateSharedServices(t.project_id);return $AEV(a,"click",function(){var t={selectedItem:function(){return e.current_service_select},collection:function(){return i},filterItem:function(e){var t=void 0,r=void 0;return e.notify_uid?(t=v.renderAvatar(e,"small",P.theme),r=e.name):(t=v.renderAvatar(window.User,"small",P.theme),r=C+" ("+e.name+")"),DIV({c:"complete_item"},t,r)},onSelect:function(t){if(p(),"settings"===t.id?y.showPrefs("reminders"):(e.current_service_select=t,$replace(o,n())),e.absolute_input)return e.absolute_input.focus()},wildcard_match:!0},s=new h(t);return s.showTooltip({icon:a,title:r,arrow_left_offset:5,top_offset:35,left_offset:170,fn_on_hide:function(){return s=null}}),!1}),a}}},{key:"clean",value:function(){$remove(this.adder),$remove(this.adder_below),$remove(this.absolute_input),this.manager=null,this.adder=null,this.adder_below=null,this.absolute_input=null}},{key:"parseDate",value:function(e){var t=s.parse(e);if(""===e)return{error:_("Date can't be empty")};if(t.error||!t.due_date)return{error:_("Invalid date")};if(t.due_date&&!u.has_time(t.due_date)){var r=t;if(t=s.parse(t.date_string+" @ 9:00"),t.due_date){var n=new Date;if(u.day_diff(n,t.due_date)>=365){var o=n.getHours()+3,a="00";o>23&&(o=23,a=29),t=s.parse(r.date_string+" @ "+o+":"+a)}}}return t}},{key:"getReminderTypeIcon",value:function(e){switch(e){case"absolute":return svgs.get("sm1/history.svg");case"relative":return svgs.get("sm1/clock.svg");case"location":return svgs.get("sm1/location_mark.svg");default:return svgs.get("sm1/history.svg")}}}]),e}();t.exports=D},{"../../containers/premium_promo/PremiumOnlyModal":120,"../../menus/MenuRemindersTypes":154,"../../models/Collaborators":160,"../../models/DateExt":164,"../../models/Reminders":173,"../../utils":484,"../avatars/Avatars":17,"../opener/WindowOpener.js":53,"../themes/Themes":95,"./RemindersConst.js":80,"./RemindersLocation":81}],80:[function(e,t,r){"use strict";t.exports.min_to_words={0:_("0 min"),10:_("10 min"),30:_("30 min"),45:_("45 min"),60:_("1 hour"),120:_("2 hours"),180:_("3 hours"),1440:_("1 day"),2880:_("2 days"),4320:_("3 days"),10080:_("1 week")}},{}],81:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Indicator,s=window,l=s.GB_hide,u=window,c=u.IstCompleteSelect,d=e("../../models/RemindersLocationModel"),f=function(){function e(){n(this,e),this.render=this.render.bind(this),this.getPlace=this.getPlace.bind(this),this.getPlaceResolved=this.getPlaceResolved.bind(this),this.reset=this.reset.bind(this),this._render=this._render.bind(this),this.initGoogleMaps=this.initGoogleMaps.bind(this),this.selectLocation=this.selectLocation.bind(this),this.showLastLocations=this.showLastLocations.bind(this),this.loadGoogle=this.loadGoogle.bind(this),this.loaded=this.loaded.bind(this),this.nearbySearch=this.nearbySearch.bind(this),this.load_timeout=null,this.callbacks=[]}return o(e,[{key:"render",value:function(e){var t=this;if(window.google&&window.google.maps)return this._render(e),this.holder;var r=DIV({c:"location_selecter_holder"},i.cssSpinner()),n=function(){$replace(r,t._render(e))};return this.loadGoogle(n),r}},{key:"formatPlace",value:function(e,t){return{name:e,loc_lat:""+t.lat(),loc_long:""+t.lng(),loc_trigger:$selectValue(this.gtrigger),radius:100}}},{key:"getPlace",value:function(){if(this.place&&this.gmarker){var e=this.gmarker.getPosition();return this.formatPlace(this.place.name,e)}}},{key:"getPlaceResolved",value:function(e){var t=this;if(this.place&&this.gmarker){var r=this.gmarker.getPosition();this.start_location&&r.lat()===this.start_location.lat()&&r.lng()===this.start_location.lng()?e(this.formatPlace(this.place.name,r)):this.nearbySearch(r,function(n){n=n||t.place.name,e(t.formatPlace(n,r))})}else e(null)}},{key:"reset",value:function(){this.input.value="",$hide(this.gholder),this.place=null,this.start_location=null}},{key:"_render",value:function(e){var t=this,r=A({href:"#",c:"service_selector"},svgs.get("sm1/caret.svg"),svgs.get("sm1/location_mark.svg"));return r.reuseable=!0,$AEV(r,"click",$p(this.showLastLocations,r)),this.holder||(this.holder=DIV({c:"location_selecter"},r,this.input=INPUT({type:"text",placeholder:_("Type location"),reuseable:!0})),this.initGoogleMaps(this.input,e)),this.place=null,this.input.value="",setTimeout(function(){t.input.focus()},100),$AEV(this.input,"keyup",function(){""===t.input.value&&$hide(t.gholder)}),$hide(this.gholder),$replace(e,this.gholder),this.holder}},{key:"initGoogleMaps",value:function(e){var t=this;if(this.gholder)return this.gholder;var r=new window.google.maps.places.Autocomplete(e);this.gholder=DIV({c:"map_holder"},this.map_canvas=DIV({c:"map"}),this.gtrigger=SELECT(OPTION({value:"on_enter",selected:"selected"},_("When I arrive")),OPTION({value:"on_leave"},_("When I leave")))),window.google.maps.event.addListener(r,"place_changed",function(){t.place=r.getPlace(),t.place.geometry&&t.selectLocation(t.place.geometry)})}},{key:"selectLocation",value:function(e){if($show(this.gholder),!this.gmap){var t={zoom:17,mapTypeControl:!1,zoomControl:!0,streetViewControl:!1};this.gmap=new window.google.maps.Map(this.map_canvas,t),this.gmarker=new window.google.maps.Marker({map:this.gmap,anchorPoint:new window.google.maps.Point(0,-29),draggable:!0})}this.gmarker.setPosition(e.location),this.gmarker.setVisible(!0),this.start_location=this.gmarker.getPosition(),e.viewport?this.gmap.fitBounds(e.viewport):(this.gmap.setCenter(e.location),this.gmap.setZoom(17))}},{key:"showLastLocations",value:function(e){var t=this,r={selectedItem:function(){return null},collection:function(){var e=[],t=!0,r=!1,n=void 0
;try{for(var o,a=d.getLastLocations()[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;e.push({name:i[0],loc_lat:parseFloat(i[1]),loc_long:parseFloat(i[2])})}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return e},filterItem:function(e,t){return $setHTML(DIV({c:"complete_item"}),t)},txt_no_matches_found:_("No recent locations found."),onSelect:function(e){t.place={name:e.name},t.input.value=e.name;var r={location:new window.google.maps.LatLng(e.loc_lat,e.loc_long),viewport:null};return t.selectLocation(r),l(),!1},wildcard_match:!0},n=new c(r);return n.showTooltip({icon:e,title:_("Recent locations"),arrow_left_offset:5,top_offset:35,left_offset:170,fn_on_hide:function(){return n=null}}),!1}},{key:"loadGoogle",value:function(e){var t=this;if(!window.google||!window.google.maps)return this.load_timeout&&clearTimeout(this.load_timeout),this.callbacks.push(e),$add($body(),SCRIPT({src:"https://maps.googleapis.com/maps/api/js?libraries=places&async=2&callback=RemindersLocation.loaded&key=AIzaSyCXMDZI-DQwpQ72521KB_V45LXL1Zm_lHU&sensor=false"})),this.load_timeout=setInterval(function(){window.google&&window.google.maps&&t.loaded()},500)}},{key:"loaded",value:function(){this.load_timeout&&(clearTimeout(this.load_timeout),this.load_timeout=null);var e=!0,t=!1,r=void 0;try{for(var n,o=this.callbacks[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){(0,n.value)()}}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}this.callbacks=[]}},{key:"nearbySearch",value:function(e,t){var r=new window.google.maps.LatLng(e.lat(),e.lng()),n={location:r,radius:"5"};new window.google.maps.places.PlacesService(this.gmap).nearbySearch(n,function(e){return t(e&&e.length>0?e[0].name:null)})}}]),e}();window.RemindersLocation=new f,t.exports=window.RemindersLocation},{"../../models/RemindersLocationModel":174}],82:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../../models/Reminders"),i=a.BufferedRemindersModel,s=e("../../models/ItemsModel"),l=e("../items_utils/ItemDueDates.js"),u=e("./RemindersAdder"),c=e("./RemindersViewer"),d=e("../../menus/MenuRemindersTypes"),f=function(){function e(t,r){n(this,e);var o=void 0;this.render=this.render.bind(this),this.updateParentItem=this.updateParentItem.bind(this),this.holder=r,t?(o=s.getById(t.json.id))&&(i.cur_item=o,i.use_buffered=!1):(i.use_buffered=!0,o=i.getCurItem()),this.viewer=new c(this),this.adder=new u(this,o),d.init(this),o&&o.due&&o.due.with_time?d.get().setRelativePossible(!0):d.get().setRelativePossible(!1),window.REMINDER_MANAGER=this}return o(e,null,[{key:"initClass",value:function(){this.prototype.min_to_words={0:_("0 min"),10:_("10 min"),30:_("30 min"),45:_("45 min"),60:_("1 hour"),120:_("2 hours"),180:_("3 hours"),1440:_("1 day"),2880:_("2 days"),4320:_("3 days"),10080:_("1 week")}}}]),o(e,[{key:"render",value:function(){var e=DIV({c:"reminder_manager"},this.viewer.render(),this.adder.render());$replace(this.holder,e)}},{key:"updateParentItem",value:function(e){if(!i.use_buffered){var t=i.getCurItem();if(!t)return;var r=!0,n=!1,o=void 0;try{for(var a,s=$all("li","item_"+t.id)[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,c=$all("span","date",u);c=c.length>0?c[0]:$all("td","column_project",u)[0],l.updateAlarmIcon(c,e)}}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}}var d=$("reminders_icon");this.viewer.is_empty?$removeClass(d,"active"):$addClass(d,"active")}},{key:"clean",value:function(){this.adder.clean(),this.viewer.clean(),this.adder=null,this.viewer=null,window.REMINDER_MANAGER=null}}]),e}();f.initClass(),t.exports=f},{"../../menus/MenuRemindersTypes":154,"../../models/ItemsModel":167,"../../models/Reminders":173,"../items_utils/ItemDueDates.js":31,"./RemindersAdder":79,"./RemindersViewer":83}],83:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../../utils"),i=window,s=i.DateistDateHelpers,l=window,u=l.DateUtils,c=window,d=c.svgs,f=e("../avatars/Avatars"),p=e("../../models/Reminders"),m=p.BufferedRemindersModel,h=e("../../models/Collaborators"),v=e("./RemindersConst.js"),y=e("../themes/Themes"),g=function(e){switch(e){case"absolute":return d.get("sm1/history.svg");case"relative":return d.get("sm1/clock.svg");case"location":return d.get("sm1/location_mark.svg");default:return d.get("sm1/history.svg")}},b=function(){function e(t){n(this,e),this.reRender=this.reRender.bind(this),this.render=this.render.bind(this),this.deleteNotification=this.deleteNotification.bind(this),this.clean=this.clean.bind(this),this.manager=t}return o(e,null,[{key:"initClass",value:function(){this.renderRaw=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=void 0;void 0===r.delete_possible&&(r.delete_possible=!0);var o=UL({c:"reminder_viewer"});0===t.length&&$addClass(o,"is_empty"),n=!!h.isProjectShared(e.project_id);var i=!0,l=!1,c=void 0;try{for(var p,m=t[Symbol.iterator]();!(i=(p=m.next()).done);i=!0){var b,w=p.value,E=null;if(n){var k=h.getUserById(w.notify_uid||window.User.id);k&&(E=f.renderAvatar(k,"small",y.theme))}E||(E=g(w.type));var S="",j="";if("absolute"===w.type)if(w.due.is_recurring){var T=w.due.string;S=T}else{var O=w.due.toDate(),I=u.humanizeDayDiff(s.day_diff(new Date,O),O);S=I}else if("relative"===w.type){var P=v.min_to_words[w.minute_offset];S=void 0!==P?_("%s before").replace("%s",P):(0,a.format)(_nx("reminder","1 min before","{n} min before",w.minute_offset),{n:w.minute_offset})}else"location"===w.type&&(S=w.name,j="on_enter"===w.loc_trigger?_("When I arrive"):_("When I leave"));r.delete_possible&&(b=A({href:"#",c:"trash"},d.get("sm1/trash.svg")),$AEV(b,"click",$p(r.fn_delete_notification,w.id)));var C=void 0;C=j.length>0?SPAN({c:"text"},B(S),BR(),j):SPAN({c:"text"},B(S)),$add(o,LI({c:"reminder"},b,DIV(E,C)))}}catch(e){l=!0,c=e}finally{try{!i&&m.return&&m.return()}finally{if(l)throw c}}return o}}}]),o(e,[{key:"reRender",value:function(){var e=this.viewer;$swap(e,this.render()),$remove(e)}},{key:"render",value:function(){var t=m.getCurrentReminders(),r=m.getCurItem();0===t.length?this.is_empty=!0:this.is_empty=!1;var n={fn_delete_notification:this.deleteNotification};return this.viewer=e.renderRaw(r,t,n),this.viewer}},{key:"deleteNotification",value:function(e){m.remove(e),this.reRender();var t=m.getCurrentReminders();return this.manager.updateParentItem(t.length>0),!1}},{key:"clean",value:function(){$remove(this.viewer),this.manager=null,this.viewer=null}}]),e}();b.initClass(),t.exports=b},{"../../models/Collaborators":160,"../../models/Reminders":173,"../../utils":484,"../avatars/Avatars":17,"../themes/Themes":95,"./RemindersConst.js":80}],84:[function(e,t,r){"use strict";var n=new Class({init:function(e,t){$bindMethods(this),this.field=e,this.clone=ICE.DIV({class:"auto_exapnd_clone"},"-"),$add($body(),this.clone),$addClass(e,"auto_exapnd");var r="keypress";this.extra_h=0,($isIe()||$isSafari())&&(r="keydown"),$AEV(e,r,this.keyPress),$AEV(e,"focus",this.resize);var n=this;$AEV(e,"paste",function(){setTimeout(n.resize,100)}),e.resize_textarea=this.resize,e.resize=this.resize,this.escape_cr=!1!==t},keyPress:function(){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(this.resize,10)},resize:function(){var e=this.field,t=this.clone;if(e&&0!==e.clientHeight){t.style.width=e.offsetWidth+"px";var r;if(r=e.proxyGetValue?e.proxyGetValue():e.value,r=r.replace(/</g,"&gt;"),r=r.replace(/\n\r?/g,"<br>--"),""===r&&(r="T"),this.clone.innerHTML=r,t.offsetHeight!=this.old_height){var n=t.offsetHeight;e.style.height=n+this.extra_h+"px",this.old_height=n}}},remove:function(){$remove(this.clone),this.clone=null,this.field=null}});t.exports=n},{}],85:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=window,s=i.LibEdit,l=window,u=l.DateUtils,c=window,d=c.Dateist,f=window,p=f.DateistUtils,m=window,h=m.IstComplete,v=window,y=v.Signals,g=window,b=(g.$static_path,e("../project_editor/ProjectEditorManager")),w=e("../../models/LabelsModel"),E=e("../../models/ProjectsModel"),k=e("../../models/Collaborators"),S=e("../../models/DateExt").default,j=function(){function e(){n(this,e),this.annotateFormData=this.annotateFormData.bind(this),this.attach=this.attach.bind(this),this.setCurrentProject=this.setCurrentProject.bind(this),this.setCurrentPerson=this.setCurrentPerson.bind(this),this.deselectPriority=this.deselectPriority.bind(this),this.generateUserMatcher=this.generateUserMatcher.bind(this),this.generateProjectMatcher=this.generateProjectMatcher.bind(this);var t=_("priority");this.re_priority=new RegExp("(?:(?:^|\\s)!!|\\bp|"+t+")\\s*(1|2|3|4)(?=\\s|$)","g")}return a(e,null,[{key:"initClass",value:function(){this.prototype.truncate_links=!1,this.prototype.highlight_labels=!0,this.prototype.highlight_project=null,this.prototype.highlight_person=null,this.prototype.highlight_priority=null,this.prototype.re_labels=/(?:^|\s+)@([^\s,]+)/g,this.prototype.re_links=/[\w-]+:\/\/[^\s]+/g,this.prototype.re_special_chars=/([+.?*+^$[\]\\(){}|_&-])/g}}]),a(e,[{key:"annotateFormData",value:function(e,t){var r=void 0,n={};for(var o in e.matches){var a=e.matches[o];switch(a[0]){case"priority":this.highlight_priority&&(t.content=t.content.replace(a[1],""),t.priority=5-a[2]);break;case"date":t.content=t.content.replace(a[1],""),r=a[2],r&&r.has_only_time&&t.due?t.due=t.due.inheritDate({year:t.due.getFullYear(),month:t.due.getMonth(),day:t.due.getDate(),hours:r.due_date.getHours(),minutes:r.due_date.getMinutes(),seconds:0},{withTime:!0,timezone:t.due.timezone}):t.due=S.fromDateist(r);break;case"project":this.highlight_project&&(t.content=t.content.replace(a[1],""),t.project_id=this.highlight_project[0],t.item_order=null,t.indent=1);break;case"person":this.highlight_person&&(t.content=t.content.replace(a[1],""),t.responsible_uid=this.highlight_person[0],t.inherit_asignee=!1);break;case"label":this.highlight_labels&&(n[a[3]]=a)}}var i=[],s=!0,l=!1,u=void 0;try{for(var c,d=$$("b.t_label",e)[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value,p=f.json[3];if(p&&-1!==p.indexOf("@")){var m=n[p],h=w.getByName(p.replace("@",""),!1);h.length>0&&m&&(h=h[0],t.content=t.content.replace(m[1],""),i.push(h.id))}}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}return t.labels=i,t.content=$strip(t.content.replace(/\s\s+/," ")),t}},{key:"attach",value:function(e,t){var r=this,n=void 0,a=void 0;d.clear_free_text_cache(),e.ignored={},e.matches={},e.initial_has_content=t,e.dateist_disabled=!1,this.highlight_project=null,this.highlight_person=null,this.highlight_priority=null,this.re_project_matchers=null,this.user_matcher_cache={},this.generateProjectMatcher();var i=function(t,o){t=t.replace(/``/g,"'"),"t_link"===o&&(r.truncate_links=!1),n=s.getCaretOffsetWithin(e),s.setCaretPositionWithin(e,n.start);var i=function(t){e.matches[t]&&delete e.matches[t],e.ignored[t]=!0};if("t_date"===o){a=p.is_spaceless_lang(window.DATEIST_LANG);var l=d.split_text(t,window.DATEIST_LANG),u=0,c=!0,m=!1,_=void 0;try{for(var v,y=l[Symbol.iterator]();!(c=(v=y.next()).done);c=!0){var g=(v.value,""),b=!0,w=!1,E=void 0;try{for(var k,S=l.slice(u)[Symbol.iterator]();!(b=(k=S.next()).done);b=!0){var j=k.value;a?g+=j:g=g+" "+j,g=p.trim(g),i(g)}}catch(e){w=!0,E=e}finally{try{!b&&S.return&&S.return()}finally{if(w)throw E}}u+=1}}catch(e){m=!0,_=e}finally{try{!c&&y.return&&y.return()}finally{if(m)throw _}}}else"t_project"===o?r.setCurrentProject(null):"t_person"===o&&r.setCurrentPerson(null);return i(t),h.hide(),f(),!1};e.ignore_match=i;var l=function(t){e.matches[t]&&delete e.matches[t],e.ignored[t]=!0},c=function(e){var t=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&"));return a=p.is_spaceless_lang(window.DATEIST_LANG),t=a?"(^|\\s*)"+t:"(^|\\s+)"+t+"(?:$|(?=[\\s\\)\\]]+))",new RegExp(t,"gi")},f=function(){var n=void 0,a=void 0,s=void 0,d=void 0,f=void 0,p=void 0,m=void 0,_={},v=e.proxyGetValue();v=v.replace(/\n/g," ");var y=v.match(r.re_priority);if(y){y=v.match($last(y)),p=$strip(y[0]);var g=parseInt(p.match(/\d+/)[0]);e.ignored[p]||(r.highlight_priority=_[p]=["priority",c(p),parseInt(g),p])}if(r.highlight_labels){var k=v.match(r.re_labels);if(k){var S=null;h.current_input&&(S=h.current_input.istcomplete_word||null);var j=!0,T=!1,O=void 0;try{for(var I,P=k[Symbol.iterator]();!(j=(I=P.next()).done);j=!0){var C=I.value;if(C=$strip(C),S!==C){w.getByName(C.replace("@","").toLowerCase()).length>0&&(e.ignored[C]||(_[C]=["label",c(C),C,C.replace("$","$$$$")]))}}}catch(e){T=!0,O=e}finally{try{!j&&P.return&&P.return()}finally{if(T)throw O}}}}var D=window.User;if(!(void 0!==D.features.dateist_inline_disabled?D.features.dateist_inline_disabled:D.dateist_inline_disabled)&&!e.dateist_disabled){var A=u.parse(v,null,!0,e.ignored);if(A&&A.due_date){var M=A.date_string_matched,x=A.pos[0];"@"===(0===x?null:v[x-1])||0===M.indexOf("@")||e.ignored[M]||(_[M]=["date",c(M),A,M])}}if(r.truncate_links){var R=v.match(r.re_links);if(R){var N=!0,$=!1,L=void 0;try{for(var U,V=R[Symbol.iterator]();!(N=(U=V.next()).done);N=!0){var F=U.value;e.ignored[F]||(_[F]=["link",c(F),F,F])}}catch(e){$=!0,L=e}finally{try{!N&&V.return&&V.return()}finally{if($)throw L}}}}if(r.re_project_matchers&&(r.highlight_project&&r.highlight_project[2]||v.match(/#[^\s]+/)&&(n=r.genericPersonProjectMatcher(e,v,r.re_project_matchers))&&(r.highlight_project=n)),r.highlight_project){var B=Array.from(r.highlight_project),H=o(B,3);d=H[0],s=H[1],H[2],_[s]=["project",c(s),d,s]}if(v.match(/\+[^\s]+/)){if(d=null,r.highlight_project)d=r.highlight_project[0];else{var G=b.getCurrentEditor();G&&(d=G.project_id)}if(d){var z=E.get(d);if(z&&z.shared){var q=r.generateUserMatcher(d);n=r.genericPersonProjectMatcher(e,v,q),n&&(r.highlight_person=n)}}}if(r.highlight_person){var W=void 0,Y=Array.from(r.highlight_person),K=o(Y,3);W=K[0],s=K[1],K[2],_[s]=["person",c(s),W,s]}if(t=e.initial_has_content){for(p in _)f=_[p],"date"===f[0]&&(m=f[4]||f[3],e.ignored[m]=!0,delete _[p]);e.initial_has_content=!1}var J=v;for(p in _){var Q;if(f=_[p],m=f[4]||f[3],"link"===f[0])Q="";else if(Q=r.getIcon(f[0]),"priority"===f[0]){var X=m.indexOf(f[2]);m="\u27e6i\u27e7"+m.substring(0,X)+"\u27e6/i\u27e7"+m.substring(X)}else"date"!==f[0]&&(m="\u27e6i\u27e7"+m.substring(0,1)+"\u27e6/i\u27e7"+m.substring(1));a=f[3].replace(/'/g,"``").replace("$","$$$$"),a!==f[3]&&(_[a]=f,delete _[f[3]]),J=J.replace(f[1],"$1\u27e6b id='"+a+"' class='t_"+f[0]+"'\u27e7"+Q+"\u27e6span\u27e7"+m+"\u27e6/span\u27e7\u27e6/b\u27e7")}if(t){"\u27e7"===J.charAt(J.length-1)&&(J+=" ")}e.proxySetValue(J,!1);var Z=!0,ee=!1,te=void 0;try{for(var re,ne=$all("b",null,e)[Symbol.iterator]();!(Z=(re=ne.next()).done);Z=!0){var oe=re.value;oe.onclick=oe.ignore_match=$p(i,oe.id,oe.className),oe.match_deleted=$p(l,oe.id),oe.json=_[oe.id]}}catch(e){ee=!0,te=e}finally{try{!Z&&ne.return&&ne.return()}finally{if(ee)throw te}}return e.matches=_};return e.onchanged=f,e.cancelInput=function(e){var t=void 0;if(!window.getSelection)return!1;var r=window.getSelection(),n=s.getSelectedNodes();if(8===e.keyAscii&&n.length>0){n=s.getSelectedNodes();var o=function(){var e=[],r=!0,o=!1,a=void 0;try{for(var i,s=n[Symbol.iterator]();!(r=(i=s.next()).done);r=!0)t=i.value,"b"===$nodeName(t)&&t.match_deleted&&e.push(t)}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}return e}(),a=!0,i=!1,l=void 0;try{for(var u,c=o[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)t=u.value,t.match_deleted()}catch(e){i=!0,l=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw l}}var d=$first(n);if(d){var f=d.parentNode;f&&f.match_deleted&&f.match_deleted()}return!1}if(8===e.keyAscii){r=window.getSelection();var p=r.focusNode;if(p&&"#text"===$nodeName(p)){var m=p.parentElement;if(m){var h=m.parentElement;if(h&&"b"===$nodeName(h))return h.ignore_match&&h.ignore_match(),!0}}if(p&&27===e.keyAscii){var _=$gp(p,"div"),v=$all("b",null,_),y=$last(v);if(y&&y.ignore_match&&$hasClass(y,"t_date"))return y.ignore_match(),!0}}return!1},$AEV(e,"keydown",function(e){return!e.ctrl||66!==e.key&&73!==e.key&&85!==e.key||(e.preventDefault(),!1)})}},{key:"getIcon",value:function(e){var t=void 0;switch(e){case"project":t="sm1/quick_add_project.svg";break;case"label":t="sm1/quick_add_label.svg";break;case"person":t="sm1/quick_add_assignee.svg";break;case"priority":t="sm1/quick_add_priority.svg";break;case"date":t="sm1/quick_add_calendar.svg"}return svgs.getString(t).replace(/</g,"\u27e6").replace(/>/g,"\u27e7")}},{key:"setCurrentProject",value:function(e,t){var r=b.current_form;if(t&&r&&this.highlight_project){this.highlight_project[2]&&$remove($all("b","t_project",r))}if(t?(this.highlight_person&&this.setCurrentPerson(null),this.highlight_project=[e,t,!0]):(e=null,this.highlight_project=null),r){var n=r.people_assigner;n&&n.onProjectUpdated(e)}y.sendSignal("natural_language_project_updated",e)}},{key:"setCurrentPerson",value:function(e,t){var r=b.current_form;if(t&&r&&this.highlight_person){this.highlight_person[2]&&$remove($all("b","t_person",r))}this.highlight_person=t?[e,t,!0]:null}},{key:"deselectPriority",value:function(e){e&&(this.highlight_priority=null,$remove($all("b","t_priority",e)))}},{key:"generateUserMatcher",value:function(e){var t=window.User.id;if(!this.user_matcher_cache[e]){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=k.getAll(e)[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value,u=l.full_name||l.email;if(u=$strip(u.replace(this.re_special_chars,"\\$1")),0!==u.length){var c=[];c.push(u);var d=u.split(" ")[0],f=u.split(" "),p="";if(f.length>1){p=d+"\\s"+f[1][0]+"\\.?"}p!==u&&p.length>0&&c.push(p),d!==u&&d.length>0&&c.push(d),l.id===t&&c.push(_x("task_assignment","me")),c.length>0&&r.push([l.id,new RegExp("(?:^|\\s)\\+(?:"+c.join("|")+")","i"),u])}}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}this.user_matcher_cache[e]=r}return this.user_matcher_cache[e]}},{key:"generateProjectMatcher",value:function(){this.re_project_matchers=[];var e=!0,t=!1,r=void 0;try{for(var n,o=E.getAll()[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var a=n.value,i=a.name;i=$strip(i.replace(this.re_special_chars,"\\$1")),this.re_project_matchers.push([a.id,new RegExp("(?:^|\\s)#"+i,"i"),i])}}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}}},{key:"genericPersonProjectMatcher",value:function(e,t,r){var n=[],a={},i={},s=!0,l=!1,u=void 0;try{for(var c,d=r[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value,p=Array.from(f),m=o(p,3),h=m[0],_=m[1],v=(m[2],t.match(_));if(v){var y=$strip(v[0]);e.ignored[y]||(n.push([v.index+y.length,h,y]),a[v.index]&&a[v.index]!==h?i[v.index]=!0:a[v.index]=h)}}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}var g=[],b=!0,w=!1,E=void 0;try{for(var k,S=n[Symbol.iterator]();!(b=(k=S.next()).done);b=!0){var j=k.value;i[j[0]]||g.push(j)}}catch(e){w=!0,E=e}finally{try{!b&&S.return&&S.return()}finally{if(w)throw E}}if(n.length>1)return null;var T=$first(g);return T?[T[1],T[2],!1]:null}}]),e}();j.initClass(),window.NatrualLanguageParsing=new j,t.exports=window.NatrualLanguageParsing},{"../../models/Collaborators":160,"../../models/DateExt":164,"../../models/LabelsModel":168,"../../models/ProjectsModel":171,"../project_editor/ProjectEditorManager":61}],86:[function(e,t,r){"use strict";var n=window,o=n.LibEdit,a=window,i=a.IstComplete,s=e("../../utils/addDeferCompositionEndListener").default,l=e("../../models/Storage"),u=l.$storage,c=void 0,d=function(e){e.className="richtext_editor sel_richtext_editor";var t=DIV(e);if(e.generatePlaceholder){var r=m.genereate();r&&(t.placeholderText=r)}e.placeholder&&(t.placeholderText=e.placeholder),t.contentEditable=!0,t.proxyFocus=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];setTimeout(function(){t.focus(),e&&o.setCaretPositionWithin(t,t.proxyGetValue().length)},50)};var n=null;if(t.proxySelect=function(){var e=document.createRange();e.selectNodeContents(t);var r=window.getSelection();r.removeAllRanges(),r.addRange(e)},t.placeholderText){var a=function(){""===(t.textContent||t.innerText)?t.placeholder||(t.placeholder=SPAN({c:"rich_text_placeholder"},t.placeholderText),$AEV(t.placeholder,"contextmenu",function(e){if(e.shift)return!0;$remove(t.placeholder),t.proxyFocus()}),$addBefore(t.placeholder,t),setTimeout(function(){t.offsetWidth&&$setWidth(t.placeholder,t.offsetWidth)},50)):t.placeholder&&($remove(t.placeholder),t.placeholder=null)};n=function(){t.placeholder_ta&&clearTimeout(t.placeholder_ta),t.placeholder_ta=setTimeout(a,0)},$AEV(t,"keyup",n)}return t.proxyGetValue=function(){var e=t.textContent||t.innerText;return e=e.replace(new RegExp(i.CHAR_FORCED_WHITESPACE,"g")," "),e=e.replace(/\u00A0/g," ")},t.proxyPlaceCursor=function(){o.placeCursor(t,t.proxyGetValue().length)},$AEV(t,["keydown"],function(e){if(window.getSelection)try{if(!window.getSelection().getRangeAt(0).collapsed){var r=t.proxyGetValue().length;return window.getSelection().toString().length===r&&46===e.keyCode&&(t.proxySetValue(""),t.proxyFocus(),e.preventDefault()),!0}}catch(e){}}),$AEV(t,["keypress","paste"],function(e){if(e.clipboardData){e.preventDefault();var r=o.normalzieClipboardData(e.clipboardData.getData("text/plain"));return!(-1!==r.indexOf("\n")&&t.onMultilinePaste&&!t.onMultilinePaste(t,r))&&(document.execCommand("insertHTML",!1,r),t.onchanged&&t.onchanged(),!1)}if(e.ctrl&&e.key||e.shift)return!0;if(c&&clearTimeout(c),window.getSelection)try{if(!window.getSelection().getRangeAt(0).collapsed)return!0}catch(e){}return c=setTimeout(t.onchanged,0),!0}),s(t,function(){c&&clearTimeout(c),c=setTimeout(t.onchanged,0)}),t.proxySetValue=function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=void 0;o.getSelectedNode(),void 0===t.save_position&&(t.save_position=!0),t.save_position&&(i=o.getCaretOffsetWithin(t)),e=e.replace(/&/g,"&amp;"),e=e.replace(/(?:^\s)|(?:\s$)/g,"&nbsp;"),e=e.replace(/\s\s/g," &nbsp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/\u27e6/g,"<"),e=e.replace(/\u27e7/g,">"),t.innerHTML=e,t.placeholderText&&n&&n(),a&&t.save_position&&o.setCaretPositionWithin(t,i.start),r&&t.onchanged&&setTimeout(t.onchanged,0)},$AEV(t,"focus",function(){t.save_position=!0}),t},f=[_("Get pastries sun at 9")+" "+_("#Family"),_("Renew gym every May 1st")+" "+_("#Health"),_("Design meeting at 11am p1")+" "+_("#Meeting"),_("Learn Portuguese every 2 days")+" "+_("#Learning"),_("Buy gift tomorrow at 6pm p1")+" "+_("#Errands"),_("Read every day p3 @goals")+" "+_("#Learning"),_("Conference Wednesday at 15")+" "+_("#Meeting"),_("Family lunch on Sunday at 11am")+" "+_("#Personal")],p="WR_PlaceholderCount",m={genereate:function(){if(this.increaseCount()>=100)return null;var e=Math.floor(Math.random()*f.length);return _("e.g.")+" "+f[e]},increaseCount:function(){var e=u(p).get();if(null===e)return this.restoreCountFromServer(),100;var t=parseInt(e||0);return t+=1,u(p).set(""+t),100===t&&this.markAsSeenGlobally(),t},restoreCountFromServer:function(){var e=$requestJSON("/API/v7/tooltips/is_seen");return e.addCallback(function(e){e.result?u(p).set(100):u(p).set("0")}),e.sendReq({name:"web_ph_natrual_text",token:window.User.token})},markAsSeenGlobally:function(){$request("/API/v7/tooltips/mark_as_seen").sendReq({name:"web_ph_natrual_text",token:window.User.token})}};t.exports=d},{"../../models/Storage":179,"../../utils/addDeferCompositionEndListener":464}],87:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("react"),s=n(i),l=e("react-dom"),u=n(l),c=e("../../react_components/emptyState"),d=window,f=d.Signals,p=window,m=p.GB_showHTML,h=window,v=h.GB_hide,y=window,g=y.IstComplete,b=window,w=b.IstButton,E=window,k=E.Alerts,S=window,j=S.IstTooltip,T=window,O=T.Indicator,I=window,C=I.TooptipWin,D=e("../avatars/Avatars"),M=e("../project_editor/ProjectEditorManager"),x=e("../../containers/premium_promo/PremiumOnlyModal"),R=e("../formatter/Formatter.js"),N=e("../../models/ProjectsModel"),L=e("../projects_list/ProjectListUtils"),U=e("../../models/Collaborators");N=e("../../models/ProjectsModel");var V=e("../../reducers/tooltip"),F=V.hasSeen,H=V.markSeen,G=V.TOOLTIP_SHARING,z=e("../../stores/store").default,q=e("../themes/Themes"),W=function(){function e(){o(this,e),this.refresh=this.refresh.bind(this),this.show=this.show.bind(this),this.renderView=this.renderView.bind(this),this.switchTab=this.switchTab.bind(this),this.renderProjectTabBody=this.renderProjectTabBody.bind(this),this.renderCollaboratorSelector=this.renderCollaboratorSelector.bind(this),this.renderCollaboratorTabBody=this.renderCollaboratorTabBody.bind(this),this.renderUserRow=this.renderUserRow.bind(this),this._renderAdder=this._renderAdder.bind(this),this.render_intro_text=this.render_intro_text.bind(this),this._checkEmpty=this._checkEmpty.bind(this),this.promoCheck=this.promoCheck.bind(this),this._promoShow=this._promoShow.bind(this),this.promoRemove=this.promoRemove.bind(this),this.holder=null,this.view_data=null,this.current_project=null,this.current_tab=null,this.selected_collaborators=[],f.connect("collaborators_states_updated",this.refresh)}return a(e,[{key:"refresh",value:function(){if(this.current_project&&this.holder){if(""!==this.adder_input.value)return void setTimeout(this.refresh,500);this.renderView(this.current_project)}}},{key:"show",value:function(e){var t=this;this.holder=DIV({c:"sharing_manager"}),this.view_data=DIV(),this.current_tab="tab_collaborator",$add(this.holder,this.view_data),$add(this.view_data,O.cssSpinner()),m(_("Share options"),this.holder,400,400,{callback_fn:function(){g.hide(),t.current_project=null,t.holder=null},close_validator_fn:function(){return t.empty_state_holder&&(u.default.unmountComponentAtNode(t.empty_state_holder),t.empty_state_holder=null),!0}});var r=N.get(e);return r.team_inbox&&$addClass(this.holder,"team_inbox_view"),r.inbox_project?(alert(_("It's not possible to share the inbox project. Please share a regular project."),v),!1):(this.current_project=r,this.renderView(),!1)}},{key:"renderView",value:function(){var e=this;if(!this.current_project||!this.current_tab)throw Error("State @current_project, @current_tab must be set beforing rendering");var t=UL({c:"tab_nav"}),r=LI({"data-track":"share_project|collaborators"},_("Collaborators")),n=LI({"data-track":"share_project|invite_from_project"},_("Invite From Project"));$AEV(r,"click",function(){e.switchTab("tab_collaborator")}),$AEV(n,"click",function(){e.switchTab("tab_project")}),$add(t,r,n),"tab_collaborator"===this.current_tab?($addClass(r,"active"),this.renderCollaboratorTabBody()):($addClass(n,"active"),this.renderProjectTabBody()),0===N.getAll().filter(function(t){return U.isProjectShared(t.id)&&e.current_project.id!==t.id}).length&&$addClass(t,"hidden");var o=DIV(t,this.tab_body);return $swap(this.view_data,o),this.view_data=o,this.adder_input.focus()}},{key:"switchTab",value:function(e){this.current_tab=e,this.renderView()}},{key:"renderProjectTabBody",value:function(){var e=this,t=N.getAll().filter(function(t){return U.isProjectShared(t.id)&&e.current_project.id!==t.id});if(0===t.length)return void(this.tab_body=DIV({c:"blank_screen"},_("You have no other shared projects.")));var r=UL({c:"projects_list"}),n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l,u=i.value,c=u.name.replace(/\*\s*/,"");c=R.formatSimple(c,{only_text:!0,as_html:!1}),l=0!==u.id?L.createColor(u):SPAN({c:"blank_color"});var d=LI(l,SPAN({c:"project_name"},c));!function(t){$AEV(d,"click",function(){var r=e.renderCollaboratorSelector(t);return $swap(e.tab_body,r),e.tab_body=r})}(u),$add(r,d)}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}this.tab_body=r}},{key:"renderCollaboratorSelector",value:function(e){var t=this,r=void 0,n=void 0,o=void 0,a=DIV({c:"collaborator_selector"}),i=e.name.replace(/\*\s*/,"");i=R.formatSimple(i,{only_text:!0,as_html:!1}),n=0!==e.id?L.createColor(e):SPAN({c:"blank_color"});var s=DIV({c:"back_to_list_link"},r=svgs.get("sm1/caret.svg"),SPAN({c:"project_name"},n,i));$AEV(r,"click",function(){t.switchTab("tab_project")}),$add(a,s);var l=UL({c:"collaborator_list selectable"}),u=[],c=function(){var e=[],r=!0,n=!1,a=void 0;try{for(var i,s=U.getInvitedUsers(t.current_project.id)[Symbol.iterator]();!(r=(i=s.next()).done);r=!0)o=i.value,e.push(o.id)}catch(e){n=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw a}}return e}(),d=function(){var e=[],r=!0,n=!1,a=void 0;try{for(var i,s=U.getActiveUsers(t.current_project.id)[Symbol.iterator]();!(r=(i=s.next()).done);r=!0)o=i.value,e.push(o.id)}catch(e){n=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw a}}return e}(),f=!0,p=!1,m=void 0;try{for(var h,v=U.getAll(e.id)[Symbol.iterator]();!(f=(h=v.next()).done);f=!0){var y=h.value;if(y.id!==window.User.id){var g=D.renderAvatar(y,"small",q.theme),b=SPAN({c:"user_info"},B(y.full_name));c.includes(y.id)&&$add(b,SPAN({c:"status pending"},_("Pending"))),d.includes(y.id)&&$add(b,SPAN({c:"status pending"},_("Collaborator"))),$add(b,BR(),y.email);var E=SPAN({c:"check_box"},svgs.get("sm1/check_mark_big.svg")),k=LI({c:"collaborator_list_item"},E,g,b);k.collaborator=y,c.includes(y.id)||d.includes(y.id)?$addClass(k,"is_unselectable"):(u.push(k),function(e){$AEV(e,"click",function(){$hasClass(e,"is_selected")?$removeClass(e,"is_selected"):$addClass(e,"is_selected"),T()})}(k)),$add(l,k)}}}catch(e){p=!0,m=e}finally{try{!f&&v.return&&v.return()}finally{if(p)throw m}}if($add(a,l),u.length>0){var S=function(){return u.filter(function(e){return $hasClass(e,"is_selected")}).length===u.length},j=LI({c:"batch_selector"},SPAN({c:"check_box"},svgs.get("sm1/check_mark_big.svg")),P({c:"select_all"},_("Select All")));$AEV(j,"click",function(){var e=void 0;if(S()){var t=!0,r=!1,n=void 0;try{for(var o,a=u[Symbol.iterator]();!(t=(o=a.next()).done);t=!0)e=o.value,$removeClass(e,"is_selected")}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}else{var i=!0,s=!1,l=void 0;try{for(var c,d=u[Symbol.iterator]();!(i=(c=d.next()).done);i=!0)e=c.value,$addClass(e,"is_selected")}catch(e){s=!0,l=e}finally{try{!i&&d.return&&d.return()}finally{if(s)throw l}}}T()})
;var T=function(){S()?$addClass(j,"has_all_selected"):$removeClass(j,"has_all_selected")};$addToTop(l,j);var O=w.createButton(_("Invite"),null,null,{"data-track":"share_project|collaborators_invite"});$addClass(O,"ist_button_red"),$AEV(O,"click",function(){var e=!0,r=!1,n=void 0;try{for(var o,a=$$(".collaborator_list_item.is_selected")[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var i=o.value;U.addInvite(t.current_project.id,i.collaborator.email)}}catch(e){r=!0,n=e}finally{try{!e&&a.return&&a.return()}finally{if(r)throw n}}return t.switchTab("tab_collaborator")}),$add(a,O)}return a}},{key:"renderCollaboratorTabBody",value:function(){var e=void 0;this.tab_body=DIV({c:"collaborator_tab_body"});var t=U.getActiveUsers(this.current_project.id),r=U.getInvitedUsers(this.current_project.id);if(0===t.length&&0===r.length){var n=this.render_intro_text();return e=this._renderAdder(),void $add(this.tab_body,e,n)}var o=UL({c:"collaborator_list"}),a=!0,i=!1,s=void 0;try{for(var l,u=this._sort(r)[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value,d={};$update(d,c),d.state="pending",$add(o,this.renderUserRow(d))}}catch(e){i=!0,s=e}finally{try{!a&&u.return&&u.return()}finally{if(i)throw s}}$add(o,this.renderUserRow(window.User));var f=!0,p=!1,m=void 0;try{for(var h,_=this._sort(t)[Symbol.iterator]();!(f=(h=_.next()).done);f=!0)c=h.value,c.id!==window.User.id&&$add(o,this.renderUserRow(c))}catch(e){p=!0,m=e}finally{try{!f&&_.return&&_.return()}finally{if(p)throw m}}e=this._renderAdder(),$add(this.tab_body,e,o)}},{key:"renderUserRow",value:function(e){var t=this,r=void 0,n=LI({c:"collaborator_list_item"}),o=SPAN({c:"user_info"});$ATT(n,D.renderAvatar(e,"small",q.theme)),$ATT(n,o);var a=e.full_name||e.user_full_name;if(e.id===window.User.id&&(a=_x("collaborator_list","Me")),a?$add(o,SPAN(r=B(a),BR(),e.email)):$add(o,SPAN(r=B(e.email))),"pending"===e.state&&$add(r,SPAN({c:"status pending"},_("Pending"))),e.id!==window.User.id&&!this.current_project.team_inbox){var i=void 0;$add(n,i=A({href:"#",c:"delete"},svgs.get("sm1/trash.svg"))),j.showSimpleText(i,_("Remove collaborator")),$AEV(i,"click",function(){var r=_('Are you sure you want to remove "%s"?');return r=r.replace("%s",a||e.email),k.confirm(r,function(r){r&&($remove(n),U.deleteFromProject(t.current_project.id,e))}),!1})}if(e.id===window.User.id&&!this.current_project.team_inbox){var s=void 0;$add(n,s=A({href:"#",c:"leave_channel"},svgs.get("sm1/leave.svg"))),j.showSimpleText(s,_("Leave this project")),$AEV(s,"click",function(){var e=_("Are you sure you want to leave this project?")+" "+_("This will delete it from your account.");return k.confirm(e,function(e){if(e)return U.deleteFromProject(t.current_project.id,window.User),N.deleteMany([t.current_project.id]),v(),M.reset(),!1}),!1})}return n}},{key:"_renderAdder",value:function(){var e=this,t=void 0,r=void 0,n=w.createButton(_("Invite"),null,null,{"data-track":"share_project|invite_from_project_invite"});$addClass(n,"ist_button_red"),this.adder_input=t=INPUT({type:"text",placeholder:_("Email or Name"),c:"input_email text_box"});var o=DIV({c:"invite_adder"},t,n),a=function(){var n=t.value;n=$trim(n),-1!==n.indexOf(" ")&&-1===n.indexOf("<")&&(n=n.replace(/\s+/g,","));var o=!0,a=!1,i=void 0;try{for(var s,l=n.split(/[,;]/)[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){r=s.value;var u;if(r=$trim(r),0!==r.length){if(-1===r.indexOf("@"))return alert(_("Email isn't valid")+": "+$escape(r)),!1;var c=U.getAll(e.current_project.id),d=!0,f=!1,p=void 0;try{for(var m,h=c[Symbol.iterator]();!(d=(m=h.next()).done);d=!0){if(m.value.email===r)return alert(_("User %s is already part of the project").replace("%s",$escape(r))),!1}}catch(e){f=!0,p=e}finally{try{!d&&h.return&&h.return()}finally{if(f)throw p}}if(window.User.is_premium){if(u=window.User.share_limit||26,c.length>=u)return alert(DIV(B(_("Collaboration limit reached")),P(_("Unfortunately, you've reached the limit of 25 collaborators per project.")),P(_("Need more? Get in touch")," ",A({href:"mailto:support@todoist.com"},"support@todoist.com")))),!1}else if(u=6,c.length>=u)return x.showCollaboratorLimit(),!1;U.addInvite(e.current_project.id,r)}}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}return e.renderView(),t.value="",!1};$AEV(n,"click",a);var i={collection:function(){var e={},t=[],r=!0,n=!1,o=void 0;try{for(var a,i=$values(U.collaborators)[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value;if(s.id!==window.User.id&&!e[s.email]){e[s.email]=!0;var l=s.full_name+" "+s.email,u={name:l,email:s.email,avatar_small:s.avatar_small};t.push(u)}}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}return t},filterItem:function(e,t){var r=$setHTML(SPAN({c:"name_email"}),t),n=D.renderAvatar(e,"small",q.theme);return DIV(DIV({c:"ist_complete_icon"},n),DIV({c:"ist_complete_content"},r))},onSelect:function(e){return e.email},onNoMatches:function(){return g.hide(),!1},onPreProcess:function(e,t){return 0===e.length?[]:t},wildcard_match:!0,require_trigger:!1,whole_input_match:!0,extra_width:1};return g.attach(t,i),$AEV(t,"keydown",function(e){return 13!==e.keyAscii||!g.isShown()&&a()}),o}},{key:"render_intro_text",value:function(){return this.empty_state_holder=DIV(),u.default.render(s.default.createElement(c.EmptyStateSharing,null),this.empty_state_holder),this.empty_state_holder}},{key:"_checkEmpty",value:function(e){var t=this,r=null;return"owner"!==e.user_role&&(r=A({href:"#"},_("Leave this project")),$AEV(r,"click",function(){var e=_("Are you sure you want to leave this project?")+" "+_("This will delete it from your account.");return k.confirm(e,function(e){if(e)return U.deleteFromProject(t.current_project.id,window.User),N.deleteMany([t.current_project.id]),v(),M.reset(),!1}),!1})),$add(this.holder,DIV({c:"desc"},r))}},{key:"_sort",value:function(e){var t=!0,r=!1,n=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;i.full_name?i.name=i.full_name.toLowerCase():i.name=i.email.toLowerCase()}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return e=e.sort(function(e,t){return e.name.localeCompare(t.name)})}},{key:"promoCheck",value:function(){window.User.karma<200||!F(G,z.getState())&&$isShown($("app_holder"))&&this._promoShow()}},{key:"_promoShow",value:function(){if(!$("blank_state_sharing")){this.promo_shown=!0;var e=DIV({id:"blank_state_sharing"},_("Share projects, assign tasks, discuss in real-time, and get notified when changes are made. Todoist lets you collaborate from any web-enabled device.")),t={},r=$all("a","share_icon",null,!0);r&&(t={fn_left_offset:function(e,t){return $position(r).x-t.width+40},fn_arrow_left:function(){return $position(r).x+5},fn_top_offset:function(){return $position(r).y+30},fixed_pos:!0},this.tipwin=C.show(_("Collaborate with others"),e,300,350,t),$fx.fadeIn(e),z.dispatch(H(G)))}}},{key:"promoRemove",value:function(){return this.promo_shown=!1,this.tipwin&&this.tipwin.hide(),!1}}]),e}();window.SharingManager=new W,t.exports=window.SharingManager},{"../../containers/premium_promo/PremiumOnlyModal":120,"../../models/Collaborators":160,"../../models/ProjectsModel":171,"../../react_components/emptyState":241,"../../reducers/tooltip":448,"../../stores/store":456,"../avatars/Avatars":17,"../formatter/Formatter.js":22,"../project_editor/ProjectEditorManager":61,"../projects_list/ProjectListUtils":71,"../themes/Themes":95,react:"react","react-dom":"react-dom"}],88:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../../utils"),i=e("../../models/ProjectsModel"),s=e("../../models/Colors"),l=e("../../filterist"),u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,r=DIV({c:"project_viz"}),n=e.color;return void 0!==n?$setStyle(r,{backgroundColor:s.getHex("project",e.color),width:t}):$setStyle(r,{backgroundColor:"#dddddd",width:t}),r.color=n||0,r},c=function(){function e(){n(this,e),this.show=this.show.bind(this),this.hide=this.hide.bind(this)}return o(e,[{key:"renderHolder",value:function(){return DIV({id:"quick_day_show"})}},{key:"show",value:function(e){var t=void 0,r=void 0,n=l.getByDate(e);r=0===n.length?_("No tasks due"):(0,a.format)(_n("{count} task due","{count} tasks due",n.length),{count:n.length});var o=DIV({c:"project_bar"}),s=[],c=!0,d=!1,f=void 0;try{for(var p,m=n[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var h=p.value,v=i.get(h.project_id);v&&(t=u(v,8),s.push([v.color,t]))}}catch(e){d=!0,f=e}finally{try{!c&&m.return&&m.return()}finally{if(d)throw f}}s.sort(function(e,t){return e[0]-t[0]});var y=!0,g=!1,b=void 0;try{for(var w,E=s[Symbol.iterator]();!(y=(w=E.next()).done);y=!0)t=w.value,$add(o,t[1])}catch(e){g=!0,b=e}finally{try{!y&&E.return&&E.return()}finally{if(g)throw b}}return DIV({c:"project_bar_holder"},r,CENTER(o))}},{key:"hide",value:function(){$replace($("quick_day_show"),null)}}]),e}();t.exports=new c},{"../../filterist":133,"../../models/Colors":161,"../../models/ProjectsModel":171,"../../utils":484}],89:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../postpone/Postpone"),l=n(s),u=e("../../react_components/scheduler/SchedulerWrapper"),c=n(u),d=window,f=d.IstTooltip,p=window,m=p.Dateist,h=window,v=h.DateistDateHelpers,y=window,g=y.DateUtils,b=window,w=b.Signals,E=e("../../models/SmartSchedule"),k=e("../../stores/SystemStatusStore"),S=function(){function e(){o(this,e),this.create=this.create.bind(this),this.genIcon=this.genIcon.bind(this),this.genDate=this.genDate.bind(this),this.getPostponeIcon=this.getPostponeIcon.bind(this),this.genAISchedulerIcon=this.genAISchedulerIcon.bind(this),this.daysToAdd=this.daysToAdd.bind(this)}return i(e,[{key:"create",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=!0===t.with_help_text,n=!0===t.with_smart_schedule,o=!0===t.with_today,a=!0===t.with_tomorrow,i=!0===t.with_next_week,s=!0===t.with_postpone,l=!0===t.with_month,u=!0===t.with_no_date,c=!0===t.with_more,d=DIV({c:"scheduler_holder"});r&&$add(d,SPAN({c:"desc"},_("Schedule")));var f=DIV({c:"icon_list"});if($add(d,f),!n||!t.items||t.items instanceof Array||$add(f,this.genAISchedulerIcon(t.items,e,t.onHover)),o&&$add(f,this.genIcon("today",e,t.onHover,_("Today"),"scheduler|today")),a&&$add(f,this.genIcon("tomorrow",e,t.onHover,_("Tomorrow"),"scheduler|tomorrow")),s&&t.items){t.items instanceof Array&&1===t.items.length&&(t.items=t.items[0]);var p=t.items instanceof Array?t.on_postpone_click:e;$add(f,this.getPostponeIcon(t.items,p,t.onHover,"scheduler|postpone_to"))}return i&&$add(f,this.genIcon("next_week",e,t.onHover,_("Next week"),"scheduler|next_week")),l&&$add(f,this.genIcon("month",e,t.onHover,_("In 1 month"),"scheduler|next_month")),u&&$add(f,this.genIcon("no_date",e,t.onHover,_("No due date"),"scheduler|no_due_date")),c&&$add(f,this.genIcon("more",$p(this.moreClick,e,t.items),t.onHover,_("More"),"scheduler|more")),d}},{key:"moreClick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=(arguments[2],arguments[3]);return f.hide(),t=t instanceof Array?t:[t],c.default.show({anchor:r,selectedItems:t,selectedDate:t[0].due,dialogClassName:"scheduler-editor-menu",hideMenus:!1,holder:DIV({c:"scheduler_holder"}),onDateSelect:e}),!1}},{key:"genIcon",value:function(e,t,r,n,o){var a=this,i=void 0;switch(e){case"today":i="sm1/scheduler_today.svg";break;case"tomorrow":i="sm1/scheduler_tomorrow.svg";break;case"next_week":i="sm1/scheduler_next_week.svg";break;case"month":i="sm1/scheduler_month.svg";break;case"no_date":i="sm1/scheduler_no_date.svg";break;case"more":i="sm1/more.svg"}var s=A({href:"#",c:"icon_scheduler","data-track":o},svgs.get(i));if("today"===e){var l=""+(new Date).getDate();s.querySelector("tspan").textContent=l}return"more"===e?$addClass(s,"icon_more"):"next_week"===e&&$addClass(s,"icon_next_week"),$AEV(s,["click","touchstart"],function(){return"more"!==e&&w.sendSignal("hide_editor_menu"),f.hide(),t(a.genDate(e),s),!1}),r&&$AEV(s,"mouseover",function(){if("more"!==e)return r(a.genDate(e)),!1}),f.showSimpleText(s,n,null,3,12),s}},{key:"genDate",value:function(e){if("today"===e)return m.parse("today").due_date;if("tomorrow"===e)return m.parse("tomorrow").due_date;if("next_week"===e){var t=this.daysToAdd();return m.parse("+"+t+" days").due_date}return"month"===e?m.parse("+1 month").due_date:"no_date"===e?null:void 0}},{key:"getPostponeIcon",value:function(e,t,r,n){var o=void 0,i=A({href:"#",c:"icon_scheduler icon_postpone","data-track":n},svgs.get("sm1/scheduler_postpone.svg")),s=function(e){var t=l.default.getPostponeDate(e),r=t.new_due,n=t.formated_due;if("END_REACHED"===r){var o=m.parse("tomorrow").due_date,a=v.day_diff(new Date,o);return[o,g.humanizeDayDiff(a,o)]}return[r,n]};if(e instanceof Array){var u=e.map(function(e){return s(e)[0]});return $AEV(i,["click","touchstart"],function(){return f.hide(),w.sendSignal("hide_editor_menu"),t(u),!1}),r&&$AEV(i,"mouseover",function(){r(u)}),o=SPAN(_("Postpone")),f.showSimpleText(i,o,null,3,12),i}var c=Array.from(s(e)),d=a(c,2),p=d[0],h=d[1];return $AEV(i,["click","touchstart"],function(){return f.hide(),w.sendSignal("hide_editor_menu"),t(p),!1}),r&&$AEV(i,"mouseover",function(){r(p)}),o=SPAN(_("Postpone to")," ",B(h)),f.showSimpleText(i,o,null,3,12),i}},{key:"genAISchedulerIcon",value:function(e,t,r){var n=void 0,o=void 0,a=void 0,i=void 0,s=Indicator.ringSpinner(),l=A({c:"icon_ai_scheduler","data-track":"scheduler|ai"},SPAN({c:"spin_loader"},s),o=SPAN({c:"predicted_date"},svgs.get("sm1/scheduler_smart_date.svg")),n=SPAN({c:"error_icon"},svgs.get("sm1/scheduler_error.svg")));return k.isOffline()?(i=_("Smart Schedule requires an Internet connection"),f.showSimpleText(l,i,null,3,12),$addClass(l,"has_error"),r&&$AEV(l,["mouseover"],function(){r(null)}),l):(E.predictItemDuedate(e,function(e,n){if(n)return i=_("No suggestions available"),f.showSimpleText(l,i,null,3,12),$addClass(l,"has_error"),void(r&&$AEV(l,["mouseover"],function(){r(null)}));e=v.date_max(e);var o=v.day_diff(new Date,e),s=g.humanizeDayDiff(o,e);i=DIV(_("Suggested date: "),B(s)),f.showSimpleText(l,i,null,3,12),a=l.querySelector(".predicted_date tspan"),a.textContent=e.getDate(),$addClass(l,"has_result"),$AEV(l,["click","touchstart"],function(){f.hide(),t(e)}),r&&$AEV(l,["mouseover"],function(){r(e)})}),l)}},{key:"daysToAdd",value:function(){var e=new Date,t=v.iso_day(e),r=window.Settings.START_DAY,n=window.Settings.NEXT_WEEK,o=r-t;o<=0&&(o+=7);var a=n-r;return a<0&&(a+=7),o+a}}]),e}();t.exports=new S},{"../../models/SmartSchedule":176,"../../react_components/scheduler/SchedulerWrapper":352,"../../stores/SystemStatusStore":453,"../postpone/Postpone":58}],90:[function(e,t,r){"use strict";var n=e("../generic_manager/GenericManagerUtils.js"),o=Class({current_replacer:null,init:function(e,t){this.li_items=e,this.controller=t,this.set_indent=!0,this.start_x=0,this.current_indent=1,this.indent_level="ProjectList"==t.name&&22||28,this.max_indent="ProjectList"==t.name&&4||5,$bindMethods(this)},onStart:function(){var e=ICE.$dnd.current_root,t=e.getBoundingClientRect().top,r=this.current_replacer=LI();ICE.$dnd.current_replacer=r,this.start_indent_x=(e.json.indent-1)*this.indent_level,this.set_indent&&($setStyle(r,"marginLeft",this.start_indent_x+"px"),this.current_indent=e.json.indent,this.cur_child=n.getChildren(e)),this.cur_child=this.cur_child||[],ICE.$dnd.cur_child=this.cur_child,$map(this.cur_child,function(e){$hide(e)}),$setClass(r,e.className),$addClass(r,"drop_item"),$removeClass(r,"current"),$addClass(e,"on_drag");var o=0;$hasClass(e,"task_item")||(o=1),$setHeight(r,e.offsetHeight-o),$setOpacity(e,1),$setTop(e,t),e.style.position="fixed",$addAfter(r,e),$setWidth(e,r.offsetWidth)},onDrag:function(){var e=ICE.$dnd.current_root,t=this.current_replacer,r=e.getBoundingClientRect().top,n=r+e.offsetHeight;if(this.li_items.forEach(function(o){if(o!==e){var a=o.getBoundingClientRect().top,i=a+o.offsetHeight/2,s=a+o.offsetHeight;if($hasClass(o,"reorder_item")&&r<i&&n>i)return void $addAfter(t,o);if(n>i&&n<s){for(;o.nextSibling&&"none"==o.nextSibling.style.display;)o=o.nextSibling;$addAfter(t,o)}else r<i&&r>a&&$addBefore(t,o)}}),this.set_indent){0===this.start_x&&(this.start_x=$position(e).x-this.start_indent_x);var o=$position(e).x-this.start_x,a=this.current_indent,i=this.indent_level;o<=10?a=1:o>=1*i-10&&o<=1*i+10?a=2:o>=2*i-10&&o<=2*i+10?a=3:o>=3*i-10&&o<=3*i+10?a=4:o>=4*i-10&&o<=4*i+10?a=5:o>=5*i-10&&o<=5*i+10&&(a=6),a>this.max_indent&&(a=this.max_indent);for(var s=t.previousSibling;;){if(!s)break;{if(s.json&&s!=e&&!$isHidden(s)&&!$hasClass(s,"manager")&&!$hasClass(s,"reorder_item"))break;s=s.previousSibling}}s?a>s.json.indent&&(a=Math.min(s.json.indent+1,this.max_indent)):a=1;var l=t.nextSibling;if(l){var u=l.json.indent;a<u&&(a=u)}$setStyle(t,"marginLeft",(a-1)*this.indent_level+"px"),this.current_indent=a}},onEnd:function(){var e=this,t=ICE.$dnd.current_root,r=this.current_replacer;if($removeClass(t,"on_drag"),t.style.position="",t.style.left="",t.style.top="",t.style.width="",t.style.opacity=1,this.set_indent){var o=this.current_indent;if(o>5&&(o=5),o!=t.json.indent){var a=o-t.json.indent;n.setIndent(t,o),$map(this.cur_child,function(t){var r=t.json.indent+a;r>e.max_indent&&(r=e.max_indent),n.setIndent(t,r)})}}try{$addBefore(t,r)}catch(e){}$remove($$("li.drop_item"));var i=this.controller.name||this.controller.list_class;if(("ProjectList"==i||"ProjectEditor"==i)&&n.normalizeIndent(t,t),ICE.$dnd.removeDragAble(t),this.current_replacer=null,ICE.$dnd.current_replacer=null,this.cur_child)return $rmap(this.cur_child,function(e){$addAfter(e,t)}),n.showHideChildren(this.cur_child,t),ICE.$dnd.cur_child=this.cur_child=null,!1}});t.exports=o},{"../generic_manager/GenericManagerUtils.js":26}],91:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parseStartPage=void 0;var n=e("../../stores/store"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=e("../../reducers/mainView"),i=e("../../utils"),s=e("../agenda/AgendaUtils"),l=e("../loading/Loading.js"),u=e("../projects_list/ProjectListUtils"),c=e("../location_manager/LocationManager.js"),d=function(e){var t=/project\?id=(\d+)/,r=t.exec(e);return r?{type:"project",id:parseInt(r[1])}:r},f=function(e){var t=/project:(\d+)/,r=t.exec(e);return r?{type:"project",id:parseInt(r[1])}:r},p=function(e){var t=/_project_(\d+)/,r=t.exec(e);return r?{type:"project",id:parseInt(r[1])}:r},m=function(e){var t=/filter\?id=(\d+)/,r=t.exec(e);return r?{type:"filter",id:parseInt(r[1])}:r},h=function(e){var t=/filter:(\d+)/,r=t.exec(e);return r?{type:"filter",id:parseInt(r[1])}:r},_=function(e){var t=/label\?name=(.+)/,r=t.exec(e);return r?{type:"label",name:r[1]}:r},v=function(e){var t=/label:(\d+)/,r=t.exec(e);return r?{type:"label",id:parseInt(r[1])}:r},y=function(e){return"today"===e?{type:"today"}:null},g=function(e){return"next7days"===e?{type:"next7days"}:null},b=function(e){return"overdue, today"===e?{type:"today"}:null},w=function(e){return"overdue, 7 days"===e?{type:"next7days"}:null},E=function(e){return"_blank"===e||"blank"===e?{type:"blank"}:null},k=r.parseStartPage=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){try{for(var r=0;r<t.length;r++){var n=t[r](e);if(n)return n}}catch(e){}return{type:"invalid"}}}(y,b,g,w,E,d,f,p,_,v,m,h),S=!0,j={show:function(){var e=c.getHash();return e&&S&&"start"!=e&&-1==e.indexOf("utm_source")?(c.updateView(e,!0),S=!1,l.hide(),!0):(j.queryStart(),c.updateLocation("start"),l.hide(),!1)},queryStart:function(){var e=window.Settings&&window.Settings.START_PAGE||"today";u.deselectCurrent();var t=o.default.getState(),r=k(e);switch(r.id&&(r.id=(0,i.toUniqueID)(t,r.id)),r.type){case"today":o.default.dispatch((0,a.showTodayView)());break;case"next7days":o.default.dispatch((0,a.show7DaysView)());break;case"project":var n=r.id;t.projects[n]&&o.default.dispatch((0,a.showProjectView)([n],{bottomListSelected:!0}));break;case"label":var l=r.id;t.labels[l]&&o.default.dispatch((0,a.showLabelView)(l,{bottomListSelected:!0}));break;case"filter":var c=r.id;t.filters[c]&&o.default.dispatch((0,a.showFilterView)(c,{bottomListSelected:!0}));break;case"blank":s.reset(),$replace($("editor"),null);break;case"invalid":o.default.dispatch((0,a.showQueryView)(e))}}};r.default=j},{"../../reducers/mainView":426,"../../stores/store":456,"../../utils":484,"../agenda/AgendaUtils":8,"../loading/Loading.js":39,"../location_manager/LocationManager.js":42,"../projects_list/ProjectListUtils":71}],92:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Signals,s=window,l=s.IstButton,u=window,c=u.Indicator,d=window,f=d.Alerts,p=window,m=p.GB_showHTML,h=e("../../models/SyncEngine"),v=e("../../models/ItemsModel"),y=e("../../models/ProjectsModel"),g=e("../../models/LabelsModel"),b=e("../../models/FiltersModel"),w=function(){function e(){var t=this;n(this,e),i.connect("sync_state_changed",function(){if(t.ul){h.getSyncState()===h.sync_states.syncing?($replace(t.ul,LI("...")),$setVisibility(t.btn_retry,!1),$show(t.indicator)):(t.generateListReport(t.ul),$setVisibility(t.btn_retry,!0),$hide(t.indicator))}})}return o(e,[{key:"show",value:function(){var e=this;this.btn_retry=l.createButton(_("Try to sync again"),null,"red");var t=l.createButton(_("Discard failed updates"),null),r=DIV({c:"sync_report"},DIV(_("Your updates couldn't be synced with Todoist's servers. Please wait a few minutes and try again."),DIV({c:"small_separator"}),this.indicator=c.cssSpinner(),this.btn_retry,DIV({c:"separator"}),_("Detailed log"),":",DIV({c:"small_separator"}),this.ul=UL({c:"sync_error_text",name:"body"})),DIV({c:"separator"}),DIV(SPAN({c:"desc"},_("Discarding will restore your sync, but your updates mentioned above will be lost")),DIV({c:"small_separator"}),t),DIV({c:"separator"}));$hide(this.indicator),this.generateListReport(this.ul),$AEV(this.btn_retry,"click",function(){return h.sync(null,!0,!0),!1}),$AEV(t,"click",function(){return f.confirmYesNo(_("Are you sure you want to discard your sync updates?"),function(e){e&&(h.sync_queue.clear(),i.sendSignal("clear_local_data"),window.location.reload())}),!1});var n=DIV({c:"sync_error_handler"},r);m(_("Sync issues"),n,300,550,function(){e.ul=null})}},{key:"generateListReport",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];$replace(e,null);var n=function(e){var t=y.get(e.id),r=(null!=t?t.name:void 0)||e.name;if(r)return $trim(r,75)},o=0,a={};if(!r){var i=void 0;$add(e,LI({c:"full_log"},i=A({href:"#"},_("Show full log")))),$AEV(i,"click",function(){return t.generateListReport(e,!0),!1})}var s=!0,l=!1,u=void 0;try{for(var c,d=h.sync_queue.get()[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value;if(f.last_error){var p;o++;var m=f.type+"-"+f.args.id+"-"+f.last_error.error_code;if(a[m])continue;a[m]=!0;var w=null;try{-1!==f.type.indexOf("item_")?w=function(e){var t=v.getById(e.id),r=(null!=t?t.content:void 0)||e.content;if(r)return $trim(r,75)}(f.args):-1!==f.type.indexOf("project_")?w=n(f.args):-1!==f.type.indexOf("share_")?w=n(f.args):-1!==f.type.indexOf("label_")?w=function(e){var t=g.getById(e.id),r=(null!=t?t.name:void 0)||e.name;if(r)return $trim(r,75)}(f.args):-1!==f.type.indexOf("filter_")&&(w=function(e){var t=b.get(e.id),r=(null!=t?t.name:void 0)||t.name;if(r)return $trim(r,75)}(f.args))}catch(e){}w=w?B(w,": "):"",p=r?LI(B(w),$serialize(f)):LI(B(w),this.humanCommandType(f.type),". "),$add(e,p)}}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}0===o&&$add(e,LI(_("All updates processed successfully!")))}},{key:"getJson",value:function(){var e=[window.User.id,navigator.appVersion,window.LANG,$queryArgument("v")],t=!0,r=!1,n=void 0;try{for(var o,a=h.sync_queue.get()[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;if(i.last_error){var s=$update({},i);s.args=$update({},i.args),s.args&&(s.args.content&&(s.args.content="..."),s.args.name&&(s.args.name="...")),e.push(s)}}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return $serialize(e)}},{key:"humanCommandType",value:function(e){switch(e){case"item_add":return _("Task add failed");case"item_delete":return _("Task delete failed");case"item_update":case"item_update_date_complete":return _("Task update failed");case"item_move":return _("Task move failed");case"item_complete":return _("Task complete failed");case"item_uncomplete":return _("Task uncomplete failed");case"item_update_orders_indents":case"item_update_day_orders":return _("Task order update failed");case"note_add":return _("Comment add failed");case"note_update":return _("Comment update failed");case"note_delete":return _("Comment delete failed");case"project_add":return _("Project add failed");case"project_update":return _("Project update failed");case"project_delete":return _("Project delete failed");case"project_archive":return _("Project archive failed");case"project_unarchive":return _("Project unarchive failed");case"project_update_orders_indents":return _("Project order update failed");case"label_add":return _("Label add failed");case"label_delete":return _("Label delete failed");case"label_update":return _("Label update failed");case"label_update_orders":return _("Label order update failed");case"filter_add":return _("Filter add failed");case"filter_delete":return _("Filter delete failed");case"filter_update":return _("Filter update failed");case"filter_update_orders":return _("Filter order update failed");case"share_project":return _("Share project failed");case"delete_collaborator":return _("Remove collaborator failed");case"accept_invitation":return _("Accept invitation failed");case"reject_invitation":return _("Reject invitation failed");case"delete_invitation":return _("Delete invitation failed")}return _("%s failed").replace("%s",e)}}]),e}();t.exports=new w},{"../../models/FiltersModel":166,"../../models/ItemsModel":167,"../../models/LabelsModel":168,"../../models/ProjectsModel":171,"../../models/SyncEngine":181}],93:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Signals,s=window,l=s.Indicator,u=window,c=u.IstTooltip,d=e("../../models/SyncEngine"),f=e("../../models/LoadEngine"),p=e("../../components/sync_error_handler/SyncErrorHandler"),m=function(){function e(){var t=this;n(this,e),this.render=this.render.bind(this),this.syncStateChanged=this.syncStateChanged.bind(this),this._syncStateChanged=this._syncStateChanged.bind(this),this.showOfflineInfo=this.showOfflineInfo.bind(this),this.forceSync=this.forceSync.bind(this),this.showSyncErrorHandler=this.showSyncErrorHandler.bind(this),this.current_state=null,i.connect("sync_state_changed",this.syncStateChanged),$AEV(window,"online",this.syncStateChanged),$AEV(window,"offline",this.syncStateChanged),$AEV(window,"load",function(){t.render(),!1===navigator.onLine&&t.syncStateChanged()})}return o(e,[{key:"render",value:function(){return this.holder?this.holder:(this.holder=SPAN({id:"sync_state_icon"}),this.holder)}},{key:"syncStateChanged",value:function(){this.holder&&(this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(this._syncStateChanged,100))}},{key:"_syncStateChanged",value:function(){var e=d.getSyncState(),t=d.sync_states,r=null;r=e===t.syncing?"syncing":d.global_error?"offline":d.getQueueErrorLength()?"offline":f.fetched_data_from_server?"none":"offline";var n=navigator.onLine;if("none"==r&&void 0!==n&&(n||(r="offline")),this.current_state!==r&&(this.current_state=r,r))if($replace(this.holder,null),"syncing"===r)$add(this.holder,l.cssSpinner("small"));else if("offline"===r){var o=void 0;this.offline_link=o=SPAN({href:"#",c:"fixed_pos"},svgs.get("sm1/warning.svg",{className:"sync_alert"})),$AEV(o,"mouseover",$p(this.showOfflineInfo,o)),$AEV(o,"mouseout",c.hide),!d.global_error&&d.getQueueErrorLength()>0&&$addClass(o,"sync_error_blinking"),o.onclick=this.forceSync,$add(this.holder,o)}}},{key:"showOfflineInfo",value:function(e){var t=void 0;d.getSyncState();var r=_("Offline mode is on");if(this.offline_link.onclick=this.forceSync,!1===navigator.onLine)t=DIV({c:"sync_error_tooltip"},_("Looks like you're not connected to the Internet. Changes you make in offline mode will be synced when you reconnect."));else if(d.global_error){var n=d.timeout/1e3||10;t=DIV({c:"sync_error_tooltip"},P(_("We're having trouble reaching the Todoist servers. Changes you make in offline mode will be synced once we're able to reconnect.")),P(_("Click on this icon to force a sync.")),P(_("Trying again in %s seconds...").replace("%s",n)))}else d.getQueueErrorLength()>0?(r=_("Sync issues"),t=DIV({c:"sync_error_tooltip"},_("We could not sync some updates"),BR(),_("Click here for more details")),this.offline_link.onclick=this.showSyncErrorHandler):t=null;c.show(e,DIV({c:"ist_tooltip_content"},B(r),t),null,5,5)}},{key:"forceSync",value:function(){return c.hide(),this.current_state="syncing",d.sync(null,!0,!0),$replace(this.holder,l.cssSpinner("small")),!1}},{key:"showSyncErrorHandler",value:function(){return p.show(),!1}}]),e}();t.exports=new m},{"../../components/sync_error_handler/SyncErrorHandler":92,"../../models/LoadEngine":169,"../../models/SyncEngine":181}],94:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Signals,s=window,l=s.GB_hide,u=window,c=u.Indicator,d=window,f=d.IstButton,p=window,m=p.GB_showYouTube,h=window,v=h.GB_showHTML,y=window,g=y.GHtml5Uploader,b=e("../../models/ProjectsModel"),w=e("../../models/TemporaryIds"),E=e("../copy_to_clipboard/CopyForm"),k=e("../../containers/premium_promo/PremiumOnlyModal"),S=e("../../models/SyncEngine"),j=function(){function e(){n(this,e),this.showExportTemplate=this.showExportTemplate.bind(this),this.exportAsFile=this.exportAsFile.bind(this),this.exportAsUrl=this.exportAsUrl.bind(this)}return o(e,[{key:"showExportTemplate",value:function(e){var t=void 0,r=void 0;if(!this.checkPremiumForTemplates())return!1;var n=DIV({
c:"template_exporter"},DIV(_("Please pick the template type:")),DIV(t=f.createButton(_("Export as file"),svgs.get("sm1/file.svg"))),DIV(r=f.createButton(_("Export as shareable URL"),svgs.get("sm1/link.svg"))),DIV({c:"template_relative"},LABEL(this.input_relative=INPUT({type:"checkbox"}),_("Use relative dates")),BR(),SPAN({c:"desc"},_("Relative means \u201cTomorrow\u201d will get turned into \u201c+1 day\u201d"))));this.input_relative.checked=!0,$AEV(t,"click",$p(this.exportAsFile,e)),$AEV(r,"click",$p(this.exportAsUrl,e,n)),v(_("Export as a template"),n,300,400)}},{key:"exportAsFile",value:function(e){var t=this,r=function(e){var r=t.input_relative.checked&&1||0,n=$encode({project_id:e,use_relative_dates:r}),o="/API/"+S.api_version+"/templates/export_as_file?"+n;return window.open(o),l(),!1};this.customShowGb(e,r)}},{key:"exportAsUrl",value:function(e,t){var r=this,n=function(e){var r=$encode({t_url:e.file_url}),n=E.genereate();n.input.value="https://todoist.com/API/"+S.api_version+"/import/project_from_url?"+r,$replace(t,DIV(_("Copy the URL"),":",BR(),n.form))},o=function(){$replace(t,c.cssSpinner());var o=$requestJSON("/API/"+S.api_version+"/templates/export_as_url");o.addCallback(n);var a=r.input_relative.checked&&1||0;o.sendReq({project_id:e,use_relative_dates:a})};return this.customShowGb(e,o),!1}},{key:"showImport",value:function(e){var t=void 0,r=void 0;if(!this.checkPremiumForTemplates())return!1;var n=DIV({c:"template_importer"},t=DIV({c:"upload_holder"}),DIV({c:"template_help"},_("Import tasks from a template, use this to create a new project by duplicating an existing one."),BR(),r=A({href:"https://www.youtube.com/watch?v=_Rl_CLGY_3o"},"\u25b6 ",_("Show a help video"))));$AEV(r,"click",function(){return m("","https://www.youtube.com/watch?v=_Rl_CLGY_3o",387,640),!1});var o=function(){var t={onSuccess:function(){b.get(e)&&i.sendSignal("instant_refresh_interface"),setTimeout(l,200)}};top.SyncEngine.sync(t,!0)},a=new g(t,"/API/"+S.api_version+"/templates/import_into_project?project_id="+e,!1,{allFilesUploaded:o,fileUploaded:o});return v(_("Import from template"),n,300,400,{close_validator_fn:function(){return a.remove(),!0}}),!1}},{key:"checkPremiumForTemplates",value:function(){return!!window.User.is_premium||(k.showTemplate(),!1)}},{key:"customShowGb",value:function(e,t){w.waitToResolve(e,function(e){t(e)})}}]),e}();t.exports=new j},{"../../containers/premium_promo/PremiumOnlyModal":120,"../../models/ProjectsModel":171,"../../models/SyncEngine":181,"../../models/TemporaryIds":184,"../copy_to_clipboard/CopyForm":19}],95:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../../stores/store"),s=n(i),l=e("../../stores/subscribeSelected"),u=n(l),c=e("../../reducers/settings"),d=e("../../reducers/selectors"),f=e("../../logger/Logger"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(f),m=window,h=m.Signals,_={amethyst:"https://d3ptyyxy2at9ui.cloudfront.net/theme_amethyst.svgs-335efe.js",blueberry:"https://d3ptyyxy2at9ui.cloudfront.net/theme_blueberry.svgs-6ad750.js",clover:"https://d3ptyyxy2at9ui.cloudfront.net/theme_clover.svgs-d26a90.js",dark:"https://d3ptyyxy2at9ui.cloudfront.net/theme_dark.svgs-57fa08.js",graphite:"https://d3ptyyxy2at9ui.cloudfront.net/theme_graphite.svgs-4435ec.js",gold:"https://d3ptyyxy2at9ui.cloudfront.net/theme_gold.svgs-08fb4e.js",neutral:"https://d3ptyyxy2at9ui.cloudfront.net/theme_neutral.svgs-6e975d.js",noir:"https://d3ptyyxy2at9ui.cloudfront.net/theme_noir.svgs-57fdfa.js",sky:"https://d3ptyyxy2at9ui.cloudfront.net/theme_sky.svgs-170135.js",sunflower:"https://d3ptyyxy2at9ui.cloudfront.net/theme_sunflower.svgs-a53879.js",tangerine:"https://d3ptyyxy2at9ui.cloudfront.net/theme_tangerine.svgs-f10197.js",todoist:"https://d3ptyyxy2at9ui.cloudfront.net/theme_todoist.svgs-fb8195.js"},v=function(){function e(){var t=this;o(this,e),this.theme="theme_todoist",this.theme_name="todoist",this.theme_number=15,this.theme_id_to_name={1:"noir",2:"neutral",3:"tangerine",4:"sunflower",5:"clover",6:"blueberry",7:"sky",8:"amethyst",9:"graphite",10:"gold",11:"dark"},this.loading_svg_bundles={},this.switchThemes=this.switchThemes.bind(this),this.loadSvgBundle=this.loadSvgBundle.bind(this),(0,u.default)(s.default,c.getTheme,d.dataLoaded,function(e,r){$html()&&void 0!==e&&r&&t.theme_number!==e&&t.switchThemes(e)})}return a(e,[{key:"changeThemeClass",value:function(e){var t="theme_"+this.theme_id_to_name[e]||"theme_todoist",r=$html().className;r=r.replace(/theme_\S+/g,""),r+=" "+t,$html().className=r}},{key:"switchThemes",value:function(e){var t=this;$("top_bar")&&(this.theme_number=e,this.theme_name=this.theme_id_to_name[e]||"todoist",this.theme="theme_"+this.theme_name,this.loadSvgBundle().then(function(){return t.changeThemeClass(e),h.sendSignal("theme_changed")}))}},{key:"loadSvgBundle",value:function(){var e=this;return this.loading_svg_bundles[this.theme_name]instanceof Promise?this.loading_svg_bundles[this.theme_name]:($remove($("theme-loader")),this.loading_svg_bundles[this.theme_name]=new Promise(function(t){var r=SCRIPT({id:"theme-loader",src:_[e.theme_name]||_.todoist,async:!0});r.onload=function(){e.loading_svg_bundles[e.theme_name]=!1,t()},r.onerror=function(r){e.loading_svg_bundles[e.theme_name]=!1,p.captureError(r,{tags:{where:"ThemesSVGLoader"}}),t()},$add(document.body,r)}),this.loading_svg_bundles[this.theme_name])}}]),e}();window.Themes=new v,t.exports=window.Themes},{"../../logger/Logger":141,"../../reducers/selectors":444,"../../reducers/settings":445,"../../stores/store":456,"../../stores/subscribeSelected":457}],96:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.GB_showHTML,s=window,l=s.GB_hideIfNeeded,u=window,c=u.format,d=e("../../models/Storage"),f=d.$storage,p=e("../opener/WindowOpener.js"),m=function(){function e(){n(this,e),this.getValidTimezone=this.getValidTimezone.bind(this),this.setValidTimezone=this.setValidTimezone.bind(this),this.checkTimezone=this.checkTimezone.bind(this),this.guessTimezone=this.guessTimezone.bind(this),this.showTimezoneHint=this.showTimezoneHint.bind(this),this.showTimezoneHintNormal=this.showTimezoneHintNormal.bind(this),this.createHintLink=this.createHintLink.bind(this),this.changeTimezoneToCurrent=this.changeTimezoneToCurrent.bind(this),this.hideTimezoneHint=this.hideTimezoneHint.bind(this),this.showSettings=this.showSettings.bind(this)}return o(e,[{key:"getValidTimezone",value:function(){return f("valid_timezone").get()}},{key:"setValidTimezone",value:function(e){f("valid_timezone").set(e)}},{key:"checkTimezone",value:function(){var e=void 0,t=void 0,r=void 0,n=window,o=n.User;if(o&&(o.tz_offset||o.tz_info)&&!window.PRINT_MODE){if(o.tz_info)e=o.tz_info.timezone,t=o.tz_info.hours,r=o.tz_info.minutes;else{e=o.timezone;var a=o.tz_offset;t=a[1],r=a[2]}if(this.getValidTimezone()!==e){var i=60*t+r,s=-(new Date).getTimezoneOffset();if(i!==s){var l=void 0;try{l=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){l=null}this.guessTimezone(s,l)}}}}},{key:"guessTimezone",value:function(e,t){var r=$requestJSON("/API/v7/guess_timezone");r.addCallback(this.showTimezoneHint),r.sendReq({mm_offset:e,timezone_name:t})}},{key:"showTimezoneHint",value:function(e){this.showTimezoneHintNormal(e)}},{key:"showTimezoneHintNormal",value:function(e){if(e!==(window.User.timezone||window.User.tz_info.timezone)){var t=DIV({c:"timezone_alert"});"UNKNOWN_TIMEZONE"!==e?(this.current_timezone=e,$add(t,c(_("Change timezone to %s?"),e),BR(),this.createHintLink(_("Yes, update my settings"),this.changeTimezoneToCurrent,"ist_button ist_button_red ist_button_big timezone_button"),BR(),this.createHintLink(_("Don't update settings"),this.hideTimezoneHint,"timezone_link timezone_link_block"),this.createHintLink(_("View my settings"),this.showSettings,"timezone_link timezone_link_block"))):$add(t,DIV({c:"timezone_alert_message"},_("Your system timezone doesn't match your Todoist settings. Fix it now?")),this.createHintLink(_("Yes, show my settings"),this.showSettings,"ist_button ist_button_red ist_button_big timezone_button"),BR(),this.createHintLink(_("Don't update settings"),this.hideTimezoneHint,"timezone_link timezone_link_block")),i(_("Time zone settings"),DIV(t),200,400)}}},{key:"createHintLink",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"timezone_link",n=A({c:r,href:"#"},e);return $AEV(n,"click",t),n}},{key:"changeTimezoneToCurrent",value:function(){var e=this;this.hideTimezoneHint();var t=$request("/prefs/general/update_timezone");return t.addCallback(function(){return window.tz_info?window.User.tz_info.timezone=e.current_timezone:window.User.timezone=e.current_timezone,f("User").set(window.User),window.location.reload()}),t.sendReq({value:this.current_timezone}),!1}},{key:"hideTimezoneHint",value:function(){return l(),!1}},{key:"showSettings",value:function(){return this.hideTimezoneHint(),p.showPrefs("general"),!1}}]),e}();t.exports=new m},{"../../models/Storage":179,"../opener/WindowOpener.js":53}],97:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Signals,s=window,l=s.IstTooltip,u=e("../sync_state_icon/SyncStateIcon"),c=e("../notifications/Notifications"),d=e("../quick_add/QuickAdd"),f=e("../start_page/StartPage.js").default,p=e("../../menus/MenuUser.js"),m=function(){function e(){n(this,e)}return o(e,[{key:"renderTopLogo",value:function(){var e=A({href:"#"},svgs.get("sm1/todoist_logo.svg"));e.onclick=function(){return f.queryStart(),!1},$replace($("logo"),e)}},{key:"render",value:function(){var e=void 0,t=void 0;this.renderTopLogo();var r=$("top_icons");$addBefore(e=SPAN({"data-track":"navigation|quick_add"},this.createIcon(SPAN(svgs.get("sm1/plus_m.svg")),SPAN(B(_("Quick Add Task")),BR(),_("Open by typing %s").replace("%s","q")))),$("before_pie")),e.id="quick_add_task_holder",$AEV(e,"click",function(){d.toggle()}),$add(r,c.renderIcon()),$add(r,t=SPAN({id:"gear_holder",c:"menu_icon fixed_pos","data-track":"navigation|gear"},svgs.get("sm1/gear.svg",{className:"gear_normal"}),svgs.get("sm1/gear_alert.svg",{className:"gear_alerted"}))),$AEV(t,"click",function(){return p.open(t),!1}),$ATT($("top_icons"),u.render()),i.connect("new_version_available",function(){$addClass(t,"is_alerted")})}},{key:"createIcon",value:function(e,t,r){var n=e;return $isTouchDeviceOnly()||t&&l.showSimpleText(n,t,null,2,4),r&&$AEV(n,"click",r),n}}]),e}();t.exports=new m},{"../../menus/MenuUser.js":157,"../notifications/Notifications":51,"../quick_add/QuickAdd":73,"../start_page/StartPage.js":91,"../sync_state_icon/SyncStateIcon":93}],98:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.MAX_NUMBER_OF_FILTERS=150,r.MAIN_VIEW_TYPE_QUERY="query",r.MAIN_VIEW_TYPE_PROJECT="project",r.MAIN_VIEW_TYPE_ACTIVITY_LOG="activity_log",r.MAIN_VIEW_TYPE_LABEL="label",r.MAIN_VIEW_TYPE_FILTER="filter",r.MAIN_VIEW_TYPE_TODAY="today",r.MAIN_VIEW_TYPE_7_DAYS="7_days",r.DragTypes={Item:"Item",FilterListItemSortable:"FilterListItemSortable",PostponeBox:"PostponeBox"}},{}],99:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(r.THEME_TODOIST=0,r.THEME_NOIR=1,r.THEME_NEUTRAL=2),o=(r.THEME_TANGERINE=3,r.THEME_SUNFLOWER=4),a=(r.THEME_CLOVER=5,r.THEME_BLUEBERRY=6,r.THEME_SKY=7,r.THEME_AMETHYST=8,r.THEME_GRAPHITE=9,r.THEME_GOLD=10,r.THEME_DARK=11),i=r.HEX_TODOIST="#db4c3f",s=r.HEX_NOIR="#3d3d3d",l=r.HEX_NEUTRAL="#f7f7f7",u=r.HEX_TANGERINE="#ff9000",c=r.HEX_SUNFLOWER="#fecf05",d=r.HEX_CLOVER="#3c9b0d",f=r.HEX_BLUEBERRY="#316fea",p=r.HEX_SKY="#4dc1e6",m=r.HEX_AMETHYST="#8e24aa",h=r.HEX_GRAPHITE="#506578",_=r.HEX_GOLD="#e0b53f",v=r.HEX_DARK="#f55547",y=(r.DARK_THEME_ICON_COLOR="#d4d4d4",r.DARK_THEME_ICON_COLOR_DARKER="#3e3e3e",r.DARK_THEME_BG_LIGHTER="#282828",[i,s,l,u,c,d,f,p,m,h,_,v]);r.colorInHex=function(e){return y[e]?y[e]:(console.log("[warning] unsupported theme value",e),i)},r.topIconColor=function(e){return e==n?"#484B4C":e==o?"#484B4C":e==a?"rgba(255, 255, 255, 0.8)":"#ffffff"}},{}],100:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("react-redux"),o=e("../react_components/notes/Avatar"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=function(e){return{theme:e.user.theme}};r.default=(0,n.connect)(i)(a.default)},{"../react_components/notes/Avatar":313,"react-redux":"react-redux"}],101:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("react-redux"),o=e("../react_components/DocumentTitle"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=function(e){return{mainView:e.mainView,filters:e.filters,labels:e.labels,projects:e.projects}};r.default=(0,n.connect)(i)(a.default)},{"../react_components/DocumentTitle":202,"react-redux":"react-redux"}],102:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../logger/Logger"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(f),m=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={hasError:!1,eventID:null},r}return i(t,e),s(t,[{key:"componentDidCatch",value:function(e,t){this.setState({hasError:!0});var r=p.captureError(e,{extra:{info:t},tags:{react:1}});this.setState({eventID:r})}},{key:"render",value:function(){if(!this.state.hasError)return this.props.children;if(!this.props.showErrorMsg)return null;var e=_("An unknown error happened while loading data... Please try reload Todoist.<br /><p>Contact Todoist Support (support@todoist.com) and supply the error ID below if this problem persists.</p>");return u.default.createElement("div",{style:{color:"#999999"}},u.default.createElement("p",{dangerouslySetInnerHTML:{__html:e}}),u.default.createElement("p",null,"Error ID: "+this.state.eventID))}}]),t}(u.default.Component);m.propTypes={showErrorMsg:d.default.bool,children:d.default.node},m.defaultProps={showErrorMsg:!1},r.default=m},{"../logger/Logger":141,"prop-types":"prop-types",react:"react"}],103:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("reselect"),a=e("../utils"),i=e("react-redux"),s=e("../reducers/filters"),l=e("../reducers/user"),u=e("../constants/constants"),c=e("../react_components/filter_list/FilterList"),d=function(e){return e&&e.__esModule?e:{default:e}}(c),f=e("../containers/premium_promo/PremiumOnlyModal"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(f),m=e("../reducers/mainView"),h=(0,o.createSelector)(s.filterGetAll,function(e){var t=e.mainView,r=void 0;return t.type===u.MAIN_VIEW_TYPE_FILTER&&t.bottomListSelected&&(r=t.id),r},function(e){return(0,l.isPremium)(e.user)},function(e,t,r){return{filters:e,filterCount:{},isPremium:r,selectedFilterID:t}}),_=(0,a.LMemoize)(function(e){return{onItemSelected:function(t){e((0,m.showFilterView)(t,{bottomListSelected:!0}))},onFilterAdd:function(t,r,n){var o=e((0,s.filterAdd)(t,r,n));e((0,m.showFilterView)(o.id,{bottomListSelected:!0}))},onDelete:function(t){e((0,s.filterRemove)(t.id))},onUpdate:function(t,r){(0,a.keys)(r).length>0&&(e((0,s.filterUpdate)(t,r)),e((0,m.showFilterView)(t,{bottomListSelected:!0})))},onFavoriteClick:function(t){e((0,s.filterUpdate)(t.id,{is_favorite:!0}))},onOrderChanged:function(t){for(var r=[],n=0;n<t.length;n++){var o=n+1,a=t[n];a.item_order!==o&&r.push({id:a.id,item_order:o})}r.length>0&&e((0,s.filterUpdateOrders)(r))}}}),v=function(){return p.showFilter(),!1},y=function(e,t,r){return e.isPremium?n({},e,t,r):n({},e,t,r,{onFavoriteClick:v,onAddClick:v,onEditClick:v,onDeleteClick:v})};r.default=(0,i.connect)(h,_,y)(d.default)},{"../constants/constants":98,"../containers/premium_promo/PremiumOnlyModal":120,"../react_components/filter_list/FilterList":267,"../reducers/filters":412,"../reducers/mainView":426,"../reducers/user":451,"../utils":484,"react-redux":"react-redux",reselect:"reselect"}],104:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("../utils/fp"),u=e("react"),c=n(u),d=e("prop-types"),f=n(d),p=e("react-redux"),m=e("../react_components/DailyGoalNotifier"),h=n(m),_=e("../react_components/WeeklyGoalNotifier"),v=n(_),y=e("./ProductivityStat"),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(y),b=e("../reducers/stats"),w=e("../reducers/settings"),E=function(e){return(0,l.get)("days_items."+(0,b.today)()+".goal_first_reached_at",e)},k=function(e){return(0,l.get)("week_items."+(0,b.thisWeek)()+".goal_first_reached_at",e)},S=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onClose=function(){r.setState({openDay:!1,openWeek:!1})},r.handleClick=function(){g.show(),r.setState({openDay:!1,openWeek:!1})},r.state={openDay:!1,openWeek:!1},r}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){var t=E(e.stats);t&&Date.now()-t.getTime()<1e3&&this.setState({openDay:!0});var r=k(e.stats);r&&Date.now()-r.getTime()<1e3&&this.setState({openWeek:!0})}},{key:"render",value:function(){if(Math.max(document.documentElement.clientWidth,window.innerWidth||0)<700)return null;var e=this.props,t=e.userName,r=e.stats,n=e.theme,o={userName:t,theme:n,open:this.state.openDay,goal:(0,b.dailyGoal)({stats:r}),onClose:this.onClose,onClick:this.handleClick},a={userName:t,theme:n,open:this.state.openWeek,goal:(0,b.weekGoal)({stats:r}),onClose:this.onClose,onClick:this.handleClick};return c.default.createElement(c.default.Fragment,null,c.default.createElement(h.default,o),c.default.createElement(v.default,a))}}]),t}(c.default.Component);S.propTypes={userName:f.default.string,stats:f.default.object};var j=function(e){return{userName:(0,l.get)("user.full_name",e),theme:(0,w.getTheme)(e),stats:e.stats}};r.default=(0,p.connect)(j)(S)},{"../react_components/DailyGoalNotifier":200,"../react_components/WeeklyGoalNotifier":214,"../reducers/settings":445,"../reducers/stats":446,"../utils/fp":477,"./ProductivityStat":110,"prop-types":"prop-types",react:"react","react-redux":"react-redux"}],105:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("react"),a=n(o),i=e("react-redux"),s=e("reselect"),l=e("../react_components/item_detail/ItemDetail"),u=n(l),c=e("../reducers/detailView"),d=function(e){return e.item?a.default.createElement(u.default,e):null},f=(0,s.createSelector)(function(e){return e.detailView},function(e){return e.items},function(e){return e.projects},function(e,t,r){if(!e||"item"!==e.type)return{};var n=t[e.id];return{item:n,project:r[n.project_id]}}),p=function(e){return{onClosed:function(){return e((0,c.detailViewClose)())}}};r.default=(0,i.connect)(f,p)(d)},{"../react_components/item_detail/ItemDetail":301,"../reducers/detailView":410,react:"react","react-redux":"react-redux",reselect:"reselect"}],106:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=f.default.getTotalCompletedCount(),n=DIV(),o={karmaLv:e,totalCompletedCount:r,lang:window.LANG,lastMonthCompletedCount:t.completed_last_month,topPercent:t.top_procent};GB_showHTML("",n,300,450,{close_validator_fn:function(){return l.default.unmountComponentAtNode(n),!0}}),l.default.render(i.default.createElement(c.default,o),n)}Object.defineProperty(r,"__esModule",{value:!0}),r.show=o;var a=e("react"),i=n(a),s=e("react-dom"),l=n(s),u=e("../react_components/KarmaPromotion"),c=n(u),d=e("../models/ItemsModel.js"),f=n(d);window.showKarmaPromotion=function(e,t){o(e,t)}},{"../models/ItemsModel.js":167,"../react_components/KarmaPromotion":206,react:"react","react-dom":"react-dom"}],107:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("react-redux"),o=e("reselect"),a=e("../reducers/labels"),i=e("../reducers/counts"),s=e("../reducers/mainView"),l=e("../constants/constants"),u=e("../react_components/label_list/LabelList"),c=function(e){return e&&e.__esModule?e:{default:e}}(u),d=(0,o.createSelector)(a.labelGetAll,i.countByLabel,function(e){var t=e.mainView;return t.type===l.MAIN_VIEW_TYPE_LABEL&&t.bottomListSelected?t.id:null},function(e,t,r){return{labels:e,labelCount:t,selectedLabelID:r}}),f=function(e){return{onLabelCreate:function(t){return e((0,a.labelAdd)(t))},onLabelUpdate:function(t){var r=t.id,n=t.name,o=t.color;return e((0,a.labelUpdate)(r,{name:n,color:o}))},onReorder:function(t){return e((0,a.labelUpdateOrders)(t))},onDelMenuClick:function(t){var r=t.id;return e((0,a.labelRemove)(r))},onFavoriteMenuClick:function(t){var r=t.id;return e((0,a.labelUpdate)(r,{is_favorite:!0}))},onLabelSelect:function(t){return e((0,s.showLabelView)(t.id,{bottomListSelected:!0}))}}};r.default=(0,n.connect)(d,f)(c.default)},{"../constants/constants":98,"../react_components/label_list/LabelList":303,"../reducers/counts":408,"../reducers/labels":422,"../reducers/mainView":426,"react-redux":"react-redux",reselect:"reselect"}],108:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("../utils"),c=e("react-redux"),d=e("react"),f=n(d),p=e("prop-types"),m=n(p),h=e("./FilterList"),v=n(h),y=e("./ErrorBoundary"),g=n(y),b=e("./TopMenu"),w=n(b),E=e("../react_components/icons/PlusIcon"),k=n(E),S=e("../react_components/reactist/ExpansionPanel"),j=n(S),T=e("../react_components/reactist/ExpansionPanelSummary"),O=n(T),I=e("../components/projects_list/ProjectList"),P=n(I),C=e("../react_components/label_list/LabelsPanel"),D=n(C),A=e("../reducers/selectors"),M=e("../reducers/user"),x=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.oldComponentRendered=!1,r.savePanelState=(0,u.debounce)(function(){localStorage.setItem("panels",JSON.stringify(r.state))},1e3),r.createPanelHandler=function(e){return function(t,n){r.setState(o({},e,n)),r.savePanelState();for(var a=[0,100,200,300,400],i=0;i<a.length;i++){var s=a[i];setTimeout(r.handleStickyHeaders,s)}}},r.handleFilterChange=r.createPanelHandler("filterOn"),r.handleLabelChange=r.createPanelHandler("labelOn"),r.handleProjectChanage=r.createPanelHandler("projectOn"),r.handleProjectAddClick=function(e){e.stopPropagation();var t=$$('#projects_list [data-type="project_list_item"]:first-child')[0];P.default.current_item=t,P.default.showAddItem(!0,!0),r.state.projectOn||r.setState({projectOn:!0})},r.showEditorStream=function(e){r.showEditorStreamCallback=e},r.handleFilterAddClick=function(e){e.stopPropagation(),r.showEditorStreamCallback("top"),r.state.filterOn||r.setState({filterOn:!0})},r.state={projectOn:!0,filterOn:!1,labelOn:!1},r.leftMenuHolder=f.default.createRef(),r.handleStickyHeaders=r.handleStickyHeaders.bind(r);var n=r.loadPanelState();return n&&(r.state=n),r}return s(t,e),l(t,[{key:"componentDidMount",value:function(){var e=this;this.props.loaded&&!this.oldComponentRendered&&this.renderOldComponent(),this.panelSummaries=this.leftMenuHolder.current.getElementsByClassName("panel_summary"),this.leftMenuHolder.current.addEventListener("click",this.handleStickyHeaders),this.leftMenuHolder.current.addEventListener("scroll",this.handleStickyHeaders),Signals.connect("filterlist_open_edit",function(){e.setState({filterOn:!0})})}},{key:"componentWillUnmount",value:function(){this.panelSummaries=null,this.leftMenuHolder.current.removeEventListener("click",this.handleStickyHeaders),this.leftMenuHolder.current.removeEventListener("scroll",this.handleStickyHeaders)}},{key:"componentWillReceiveProps",value:function(e){e.loaded&&!this.oldComponentRendered&&this.renderOldComponent()}},{key:"renderOldComponent",value:function(){this.oldComponentRendered||(P.default.initWithData(),P.default.render(),this.oldComponentRendered=!0)}},{key:"loadPanelState",value:function(){try{var e=localStorage.getItem("panels");return e?JSON.parse(e):null}catch(e){}}},{key:"handleStickyHeaders",value:function(){var e=44;window.MINI_VERSION&&(e=35);var t=document.getElementById("top_filters"),r=t.offsetTop+t.offsetHeight-e,n=this.leftMenuHolder.current.scrollTop;if(n<r){var o=!0,a=!1,i=void 0;try{for(var s,l=this.panelSummaries[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){s.value.style.top="auto"}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}}else{var u=!0,c=!1,d=void 0;try{for(var f,p=this.panelSummaries[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var m=f.value,h=m.nextSibling.offsetTop-m.offsetHeight-e,_=h+m.nextSibling.offsetHeight;m.style.top=n>=h&&n<=_?n-h+"px":n>=_?_-h+"px":"auto"}}catch(e){c=!0,d=e}finally{try{!u&&p.return&&p.return()}finally{if(c)throw d}}}}},{key:"render",value:function(){var e=this.props,t=e.loaded,r=e.isPremium,n=this.state,o=n.projectOn,a=n.filterOn,i=n.labelOn;return f.default.createElement("div",{id:"left_menu",className:"left_menu",ref:this.leftMenuHolder},f.default.createElement("div",{id:"list_holder"},t?f.default.createElement(w.default,null):null,f.default.createElement(j.default,{expanded:o,onChange:this.handleProjectChanage},f.default.createElement(O.default,{track:"navigation|projects_panel"},f.default.createElement("h5",null,_("Projects")),f.default.createElement(k.default,{className:"adder_icon",onClick:this.handleProjectAddClick,"data-track":"navigation|projects_quick_add"})),f.default.createElement("ul",{id:"projects_list",className:"items generic_left_list"}),f.default.createElement("div",{id:"projects_list_manager",className:"left_list_manager_holder"})),t&&f.default.createElement(D.default,{isPremium:r,expanded:i,onTogglePanel:this.handleLabelChange}),f.default.createElement(j.default,{expanded:a,onChange:this.handleFilterChange},f.default.createElement(O.default,{track:"navigation|filters_panel"},f.default.createElement("h5",null,_("Filters")),f.default.createElement(k.default,{className:"adder_icon",onClick:this.handleFilterAddClick,"data-track":"navigation|filters_quick_add"})),f.default.createElement("div",{id:"filters_list_holder"},f.default.createElement(g.default,{showErrorMsg:!0},t?f.default.createElement(v.default,{showEditorStream:this.showEditorStream}):null)))))}}]),t}(f.default.Component);x.propTypes={loaded:m.default.object,isPremium:m.default.bool};var R=function(e){return{loaded:(0,A.dataLoaded)(e),isPremium:(0,M.isPremium)(e.user)}};r.default=(0,c.connect)(R)(x)},{"../components/projects_list/ProjectList":70,"../react_components/icons/PlusIcon":291,"../react_components/label_list/LabelsPanel":305,"../react_components/reactist/ExpansionPanel":340,"../react_components/reactist/ExpansionPanelSummary":341,"../reducers/selectors":444,"../reducers/user":451,"../utils":484,"./ErrorBoundary":102,"./FilterList":103,"./TopMenu":118,"prop-types":"prop-types",react:"react","react-redux":"react-redux"}],109:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("react-redux"),a=e("../reducers/notes/notesActions"),i=e("../reducers/notes/notesSelectors"),s=e("../reducers/notes/notesConstants"),l=e("../reducers/user"),u=e("../models/Collaborators"),c=n(u),d=e("../react_components/notes/Notes"),f=n(d),p=function(e,t){var r=t.parentId,n=t.type,o=t.projectId,a=(0,l.getUser)(e);return{user:a,notes:(n===s.TYPE_PROJECT_NOTE?i.getProjectNotesSorted:i.getItemNotesSorted)(e,r),collaborators:c.default.getAll(o),isPremium:(0,l.isPremium)(a)}},m={onAddReaction:a.addReaction,onRemoveReaction:a.removeReaction,onAddNote:a.addNoteWithFiles,onRemoveNote:a.remove,onUpdateNote:a.update};r.default=(0,o.connect)(p,m)(f.default)},{"../models/Collaborators":160,"../react_components/notes/Notes":320,"../reducers/notes/notesActions":429,"../reducers/notes/notesConstants":430,"../reducers/notes/notesSelectors":432,"../reducers/user":451,
"react-redux":"react-redux"}],110:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0}),r.show=r.attach=void 0;var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("../utils/fp"),c=e("../stores/store"),d=o(c),f=e("react"),p=o(f),m=e("react-dom"),h=o(m),v=e("prop-types"),y=(o(v),e("../components/Constants")),g=o(y),b=e("../react_components/productivity_stat/ProductivityStat"),w=o(b),E=e("../react_components/spinners"),k=e("../components/opener/WindowOpener.js"),S=o(k),j=e("../logger/Logger"),T=n(j),O=e("../reducers/user"),I=e("../reducers/stats"),P=e("../reducers/settings"),C=e("./premium_promo/PremiumOnlyModal"),D=n(C),A=e("../react_components/emptyState"),M=window,x=M.Signals,R=window,N=R.GB_hide,L=(r.attach=function(e){$AEV(e,"click",L)},r.show=function(){if(!($$(".completed_quick_viz").length>0)){var e=DIV({c:"completed_quick_viz"}),t={fn_left_offset:function(e,t){var r=$position($("top_completed_holder")).x;return window.MINI_VERSION?r-200:r-t.width/2},fn_top_offset:function(){return window.MINI_VERSION?g.default.top_bar.top_offset_mini:g.default.top_bar.top_offset_full},fn_arrow_left:function(){return $position($("top_completed_holder")).x+7},fixed_pos:!0,close_validator_fn:function(){return h.default.unmountComponentAtNode(e),!0}},r=d.default.dispatch((0,I.fetchStats)()),n=d.default.getState();h.default.render(p.default.createElement(U,{width:280,user:n.user,stats:r,theme:(0,P.getTheme)(n)}),e);var o=TooptipWin.show(_("Your Productivity"),e,300,310,t);o&&o.g_window&&$addClass(o.g_window,"productivity-stat")}}),U=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={stats:null,error:null},r.props.stats.then(function(e){return r.setState({stats:e})}).catch(function(e){return r.setState({error:e})}),r}return s(t,e),l(t,[{key:"componentDidCatch",value:function(e,t){T.captureError(e,{extra:{info:t},tags:{react:1}}),this.setState({error:e})}},{key:"render",value:function(){var e=this.props,t=e.user,r=e.width,n=e.theme;if(!this.state.stats&&!this.state.error)return p.default.createElement("div",{className:"status_loading"},p.default.createElement(E.RingSpinner,{theme:n}));if(this.state.error)return p.default.createElement("div",{className:"status_error"},p.default.createElement("h6",null,_("Productivity report requires an Internet connection")),p.default.createElement("p",null,_("Please check your connection and try again")));if(0===(0,u.getOr)(0,"stats.completed_count",this.state))return p.default.createElement(A.EmptyStateProductivity,{onButtonClick:function(){return S.default.showPrefs("karma")}});var o=(0,u.getOr)(0,"stats.days_items[0].total_completed",this.state),a=(0,u.getOr)(0,"stats.week_items[0].total_completed",this.state),i={theme:n,hideKarma:!!t.karma_disabled,isPremium:(0,O.isPremium)(t),stat:this.state.stats,width:r,userName:t.full_name,completedToday:o,completedThisWeek:a,onSettingEditClick:function(){return S.default.showPrefs("karma")},onKarmaInfoClick:S.default.showKarmaInfo,onViewAllCompletedClick:function(){N(),(0,O.isPremium)(t)?x.sendSignal("activity_log.show_completed"):D.showCompletedTasksView()}};return p.default.createElement(w.default,i)}}]),t}(p.default.Component)},{"../components/Constants":1,"../components/opener/WindowOpener.js":53,"../logger/Logger":141,"../react_components/emptyState":241,"../react_components/productivity_stat/ProductivityStat":333,"../react_components/spinners":401,"../reducers/settings":445,"../reducers/stats":446,"../reducers/user":451,"../stores/store":456,"../utils/fp":477,"./premium_promo/PremiumOnlyModal":120,"prop-types":"prop-types",react:"react","react-dom":"react-dom"}],111:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("react"),a=n(o),i=e("react-redux"),s=e("reselect"),l=e("../react_components/project_detail/ProjectDetail"),u=n(l),c=e("../reducers/detailView"),d=function(e){return e.project?a.default.createElement(u.default,e):null},f=(0,s.createSelector)(function(e){return e.detailView},function(e){return e.projects},function(e,t){return e&&"project"===e.type?{project:t[e.id]}:{}}),p=function(e){return{onClosed:function(){return e((0,c.detailViewClose)())}}};r.default=(0,i.connect)(f,p)(d)},{"../react_components/project_detail/ProjectDetail":339,"../reducers/detailView":410,react:"react","react-redux":"react-redux",reselect:"reselect"}],112:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function u(e,t){if(!(0,Y.hasSeen)(Y.TOOLTIP_SMART_SCHEDULE,q.default.getState())){var r=function(){q.default.dispatch((0,Y.markSeen)(Y.TOOLTIP_SMART_SCHEDULE))},n=function(){q.default.dispatch((0,Y.markSeen)(Y.TOOLTIP_SMART_SCHEDULE)),u(e,t)};return void x.show(n,r)}if(A.isOffline()){var o=function(){u(e,t)};return void N.show(o)}var a=DIV(),i=GB_showHTML(_("Suggested dates"),a,500,600,{close_validator_fn:function(){return v.default.unmountComponentAtNode(a),!0}}),s=function(){t&&t.onSubmitted&&t.onSubmitted(),GB_hide()},l=q.default.getState();v.default.render(m.default.createElement(X,{theme:(0,W.getTheme)(l),items:e,onUpdateSubmit:s,onCancel:function(){return i.hide()}}),a)}Object.defineProperty(r,"__esModule",{value:!0});var c=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.openSmartSchedule=u;var p=e("react"),m=o(p),h=e("react-dom"),v=o(h),y=e("prop-types"),g=o(y),b=e("react-transition-group"),w=e("../models/Colors"),E=n(w),k=e("../models/ProjectsModel"),S=n(k),j=e("../filterist"),T=n(j),O=e("../models/SmartSchedule"),I=n(O),P=e("../components/formatter/Formatter.js"),C=o(P),D=e("../stores/SystemStatusStore"),A=n(D),M=e("./SmartScheduleTip"),x=n(M),R=e("./SmartScheduleOffline"),N=n(R),$=e("../models/ItemsModel"),L=o($),U=e("../react_components/spinners"),V=e("../react_components/icons"),F=e("./TasksDueBar"),B=o(F),H=e("../react_components/scheduler/SchedulerWrapper"),G=o(H),z=e("../stores/store"),q=o(z),W=e("../reducers/settings"),Y=e("../reducers/tooltip"),K=function(e){var t=e.children,r=l(e,["children"]);return m.default.createElement(b.CSSTransition,f({},r,{timeout:{enter:300,exit:0},classNames:"fade"}),t)},J=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.rescheduleClicked=r.rescheduleClicked.bind(r),r.removeClicked=r.removeClicked.bind(r),r}return s(t,e),d(t,[{key:"componentDidMount",value:function(){IstTooltip.showSimpleText(this.rescheduleBtnDom,_("Re-schedule"),null,10,3),IstTooltip.showSimpleText(this.removeBtnDom,_("Remove task from Smart Scheduling"))}},{key:"componentWillUnmount",value:function(){IstTooltip.hide()}},{key:"rescheduleClicked",value:function(e){var t=this,r=this.props.item;IstTooltip.hide(),this.listItemDom.classList.add("on_rescheduling"),G.default.show({anchor:e.target,dialogClassName:"scheduler-smart-schedule",holder:DIV({c:"scheduler_holder"}),selectedDate:r.due,selectedItems:[r],onDateSelect:function(e){t.props.rescheduleFn(r,e?e.toDate():null)},onHide:function(){t.listItemDom&&t.listItemDom.classList.remove("on_rescheduling")}})}},{key:"removeClicked",value:function(){this.props.removeFn(this.props.item),IstTooltip.hide()}},{key:"render",value:function(){var e=this,t=this.props.item,r=S.get(t.project_id),n={backgroundColor:E.getHex("project",r.color)},o=C.default.format(t.content),a=C.default.format(r.name),i=null;if(this.props.item.due){var s=_("Current: {item_due_date}").replace("{item_due_date}",DateUtils.formatView(this.props.item.due,!1));i=m.default.createElement("span",{className:"current_due"},s)}return m.default.createElement("li",{ref:function(t){return e.listItemDom=t}},m.default.createElement("div",{className:"task_block"},m.default.createElement("span",{className:"task_content",dangerouslySetInnerHTML:{__html:o}}),i),m.default.createElement("div",{className:"project_label"},m.default.createElement("span",{className:"project_label_name",dangerouslySetInnerHTML:{__html:a}}),m.default.createElement("span",{className:"project_label_color",style:n})),m.default.createElement("div",{className:"control"},m.default.createElement("span",{className:"control-reschedule",ref:function(t){return e.rescheduleBtnDom=t},onClick:this.rescheduleClicked},m.default.createElement(V.CalendarIcon,null)),m.default.createElement("span",{ref:function(t){return e.removeBtnDom=t},onClick:this.removeClicked},m.default.createElement(V.SmartScheduleStrikeIcon,null))))}}]),t}(m.default.Component);J.propTypes={item:g.default.object.isRequired,rescheduleFn:g.default.func.isRequired,removeFn:g.default.func.isRequired};var Q=function(e){function t(e){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return s(t,e),d(t,[{key:"render",value:function(){var e=this,t=void 0,r=void 0,n=void 0,o=void 0;if(this.props.newDueDate){var a=new Date;switch(DateistDateHelpers.day_diff(a,this.props.newDueDate)){case 0:t=_("Today"),r=DateUtils.formatView(this.props.newDueDate,!0);break;case 1:t=_("Tomorrow"),r=DateUtils.formatView(this.props.newDueDate,!0);break;default:t=DateUtils.getWeekDay(this.props.newDueDate.getDay()),r=DateUtils.formatView(this.props.newDueDate,!1)}n=T.getByDate(this.props.newDueDate),o=n.length>0?m.default.createElement(B.default,{withTooltip:!0,className:"day_section__item_bar",items:n,blockHeigth:11}):null}else t=_("No due date");return m.default.createElement("div",{className:"day_section"},m.default.createElement("h2",null,t,m.default.createElement("small",null,r),o),m.default.createElement("ul",null,m.default.createElement(b.TransitionGroup,null,this.props.items.map(function(t){return m.default.createElement(b.CSSTransition,{key:t.id,timeout:{enter:300,exit:0},classNames:"list_item"},m.default.createElement(J,{key:t.id,item:t,rescheduleFn:e.props.rescheduleFn,removeFn:e.props.removeFn}))}))))}}]),t}(m.default.Component);Q.propTypes={items:g.default.array.isRequired,newDueDate:g.default.object,rescheduleFn:g.default.func.isRequired,removeFn:g.default.func.isRequired};var X=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={items:r.props.items,newDueDates:null,error:null},r.reschedule=r.reschedule.bind(r),r.removeFromSmartSchedule=r.removeFromSmartSchedule.bind(r),r.submitSuggestion=r.submitSuggestion.bind(r),r}return s(t,e),d(t,[{key:"componentDidMount",value:function(){var e=this;I.predictItemDuedate(this.state.items,function(t,r){if(r)return e.setState({error:r}),void console.log("SmartSchedule error: ",r);e.setState({newDueDates:t})})}},{key:"reschedule",value:function(e,t){var r=this.state.items.indexOf(e),n=Array.from(this.state.newDueDates);n[r]=t,this.setState({newDueDates:n})}},{key:"removeFromSmartSchedule",value:function(e){var t=this.state.items.indexOf(e),r=Array.from(this.state.items),n=Array.from(this.state.newDueDates);r.splice(t,1),n.splice(t,1),0==r.length&&this.props.onCancel&&this.props.onCancel(),this.setState({items:r,newDueDates:n})}},{key:"submitSuggestion",value:function(){var e=this,t=this.state.items.reduce(function(t,r,n){return t[r.id]=e.state.newDueDates[n],t},{});L.default.updateDue(t),this.props.onUpdateSubmit()}},{key:"render",value:function(){var e=this;if(this.state.error)return m.default.createElement("div",{className:"SmartSchedule"},m.default.createElement("div",{className:"error_display"},m.default.createElement("p",null,"Opps...Something went wrong with our service. Please try again later.")));if(!this.state.newDueDates)return m.default.createElement("div",{className:"SmartSchedule"},m.default.createElement("div",{className:"smart_schedule_loader"},m.default.createElement(U.RingSpinner,{theme:this.props.theme})));var t=[],r=!0,n=!1,o=void 0;try{for(var a,i=this.state.newDueDates.entries()[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=c(a.value,2),l=s[0],u=s[1];u||t.push(this.state.items[l])}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}var d=void 0;t.length>0&&(d=m.default.createElement(K,{key:"no_date"},m.default.createElement(Q,{key:"no_date",items:t,newDueDate:null,rescheduleFn:this.reschedule,removeFn:this.removeFromSmartSchedule})));var f=new Map,p=!0,h=!1,v=void 0;try{for(var y,g=this.state.newDueDates.entries()[Symbol.iterator]();!(p=(y=g.next()).done);p=!0){var w=c(y.value,2),l=w[0],u=w[1];if(u){var E=this.state.items[l],k=I.isoDateStr(u);f.has(k)?f.get(k).push(E):f.set(k,[E])}}}catch(e){h=!0,v=e}finally{try{!p&&g.return&&g.return()}finally{if(h)throw v}}var S=Array.from(f).sort().map(function(t){var r=c(t,2),n=r[0],o=r[1],a=I.isoDateStrToDate(n);return a.setHours(23),a.setMinutes(59),a.setSeconds(59),m.default.createElement(K,{key:n},m.default.createElement(Q,{key:n,items:o,newDueDate:a,rescheduleFn:e.reschedule,removeFn:e.removeFromSmartSchedule}))});return m.default.createElement("div",{className:"SmartSchedule"},m.default.createElement("div",{className:"day_sections_holder"},m.default.createElement(b.TransitionGroup,null,m.default.createElement("div",{className:"desc"},_("Smart Schedule is an AI that helps you schedule tasks."),"\xa0",m.default.createElement("a",{href:"https://todoist.com/smartSchedule",target:"_blank",rel:"noopener noreferrer"},_("Learn more"))),d,S)),m.default.createElement("div",{className:"action_holder"},m.default.createElement("a",{onClick:this.props.onCancel,className:"cancel_btn"},_("Cancel")),m.default.createElement("a",{onClick:this.submitSuggestion,className:"ist_button ist_button_red submit_btn"},_("Update"))))}}]),t}(m.default.Component);X.propTypes={theme:g.default.number.isRequired,items:g.default.array.isRequired,onUpdateSubmit:g.default.func,onCancel:g.default.func}},{"../components/formatter/Formatter.js":22,"../filterist":133,"../models/Colors":161,"../models/ItemsModel":167,"../models/ProjectsModel":171,"../models/SmartSchedule":176,"../react_components/icons":300,"../react_components/scheduler/SchedulerWrapper":352,"../react_components/spinners":401,"../reducers/settings":445,"../reducers/tooltip":448,"../stores/SystemStatusStore":453,"../stores/store":456,"./SmartScheduleOffline":113,"./SmartScheduleTip":114,"./TasksDueBar":116,"prop-types":"prop-types",react:"react","react-dom":"react-dom","react-transition-group":"react-transition-group"}],113:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=DIV(),r=GB_showHTML(_("Smart Schedule"),t,500,500,{close_validator_fn:function(){return l.default.unmountComponentAtNode(t),!0}}),n=function(t){r.hide(),e&&e(),t.preventDefault()};l.default.render(i.default.createElement(d,{onTryClick:n}),t)}Object.defineProperty(r,"__esModule",{value:!0}),r.show=o;var a=e("react"),i=n(a),s=e("react-dom"),l=n(s),u=e("prop-types"),c=n(u),d=function(e){return i.default.createElement("div",{className:"smart_schedule_offline"},i.default.createElement("h1",null,_("Smart Schedule requires an Internet connection")),i.default.createElement("p",null,_("Please check your connection and try again")),i.default.createElement("div",{className:"action_holder"},i.default.createElement("a",{className:"ist_button ist_button_red try_btn",onClick:e.onTryClick},_("Try Again"))))};d.propTypes={onTryClick:c.default.func}},{"prop-types":"prop-types",react:"react","react-dom":"react-dom"}],114:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r=DIV(),n=GB_showHTML(_("Smart Schedule"),r,500,500,{close_validator_fn:function(){return l.default.unmountComponentAtNode(r),t&&t(),!0}}),o=function(t){n.hide(),e&&e(),t.preventDefault()};l.default.render(i.default.createElement(d,{onTryClick:o}),r)}Object.defineProperty(r,"__esModule",{value:!0}),r.show=o;var a=e("react"),i=n(a),s=e("react-dom"),l=n(s),u=e("prop-types"),c=n(u),d=function(e){return i.default.createElement("div",{className:"smart_schedule_tip"},i.default.createElement("div",{className:"banner_img_wrap"},i.default.createElement("img",{src:"https://d3ptyyxy2at9ui.cloudfront.net/smart_schedule_illustration-ad7f0c.png",alt:""})),i.default.createElement("h1",null,_("Manage your workload faster than ever!")),i.default.createElement("p",null,_("The AI-powered Smart Schedule suggests the best due dates for your tasks based on:")),i.default.createElement("ul",null,i.default.createElement("li",null,_("Task urgency")),i.default.createElement("li",null,_("Your current task load")),i.default.createElement("li",null,_("Your productivity habits"))),i.default.createElement("p",null,_("And more...")),i.default.createElement("div",{className:"action_holder"},i.default.createElement("a",{className:"menu_item_more",href:"https://todoist.com/smartSchedule",target:"_blank",rel:"noopener noreferrer"},_("Learn more")),i.default.createElement("a",{className:"ist_button ist_button_red try_btn",onClick:e.onTryClick},_("Try it"))))};d.propTypes={onTryClick:c.default.func}},{"prop-types":"prop-types",react:"react","react-dom":"react-dom"}],115:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("../utils"),c=e("react"),d=n(c),f=e("react-dom"),p=n(f),m=e("../stores/store"),h=n(m),v=e("../models/SyncLogs"),y=n(v),g=e("../react_components/SyncDebugConsole"),b=n(g),w=e("../models/ProjectsModel"),E=n(w),k=e("../models/Reminders"),S=e("../models/LabelsModel"),j=n(S);$AEV(document,"keydown",function(e){var t=window.event?event:e;68==t.keyCode&&t.ctrlKey&&e.altKey&&T()});var T=function(){var e=DIV();GB_showHTML(_("Sync debug console"),e,500,700,{close_validator_fn:function(){return p.default.unmountComponentAtNode(e),!0}}),p.default.render(d.default.createElement(I,null),e)},O=function(e){return(0,u.values)(e).filter(function(e){return(0,u.isTempID)(e.id)})},I=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));P.call(r);var n=y.default.getReport(),i=r.getAllUnsyncObject();return r.state=s({},n,{unsync:i,onUnsyncExportClick:r.handleUnsyncExport,onReportExportClick:r.handleReportExport}),r}return i(t,e),l(t,[{key:"getAllUnsyncObject",value:function(){return{projects:O(E.default.model_data),notes:O(h.default.getState().notes),reminders:O(k.RemindersModel.model_data),labels:O(j.default.model_data)}}},{key:"render",value:function(){return d.default.createElement(b.default,this.state)}}]),t}(d.default.Component),P=function(){var e=this;this.handleUnsyncExport=function(){var t=e.getAllUnsyncObject();t.user_id=window.User.id;var r=JSON.stringify(t);return(0,u.uploadJSON)(r,"unsync_data.json")},this.handleReportExport=function(){var e=y.default.getReport(),t=JSON.stringify(e);return(0,u.uploadJSON)(t,"sync_report.json")}}},{"../models/LabelsModel":168,"../models/ProjectsModel":171,"../models/Reminders":173,"../models/SyncLogs":182,"../react_components/SyncDebugConsole":211,"../stores/store":456,"../utils":484,react:"react","react-dom":"react-dom"}],116:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("react"),c=o(u),d=e("prop-types"),f=o(d),p=e("classnames"),m=o(p),h=e("../utils/format"),_=o(h),v=e("../models/ProjectsModel"),y=n(v),g=e("../models/Colors"),b=n(g),w=function(e){function t(){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),l(t,[{key:"componentDidMount",value:function(){if(this.props.withTooltip){var e=(0,_.default)(_n("{count} task due","{count} tasks due",this.props.items.length),{count:this.props.items.length});IstTooltip.showSimpleText(this.ref,e)}}},{key:"render",value:function(){var e=this,t=this.props,r=t.blockHeight,n=t.blockWidth,o=t.className,a=t.items,i=void 0;try{var s=a.map(function(e){var t=y.get(e.project_id);return b.getHex("project",t.color)}).sort();i=s.map(function(e,t){var o={backgroundColor:e,display:"inline-block",width:n,height:r};return c.default.createElement("span",{key:t,className:"tasks-due-bar-unit",style:o})})}catch(e){i=[]}var l=(0,m.default)("tasks-due-bar",o);return c.default.createElement("div",{ref:function(t){return e.ref=t},className:l},i)}}]),t}(c.default.Component);w.propTypes={blockHeight:f.default.number,blockWidth:f.default.number,items:f.default.array.isRequired,height:f.default.number,withTooltip:f.default.bool,className:f.default.string},w.defaultProps={blockHeight:8,blockWidth:8,withTooltip:!1},r.default=w},{"../models/Colors":161,"../models/ProjectsModel":171,"../utils/format":474,classnames:"classnames","prop-types":"prop-types",react:"react"}],117:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(){try{return ICE.annotateAjaxData.push(function(e){window.CLIENT_ID&&e instanceof Object&&(e._client_id=window.CLIENT_ID)}),B.default.init(),L.default.loadData().then(Pe.default.loadSvgBundle).then(function(){Signals.sendSignal("app_data_loaded"),l(),De.default.inIDB("notes")&&De.default.loadStatus.notes.then(function(){Signals.sendSignal("instant_refresh_interface")}),ke.start(),setTimeout(function(){$addClass($html(),"todoist_loaded")},50),A.default.onIntialized&&A.default.onIntialized()}).catch(function(e){(0,je.default)(e,{message:_("Could not load Todoist local data. Could be because you are using a private window. Please try login again.")})}),(0,R.postMessageToWindow)(top,"TODOIST_INITED:true")}catch(e){(0,je.default)(e,{message:_("Could not load Todoist local data. Could be because you are using a private window. Please try login again.")})}}function l(){var e=$("left_menu");return $hide($("app_holder"),e,$("content")),e&&x.default.render(),window.PageAddTask=pe.default,IstTooltip.init(),re.default.init(),Y.default.init(),G.default.init(),q.default.init(),oe.default.init(),Y.default.init(),ee.default.init(),ue.ProjectEditorGeneric.init(),X.default.init(),le.default.render(),he.default.init(X.default.get()),ve.default.init(),ge.default.init(),we.default.init(),ie.default.current_list=$("projects_list"),e&&$AEV(window,"load",function(){return ie.default.arrows.updateArrows()}),setTimeout(u,10),J.default.checkTimezone(),Signals.sendSignal("instant_refresh_interface"),document.addEventListener("click",function(e){(0,Oe.default)(e.target)}),Signals.sendSignal("data_fully_loaded")}function u(){try{c(),IstComplete.init(),A.default.loadStartPage&&de.default.show(),$AEV([$("editor")],"contextmenu",function(e){if(e.shift)return!0;var t,r;return!(!(t=$eventElm(e))||"textarea"!==(r=$nodeName(t))&&"input"!==r)||!e.ctrl}),$AEV(window,"resize",function(){Signals.sendSignal("hide_menus")}),$AEV($("left_menu"),"scroll",function(){var e=$("left_menu").scrollTop;e!==window.LEFT_MENU_ST&&Signals.sendSignal("hide_menus"),window.LEFT_MENU_ST=e}),$show($("app_holder"),$("top_bar"),$("left_menu"),$("content")),V.default.init(),V.default.recalculate()}catch(e){(0,je.default)(e)}}function c(){if(window.location.host.match(/firefox|gmail/)){var e=function(){return!1};FilesManager.isDropboxEnabled=e,FilesManager.isDriveEnabled=e,FilesManager.isSelectFilesEnabled=e}}Object.defineProperty(r,"__esModule",{value:!0});var d=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),f=e("react"),p=n(f),m=e("react-redux"),h=e("react-dnd"),v=e("@doist/react-dnd-html5-backend"),y=n(v),g=e("../stores/store"),b=n(g),w=e("./LeftMenu"),E=n(w),k=e("./topbar/TopBar"),S=n(k),j=e("./ErrorBoundary"),T=n(j),O=e("./GoalNotifier"),I=n(O),P=e("./DocumentTitle"),C=n(P),D=e("../models/Config"),A=n(D),M=e("../components/left_menu/LeftMenu"),x=n(M),R=e("../components/misc/Util.js"),N=e("../models/LoadEngine"),L=n(N),U=e("../mini/DimensionCalculator"),V=n(U),F=e("../plugin_version/MessageHandler"),B=n(F),H=e("../plugin_version/PluginVersion.js"),G=n(H),z=e("../plugin_version/LinkRedirecter.js"),q=n(z),W=e("../components/location_manager/LocationManager.js"),Y=n(W),K=e("../components/timezone_checker/TimezoneChecker"),J=n(K),Q=e("../components/agenda/Agenda.js"),X=n(Q),Z=e("../components/notes/Notes.js"),ee=n(Z),te=e("../components/item_selecter/ItemSelecter.js"),re=n(te),ne=e("../components/keyboard_shortcuts/KeyboardShortcuts.js"),oe=n(ne),ae=e("../components/projects_list/ProjectList"),ie=n(ae),se=e("../components/projects_list/ProjectArchive"),le=n(se),ue=e("../components/project_editor/ProjectEditor.js"),ce=e("../components/start_page/StartPage.js"),de=n(ce),fe=e("../components/page_add_task/PageAddTask"),pe=n(fe),me=e("../menus/MenuAgendaEdit.js"),he=n(me),_e=e("../menus/MenuUser.js"),ve=n(_e),ye=e("../menus/MenuItemEditMore"),ge=n(ye),be=e("../menus/MenuReschedule"),we=n(be),Ee=e("../models/Cron"),ke=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(Ee),Se=e("../init/showInitError"),je=n(Se),Te=e("../utils/traverseTracking"),Oe=n(Te),Ie=e("../components/themes/Themes"),Pe=n(Ie),Ce=e("../models/StatePersistence"),De=n(Ce),Ae=e("./UndoToast"),Me=n(Ae),xe=e("./promo_toast/PromoToast"),Re=n(xe),Ne=e("./ItemDetail"),$e=n(Ne),Le=e("./ProjectDetail"),Ue=n(Le),Ve=e("../components/promotions/AssistantPromo"),Fe=(n(Ve),function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),d(t,[{key:"componentDidMount",value:function(){s()}},{key:"render",value:function(){return p.default.createElement(m.Provider,{store:b.default},p.default.createElement("div",{id:"page_background"},p.default.createElement(S.default,null),p.default.createElement("div",{id:"app_holder"},p.default.createElement("a",{href:"/premium",className:"go_premium",target:"_blank",style:{display:"none"},id:"premium_promotion"},_("Upgrade and get more done")),p.default.createElement("div",{id:"notifier",style:{display:"none"}}),p.default.createElement(E.default,null),p.default.createElement("div",{id:"content",className:"main_content"},p.default.createElement("div",{id:"editor"}),p.default.createElement(T.default,null,p.default.createElement(Me.default,null)))),p.default.createElement(T.default,null,p.default.createElement(Re.default,null)),p.default.createElement(T.default,null,p.default.createElement(I.default,null)),p.default.createElement(T.default,null,p.default.createElement(C.default,null)),p.default.createElement(T.default,null,p.default.createElement(Ue.default,null)),p.default.createElement(T.default,null,p.default.createElement($e.default,null))))}}]),t}(p.default.Component));r.default=(0,h.DragDropContext)(y.default)(Fe)},{"../components/agenda/Agenda.js":5,"../components/item_selecter/ItemSelecter.js":27,"../components/keyboard_shortcuts/KeyboardShortcuts.js":35,"../components/left_menu/LeftMenu":38,"../components/location_manager/LocationManager.js":42,"../components/misc/Util.js":44,
"../components/notes/Notes.js":46,"../components/page_add_task/PageAddTask":54,"../components/project_editor/ProjectEditor.js":59,"../components/projects_list/ProjectArchive":69,"../components/projects_list/ProjectList":70,"../components/promotions/AssistantPromo":72,"../components/start_page/StartPage.js":91,"../components/themes/Themes":95,"../components/timezone_checker/TimezoneChecker":96,"../init/showInitError":140,"../menus/MenuAgendaEdit.js":146,"../menus/MenuItemEditMore":147,"../menus/MenuReschedule":155,"../menus/MenuUser.js":157,"../mini/DimensionCalculator":158,"../models/Config":162,"../models/Cron":163,"../models/LoadEngine":169,"../models/StatePersistence":178,"../plugin_version/LinkRedirecter.js":192,"../plugin_version/MessageHandler":193,"../plugin_version/PluginVersion.js":194,"../stores/store":456,"../utils/traverseTracking":511,"./DocumentTitle":101,"./ErrorBoundary":102,"./GoalNotifier":104,"./ItemDetail":105,"./LeftMenu":108,"./ProjectDetail":111,"./UndoToast":119,"./promo_toast/PromoToast":124,"./topbar/TopBar":126,"@doist/react-dnd-html5-backend":"@doist/react-dnd-html5-backend",react:"react","react-dnd":"react-dnd","react-redux":"react-redux"}],118:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("react-redux"),o=e("../constants/constants.js"),a=e("../reducers/mainView"),i=e("../react_components/TopMenu"),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=e("../reducers/projects"),u=e("../reducers/labels"),c=e("../reducers/filters"),d=e("../reducers/user"),f=e("../reducers/counts"),p=e("../utils"),m=e("../utils/fp"),h=e("reselect"),_=(0,h.createSelector)(function(e){return e.mainView},function(e){return e.projects},function(e,t){var r=e.id,n=e.ids,a=e.bottomListSelected;if(a)return null;switch(e.type){case o.MAIN_VIEW_TYPE_TODAY:return{menu:"today"};case o.MAIN_VIEW_TYPE_7_DAYS:return{menu:"7days"};case o.MAIN_VIEW_TYPE_LABEL:return{menu:"label",id:r};case o.MAIN_VIEW_TYPE_FILTER:return{menu:"filter",id:r};case o.MAIN_VIEW_TYPE_PROJECT:if(1!==n.length)return null;var i=n[0],s=t[i];if(!s)return null;if(s.inbox_project||s.team_inbox||!a)return{menu:"project",id:i};break;default:return null}}),v=[],y=(0,h.createSelector)(f.countByProject,l.projectGetFavorite,function(e){return e.user},(0,p.memoizeReturn)(function(e,t,r){var n=t.map(function(e){return e.id});return n.push(r.inbox_project),n.push(r.team_inbox),(0,m.pick)(n)(e)})),g=(0,h.createSelector)(_,u.labelGetFavorite,c.filterGetFavorite,l.projectGetFavorite,f.countToday,f.countSevenDays,f.countOverdue,y,f.countByLabel,f.countByFilter,(0,m.get)("collaborators.byPID"),function(e){return e.user},function(e){return e.clock},function(e,t,r,n,o,a,i,s,l,u,c,f,p){var m=(0,d.isPremium)(f),h=m?t:v,_=m?r:v;return{selected:e,clock:p,inboxPID:f.inbox_project,teamInboxPID:f.team_inbox,projects:n,labels:h,filters:_,todayCount:o,sevenDaysCount:a,overdueCount:i,projectCount:s,labelCount:l,filterCount:u,collaboratorsByPID:c}}),b=(0,p.LMemoize)(function(e){return{onSelect:function(t){var r=t.menu,n=t.id;switch(r){case"today":e((0,a.showTodayView)());break;case"7days":e((0,a.show7DaysView)());break;case"project":e((0,a.showProjectView)([n]));break;case"label":e((0,a.showLabelView)(n));break;case"filter":e((0,a.showFilterView)(n))}},onUnfavorite:function(t){var r=t.menu,n=t.id;switch(r){case"project":e((0,l.projectUpdate)(n,{is_favorite:0}));break;case"label":e((0,u.labelUpdate)(n,{is_favorite:0}));break;case"filter":e((0,c.filterUpdate)(n,{is_favorite:0}))}}}});r.default=(0,n.connect)(g,b)(s.default)},{"../constants/constants.js":98,"../react_components/TopMenu":213,"../reducers/counts":408,"../reducers/filters":412,"../reducers/labels":422,"../reducers/mainView":426,"../reducers/projects":435,"../reducers/user":451,"../utils":484,"../utils/fp":477,"react-redux":"react-redux",reselect:"reselect"}],119:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=e.text;return d.default.createElement("span",{dangerouslySetInnerHTML:{__html:g.default.formatSimple(t)}})}Object.defineProperty(r,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=e("react"),d=n(c),f=e("react-redux"),p=e("../reducers/items"),m=e("../reducers/projects"),h=e("../reducers/sections"),v=e("../reducers/mainView"),y=e("../components/formatter/Formatter"),g=n(y),b=e("../reducers/undo"),w=e("../utils/fp"),E=e("../utils"),k=e("../react_components/reactist/Notifier"),S=n(k),j=e("../react_components/TemplateText"),T=n(j),O={transition:"all 300ms ease-out",bottom:"-10px",opacity:0},I={entering:{bottom:"-10px",opacity:0},entered:{bottom:"10px",opacity:1}},P=function(e,t,r){switch(e.type){case m.PROJECT_MOVE_AND_REORDER_UNDO:return{onUndoClick:function(){return t((0,m.projectMoveAndReorderUndo)())},renderContent:function(){return _("Order changed")}};case p.ITEM_UPDATE_DAY_ORDER_UNDO:return{onUndoClick:function(){return t((0,p.itemUpdateDayOrderUndo)())},renderContent:function(){return _("Order changed")}};case p.ITEM_UPDATE_DUE_UNDO:return{onUndoClick:function(){return t((0,p.itemUpdateDueUndo)())},renderContent:function(){return _("Due date updated")}};case h.SECTION_REOREDER_UNDO:return{onUndoClick:function(){return t((0,h.sectionReorderUndo)())},renderContent:function(){return _("Order changed")}};case h.SECTION_MOVE_UNDO:return{onUndoClick:function(){return t((0,h.sectionMoveUndo)())},renderContent:function(){var n=e.destProject,o=d.default.createElement("a",{className:"project_link",href:"#project/"+n.id,onClick:function(e){e.preventDefault(),t((0,v.showProjectView)([n.id])),r()}},d.default.createElement(s,{text:n.name}));return d.default.createElement(T.default,{text:_("Section moved to {project_name}"),keyval:{project_name:o}})}};case p.ITEM_MOVE_AND_REORDER_UNDO:return{onUndoClick:function(){return t((0,p.itemMoveAndReorderUndo)())},renderContent:function(){return _("Order changed")}};case p.ITEM_MOVE_MULTIPLE_UNDO:return{renderContent:function(){var n=e.destProject,o=d.default.createElement("a",{className:"project_link",href:"#project/"+n.id,onClick:function(e){e.preventDefault(),t((0,v.showProjectView)([n.id])),r()}},d.default.createElement(s,{text:n.name}));return d.default.createElement(T.default,{text:_("Task moved to {project_name}"),keyval:{project_name:o}})}};case p.ITEM_COMPLETE_RECURRING_UNDO:return{onUndoClick:function(){return t((0,p.itemCompleteRecurringUndo)())},renderContent:function(){return(0,E.format)(_("Completed. Next occurrence: {date}"),{date:DateUtils.formatView(e.due)})}};case p.ITEM_COMPLETE_UNDO:return{onUndoClick:function(){return t((0,p.itemCompleteUndo)())},renderContent:function(){var t=(0,w.values)(e.prevState.items).length;return(0,E.format)(_n("1 task completed","{n} tasks completed",t),{n:t})}};case p.ITEM_ARCHIVE_UNDO:return{onUndoClick:function(){return t((0,p.itemArchiveUndo)())},renderContent:function(){var t=(0,w.values)(e.prevState.items).length;return(0,E.format)(_n("1 task archived","{n} tasks archived",t),{n:t})}};case b.NOTIFY_ADD_TO_PROJECT:return{renderContent:function(){var n=e.project,o=d.default.createElement("a",{className:"project_link",href:"#project/"+n.id,onClick:function(e){e.preventDefault(),t((0,v.showProjectView)([n.id])),r()}},d.default.createElement(s,{text:n.name})),a=_("Task added to {project_name}");return d.default.createElement(T.default,{text:a,keyval:{project_name:o}})}};default:return{renderContent:function(){return e.message}}}},C=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleKeybordShortcut=function(e){var t=e.keyAscii;if(!e.ctrl&&-1!==[117,1075].indexOf(t)&&"BODY"===e.target.tagName){var n=r.props,o=n.undo,a=n.dispatch;if(!o)return null;(0,P(o,a,r.handleHideClick).onUndoClick)()}},r.handleHideClick=function(){return r.props.dispatch((0,b.undoClear)())},r.handleOnClose=function(){return r.props.dispatch((0,b.undoClear)())},r}return i(t,e),u(t,[{key:"componentDidMount",value:function(){document.addEventListener("keypress",this.handleKeybordShortcut)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keypress",this.handleKeybordShortcut)}},{key:"render",value:function(){var e=this,t=this.props,r=t.undo,n=t.dispatch;if(!r)return null;var o=P(r,n,this.handleHideClick),a=o.renderContent,i=o.onUndoClick;return d.default.createElement(S.default,{opened:!0,autoHideDurationMs:8e3,resumeHideDurationMs:8e3,transitionDurationMs:300,onClose:this.handleOnClose},function(t,r){return d.default.createElement("div",{className:"undo_toast_positioner"},d.default.createElement("div",l({className:"undo_toast",style:l({},O,I[t])},r),d.default.createElement("div",{className:"notifier_content"},d.default.createElement("span",{className:"text_holder"},a()),i?d.default.createElement("a",{id:"undo_link",onClick:i},_("Undo")):null,d.default.createElement("a",{className:"hide_link",onClick:e.handleHideClick},_("Hide")))))})}}]),t}(d.default.Component),D=function(e){return{undo:e.undo}},A=function(e){return{dispatch:e}};r.default=(0,f.connect)(D,A)(C)},{"../components/formatter/Formatter":22,"../react_components/TemplateText":212,"../react_components/reactist/Notifier":342,"../reducers/items":417,"../reducers/mainView":426,"../reducers/projects":435,"../reducers/sections":441,"../reducers/undo":449,"../utils":484,"../utils/fp":477,react:"react","react-redux":"react-redux"}],120:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=DIV(),r=GB_showHTML(_("Premium"),t,500,500,{no_side_padding:!0,close_validator_fn:function(){return O.default.unmountComponentAtNode(t),!0}}),n=function(){r.hide()},o=k(Q[e],3),a=o[0],i=o[1],s=o[2];O.default.render(j.default.createElement(Z,{isEligibleForTrial:!1,feature:e,header:a,headerImg:i,body:s,onLinkClick:n}),t)}function a(e){var t=e.onClose,r=e.feature,n=e.isEligibleForTrial,o=k(Q[r],3),a=o[0],i=o[1],s=o[2];return j.default.createElement(Z,{isEligibleForTrial:n,header:a,headerImg:i,body:s,onLinkClick:t})}function i(){o(x)}function s(){o(R)}function l(){o(N)}function u(){var e=A.default.getState().user;o((e.features.restriction||e.restriction||0)>0?L:$)}function c(){o(U)}function d(){o(V)}function f(){o(F)}function p(){o(B)}function m(){o(H)}function h(){o(G)}function v(){o(z)}function y(){o(q)}function g(){o(W)}function b(){o(Y)}function w(){o(K)}function E(){o(J)}Object.defineProperty(r,"__esModule",{value:!0}),r.PremiumModal=r.MODAL_CONTENT=void 0;var k=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r.showLabel=i,r.showTaskComment=s,r.showProjectComment=l,r.showReminder=u,r.showFilter=c,r.showTemplate=d,r.showEmailForwarding=f,r.showProjectCalendarFeed=p,r.showCollaboratorLimit=m,r.showTaskActivityLog=h,r.showProjectActivityLog=v,r.showTaskDuplication=y,r.showSharedProjectFileUpload=g,r.showAudioRecording=b,r.showCompletedTasksView=w,r.showCompletedTasksSearch=E;var S=e("react"),j=n(S),T=e("react-dom"),O=n(T),I=e("prop-types"),P=n(I),C=e("react-redux"),D=e("../../stores/store"),A=n(D),M=e("../../utils"),x="FEATURE_LABEL",R="FEATURE_TASK_COMMENT",N="FEATURE_PROJECT_COMMENT",$="FEATURE_REMINDER",L="FEATURE_UNLIMITED_REMINDER",U="FEATURE_FILTER",V="FEATURE_TEMPLATE",F="FEATURE_EMAIL_FORWARDING",B="FEATURE_PROJECT_CALENDAR_FEED",H="FEATURE_COLLABORATOR_LIMIT",G="FEATURE_TASK_ACTIVITY_LOG",z="FEATURE_PROJECT_ACTIVITY_LOG",q="FEATURE_TASK_DUPLICATION",W="FEATURE_SHARED_PROJECT_FILE_UPLOAD",Y="FEATURE_AUDIO_RECORDING",K="FEATURE_COMPLETED_TASKS_VIEW",J="FEATURE_COMPLETED_TASKS_SEARCH",Q=r.MODAL_CONTENT={FEATURE_LABEL:[_("Labels are a Premium feature"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_labels%402x-0daa73.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Save time by batching your tasks together with custom labels like @email, @waiting, or @5_min.")))],FEATURE_TASK_COMMENT:[_("Comments & File Uploads are Premium features"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_comments%402x-9bdc1b.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Save time by keeping all the information you need organized right with your tasks. Upload any file \u2013 documents, photos, spreadsheets, PDFs \u2013 and add additional notes to your tasks.")))],FEATURE_PROJECT_COMMENT:[_("Project Comments and Uploads are Premium features"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_comments%402x-9bdc1b.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Keep all the project-level information you need neatly organized in one place. Upload relevant files and save important project details in additional notes.")))],FEATURE_REMINDER:[_("Reminders are a Premium feature"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_reminders%402x-2a06f2.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Never forget a task again. Send yourself a reminder by email or push notification at a specific date & time or location.")))],FEATURE_UNLIMITED_REMINDER:[_("Get unlimited Reminders!"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_reminders%402x-2a06f2.png",j.default.createElement("div",null,j.default.createElement("p",null,_("You\u2019ve reached your limit of 5 task reminders. Upgrade to Premium to get unlimited reminders \u2013 via email or push notification \u2013 for any task.")))],FEATURE_FILTER:[_("Custom Filters are a Premium feature"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_filters%402x-3488bf.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Customize your Todoist with saved searches for your most important task views. For example, all the tasks due in the next 7 days in a specific project.")))],FEATURE_TEMPLATE:[_("Templates are a Premium feature"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_templates%402x-9e0bf8.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Save time by copying and recreating any project. Create checklists for repetitive work like writing blog posts, preparing for trade shows, or onboarding new clients.")))],FEATURE_EMAIL_FORWARDING:[_("Email Forwarding is a Premium feature"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_mail%402x-b21cce.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Organize your inbox by forwarding emails as tasks to any Todoist project. Or keep all the relevant information organized in one place by forward emails as task and project comments.")))],FEATURE_PROJECT_CALENDAR_FEED:[_("Project Calendar Feeds is a Premium feature"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_calendar%402x-2ab433.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Stay on top of your deadlines by viewing any project inside your calendar. Stay on the same page by sharing project calendar feeds with clients, coworkers, or loved ones.")))],FEATURE_COLLABORATOR_LIMIT:[_("Share projects with up to 25 people!"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_collaborators%402x-d540f8.png",j.default.createElement("div",null,j.default.createElement("p",null,(0,M.format)(_n("You\u2019ve reached your limit of 1 collaborator per project.","You\u2019ve reached your limit of {n} collaborators per project.",5),{n:5})),j.default.createElement("p",null,_("Upgrade to Premium and share your projects with up to 25 people.")))],FEATURE_TASK_ACTIVITY_LOG:[_("Task Activity Log is a Premium feature"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_activity%402x-799c4c.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Get a quick overview of who did what and when for any task. See who created or completed it, changed the due date, added comments or file uploads, and more.")))],FEATURE_PROJECT_ACTIVITY_LOG:[_("Project Activity Log is a Premium feature"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_activity%402x-799c4c.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Get a quick overview of who did what and when in any project. See who created or completed tasks, changed due dates, added comments or file uploads, and more.")))],FEATURE_TASK_DUPLICATION:[_("Duplicate Tasks is a Premium feature"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_tasks%402x-8833a6.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Save time by easily creating copies of one or more tasks inside any project.")))],FEATURE_SHARED_PROJECT_FILE_UPLOAD:[_("File Uploads are a Premium feature"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_files%402x-c90218.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Share any file - documents, photos, spreadsheets, PDFs, and more - with anyone. Uploads stay neatly organized right with your tasks.")))],FEATURE_AUDIO_RECORDING:[_("Audio Recording is a Premium feature"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_audio%402x-893f7e.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Quickly share more details in an audio recording. Audio recordings stay neatly organized with your task and easily accessible to everyone in your shared project.")))],FEATURE_COMPLETED_TASKS_VIEW:[_("The Completed Tasks Overview is a Premium feature"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_tasks%402x-8833a6.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Get an overview of all completed tasks across all projects. Review your own progress \u2013 or create reports for your team. Free users can still view completed tasks inside any project.")))],FEATURE_COMPLETED_TASKS_SEARCH:[_("Completed tasks search is a Premium feature"),"https://d3ptyyxy2at9ui.cloudfront.net/premium_tasks%402x-8833a6.png",j.default.createElement("div",null,j.default.createElement("p",null,_("Expand your search to all your completed tasks.")))]};a.propTypes={onClose:P.default.func,feature:P.default.string.isRequired,isEligibleForTrial:P.default.bool};var X=function(e){var t=e.user;return{isEligibleForTrial:!(t.free_trail_expires||t.is_premium||!t.magic_num_reached)}},Z=(r.PremiumModal=(0,C.connect)(X)(a),function(e){var t=void 0;return t=e.isEligibleForTrial?j.default.createElement("a",{className:"ist_button ist_button_red link_cta",href:"/premium/free_trial",target:"_blank",onClick:e.onLinkClick},_("Start Your Free Trial")):j.default.createElement("a",{className:"ist_button ist_button_red link_cta",href:"/premium/upgrade",target:"_blank",onClick:e.onLinkClick},_("Upgrade Now")),j.default.createElement("div",{className:"PremiumOnlyModal"},j.default.createElement("h1",null,e.header,j.default.createElement("img",{src:e.headerImg,alt:""})),j.default.createElement("div",{className:"main_content"},e.body,j.default.createElement("div",{className:"action_holder"},t,j.default.createElement("a",{className:"link_more action",href:"https://todoist.com/premium",target:"_blank",rel:"noopener noreferrer",onClick:e.onLinkClick},_("Learn more about Premium")))))});Z.propTypes={isEligibleForTrial:P.default.bool.isRequired,onLinkClick:P.default.func,header:P.default.node,headerImg:P.default.string,body:P.default.node};_("Monthly Summary is a Premium feature"),_("Audio Recording is a Premium feature"),_("Photo Uploads are a Premium feature"),_("Premium Themes are a Premium feature"),_("The Activity Log is a Premium feature"),_("See any changes that have been made in your account, by you or your collaborators. Free users can still view their completed tasks inside any project."),_("Learn more")},{"../../stores/store":456,"../../utils":484,"prop-types":"prop-types",react:"react","react-dom":"react-dom","react-redux":"react-redux"}],121:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("react"),c=n(u),d=e("../../react_components/reactist/Notifier"),f=n(d),p=e("../../reducers/tooltip"),m=e("../../stores/store"),h=n(m),v={transition:"all 300ms ease-out",bottom:"-10px",opacity:0},y={entering:{bottom:"-10px",opacity:0},entered:{bottom:"10px",opacity:1}},g=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleLearnMoreClick=function(){r.markSeen()},r.handleGotItClick=function(){r.markSeen()},r.handleOnClose=function(){r.markSeen()},r.handleLearnMoreClick=r.handleLearnMoreClick.bind(r),r}return i(t,e),l(t,[{key:"markSeen",value:function(){h.default.dispatch((0,p.markSeen)(p.TOOLTIP_GOOGLE_ASSISTANT))}},{key:"render",value:function(){var e=this;return c.default.createElement(f.default,{opened:!0,autoHideDurationMs:8e3,resumeHideDurationMs:8e3,transitionDurationMs:300,onClose:this.handleOnClose},function(t,r){return c.default.createElement("div",s({className:"promo_banner",style:s({},v,y[t])},r),c.default.createElement("div",{className:"banner is-shown"},c.default.createElement("div",{className:"main-section-full"},c.default.createElement("h1",null,_("Your Google Assistant lists are now synced with Todoist projects. Any synced tasks will have the \u201cAssistant\u201d label.")),c.default.createElement("a",{className:"ist_button ist_button_red",onClick:e.handleGotItClick},_("Got it")),c.default.createElement("a",{className:"link",onClick:e.handleLearnMoreClick,href:"https://get.todoist.help/hc/en-us/articles/360003357900",target:"_blank",rel:"noopener noreferrer"},_("Learn more")))))})}}]),t}(c.default.Component);r.default=g},{"../../react_components/reactist/Notifier":342,"../../reducers/tooltip":448,"../../stores/store":456,react:"react"}],122:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0}),r.shouldShowPremiumTrialBanner=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("react-redux"),p=e("../../reducers/tooltip"),m=e("../../stores/store"),h=n(m),v=e("../../utils/format"),y=n(v),g=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onAcceptClick=r.onAcceptClick.bind(r),r.onRejectClick=r.onRejectClick.bind(r),r}return i(t,e),s(t,[{key:"onAcceptClick",value:function(){h.default.dispatch((0,p.acceptPremiumTrial)()).then(function(){window.location="/premium/free_trial"})}},{key:"onRejectClick",value:function(){h.default.dispatch((0,p.rejectPremiumTrial)())}},{key:"render",value:function(){return u.default.createElement("div",{className:"promo_banner"},u.default.createElement("div",{className:"banner is-shown"},u.default.createElement("img",{className:"banner-img",src:"https://d3ptyyxy2at9ui.cloudfront.net/laptop_premium-ab7b7a.png",alt:""}),u.default.createElement("div",{className:"main-section"},u.default.createElement("div",null,u.default.createElement("h1",null,(0,y.default)(_("{user_name}, want to try Premium for free? It\u2019s this way\u2026"),{user_name:this.props.user?this.props.user.full_name:""})),u.default.createElement("a",{className:"ist_button ist_button_red",onClick:this.onAcceptClick},_("Start Free Trial")),u.default.createElement("a",{className:"not-now-btn",onClick:this.onRejectClick},_("Not Now"))))))}}]),t}(u.default.Component);g.propTypes={user:d.default.object};var b=function(e){return{user:e.user}};r.default=(0,f.connect)(b)(g);r.shouldShowPremiumTrialBanner=function(e){return e.user&&!e.user.free_trail_expires&&!e.user.is_premium&&(0,p.isScheduled)(p.TOOLTIP_PREMIUM_TRIAL,e)}},{"../../reducers/tooltip":448,"../../stores/store":456,"../../utils/format":474,"prop-types":"prop-types",react:"react","react-redux":"react-redux"}],123:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0}),r.shouldShowPremiumWillExpireBanner=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("react-redux"),p=e("../../reducers/tooltip"),m=e("../../stores/store"),h=n(m),v=e("../../utils/format"),y=n(v),g=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onUpgradeClick=r.onUpgradeClick.bind(r),r.onNotNowClick=r.onNotNowClick.bind(r),r}return i(t,e),s(t,[{key:"onUpgradeClick",value:function(){h.default.dispatch((0,p.markSeen)(p.TOOLTIP_PREMIUM_EXPIRING,p.EVENT_PREMIUM_EXPIRING_FOLLOW))}},{key:"onNotNowClick",value:function(){h.default.dispatch((0,p.markSeen)(p.TOOLTIP_PREMIUM_EXPIRING,p.EVENT_PREMIUM_EXPIRING_CLOSE))}},{key:"render",value:function(){var e=this.props.user.full_name.split(" ")[0],t=void 0;return t=this.props.isPremiumTrial?(0,y.default)(_("{user_first_name}, just a reminder - your Premium trial ends in {day_num} days. Want to stay Premium? Click here."),{user_first_name:e,day_num:this.props.expireDayCount}):(0,y.default)(_("{user_first_name}, just a reminder - your Premium expires in {day_num} days. Want to keep your Premium access? Click here."),{user_first_name:e,day_num:this.props.expireDayCount}),u.default.createElement("div",{className:"promo_banner"},u.default.createElement("div",{className:"banner is-shown"},u.default.createElement("img",{className:"banner-img",src:"https://d3ptyyxy2at9ui.cloudfront.net/laptop_premium-ab7b7a.png",alt:""}),u.default.createElement("div",{className:"main-section"},u.default.createElement("h1",null,t),u.default.createElement("a",{className:"ist_button ist_button_red",onClick:this.onUpgradeClick,href:"https://todoist.com/premium",target:"_blank",rel:"noopener noreferrer"},this.props.isPremiumTrial?_("Upgrade"):_("Renew")),u.default.createElement("a",{className:"not-now-btn",onClick:this.onNotNowClick},_("Not Now")))))}}]),t}(u.default.Component);g.propTypes={user:d.default.object,isPremiumTrial:d.default.bool,expireDayCount:d.default.number};var b=function(e){var t=!1,r=null;e.user.free_trail_expires&&(r=new Date(e.user.free_trail_expires),t=r>new Date),t||(r=new Date(e.user.premium_until));var n=DateistDateHelpers.day_diff(new Date,r);return{user:e.user,isPremiumTrial:t,expireDayCount:n}};r.default=(0,f.connect)(b)(g);r.shouldShowPremiumWillExpireBanner=function(e){if(!e.user||!e.user.premium_until&&!e.user.free_trail_expires||!(0,p.isScheduled)(p.TOOLTIP_PREMIUM_EXPIRING,e))return!1;var t=!1,r=null;e.user.free_trail_expires&&(r=new Date(e.user.free_trail_expires),t=r>new Date),t||(r=new Date(e.user.premium_until));var n=DateistDateHelpers.day_diff(new Date,r);return!(n>40||n<0)}},{"../../reducers/tooltip":448,"../../stores/store":456,"../../utils/format":474,"prop-types":"prop-types",react:"react","react-redux":"react-redux"}],124:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("react-redux"),p=e("reselect"),m=e("./GoogleAssistant"),h=n(m),_=e("./PremiumTrialBanner"),v=n(_),y=e("./PremiumWillExpireBanner"),g=n(y),b=e("../../reducers/tooltip"),w=e("../../utils/fp"),E=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.state;return e.undo?null:(0,b.isScheduled)(b.TOOLTIP_GOOGLE_ASSISTANT,e)?u.default.createElement(h.default,null):(0,_.shouldShowPremiumTrialBanner)(e)?u.default.createElement(v.default,null):(0,
y.shouldShowPremiumWillExpireBanner)(e)?u.default.createElement(g.default,null):null}}]),t}(u.default.Component);E.propTypes={state:d.default.shape({tooltip:d.default.shape({scheduled:d.default.any,seen:d.default.any})})};var k=(0,p.createSelector)((0,w.pick)(["undo","tooltip.scheduled","tooltip.seen","user"]),function(e){return{state:e}}),S=(0,f.connect)(k)(E);r.default=S},{"../../reducers/tooltip":448,"../../utils/fp":477,"./GoogleAssistant":121,"./PremiumTrialBanner":122,"./PremiumWillExpireBanner":123,"prop-types":"prop-types",react:"react","react-redux":"react-redux",reselect:"reselect"}],125:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("react-redux"),o=e("../../react_components/topbar/DailyGoalPie"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=e("../../reducers/stats"),s=e("../../reducers/settings"),l=e("../ProductivityStat"),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),c=function(e){var t=e.stats,r=e.user;return t&&r?{vocationMode:r.features.karma_vacation,goal:(0,i.dailyGoal)(e),completed:(0,i.completedToday)(e),counter:r.karma_disabled?t.completed_count:r.karma,theme:(0,s.getTheme)(e),onClick:u.show}:{}};r.default=(0,n.connect)(c)(a.default)},{"../../react_components/topbar/DailyGoalPie":405,"../../reducers/settings":445,"../../reducers/stats":446,"../ProductivityStat":110,"react-redux":"react-redux"}],126:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("react-redux"),p=e("./DailyGoalPie"),m=n(p),h=e("../ErrorBoundary"),_=n(h),v=e("../../components/top_icons/TopIcons"),y=n(v),g=e("../../components/quick_find/QuickFind"),b=n(g),w=e("../../components/themes/Themes"),E=n(w),k=e("../../reducers/selectors"),S=e("../../reducers/settings"),j=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"componentDidMount",value:function(){y.default.render(),b.default.render(),E.default.switchThemes(this.props.theme)}},{key:"render",value:function(){return u.default.createElement("div",{id:"top_bar",style:{display:"none"}},u.default.createElement("div",{id:"top_bar_inner"},u.default.createElement("div",{id:"logo","data-track":"navigation|todoist_logo"}),u.default.createElement("div",{id:"top_icons"},u.default.createElement("span",{id:"before_pie",style:{display:"none"}}),u.default.createElement(_.default,null,u.default.createElement(m.default,null))),u.default.createElement("div",{id:"quick_find"})))}}]),t}(u.default.Component);j.propTypes={theme:d.default.number};var T=function(e){return{dataLoaded:(0,k.dataLoaded)(e),theme:(0,S.getTheme)(e)}},O=function(e){return e.dataLoaded?u.default.createElement(j,e):null};r.default=(0,f.connect)(T)(O)},{"../../components/quick_find/QuickFind":76,"../../components/themes/Themes":95,"../../components/top_icons/TopIcons":97,"../../reducers/selectors":444,"../../reducers/settings":445,"../ErrorBoundary":102,"./DailyGoalPie":125,"prop-types":"prop-types",react:"react","react-redux":"react-redux"}],127:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("../stores/subscribeSelected"),s=n(i),l=e("../stores/store"),u=n(l),c=e("../reducers/counts"),d=e("reselect"),f=e("../reducers/settings"),p=e("../reducers/notes/notesConstants"),m=e("../reducers/notes/notesActions"),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(m),v=window,y=v.DateistDateHelpers,g=window,b=g.DateUtils,w=window,E=w.Signals,k=e("../components/misc/Misc.js"),S=k.isMacApp,j=k.getMacAppVersion,T=e("../components/projects_list/ProjectListUtils"),O=e("../components/notes/Notes.js"),I=e("../components/local_notifications/LocalNotifications"),P=e("../components/local_reminders/LocalReminders"),C=e("../components/postpone/Postpone"),D=e("../components/quick_add/SmartPrefilling"),A=e("../components/agenda/AgendaCurrentDays"),M=e("../models/ItemsModel"),x=e("../models/LabelsModel"),R=e("../models/ProjectsModel"),N=e("../models/SyncEngine"),$=e("../models/Collaborators"),L=e("../models/Reminders"),U=L.RemindersModel,V=e("../filterist"),F=e("../models/UtilModels"),B=e("../models/Colors"),H=e("../plugin_version/ContentTransformers"),G=H.GContentTransformers,z=e("../models/DateExt").default,q="local.todoist.com"===window.location.host,W="beta.todoist.com"===window.location.host,Y="macstore.todoist.com"===window.location.host,K=(0,d.createSelector)(function(e){return e.user},f.getTheme,function(e,t){return a({},e,{theme:t})}),J=function(){return K(u.default.getState())};if(S()||q||W||Y){var Q=void 0;window.MacBridge=Q={bridge:null,handleRequest:function(e,t){var r=void 0,n=void 0,a=void 0,i={status:"ok"},s=j(),l=function(e,t){var r=!0,n=!1,o=void 0;try{for(var a,i=t[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var l=a.value;null===l.color&&(l.color=7),s&&s<7.1&&(l.color=B.normalizeToOld(e,l.color))}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}},c=function(){i.projects=[];var e=!0,t=!1,r=void 0;try{for(var n,o=R.getAll({with_indent:!0})[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var a=n.value,s=$update({},a);$.isProjectShared(a.id)?(s.collaborators=$.getAll(s.id),i.projects.push(s)):i.projects.push(s)}}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}l("project",i.projects)},d=function(){i.labels=[];var e=!0,t=!1,r=void 0;try{for(var n,o=x.getAll(!0)[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var a=n.value,s=$update({},a);i.labels.push(s)}}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}l("label",i.labels)},f=function(){var e=Array.from(V.getOverdueAndToday()),t=o(e,2),r=t[0],n=t[1];i.items_today=Q.handleDayResult(r),i.items_overdue=Q.handleDayResult(n)},m=function(){i.user=J(),i.user.lang=window.LANG,i.user.dateist_lang=window.DATEIST_LANG||"en"};if("sync"===e.action)N.sync(null,!0);else if("logout"===e.action)E.sendSignal("logout");else if("getData"===e.action)c(),d(),f(),m();else if("getProjects"===e.action)c();else if("getLabels"===e.action)d();else if("getTodayItems"===e.action)f();else if("getUser"===e.action)m();else if("parseDate"===e.action)Q.parseDate(e,i);else if("formatDate"===e.action)Q.formatDate(e,i);else if("getCollaborators"===e.action)i.collaborators=$.collaborators;else if("getProjectMembersWithID"===e.action){var _=void 0;_=$.isProjectShared(e.id)?$.getAll(e.id):[],i.members=_,i.length=_.length}else if("completeItem"===e.action)(r=M.getById(e.itemId))&&M.complete(r);else if("uncompleteItem"===e.action)(r=M.getById(e.itemId))&&M.uncomplete(r.id,r.in_history);else if("genericAction"===e.action){var v=!0,y=!1,g=void 0;try{for(var w,k=e.actions[Symbol.iterator]();!(v=(w=k.next()).done);v=!0){r=w.value;var S;if("complete"===r.action)(S=M.getById(r.id))&&M.complete(S);else if("postpone"===r.action)(S=M.getById(r.id))&&C.postPoneModel(S);else if("view_project"===r.action)T.setCurrentById(r.project_id);else if("view_task"===r.action)O.showItemNotes(r.item_id,r.note_id,r.sync_id);else if("view_project_note"===r.action)O.showProjectNotes(r.project_id,r.note_id);else if("view_business_users"===r.action)window.open("/business/users");else if("view_business_billing"===r.action)window.open("/business/accountAndBilling");else if("note_add"===r.action){var I=!!r.project_id;I?u.default.dispatch(h.add({parentId:r.project_id,content:r.text,type:p.TYPE_PROJECT_NOTE})):u.default.dispatch(h.add({parentId:r.item_id,content:r.text,type:p.TYPE_ITEM_NOTE}))}}}catch(e){y=!0,g=e}finally{try{!v&&k.return&&k.return()}finally{if(y)throw g}}E.sendSignal("refresh_interface",!0)}else if("addItem"===e.action){var P=void 0;a=R.get(e.projectId),a||(a=R.getInbox());var D=null;if(e.dueDate){if(P=b.parse(e.dueDate),!P.due_date)return i.status="error",i.reason="INVALID_DATE",t(i),i;D=z.fromDateist(P)}if(!e.content||0===e.content.length)return i.status="error",i.reason="CONTENT_IS_EMPTY",t(i),i;var A={content:e.content,due:D,project_id:a.id,priority:e.priority||1,responsible_uid:e.responsible_uid||null};if(e.dismissedLabels){var L={},F=!0,H=!1,G=void 0;try{for(var q,W=e.dismissedLabels[Symbol.iterator]();!(F=(q=W.next()).done);F=!0)n=q.value,L[n]=!0}catch(e){H=!0,G=e}finally{try{!F&&W.return&&W.return()}finally{if(H)throw G}}A.labels_to_ignore=L}if(e.labels){var Y=[],K=!0,X=!1,Z=void 0;try{for(var ee,te=e.labels[Symbol.iterator]();!(K=(ee=te.next()).done);K=!0){var re=ee.value,ne=x.getOrAdd(re);Y.push(ne.id)}}catch(e){X=!0,Z=e}finally{try{!K&&te.return&&te.return()}finally{if(X)throw Z}}A.labels=Y}if(r=M.add(A,{return_as_error:!0}),r.error)i.status="error",i.reason="LIMIT_REACHED";else{if(i.item=r,e.reminders){var oe=!0,ae=!1,ie=void 0;try{for(var se,le=e.reminders[Symbol.iterator]();!(oe=(se=le.next()).done);oe=!0){var ue=se.value;P=b.parse(ue),P.due_date&&U.add({item_id:r.id,type:"absolute",due:z.fromDateist(P)})}}catch(e){ae=!0,ie=e}finally{try{!oe&&le.return&&le.return()}finally{if(ae)throw ie}}}e.note&&e.note.length>0&&u.default.dispatch(h.add({parentId:r.id,content:e.note,type:p.TYPE_ITEM_NOTE})),E.sendSignal("instant_refresh_interface")}}else if("addLabel"===e.action)(n=x.add({name:e.name,color:e.color}))||(i.status="error",i.reason="NOT_ADDED");else if("addProject"===e.action){var ce={name:e.name,color:e.color,indent:e.indent||1};a=R.add(ce),a||(i.status="error",i.reason="NOT_ADDED")}else"shareProject"===e.action&&((a=$.addInvite(e.projectId,e.email))||(i.status="error",i.reason="NOT_SHARED"));return $isFunction(t)&&t(i),i},parseDate:function(e,t){var r=e.dueDate,n=b.parse(r);return n.due_date?(t.date_string=n.date_string,t.date_lang=n.date_lang,t.date=n.due_date.getTime()):(t.status="error",t.reason="INVALID_DATE"),t},formatDate:function(e,t){var r=e.date_string.split("-"),n=new Date(parseInt(r[0]),parseInt(r[1])-1,parseInt(r[2]));return t.date_string=b.format(n),t},handleDayResult:function(e){var t=new Date,r=new G,n=[],o=!0,a=!1,i=void 0;try{for(var s,l=e[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value,c={};$update(c,u),r.setupByContent(u.content),"outlook"===r.type?c.content="Outlook: "+r.title:"thunderbird"===r.type?c.content="Thunderbird: "+r.title:r.type&&(c.content="Gmail: "+r.title),c.is_recurring=c.due.is_recurring;var d=c.due.toDate();if(c.due_date=d,c.date_string=c.due.string,y.is_overdue(t,d)){var f=y.day_diff(new Date,d);c.diff_human=b.humanizeDayDiff(f,d)}c.indent=1,c.item_order=1,n.push(c),r.reset()}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}return n.sort(F.daySort),n}},function(e){if(window.WebViewJavascriptBridge)e(window.WebViewJavascriptBridge);else{var t=function(){e(window.WebViewJavascriptBridge)};document.addEventListener("WebViewJavascriptBridgeReady",t,!1)}}(function(e){e.init(function(){return null}),Q.bridge=e,I.connect(),P.connect(),e.registerHandler("nativeAppBridge",function(e,t){return Q.handleRequest(e,t)});(0,s.default)(u.default,c.countToday,c.countOverdue,function(t,r){e&&e.callHandler("jsAppBridge",{action:5,count:t+r},function(){return null})}),E.connect("data_fully_loaded",function(){e&&e.callHandler("jsAppBridge",{action:7},function(){return null})}),E.connect("mac_remind",function(t){if(e){var r={action:6};r.title=t.content,r.body="",r.type="reminder";var n=[{text:_("Complete"),action:"complete",id:t.id,put_in_focus:!1}];t.due&&n.push({text:_("Postpone"),action:"postpone",id:t.id,put_in_focus:!1}),r.actions=n,e.callHandler("jsAppBridge",r,function(){return null})}}),E.connect("mac_notify",function(t,r,n){if(e){var o={action:6};o.title=t,o.body=r||"",o.type="notification";var a=[];n&&a.push(n),o.actions=a,e.callHandler("jsAppBridge",o,function(){return null})}});var t=function(){if(e){var t={action:8};t.user=J(),e.callHandler("jsAppBridge",t,function(){return null})}},r=function(){if(e){var t={action:9};t.color="#f6f6f6",e.callHandler("jsAppBridge",t,function(){return null})}},n=function(){if(e){var t={action:10},r=D.prefillProject(!1);r&&(t.projectId=r);var n=D.prefillLabel();n&&(t.content="@"+n+" ");var o=A.getNonOverdue();if(o.length>0){var a=o[0],i=b.dateistResultFromDate(a);t.dueDate=i.date_string}e.callHandler("jsAppBridge",t,function(){return null})}};return(0,s.default)(u.default,K,function(){t(),r()}),E.connect("show_quick_add",function(){n()})})}},{"../components/agenda/AgendaCurrentDays":6,"../components/local_notifications/LocalNotifications":40,"../components/local_reminders/LocalReminders":41,"../components/misc/Misc.js":43,"../components/notes/Notes.js":46,"../components/postpone/Postpone":58,"../components/projects_list/ProjectListUtils":71,"../components/quick_add/SmartPrefilling":74,"../filterist":133,"../models/Collaborators":160,"../models/Colors":161,"../models/DateExt":164,"../models/ItemsModel":167,"../models/LabelsModel":168,"../models/ProjectsModel":171,"../models/Reminders":173,"../models/SyncEngine":181,"../models/UtilModels":185,"../plugin_version/ContentTransformers":190,"../reducers/counts":408,"../reducers/notes/notesActions":429,"../reducers/notes/notesConstants":430,"../reducers/settings":445,"../stores/store":456,"../stores/subscribeSelected":457,reselect:"reselect"}],128:[function(e,t,r){"use strict";function n(e){$isString(e)&&(e=$eval(e)),l.setCurrentEmail(e),l.trackIfNeeded()}function o(e){$isString(e)&&(e=$eval(e)),l.setCurrentEmail(e),i.sendSignal("PluginVersion.addToGenericController")}var a=window.LibEdit,i=window.Signals,s=e("../plugin_version/ContentTransformers").ContentTransformers,l={current_email_obj:null,addToTextArea:function(e){var t=l.current_email_obj;return!!t&&(s.type="outlook",s.link_id=t.id,s.title=t.subject,s.annotateWithIcon(e),a.insertAtCursor(e,t.subject,!0),!1)},setCurrentEmail:function(e){if(e){var t=l.current_email_obj={};$update(t,e)}else l.current_email_obj=null;i.sendSignal("PluginVersion.notifyExternalServices")},openEmail:function(e){try{return window.external.openmail(e),!1}catch(e){}return!0},tracked:!1,trackIfNeeded:function(){l.tracked||(l.tracked=!0)}};window.OutlookIntegration=l,window.setOutlookEmail=n,window.addOutlookEmail=o,t.exports=l},{"../plugin_version/ContentTransformers":190}],129:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../utils/deps");r.default=(0,n.defineDeps)("filterist",["ItemsModel","labelGetByName","projectGetByNameSearch","projectGetChildren","searchCollaborators","isShared","store"])},{"../utils/deps":470}],130:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});r.ProgrammingError=function e(t){n(this,e),this.messages=t,Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this)},r.UnrecognizedSymbolError=function e(t,r,o){n(this,e),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this),this.queryString=t,this.index=r,this.badSymbol=o,this.message="UnrecognizedSymbolError: "+o},r.GrammarError=function e(t){n(this,e),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this);var r=t.map(function(e){return e.constructor.name+'("'+e.matchedStr+'")'}).join(" ");this.message="GrammarError (tokens: "+r+")"}},{}],131:[function(e,t,r){(function(t){"use strict";function n(e){var n=void 0;return n=void 0!==r&&null!==r?t.todoist.filteri18n:window.todoist.filteri18n,e=e?e.toLowerCase():"en",n[e]?n[e]:(console.log('[warn] filterist.i18n cannot load pattern for lang "'+e+'". English is loaded instead.'),n.en)}Object.defineProperty(r,"__esModule",{value:!0}),r.load=n,e("./i18n/en")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./i18n/en":132}],132:[function(e,t,r){(function(e){"use strict";!function(){var t,n={ALL:[/^\s*:all:\s*/i,/^\s*all\s*/i],AND:[/^\s*&\s*/i],ASSIGNED:[/^\s*assigned\s*/i],ASSIGNED_BY:[/^\s*assigned by\s*:\s*([^()|&!,]+)\s*/i],ASSIGNED_TO:[/^\s*assigned to\s*:\s*([^()|&!,]+)\s*/i,/^\s*\+\s*([^()|&!,]+)\s*/i],CREATED:[/^\s*created\s*:\s*([^()|&!,]+)\s*/i,/^\s*added\s*:\s*([^()|&!,]+)\s*/i],CREATED_AFTER:[/^\s*created after\s*:\s*([^()|&!,]+)\s*/i,/^\s*added after\s*:\s*([^()|&!,]+)\s*/i],CREATED_BEFORE:[/^\s*created before\s*:\s*([^()|&!,]+)\s*/i,/^\s*added before\s*:\s*([^()|&!,]+)\s*/i],DUE:[/^\s*due\s*:\s*([^()|&!,]+)\s*/i],DUE_AFTER:[/^\s*due after\s*:\s*([^()|&!,]+)\s*/i],DUE_BEFORE:[/^\s*due before\s*:\s*([^()|&!,]+)\s*/i],DUE_RECURRING:[/^\s*recurring\s*/i],LABEL:[/^\s*label\s*:\s*([^\s()|&!,]+)\s*/i,/^\s*@\s*([^\s()|&!,]+)\s*/i],LEFT:[/^\s*\(\s*/i],NOT:[/^\s*!\s*/i],NO_DUE_DATE:[/^\s*no due date\s*/i,/^\s*no date\s*/i],NO_LABELS:[/^\s*no labels\s*/i,/^\s*no label\s*/i],NO_PRIORITY:[/^\s*no priority\s*/i],OR:[/^\s*\|\s*/i],OVERDUE:[/^\s*over due\s*/i,/^\s*overdue\s*/i,/^\s*od\s*/i],PRIORITY:[/^\s*priority\s*:\s*([1-4])\s*\s*/i,/^\s*priority\s*([1-4])\s*\s*/i,/^\s*p\s*([1-4])\s*\s*/i],PROJECT:[/^\s*p\s*:\s*([^()|&!,]+)\s*/i,/^\s*##\s*([^()|&!,]+)\s*/i],PROJECT_SINGLE:[/^\s*project\s*:\s*([^()|&!,]+)\s*/i,/^\s*#\s*([^()|&!,]+)\s*/i],RIGHT:[/^\s*\)\s*/i],SEARCH:[/^\s*search\s*:\s*([^()|&!,]+)\s*/i,/^\s*q\s*:\s*([^()|&!,]+)\s*/i],SHARED:[/^\s*shared\s*/i],TO_ME:[/^\s*:to me:\s*/i,/^\s*:to_me:\s*/i,/^\s*to me\s*/i],TO_OTHERS:[/^\s*:to others:\s*/i,/^\s*:to_others:\s*/i,/^\s*to others\s*/i],VIEW_ALL:[/^\s*view all\s*/i],WITHIN_DAYS:[/^\s*within\s*(-?[1-9]+\d*)\s*days\s*/i,/^\s*next\s*(-?[1-9]+\d*)\s*days\s*/i,/^\s*\s*(-?[1-9]+\d*)\s*days\s*/i]},o={ALL:[":all:","all"],ASSIGNED:["assigned"],ASSIGNED_BY:["assigned by:$COLLABORATOR"],ASSIGNED_TO:["assigned to:$COLLABORATOR","+$COLLABORATOR"],CREATED:["created:$DATE","added:$DATE"],CREATED_AFTER:["created after:$DATE","added after:$DATE"],CREATED_BEFORE:["created before:$DATE","added before:$DATE"],DUE:["due:$DATE"],DUE_AFTER:["due after:$DATE"],DUE_BEFORE:["due before:$DATE"],DUE_RECURRING:["recurring"],LABEL:["label:$LABEL_NAME","@$LABEL_NAME"],NO_DUE_DATE:["no due date","no date"],NO_LABELS:["no labels","no label"],NO_PRIORITY:["no priority"],OVERDUE:["over due","overdue","od"],PRIORITY:["priority $PRIORITY_LEVEL","priority:$PRIORITY_LEVEL","p$PRIORITY_LEVEL"],PROJECT:["##$PROJECT_NAME","p:$PROJECT_NAME"],PROJECT_SINGLE:["project:$PROJECT_NAME","#$PROJECT_NAME"],SEARCH:["search:$SEARCH_STR","q:$SEARCH_STR"],SHARED:["shared"],TO_ME:[":to me:",":to_me:","to me"],TO_OTHERS:[":to others:",":to_others:","to others"],VIEW_ALL:["view all"],WITHIN_DAYS:["within $DAYS_NUM days","next $DAYS_NUM days","$DAYS_NUM days"]},a={WITHIN_DAYS:"Due within $DAYS_NUM days",ASSIGNED:"Assigned",SEARCH:"Search for $SEARCH_STR",NO_PRIORITY:"No priority",SHARED:"Shared",CREATED:"Added on $DATE",ASSIGNED_TO:"Assigned to $NAME",DUE:"Due on $DATE",DUE_BEFORE:"Due before $DATE",PRIORITY:"Priority $PRIORITY_LEVEL",NO_DUE_DATE:"No due date",VIEW_ALL:"All tasks",NO_LABELS:"No labels",CREATED_AFTER:"Added after $DATE",DUE_RECURRING:"Recurring",ASSIGNED_BY:"Assigned by $NAME",DUE_AFTER:"Due after $DATE",TO_OTHERS:"Assigned to others",CREATED_BEFORE:"Added before $DATE",TO_ME:"Assigned to me",OVERDUE:"Overdue"},i={ME:["me"],OTHERS:["others","other"]};t=void 0!==r&&null!==r?e:window,void 0===t.todoist&&(t.todoist={}),void 0===t.todoist.filteri18n&&(t.todoist.filteri18n={}),t.todoist.filteri18n.en={query:o,queryRex:n,resultTitle:a,specialCollaboratorVal:i}}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],133:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function a(e){for(var t=g.default.store.getState(),r=window.LANG?window.LANG:"en",n={lang:window.LANG,isUSDate:t.user.date_format,isAMPM:t.user.time_format},o=e.split(","),a=[],i=0;i<o.length;i++){var s=function(i){var s=void 0,l=void 0;try{var c=k(o[i],n),d=u(c,2);s=d[0],l=d[1]}catch(t){if(!(t instanceof v.UnrecognizedSymbolError))throw t;var f=o.map(function(e){return e.length}).slice(0,i).reduce(function(e,t){return e+t},t.index);throw new v.UnrecognizedSymbolError(e,f,t.badSymbol)}if(1===s.length&&s[0]instanceof m.Search)return{v:[_.createSearchSection(s[0],r)]};var p=g.default.ItemsModel.getAll(!1).filter(function(e){return!e.in_history&&!e.checked&&l.eval(e,t)}),h=_.create(s,l,p,r);a=a.concat(h)}(i);if("object"===(void 0===s?"undefined":l(s)))return s.v}return a}function i(){var e=a("overdue & !assigned to: other, today & !assigned to: other"),t=u(e,2),r=t[0];return[t[1].items,r.items]}function s(e){var t=new Date(e.getTime());return t.setHours(23),t.setMinutes(59),t.setSeconds(59),t.setMilliseconds(999),g.default.ItemsModel.getAllOwn().filter(function(e){return!!e.due&&((0,c.hasTime)(t)?!e.due.with_time&&(0,c.hasSameDateAndTime)(e.due,t):(0,c.isOnSameDate)(e.due,t))})}Object.defineProperty(r,"__esModule",{value:!0}),r.createFilterFunc=void 0;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r.filter=a,r.getOverdueAndToday=i,r.getByDate=s;var c=e("../utils"),d=e("./lexer"),f=e("./parser"),p=o(f),m=e("./token"),h=e("./section"),_=o(h),v=e("./errors"),y=e("./Deps"),g=n(y),b=e("../logger/Logger"),w=n(b),E=(0,c.memoize)(function(e,t,r){return new d.Lexer({lang:e,isUSDate:t,isAMPM:r})}),k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.lang,n=t.isUSDate,o=t.isAMPM;if(void 0===r||void 0===n||void 0===o)throw new Error("Required configuration missing");var a=E(r,n,o),i=a.tokenize(e),s=i.filter(function(e){return e instanceof m.UnrecognizedSymbol});if(s.length>0){var l=s[0];throw new v.UnrecognizedSymbolError(e,l.index,l.matchedStr)}return[i,p.buildQueryTree(i)]};k=(0,c.LMemoize)(k,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.lang+"-"+t.isUSDate+"-"+t.isAMPM+"-"+e}),k.cache=new c.LRU(100);var S=function(e,t){var r=t.lang,n=t.isUSDate,o=t.isAMPM;try{var a=e.split(","),i=a.map(function(e){var t=k(e,{lang:r,isUSDate:n,isAMPM:o}),a=u(t,2),i=a[1];return function(e,t){return i.eval(e,t)}});return function(t,r){try{var n=!0,o=!1,a=void 0;try{for(var s,l=i[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){if((0,s.value)(t,r))return!0}}catch(e){o=!0,a=e}finally{try{!n&&l.return&&l.return()}finally{if(o)throw a}}return!1}catch(r){return w.default.captureError(r,{tags:{where:"_createFilterFunc"},extra:{item:t,query:e}}),!1}}}catch(e){if(e instanceof v.UnrecognizedSymbolError||e instanceof v.GrammarError)return function(){return!1};throw e}};(r.createFilterFunc=(0,c.LMemoize)(S,function(e,t){return t.lang+"-"+t.isUSDate+"-"+t.isAMPM+"-"+e})).cache=new c.LRU(100)},{"../logger/Logger":141,"../utils":484,"./Deps":129,"./errors":130,"./lexer":134,"./parser":135,"./section":136,"./token":137}],134:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.DateistMatcher=r.Lexer=r.RexMatcher=void 0;var a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("./token"),u=n(l),c=e("./i18n"),d=n(c),f=e("./errors"),p=[!1,null,null],m=r.RexMatcher=function(){function e(t,r){o(this,e),this.rex=t,this.tokenFn=r}return s(e,[{key:"match",value:function(e,t){var r=e.substring(t),n=this.rex.exec(r);if(null===n)return p;if(0!==n.index)throw new f.ProgrammingError("Programming Error: matcher should only match the beginning of string. (Rex: "+this.rex+")");return t+=n[0].length,[!0,this.tokenFn(n),t]}}]),e}(),h=function(){function e(t,r,n,a){o(this,e),this.rex=t,this.tokenCls=a,this.dateistLangs=r,this.dateistOpt=n}return s(e,[{key:"match",value:function(e,t){var r=e.substring(t),n=this.rex.exec(r);if(null===n)return p;if(0!==n.index)throw new f.ProgrammingError("Programming Error: matcher should only match the beginning of string. (Rex: "+this.rex+")");var o=n[1],a=void 0,i=void 0;try{var s=Dateist.parse_multiple(o,this.dateistLangs,this.dateistOpt);s.due_date&&!s.is_recurring&&(a=s.due_date,i=s.date_lang)}catch(e){}return a?(t+=n[0].length,o=o.trim(),[!0,new this.tokenCls(o,i,this.dateistOpt),t]):p}}]),e}(),_=(r.Lexer=function(){function e(t){o(this,e),this.opt=t||{},this.opt=i({isUSDate:1,isAMPM:0},this.opt),this.initMatchers()}return s(e,[{key:"tokenize",value:function(e){for(var t=[],r=0;r<e.length;){var n=this.nextToken(e,r),o=a(n,2),i=o[0],s=o[1];t.push(i),r=s}return t}},{key:"nextToken",value:function(e,t){var r=!0,n=!1,o=void 0;try{for(var i,s=this.matchers[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var l=i.value,c=l.match(e,t),d=a(c,3),f=d[0],p=d[1],m=d[2];if(f)return p.index=t,p.matchedStr=e.substring(t,m),[p,m]}}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}var h=t;t+=1;e:for(;t<e.length;){var _=!0,v=!1,y=void 0;try{for(var g,b=this.matchers[Symbol.iterator]();!(_=(g=b.next()).done);_=!0){var w=g.value,E=w.match(e,t),k=a(E,1),f=k[0];if(f)break e}}catch(e){v=!0,y=e}finally{try{!_&&b.return&&b.return()}finally{if(v)throw y}}t+=1}var S=e.substring(h,t),j=new u.UnrecognizedSymbol(S);return j.index=h,j.matchedStr=S,[j,t]}},{key:"initMatchers",value:function(){var e=d.load(this.opt.lang).queryRex,t=void 0;t=window.DATEIST_LANG?"en"==window.DATEIST_LANG?["en"]:[window.DATEIST_LANG,"en"]:"all_lang"===this.opt.lang?_:this.opt.lang?[this.opt.lang.slice(0,2),"en"]:["en"];var r={us_dates:this.opt.isUSDate,am_pm:this.opt.isAMPM,now_date:this.opt.now},n=d.load(this.opt.lang).specialCollaboratorVal,o=this;this.matchers=[].concat(e.LEFT.map(function(e){return new m(e,function(){return new u.Left})}),e.RIGHT.map(function(e){return new m(e,function(){return new u.Right})}),e.AND.map(function(e){return new m(e,function(){return new u.And})}),e.OR.map(function(e){return new m(e,function(){return new u.Or})}),e.NOT.map(function(e){return new m(e,function(){return new u.Not})}),e.VIEW_ALL.map(function(e){return new m(e,function(){return new u.ViewAll})}),e.NO_PRIORITY.map(function(e){return new m(e,function(){return new u.NoPriority})}),e.ALL.map(function(e){return new m(e,function(){return new u.All})}),e.TO_OTHERS.map(function(e){return new m(e,function(){return new u.ToOthers})}),e.TO_ME.map(function(e){return new m(e,function(){return new u.ToMe})}),e.NO_DUE_DATE.map(function(e){return new m(e,function(){return new u.NoDueDate})}),e.NO_LABELS.map(function(e){return new m(e,function(){return new u.NoLabels})}),e.ASSIGNED.map(function(e){return new m(e,function(){return new u.Assigned})}),e.SHARED.map(function(e){return new m(e,function(){return new u.Shared})}),e.DUE_RECURRING.map(function(e){return new m(e,function(){return new u.DueRecurring})}),e.LABEL.map(function(e){return new m(e,function(e){return new u.Label(e[1])})}),e.OVERDUE.map(function(e){return new m(e,function(){return o.opt.now?new u.Overdue(o.opt.now):new u.Overdue})}),e.PROJECT.map(function(e){return new m(e,function(e){var t=e[1].trim();return new u.Project(t)})}),e.PROJECT_SINGLE.map(function(e){return new m(e,function(e){var t=e[1].trim();return new u.ProjectSingle(t)})}),e.SEARCH.map(function(e){return new m(e,function(e){var t=e[1].trim();return new u.Search(t)})}),e.PRIORITY.map(function(e){return new m(e,function(e){var t=parseInt(e[1],10);return new u.Priority(t)})}),e.WITHIN_DAYS.map(function(e){return new m(e,function(e){var t=parseInt(e[1],10);return o.opt.now?new u.WithinDays(t,o.opt.now):new u.WithinDays(t)})}),e.ASSIGNED_TO.map(function(e){return new m(e,function(e){var t=e[1].trim().toLowerCase();return-1!=n.ME.indexOf(t)?new u.AssignedTo(u.COLLABORATOR_ME):-1!=n.OTHERS.indexOf(t)?new u.AssignedTo(u.COLLABORATOR_OTHERS):new u.AssignedTo(t)})}),e.ASSIGNED_BY.map(function(e){return new m(e,function(e){var t=e[1].trim().toLowerCase();return-1!=n.ME.indexOf(t)?new u.AssignedBy(u.COLLABORATOR_ME):-1!=n.OTHERS.indexOf(t)?new u.AssignedBy(u.COLLABORATOR_OTHERS):new u.AssignedBy(t)})}),e.CREATED.map(function(e){return new h(e,t,r,u.Created)}),e.CREATED_BEFORE.map(function(e){return new h(e,t,r,u.CreatedBefore)}),e.CREATED_AFTER.map(function(e){return new h(e,t,r,u.CreatedAfter)}),e.DUE.map(function(e){return new h(e,t,r,u.Due)}),e.DUE_BEFORE.map(function(e){return new h(e,t,r,u.DueBefore)}),e.DUE_AFTER.map(function(e){return new h(e,t,r,u.DueAfter)})),this.matchers.push(new v(t,r)),this.sortMatchers()}},{key:"sortMatchers",value:function(){this.matchers.sort(function(e,t){return e instanceof v?1:t instanceof v?-1:t.rex.source.length-e.rex.source.length||t.rex.source-e.rex.source})}}]),e}(),["en","da","pl","zh","ko","ja","de","pt","it","es","nl","ru","sv","fr"]),v=r.DateistMatcher=function(){function e(t,r){o(this,e),this.dateistLangs=t,this.dateistOpt=r}return s(e,[{key:"match",value:function(e,t){
for(var r=e.substring(t),n=void 0,o=void 0,a=void 0,i=1;i<=r.length&&i<30&&-1===[",",")","|","&"].indexOf(r[i-1]);i++){var s=r.slice(0,i);try{var l=Dateist.parse_multiple(s,this.dateistLangs,this.dateistOpt);l.due_date&&!l.is_recurring&&(n=l,o=s,a=i)}catch(e){}}return n?(t+=a,o=o.trim(),[!0,new u.Due(o,n.date_lang,this.dateistOpt),t]):p}}]),e}()},{"./errors":130,"./i18n":131,"./token":137}],135:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return new d(e).buildQueryTree()}Object.defineProperty(r,"__esModule",{value:!0}),r.Parser=r.CURSOR_END=r.QueryTree=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r.buildQueryTree=o;var i=e("./token"),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(i),l=e("./errors"),u=r.QueryTree=function(){function e(t){n(this,e),this.token=t}return a(e,[{key:"setLeft",value:function(e){if(this.token.type!==s.TOKEN_TYPE_BINARY_OPERATOR&&this.token.type!==s.TOKEN_TYPE_UNARY_OPEATOR)throw new l.ProgrammingError("Cannot attach children for token (type: "+this.token.type+")");this.left=e,this.left.parent=this}},{key:"setRight",value:function(e){if(this.token.type!==s.TOKEN_TYPE_BINARY_OPERATOR)throw new l.ProgrammingError("Cannot attach children for token (type: "+this.token.type+")");this.right=e,this.right.parent=this}},{key:"hasChild",value:function(){return"left"in this||"right"in this}},{key:"isLeaf",value:function(){return!this.hasChild()}},{key:"toString",value:function(){return this.hasChild()?this.right?"("+this.left+" "+this.token+" "+this.right+")":this.token.toString()+"("+this.left.toString()+")":this.token.toString()}},{key:"eval",value:function(e,t){if(!this.hasChild())return this.token.eval(e,t);if(this.token instanceof s.And)return this.left.eval(e,t)&&this.right.eval(e,t);if(this.token instanceof s.Or)return this.right.eval(e,t)||this.left.eval(e,t);if(this.token instanceof s.Not)return!this.left.eval(e,t);throw new l.ProgrammingError("Unrecognized operand token type")}},{key:"traverseUp",value:function(e){this.parent&&(e(this.parent),this.parent.traverseUp(e))}},{key:"traverseLeafs",value:function(e){if(this.isLeaf())return void e(this);this.left&&this.left.traverseLeafs(e),this.right&&this.right.traverseLeafs(e)}},{key:"leafNodes",value:function(){var e=[];return this.traverseLeafs(function(t){return e.push(t)}),e}},{key:"parentNodes",value:function(){var e=[];return this.traverseUp(function(t){return e.push(t)}),e}},{key:"find",value:function(e){var t=[];return e(this)&&t.push(this),this.left&&(t=t.concat(this.left.find(e))),this.right&&(t=t.concat(this.right.find(e))),t}},{key:"exist",value:function(e){return this.find(e).length>0}},{key:"clone",value:function(){var t=new e(this.token);if(this.isLeaf())return t;if(this.left){var r=this.left.clone();t.setLeft(r)}if(this.right){var n=this.right.clone();t.setRight(n)}return t}}]),e}(),c=r.CURSOR_END=null,d=r.Parser=function(){function e(t){n(this,e),this.tokens=t,this.cursor=0,this.root=null}return a(e,[{key:"next",value:function(){if(this.cursor>=this.tokens.length)return c;var e=this.tokens[this.cursor];return this.cursor=this.cursor+1,e}},{key:"peak",value:function(){return this.cursor>=this.tokens.length?c:this.tokens[this.cursor]}},{key:"buildQueryTree",value:function(){var e=this.expr();if(this.next()!==c)throw new l.GrammarError(this.tokens);return e}},{key:"expr",value:function(){return this.expr4()}},{key:"expr4",value:function(){var e=this.expr3(),t=this.peak();if(t instanceof s.Or){t=this.next();var r=new u(t);return r.setLeft(e),r.setRight(this.expr4()),r}return e}},{key:"expr3",value:function(){var e=this.expr2(),t=this.peak();if(t instanceof s.And){t=this.next();var r=new u(t);return r.setLeft(e),r.setRight(this.expr3()),r}return e}},{key:"expr2",value:function(){if(this.peak()instanceof s.Not){var e=this.next(),t=new u(e);return t.setLeft(this.expr2()),t}return this.expr1()}},{key:"expr1",value:function(){var e=this.next();if(e===c)throw new l.GrammarError(this.tokens);if(e.type===s.TOKEN_TYPE_OPERAND)return new u(e);if(e instanceof s.Left){var t=this.expr();if(!((e=this.next())instanceof s.Right))throw new l.GrammarError(this.tokens);return t}throw new l.GrammarError(this.tokens)}}]),e}()},{"./errors":130,"./token":137}],136:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()}function i(e,t){return[e.filter(t),e.filter(function(e){return!t(e)})]}function s(e,t,r,n){var o=c(e,r,t),a=m(o,2),i=a[0],s=a[1];if(i)return s;var l=g.load(n).resultTitle,u=p(l,e);if(f(t)){var d=e.filter(function(e){return e instanceof v.Search})[0],h=new T(r,k,{name:u});return h.query=d.searchStr,[h]}return[new T(r,E,{name:u})]}function l(e,t){var r=g.load(t).resultTitle,n=p(r,[e]),o=new T([],k,{name:n});return o.query=e.searchStr,o}function u(e,t){return t.find(function(t){return t.token==e})[0].parentNodes().filter(function(e){return e.token instanceof v.Not}).length%2==1}function c(e,t,r){e=e.filter(function(e){return r.exist(function(t){return t.token==e})});var n=d(e),o=e.filter(function(e){return e instanceof v.Overdue&&!u(e,r)}),s=e.filter(function(e){return e instanceof v.WithinDays&&Math.abs(e.days)<=7&&!u(e,r)}),l=e.filter(function(e){return e instanceof v.WithinDays&&Math.abs(e.days)>7&&!u(e,r)}),c=e.filter(function(e){return e instanceof v.Due&&!u(e,r)});if(0===o.length&&0===s.length&&0===l.length&&0===c.length)return[!1,null];s.length>0?(s.sort(function(e,t){return t.days-e.days}),s=s[0]):s=null;var f=t.slice(),p=[];if(o.length>0){var _=void 0,y=i(f,function(e){return o[0].eval(e)}),g=m(y,2);_=g[0],f=g[1],p.push(new T(_,w,{orderable:n}))}if(c.length>0||s){var b=c.map(function(e){return new T([],j,{day_date:e.dueDate,orderable:n})});if(s){var E=(0,h.range)(s.days).sort().map(function(e){var t=new Date;return t.setDate(t.getDate()+e),t}),k=!0,O=!1,I=void 0;try{for(var P,C=E[Symbol.iterator]();!(k=(P=C.next()).done);k=!0){var D=P.value;b.push(new T([],j,{day_date:D,orderable:n}))}}catch(e){O=!0,I=e}finally{try{!k&&C.return&&C.return()}finally{if(O)throw I}}}for(var A=[],M=0;M<b.length;M++)!function(e){var t=b[e];0===A.filter(function(e){return a(e.day_date,t.day_date)}).length&&A.push(t)}(M);A.sort(function(e,t){return e.day_date-t.day_date});var x=!0,R=!1,N=void 0;try{for(var $,L=A[Symbol.iterator]();!(x=($=L.next()).done);x=!0)!function(){var e=$.value,t=void 0,r=i(f,function(t){return t.due&&a(t.due,e.day_date)}),n=m(r,2);t=n[0],f=n[1],e.items=t}()}catch(e){R=!0,N=e}finally{try{!x&&L.return&&L.return()}finally{if(R)throw N}}p=p.concat(A)}if(l.length>0){var U=new T([],S,{orderable:n}),V=!0,F=!1,B=void 0;try{for(var H,G=l[Symbol.iterator]();!(V=(H=G.next()).done);V=!0)!function(){var e=H.value,t=void 0,r=i(f,function(t){return e.eval(t)}),n=m(r,2);t=n[0],f=n[1],U.items=U.items.concat(t)}()}catch(e){F=!0,B=e}finally{try{!V&&G.return&&G.return()}finally{if(F)throw B}}U.items.length>0&&(p=p.concat(U))}return f.length>0?[!1,null]:[!0,p]}function d(e){return 1===e.length&&(e[0]instanceof v.WithinDays||e[0]instanceof v.Due)||4===e.length&&((e[0]instanceof v.Due||e[0]instanceof v.Overdue||e[0]instanceof v.WithinDays)&&e[1]instanceof v.And&&e[2]instanceof v.Not&&e[3]instanceof v.AssignedTo)}function f(e){return e.isLeaf()&&e.token instanceof v.Search}function p(e,t){function r(t){return t instanceof v.Search?e.SEARCH.replace("$SEARCH_STR",'"'+t.searchStr+'"'):t instanceof v.WithinDays?e.WITHIN_DAYS.replace("$DAYS_NUM",t.days):t instanceof v.Priority?e.PRIORITY.replace("$PRIORITY_LEVEL",t.level):t instanceof v.NoDueDate?e.NO_DUE_DATE:t instanceof v.ViewAll?e.VIEW_ALL:t instanceof v.NoLabels?e.NO_LABELS:t instanceof v.ToOthers?e.TO_OTHERS:t instanceof v.ToMe?e.TO_ME:t instanceof v.Overdue?e.OVERDUE:t instanceof v.Or|t instanceof v.And?" "+t.matchedStr+" ":t.matchedStr}var n=t.map(r).join("");return n.length<50?n:(n=t.map(function(e){return e.matchedStr}).join(""),n.length>50&&(n=n.slice(0,50)+" ..."),n)}Object.defineProperty(r,"__esModule",{value:!0}),r.Section=r.VIEW_TYPE_DAY_VIEW_FIXED=r.VIEW_TYPE_DAY_VIEW_SPAN=r.VIEW_TYPE_SEARCH=r.VIEW_TYPE_FLAT=r.VIEW_TYPE_OVERDUE=r.VIEW_TYPE_VIEW_ALL=void 0;var m=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r.create=s,r.createSearchSection=l;var h=e("../utils"),_=e("./token"),v=n(_),y=e("./i18n"),g=n(y),b=e("./errors"),w=(r.VIEW_TYPE_VIEW_ALL="view_all",r.VIEW_TYPE_OVERDUE="overdue"),E=r.VIEW_TYPE_FLAT="flat_view",k=r.VIEW_TYPE_SEARCH="search",S=r.VIEW_TYPE_DAY_VIEW_SPAN="day_view_span",j=r.VIEW_TYPE_DAY_VIEW_FIXED="day_view_fixed",T=r.Section=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(o(this,e),r===j&&!n.day_date)throw new b.ProgrammingError("Fix day view required date");this.items=t,this.view=r,this.name=n.name,this.day_date=n.day_date,this.orderable=n.orderable}},{"../utils":484,"./errors":130,"./i18n":131,"./token":137}],137:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.UnrecognizedSymbol=r.Shared=r.Assigned=r.AssignedBy=r.AssignedTo=r.Search=r.All=r.ViewAll=r.ToOthers=r.ToMe=r.WithinDays=r.Overdue=r.CreatedAfter=r.CreatedBefore=r.Created=r.DueRecurring=r.DueAfter=r.DueBefore=r.Due=r.NoDueDate=r.ProjectSingle=r.Project=r.NoLabels=r.Label=r.NoPriority=r.Priority=r.Or=r.And=r.Right=r.Left=r.Not=r.Token=r.COLLABORATOR_OTHERS=r.COLLABORATOR_ME=r.TOKEN_TYPE_PARATHESIS=r.TOKEN_TYPE_OPERAND=r.TOKEN_TYPE_UNARY_OPEATOR=r.TOKEN_TYPE_BINARY_OPERATOR=void 0;var l=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=e("../utils"),d=e("../utils/fp"),f=e("./errors"),p=n(f),m=e("reselect"),h=e("redux"),_=e("./Deps"),v=n(_),y=r.TOKEN_TYPE_BINARY_OPERATOR=0,g=r.TOKEN_TYPE_UNARY_OPEATOR=1,b=r.TOKEN_TYPE_OPERAND=2,w=r.TOKEN_TYPE_PARATHESIS=3,E=r.COLLABORATOR_ME="COLLABORATOR_ME",k=r.COLLABORATOR_OTHERS="COLLABORATOR_OTHERS",S=r.Token=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,r=arguments[1],n=arguments[2];s(this,e),this.type=t,this.matchedStr=r,this.index=n}return u(e,[{key:"toString",value:function(){return""+this.constructor.name}},{key:"eval",value:function(e,t){throw new p.default(this.class+" did not implement eval")}}]),e}(),j=function(e){function t(e,r,n){s(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b));return o.dateStr=e,o.dateLang=r,o.dateistOpt=n,o.parse=(0,c.createMemoizedDateParser)(),o}return i(t,e),u(t,[{key:"getDate",value:function(){return this.parse(this.dateStr,this.dateLang,this.dateistOpt)}}]),t}(S),T=(r.Not=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,g))}return i(t,e),u(t,[{key:"operatorEval",value:function(e){return!e}}]),t}(S),r.Left=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,w))}return i(t,e),t}(S),r.Right=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,w))}return i(t,e),t}(S),r.And=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,y))}return i(t,e),u(t,[{key:"operatorEval",value:function(e,t){return e&&t}}]),t}(S),r.Or=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,y))}return i(t,e),u(t,[{key:"operatorEval",value:function(e,t){return e||t}}]),t}(S),r.Priority=function(e){function t(e){s(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b));return r.level=e,r}return i(t,e),u(t,[{key:"toString",value:function(){return"Priority("+this.level+")"}},{key:"eval",value:function(e){return 5-e.priority===this.level}}]),t}(S),r.NoPriority=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b))}return i(t,e),u(t,[{key:"toString",value:function(){return"No Priority"}},{key:"eval",value:function(e){return-1*e.priority+5==4}}]),t}(S),r.Label=function(e){function t(e){s(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b));return r.name=e,r.get=v.default.labelGetByName(e,{caseSensitive:!1}),r}return i(t,e),u(t,[{key:"toString",value:function(){return"Label("+this.name+")"}},{key:"eval",value:function(e,t){var r=this.get(t);return!!r&&(e.labels&&-1!==e.labels.indexOf(r.id))}}]),t}(S),r.NoLabels=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b))}return i(t,e),u(t,[{key:"toString",value:function(){return"NoLabels("+this.name+")"}},{key:"eval",value:function(e){return!e.labels||0===e.labels.length}}]),t}(S),r.Project=function(e){function t(e){s(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b));return r.name=e,r.isMatch=(0,m.createSelector)(function(e){return e.projects},function(t){var r=v.default.projectGetByNameSearch(e,{projects:t}).map(function(e){return e.id}),n=(0,h.compose)((0,d.map)(function(e){return e.id}),c.flatten,(0,d.map)(function(e){return v.default.projectGetChildren(e,{projects:t})}))(r);return r=[].concat(o(r),o(n)),r=(0,c.zipObject)(r,r.map(function(){return!0})),function(e){return!!r[e]}}),r}return i(t,e),u(t,[{key:"toString",value:function(){return"Project("+this.name+")"}},{key:"eval",value:function(e,t){return this.isMatch(t)(e.project_id)}}]),t}(S),r.ProjectSingle=function(e){function t(e){s(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b));return r.name=e,r.isMatch=(0,m.createSelector)(v.default.projectGetByNameSearch(e),function(e){var t=e.map(function(e){return e.id});return t=(0,c.zipObject)(t,t.map(function(){return!0})),function(e){return!!t[e]}}),r}return i(t,e),u(t,[{key:"toString",value:function(){return"ProjectSingle("+this.name+")"}},{key:"eval",value:function(e,t){return this.isMatch(t)(e.project_id)}}]),t}(S),r.NoDueDate=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b))}return i(t,e),u(t,[{key:"toString",value:function(){return"NoDueDate"}},{key:"eval",value:function(e){return!e.due}}]),t}(S),r.Due=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"toString",value:function(){return"Due("+this.dateStr+")"}},{key:"eval",value:function(e){return!!this.dueDate&&(!!e.due&&((0,c.hasTime)(this.dueDate)?!!e.due.with_time&&(0,c.hasSameDateAndTime)(e.due,this.dueDate):(0,c.isOnSameDate)(e.due,this.dueDate)))}},{key:"dueDate",get:function(){return this.getDate()}}]),t}(j),r.DueBefore=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"toString",value:function(){return"DueBefore"}},{key:"eval",value:function(e){var t=this.getDate();return!!t&&(!!e.due&&((0,c.hasTime)(t)?e.due.isLessThan(t):e.due.isLessThan((0,c.dayMin)(t))))}}]),t}(j),r.DueAfter=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"toString",value:function(){return"DueAfter"}},{key:"eval",value:function(e){var t=this.getDate();return!!t&&(!!e.due&&((0,c.hasTime)(t)?e.due.isGreaterThan(t):e.due.isGreaterThan((0,c.dayMax)(t))))}}]),t}(j),r.DueRecurring=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b))}return i(t,e),u(t,[{key:"toString",value:function(){return"DueRecurring"}},{key:"eval",value:function(e){return e.due&&e.due.is_recurring}}]),t}(S),r.Created=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"toString",value:function(){return"Created"}},{key:"eval",value:function(e){var t=this.getDate();return!!t&&((0,c.hasTime)(t)?(0,c.hasSameDateAndTime)(e.date_added,t):(0,c.isOnSameDate)(e.date_added,t))}}]),t}(j),r.CreatedBefore=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"toString",value:function(){return"CreatedBefore"}},{key:"eval",value:function(e){var t=this.getDate();return!!t&&((0,c.hasTime)(t)?e.date_added<t:e.date_added<(0,c.dayMin)(t))}}]),t}(j),r.CreatedAfter=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),u(t,[{key:"toString",value:function(){return"CreatedAfter"}},{key:"eval",value:function(e){var t=this.getDate();return!!t&&((0,c.hasTime)(t)?e.date_added>t:e.date_added>(0,c.dayMax)(t))}}]),t}(j),r.Overdue=function(e){function t(e){s(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b));return r.now=e,r}return i(t,e),u(t,[{key:"toString",value:function(){return"Overdue"}},{key:"eval",value:function(e){var t=this.now||new Date;return e.due&&!(0,c.isOnSameDate)(t,e.due)&&e.due.getTime()<t.getTime()}}]),t}(S),r.WithinDays=function(e){function t(e,r){s(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b));return T.call(n),n.days=e,n.now=r,n}return i(t,e),u(t,[{key:"getInterval",value:function(){var e=this.now||new Date;return this._getInterval(e.getMonth(),e.getDate())}},{key:"toString",value:function(){return"WithinDays("+this.days+")"}},{key:"eval",value:function(e){var t=this.getInterval(),r=l(t,2),n=r[0],o=r[1];return!!e.due&&(e.due.isGreaterThanOrEqual(n)&&e.due.isLessThanOrEqual(o))}}]),t}(S),function(){var e=this;this._getInterval=(0,c.memoize)(function(t,r){var n=e.now||new Date,o=new Date(n.getTime()),a=new Date(n.getTime());return e.days>0?a.setDate(n.getDate()+e.days-1):o.setDate(n.getDate()+e.days+1),o=(0,c.dayMin)(o),a=(0,c.dayMax)(a),[o,a]})});r.ToMe=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b))}return i(t,e),u(t,[{key:"toString",value:function(){return"ToMe"}},{key:"eval",value:function(e,t){return v.default.isShared(t,e.project_id)&&e.responsible_uid===t.user.id}}]),t}(S),r.ToOthers=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b))}return i(t,e),u(t,[{key:"toString",value:function(){return"ToOthers"}},{key:"eval",value:function(e,t){var r=t.user.id;return e.responsible_uid&&e.responsible_uid!==r&&e.assigned_by_uid===r}}]),t}(S),r.ViewAll=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b))}return i(t,e),u(t,[{key:"toString",value:function(){return"ViewAll"}},{key:"eval",value:function(){return!0}}]),t}(S),r.All=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b))}return i(t,e),u(t,[{key:"toString",value:function(){return"All"}},{key:"eval",value:function(){return!0}}]),t}(S),r.Search=function(e){function t(e){s(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b));return r.searchStr=e,r.matchFn=(0,c.looseMatch)(e),r}return i(t,e),u(t,[{key:"toString",value:function(){return"Search("+this.searchStr+")"}},{key:"eval",value:function(e){return this.matchFn(e.content)}}]),t}(S),r.AssignedTo=function(e){function t(e){s(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b));return r.query=e,r.search=v.default.searchCollaborators(e),r}return i(t,e),u(t,[{key:"toString",value:function(){return"AssignedTo("+this.query+")"}},{key:"eval",value:function(e,t){var r=e.project_id;return!!v.default.isShared(t,r)&&(this.query===E?e.responsible_uid===t.user.id:this.query===k?e.responsible_uid&&e.responsible_uid!==t.user.id:!!this.search(t)[e.responsible_uid])}}]),t}(S),r.AssignedBy=function(e){function t(e){s(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b));return r.query=e,r.search=v.default.searchCollaborators(e),r}return i(t,e),u(t,[{key:"toString",value:function(){return"AssignedBy("+this.query+")"}},{key:"eval",value:function(e,t){var r=e.project_id;return!!v.default.isShared(t,r)&&(this.query===E?e.assigned_by_uid===t.user.id&&e.responsible_uid:this.query===k?e.assigned_by_uid&&e.assigned_by_uid!==t.user.id&&e.responsible_uid:!!this.search(t)[e.assigned_by_uid]&&e.responsible_uid)}}]),t}(S),r.Assigned=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b))}return i(t,e),u(t,[{key:"toString",value:function(){return"Assigned"}},{key:"eval",value:function(e,t){return v.default.isShared(t,e.project_id)&&e.responsible_uid}}]),t}(S),r.Shared=function(e){function t(){return s(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b))}return i(t,e),u(t,[{key:"toString",value:function(){return"Shared"}},{key:"eval",value:function(e,t){return v.default.isShared(t,e.project_id)}}]),t}(S),r.UnrecognizedSymbol=function(e){function t(e){s(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,b));return r.symbol=e,r}return i(t,e),u(t,[{key:"toString",value:function(){return"UnrecognizedSymbol("+this.symbol+")"}},{key:"eval",value:function(){return!1}}]),t}(S)},{"../utils":484,"../utils/fp":477,"./Deps":129,"./errors":130,redux:"redux",reselect:"reselect"}],138:[function(e,t,r){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};e("babel-polyfill"),e("whatwg-fetch");var o=e("react"),a=e("react-dom"),i=e("../components/misc/Util.js").postMessageToWindow,s=e("../models/Storage").GlobalStorage,l=e("../components/notes/Notes.js"),u=e("../components/notes/NotesBuffer"),c=e("./ResolveDeps"),d=e("../containers/TodoistApp").default,f=e("../models/VersionUpdater"),p=e("../models/Config").default,m=e("./showInitError").default,h=e("../models/SyncEngine");e("../models/SyncData"),e("../external_services/MacAppBridge"),e("../components/refresh_interface/RefreshInterface"),e("../models/window"),e("../containers/SyncDebugConsole"),e("../models/WebSocketManager.js"),e("../components/comet/Comet"),window.initTodoist=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{c.resolve(),e=n({loadStartPage:!0,disablePromotion:!1},e),p.init(e);if(f.reloadIfVersionUpdated())return;var t=document.getElementById("todoist_app");a.render(o.createElement(d,null),t)}catch(e){m(e)}},window!==top&&top.postMessage&&setInterval(function(){return i(top,window.location.toString())},200),window.onbeforeunload=function(e){s.commitAll();var t=u.getNoteUploads();if(t.length>0)return t[0].item_id?l.showItemNotes(t[0].item_id):l.showProjectNotes(t[0].project_id),_("You have uploads that are not completed.");if(0!==h.getQueueSuccessLength()&&!h.global_error){setTimeout(function(){h.sync(null,!0)},10);var r=_("Some changes you've made have not been synced. Exit anyway?");return e.returnValue=r,r}}},{"../components/comet/Comet":18,"../components/misc/Util.js":44,"../components/notes/Notes.js":46,"../components/notes/NotesBuffer":48,"../components/refresh_interface/RefreshInterface":77,"../containers/SyncDebugConsole":115,"../containers/TodoistApp":117,"../external_services/MacAppBridge":127,"../models/Config":162,"../models/Storage":179,"../models/SyncData":180,"../models/SyncEngine":181,"../models/VersionUpdater":186,"../models/WebSocketManager.js":187,"../models/window":188,"./ResolveDeps":139,"./showInitError":140,"babel-polyfill":"babel-polyfill",react:"react","react-dom":"react-dom","whatwg-fetch":"whatwg-fetch"}],139:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=e("../components/agenda/Agenda.js"),s=o(i),l=e("../components/project_editor/ProjectEditor.js"),u=e("../components/projects_list/ProjectList"),c=o(u),d=e("../components/notes/Notes.js"),f=o(d),p=e("../reducers/labels"),m=e("../reducers/projects"),h=e("../reducers/collaborators"),_=e("../models/ItemsModel"),v=o(_),y=e("../models/ProjectsModel"),g=o(y),b=e("../models/Reminders"),w=e("../models/SyncEngine"),E=o(w),k=e("../utils/deps"),S=e("../containers/SmartSchedule"),j=n(S),T=e("../components/item_selecter/ItemSelecter"),O=o(T),I=e("../stores/store"),P=o(I),C=e("../reducers/notes/notesActions"),D=n(C);r.resolve=function(){(0,k.inject)(a({UtilModels:{SyncEngine:E.default},Collaborators:{ItemsModel:v.default,ProjectsModel:g.default,RemindersModel:b.RemindersModel},ProjectListUtils:{ProjectList:c.default},NotesUtils:{Notes:f.default},AgendaUtils:{Agenda:s.default,ItemsModel:v.default,store:P.default},Notes:{Agenda:s.default},ProjectEditorManager:{ProjectEditor:l.ProjectEditor},ProjectsArchive:{ProjectList:c.default},filterist:{ItemsModel:v.default,labelGetByName:p.labelGetByName,projectGetByNameSearch:m.projectGetByNameSearch,projectGetChildren:m.projectGetChildren,searchCollaborators:h.searchCollaborators,isShared:h.isShared,store:P.default},MenuProjectEditor:{ItemSelecter:O.default},DragAndDrop:{Agenda:s.default,ProjectList:c.default},Logger:{store:P.default,ProjectsModel:g.default},LoadEngine:{SyncEngine:E.default},Scheduler:{SmartSchedule:j},notesActions:{ProjectsModel:g.default}},"reducers/items/actions",{notesActions:D})),(0,k.checkIfAllInjected)()}},{"../components/agenda/Agenda.js":5,"../components/item_selecter/ItemSelecter":27,"../components/notes/Notes.js":46,"../components/project_editor/ProjectEditor.js":59,"../components/projects_list/ProjectList":70,"../containers/SmartSchedule":112,"../models/ItemsModel":167,"../models/ProjectsModel":171,"../models/Reminders":173,"../models/SyncEngine":181,"../reducers/collaborators":407,"../reducers/labels":422,"../reducers/notes/notesActions":429,"../reducers/projects":435,"../stores/store":456,"../utils/deps":470}],140:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("../stores/store"),a=n(o),i=e("../models/ProjectsModel"),s=n(i),l=e("../logger/Logger"),u=function(e){try{if(-1!==e.message.indexOf("window.User")&&-1!==e.message.indexOf("undefined")){var t=a.default.getState().user,r=localStorage.getItem("User"),n=s.default.getAll().length;l.captureError(e,{tags:{where:"undefined_user"},extra:{store_user:t,ls_user:r,projectCounts:n}})}}catch(e){}},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.message,n=t.extra,o=t.showErrorLog,a=void 0===o||o,i=t.captureError,s=void 0===i||i;console.log(e);var c=void 0;s&&(u(e),c=l.captureError(e,{tags:{where:"init"}}));var f=void 0;if(a){var p=e instanceof window.DOMError?"("+e.name+") "+e:""+e;e.message&&-1===p.indexOf(e.message)&&(p+=": "+e.message),n&&(p+="\n"+n),c&&(p+="\nEvent ID: "+c),f=TEXTAREA({readonly:"readonly"},p)}var m=A({c:"ist_button ist_button_red"},_("Ok"));r||(r=_("An unknown error happened while loading data\u2026We will try to reload Todoist."));var h=DIV({c:"init_error_popup"},P(r),P(a?_("Please contact Todoist Support (support@todoist.com) and supply the error log below if this problem persists."):_("Please contact Todoist Support (support@todoist.com) if this problem persists.")),f,m);$("app_holder")&&($("app_holder").style.display="block");var v=GB_showHTML(_("Error"),h,500,500,{close_validator_fn:function(){return d(),!0}});$AEV(m,"click",function(){d(),v.hide()})},d=function(){try{window.applicationCache.update()}catch(e){}e("../models/LoadEngine").logout()};r.default=c},{"../logger/Logger":141,"../models/LoadEngine":169,"../models/ProjectsModel":171,"../stores/store":456}],141:[function(e,t,r){"use strict";function n(){return"undefined"!=typeof Raven&&Raven.isSetup()}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(console.error(e),n()){if(t.extra=t.extra?t.extra:{},t.extra.error_message=e.message,d(e)){var r=Raven.lastEventId();return console.log(e,"\nevent_id: "+r),r}Raven.captureException(e,t);return Raven.lastEventId()}}function a(e,t){if(n())try{throw new Error(e)}catch(e){o(e,t)}console.log(e)}function i(e,t){n()&&Raven.captureMessage(e,t),console.log(e)}function s(e){n()&&Raven.captureBreadcrumb(e)}function l(e){n()&&Raven.setTagsContext(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.captureError=o,r.captureMessageWithTrace=a,r.captureMessage=i,r.captureBreadcrumb=s,r.setTagsContext=l;var u=e("../utils/deps"),c=(0,u.defineDeps)("Logger",["store","ProjectsModel"]),d=function(e){try{if(-1!==e.message.indexOf("window.User")&&-1!==e.message.indexOf("undefined")){return o(e,{tags:{where:"undefined_user_2"},extra:{store_user:c.store.getState().user,ls_user:localStorage.getItem("User"),projectCounts:c.ProjectsModel.getAll().length}}),!0}}catch(e){}return!1};r.default={captureError:o,captureMessageWithTrace:a,captureMessage:i,captureBreadcrumb:s,setTagsContext:l}},{"../utils/deps":470}],142:[function(e,t,r){"use strict";function n(e,t){var r=UL({class:"menu_buttons priorities"});$add(r,LI({class:"lbl"},_("Priority")));var n=LI({class:"priorities"});return $map([4,3,2,1],function(r){var o=5-r,a=[svgs.get("sm1/priority_1.svg"),svgs.get("sm1/priority_2.svg"),svgs.get("sm1/priority_3.svg"),svgs.get("sm1/priority_4.svg")],i=a[r-1],s=A({c:"a_priority icon_priority_"+r,"data-track":"task|more_priority_"+r},i);s.priority=o;var u=B(_("Priority %s").replace("%s",r));t&&(u=SPAN(u,BR(),"p"+r)),l.showSimpleText(s,u,null,0,5),$AEV(s,["click","touchstart"],function(t){return $preventDefault(t),e(o,s),!1}),$add(n,s)}),$add(r,n),{type:"item",view:r,extra_class:"no_hover"}}function o(e,t){var r=$all("li","colors",e.colors.view)[0];$map($AF(r.childNodes),function(e){
parseInt(e.getAttribute("data-index"))==t?$addClass(e,"selected_color"):$removeClass(e,"selected_color")})}function a(e,t){var r=UL({class:"menu_buttons colors"}),n=LI({class:"colors"});return $map(e,function(e,r){var o=r+s.START_INDEX,a=A({c:"object_color","data-index":o},svgs.get("sm1/check_mark_big.svg"));a.style.backgroundColor=e.hex,a.onclick=$p(t,o,a,null),l.showSimpleText(a,e.name,null,1,9),$add(n,a)}),$add(r,n),{type:"item",view:r,extra_class:"no_hover"}}function i(e,t){var r=UL({class:"menu_buttons reactions"}),n=LI({class:"reactions"});return $map(e,function(e,r){var o=$setHTML(A({c:"object_reaction"}),u.formatSimple(e,{as_html:!0}));o.onclick=$p(t,r,o,null),$add(n,o)}),$add(r,n),{type:"item",view:r,extra_class:"no_hover"}}var s=e("../models/Colors"),l=window.IstTooltip,u=window.DoistFormat;t.exports={createPriorities:n,selectColor:o,createColor:a,createReactions:i}},{"../models/Colors":161}],143:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){s(t,e.json.priority);var r=t.current_holder.json,n={with_help_text:!0,with_smart_schedule:!0,with_today:!0,with_postpone:!!r.due,with_tomorrow:!r.due,with_next_week:!0,with_more:!0,items:r},a=function(e){var n;n=t.saveCurrentItem?t.saveCurrentItem:function(e){e()},e instanceof Date&&(e=r.due?r.due.inheritDate({year:e.getFullYear(),month:e.getMonth(),day:e.getDate(),hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()},{withTime:59!==e.getSeconds(),timezone:r.due.timezone}):c.default.fromDate(e)),n(function(){m.default.updateDue(o({},r.id,e)),t.hide()})},i=f.default.create(a,n);$replace(t.scheduler_holder.view,i)}function i(e){$AEV(document,"click",function(t){var r=$eventElm(t);return!!($parent(r,"div","scheduler")||$parent(r,"div","dialog-timepicker")||$parent(r,"div","dialog-timezone"))||e.hide(t)})}function s(e,t){var r=$all("li","priorities",e.menu_holder)[0];l(),$map($AF(r.childNodes),function(e){e.priority==t&&$addClass(e,"priority_selected")})}function l(){$map($all("a","a_priority"),function(e){$removeClass(e,"priority_selected")})}var u=e("../models/DateExt"),c=n(u),d=e("../components/smart_scheduler/SmartScheduler"),f=n(d),p=e("../models/ItemsModel"),m=n(p);window.Signals.connect("update_priority",l),t.exports={annotateItemEditMenu:a,schedulerClose:i,selectPriority:s}},{"../components/smart_scheduler/SmartScheduler":89,"../models/DateExt":164,"../models/ItemsModel":167}],144:[function(e,t,r){"use strict";function n(e,t){return function(){var r=e.current_form;r&&""!==$gc(r,null,"richtext_editor").proxyGetValue()?"edit"==e.current_mode?e.saveItem(r,function(){e.showAddItem(!0,t)}):e.addItem(r,function(){e.showAddItem(!0,t)}):e.showAddItem(!0,t)}}function o(e,t){if(!e)return null;var r=e.current_holder;return e.current_holder=null,!1!==t&&e.hide(),r}t.exports={menuSaveAndAdd:n,getAndResetCurrent:o}},{}],145:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var o=e("../utils"),a={_createSection:function(e,t){return TABLE(TR(TH({colspan:"2"},e)),t)},_createItem:function(e,t){return TR(TD({c:"ks-dialog__label"},e),TD({c:"ks-dialog__shortcut"},t))},_platformIsMac:$isMac(),_getKeySymbol:function(e){switch(e){case"command":return this._platformIsMac?"\u2318":"Ctrl";case"alt":return this._platformIsMac?"\u2325":"Alt";case"control":return this._platformIsMac?"\u2303":"Ctrl";case"enter":return this._platformIsMac?"\u21a9\ufe0e":"Enter"}},_getTable:function(){return TABLE({c:"ks-dialog__wrapper-table"},TR(TD(this._createSection(_x("shortcuts","Task Quick Add shortcuts"),TBODY(this._createItem(_x("shortcuts","Add a label"),PRE("@")),this._createItem(_x("shortcuts","Pick a project"),PRE("#")),this._createItem(_x("shortcuts","Add an assignee"),PRE("+")),this._createItem(_x("shortcuts","Set a priority level"),DIV(PRE("p1")," , ",PRE("p2")," , ",PRE("p3")," , ",PRE("p4"))),this._createItem(_x("shortcuts","Add a quick comment"),DIV(PRE(this._getKeySymbol("control"))," + ",PRE("m"))))),this._createSection(_x("shortcuts","Used anywhere"),TBODY(this._createItem(_x("shortcuts","Select and change multiple tasks at once"),DIV.apply(void 0,n((0,o.formatToDOM)(_x("shortcuts","{shortcut1} or {shortcut2}"),{shortcut1:SPAN(PRE(this._getKeySymbol("control"))," + ",PRE("Click")),shortcut2:SPAN(PRE("\u21e7")," + ",PRE("Click"))})))),this._createItem(_x("shortcuts","Add task"),PRE("q")),this._createItem(_x("shortcuts","Add new task at the bottom of the list"),PRE("a")),this._createItem(_x("shortcuts","Add new task at the top of the list"),PRE("A")),this._createItem(_x("shortcuts","Open search"),DIV.apply(void 0,n((0,o.formatToDOM)(_x("shortcuts","{shortcut1} or {shortcut2}"),{shortcut1:PRE("/"),shortcut2:PRE("f")})))),this._createItem(_x("shortcuts","Undo last action"),PRE("u")))),this._createSection(_x("shortcuts","Adding or editing tasks"),TBODY(this._createItem(_x("shortcuts","Cancel current changes"),PRE("Esc")),this._createItem(_x("shortcuts","Save a newly created task and create a new one below it"),PRE(this._getKeySymbol("enter"))),this._createItem(_x("shortcuts","Save changes to an existing task and create a new task below it"),DIV(PRE("\u21e7")," + ",PRE(this._getKeySymbol("enter")))),this._createItem(_x("shortcuts","Save a new task or save changes to an existing one and create a new task above it"),DIV(PRE(this._getKeySymbol("control"))," + ",PRE(this._getKeySymbol("enter")))),this._createItem(_x("shortcuts","Move to the task above the task currently being edited"),DIV(PRE(this._getKeySymbol("control"))," + ",PRE("\u2191"))),this._createItem(_x("shortcuts","Move to the task below the task currently being edited"),DIV(PRE(this._getKeySymbol("control"))," + ",PRE("\u2193"))))),this._createSection(_x("shortcuts","Creating and completing sub-tasks"),TBODY(this._createItem(_x("shortcuts","Increase task indent (Works only inside projects)"),DIV(PRE(this._getKeySymbol("command"))," + ",PRE("\u2192"))),this._createItem(_x("shortcuts","Decrease task indent (Works only inside projects)"),DIV(PRE(this._getKeySymbol("command"))," + ",PRE("\u2190"))),this._createItem(_x("shortcuts","Complete a sub-task or recurring task and archive it"),DIV(PRE("\u21e7")," + ",PRE("Click")," ",_x("shortcuts","(hold down \u21e7)"))))),this._createSection(_x("shortcuts","Sorting tasks inside a project"),TBODY(this._createItem(_x("shortcuts","Sort by date"),PRE("s")),this._createItem(_x("shortcuts","Sort by priority"),PRE("p")),this._createItem(_x("shortcuts","Sort by assignee"),PRE("r")))))))},_getHolder:function(){return DIV({c:"ks-dialog"},P({c:"ks-dialog__caption"},_x("shortcuts","Shortcuts can save you time! Some can be used anywhere in the app, while others only work when adding or editing tasks.")," ",A({c:"ks-dialog__link",href:"https://get.todoist.help/hc/articles/205063212",target:"_blank"},_x("shortcuts","Learn more"))),this._getTable())},show:function(){this._holder=this._holder||this._getHolder(),GB_showHTML(_x("shortcuts","Keyboard Shortcuts"),this._holder,580,580)}};window.KeyboardShortcutsDialog=t.exports=a},{"../utils":484}],146:[function(e,t,r){"use strict";var n,o=window.IstMenu,a=window.Signals,i=window.GB_getLast,s=window.GB_hide,l=e("./HelpersMenuGeneral.js"),u=e("./HelperMenuAnnotations.js"),c=e("./HelperColorsPriorities.js"),d=e("../components/items_utils/ItemCommonEdits"),f=e("../components/items_utils/ItemUniqueLink.js"),p=e("../components/generic_manager/GenericManagerUtils.js"),m=e("../components/reminders/Reminders.js"),h=e("./../components/agenda/AgendaUtils"),v=e("../components/item_selecter/ItemSelecter.js"),y={init:function(e){n=new o,n.saveCurrentItem=e.saveCurrentItem,n.addItems(o.createItem(_("Edit task"),function(){e.editCurrentItem({},l.getAndResetCurrent(n))},{extra_class:"menu_item_edit",icon:svgs.get("sm1/edit.svg"),attr:{"data-track":"task|more_edit"}}),o.createSeparator(),n.scheduler_holder={type:"item",view:DIV(),extra_class:"no_hover"},function(){var t=c.createPriorities(function(t){e.saveCurrentItem(function(){y.updatePriority(e,t)})},!1);return t.extra_class+=" sel_f_priorities",t}()),n.addItems(o.createSeparator(),o.createItem(_("Reminders"),function(){var e=l.getAndResetCurrent(n);return e&&m.show(e),!1},{extra_class:"menu_item_reminders",icon:svgs.get("sm1/reminder.svg"),attr:{"data-track":"task|more_reminders"}}));_("Move to project");return n.addItems(o.createSeparator(),o.createItem(_("Archive task"),$p(e.saveCurrentItem,$p(y.forceComplete,e)),{extra_class:"menu_item_archive",icon:svgs.get("sm1/archive.svg"),attr:{"data-track":"task|more_archive"}}),o.createItem(_("Move to project"),function(t){e.saveCurrentItem(function(){y.showMoveTo(t)})},{extra_class:"sel_move_task menu_item_move",icon:svgs.get("sm1/move.svg"),attr:{"data-track":"task|more_move_to_project"}}),o.createItem(_("Duplicate"),function(){return e.saveCurrentItem(function(){var e=l.getAndResetCurrent(n);d.duplicate([e.json.id])}),!1},{extra_class:"menu_item_duplicate",icon:svgs.get("sm1/add_integration.svg"),attr:{"data-track":"task|more_duplicate"}}),o.createItem(_("Copy link to task"),function(){var e=l.getAndResetCurrent(n);return e&&f.show(e.json),!1},{extra_class:"menu_item_link",icon:svgs.get("sm1/link.svg"),attr:{"data-track":"task|more_link_to_task"}}),o.createSeparator(),o.createItem(_("Delete task"),y.deleteCurrentItem,{extra_class:"sel_delete_task danger",icon:svgs.get("sm1/trash.svg"),attr:{"data-track":"task|more_delete"}})),n.hide_callbacks.push(function(){$removeClass($all("li","on_menu_show"),"on_menu_show")}),n.hide_menu_icon=!0,u.schedulerClose(n),a.connect("hide_editor_menu",function(){n.hide()}),n},get:function(){return n},toggle:function(e,t,r,o){return!e.disabled&&(v.deselectAll(),$removeClass($all("li","on_menu_show"),"on_menu_show"),$addClass(e,"on_menu_show"),n.current_holder=e,u.annotateItemEditMenu(e,n),n.toggle(t,e,o),!1)},updatePriority:function(e,t){var r=l.getAndResetCurrent(n);if(r){var o=r.json.priority;d.updatePriority(r,t),e.refresh(r.json,{priority:o,due:r.json.due})}},forceComplete:function(e){var t=l.getAndResetCurrent(n);return t&&(e.completeItem(t,{shift:!0},!0),i()&&s()),!1},deleteCurrentItem:function(){var e=l.getAndResetCurrent(n);if(e){var t=$child(e,"img","arrow");if(t)try{h.fetchChildren(t)}catch(e){}p.getChildren(e,!0),d.deleteItems([e],function(e){e&&i()&&s()})}},showMoveTo:function(e){var t=$eventElm(e),r=l.getAndResetCurrent(n,!1);return r&&v.showMoveItems(t,[r]),!1}};t.exports=y},{"../components/generic_manager/GenericManagerUtils.js":26,"../components/item_selecter/ItemSelecter.js":27,"../components/items_utils/ItemCommonEdits":30,"../components/items_utils/ItemUniqueLink.js":32,"../components/reminders/Reminders.js":78,"./../components/agenda/AgendaUtils":8,"./HelperColorsPriorities.js":142,"./HelperMenuAnnotations.js":143,"./HelpersMenuGeneral.js":144}],147:[function(e,t,r){"use strict";var n=window,o=n.Signals,a=window,i=a.IstMenu,s={};r.get=function(){return s.Menu},r.init=function(){var e=void 0;s.Menu=e=new i,e.with_arrow=!0,e.pos_y_offset=6,e.arrow_y_offset=10,e.arrow_x_offset=5;var t=function(e){return SPAN({c:"keyboard_key"},e)},r=DIV({c:"indent_menu","data-track":"task_form|more_indent_left"},DIV({c:"indent_desc"},SPAN(_("Parent task")),BR(),SPAN({c:"small_text"},_("Indent Left"))),DIV({c:"indent_shortcut"},t($isMac()?"\u2318":"CTRL"),SPAN({c:"plus"},"+"),t("\u2190"))),n=DIV({c:"indent_menu","data-track":"task_form|more_indent_right"},DIV({c:"indent_desc"},SPAN(_("Sub-task")),BR(),SPAN({c:"small_text"},_("Indent Right"))),DIV({c:"indent_shortcut"},t($isMac()?"\u2318":"CTRL"),SPAN({c:"plus"},"+"),t("\u2192")));return e.addItems(i.createItem(n,function(){return o.sendSignal("menu_indent_right"),!1},{extra_class:"menu_indent"}),i.createItem(r,function(){return o.sendSignal("menu_indent_left"),!1},{extra_class:"menu_indent"})),$AEV(document,"click",e.hide),e}},{}],148:[function(e,t,r){"use strict";var n=window,o=n.Signals,a=window,i=a.IstMenu,s=e("./HelperColorsPriorities.js"),l={};r.get=function(){return l.Menu},r.init=function(){var e=void 0;return l.Menu=e=new i,$addClass(e.menu_holder,"priority_menu"),e.with_arrow=!0,e.pos_y_offset=7,e.arrow_y_offset=15,e.arrow_x_offset=4,e.addItems(s.createPriorities(function(e){return o.sendSignal("menu_priority_changed",e),!1},!0)),$AEV(document,"click",e.hide),e}},{"./HelperColorsPriorities.js":142}],149:[function(e,t,r){"use strict";var n=window,o=n.Signals,a=window,i=a.IstMenu,s=e("../models/Colors"),l=e("./HelperColorsPriorities.js"),u={};r.get=function(){return u.Menu},r.init=function(){var e=void 0;return u.Menu=e=new i,$addClass(e.menu_holder,"color_picker"),e.pos_y_offset=-3,e.pos_x_offset=4,e.addItems(e.colors=l.createColor(s.get(),function(t){return o.sendSignal("color_selected",t),e.hide(),!1})),$addClass(e.colors.view,"projects_list_colors"),$AEV(document,"click",e.hide),e}},{"../models/Colors":161,"./HelperColorsPriorities.js":142}],150:[function(e,t,r){"use strict";var n,o=e("../utils/deps"),a=window.IstMenu,i=window.Signals,s=e("./HelpersMenuGeneral.js"),l=e("./HelperMenuAnnotations.js"),u=e("./HelperColorsPriorities.js"),c=e("../components/reminders/Reminders.js"),d=e("../components/items_utils/ItemUniqueLink.js"),f=e("../components/items_utils/ItemCommonEdits"),p=(0,o.defineDeps)("MenuProjectEditor",["ItemSelecter"]),m={init:function(e){return n=new a,n.addItems(a.createItem(_("Add task above"),function(t){return s.menuSaveAndAdd(e.getCurrentSectionList(),!0)(t)},{extra_class:"menu_item_add_above",icon:svgs.get("sm1/add_above.svg"),attr:{"data-track":"task|more_add_task_above"}}),a.createItem(_("Add task below"),function(t){s.menuSaveAndAdd(e.getCurrentSectionList(),!1)(t)},{extra_class:"menu_item_add_below",icon:svgs.get("sm1/add_below.svg"),attr:{"data-track":"task|more_add_task_below"}}),a.createItem(_("Edit task"),function(){var t=e.getCurrentSectionList();t.saveCurrentItem(t.editCurrentItem)},{extra_class:"menu_item_edit",icon:svgs.get("sm1/edit.svg"),attr:{"data-track":"task|more_edit"}}),a.createSeparator(),n.scheduler_holder={type:"item",view:DIV(),extra_class:"no_hover"},function(){var e=u.createPriorities(function(e){var t=s.getAndResetCurrent(n);t&&f.updatePriority(t,e)},!1);return e.extra_class+=" sel_priorities",e}()),n.addItems(a.createSeparator(),a.createItem(_("Reminders"),function(){var e=s.getAndResetCurrent(n);return c.show(e),!1},{extra_class:"menu_item_reminders",icon:svgs.get("sm1/reminder.svg"),attr:{"data-track":"task|more_reminders"}})),n.addItems(a.createSeparator()),n.addItems(a.createItem(_("Archive task"),function(){var t=e.getCurrentSectionList(),r=s.getAndResetCurrent(n);t&&r&&t.archiveItem(r)},{extra_class:"menu_item_archive",icon:svgs.get("sm1/archive.svg"),attr:{"data-track":"task|more_archive"}}),a.createItem(_("Move to project"),function(e){return m.showMoveTo(e)},{extra_class:"sel_move_task menu_item_move",icon:svgs.get("sm1/move.svg"),attr:{"data-track":"task|more_move_to_project"}}),a.createItem(_("Duplicate"),function(){var e=s.getAndResetCurrent(n);return f.duplicate([e.json.id]),!1},{extra_class:"menu_item_duplicate",icon:svgs.get("sm1/add_integration.svg"),attr:{"data-track":"task|more_duplicate"}}),a.createItem(_("Copy link to task"),function(){var e=s.getAndResetCurrent(n);return d.show(e.json),!1},{extra_class:"menu_item_link",icon:svgs.get("sm1/link.svg"),attr:{"data-track":"task|more_link_to_task"}}),a.createSeparator(),a.createItem(_("Delete task"),function(){var t=s.getAndResetCurrent(n);return e.getCurrentSectionList().deleteCurrentItem(t),!1},{extra_class:"sel_delete_task danger",icon:svgs.get("sm1/trash.svg"),attr:{"data-track":"task|more_delete"}})),n.hide_menu_icon=!0,l.schedulerClose(n),n.hide_callbacks.push(function(){$removeClass($all("li","on_menu_show"),"on_menu_show")}),i.connect("hide_editor_menu",function(){n.hide()}),n},get:function(){return n},toggle:function(e,t,r,o){return!e.disabled&&(p.ItemSelecter.deselectAll(),$removeClass($all("li","on_menu_show"),"on_menu_show"),$addClass(e,"on_menu_show"),n.current_holder=e,l.annotateItemEditMenu(e,n),n.toggle(t,e,o),!1)},showMoveTo:function(e){var t=$eventElm(e),r=s.getAndResetCurrent(n,!1);return r&&p.ItemSelecter.showMoveItems(t,[r]),!1}};t.exports=m},{"../components/items_utils/ItemCommonEdits":30,"../components/items_utils/ItemUniqueLink.js":32,"../components/reminders/Reminders.js":78,"../utils/deps":470,"./HelperColorsPriorities.js":142,"./HelperMenuAnnotations.js":143,"./HelpersMenuGeneral.js":144}],151:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var o,a=e("../stores/store"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=e("../reducers/user"),l=window.Signals,u=window.IstMenu,c=e("../components/items_utils/ItemsSortBy.js"),d=e("../components/project_editor/ProjectExtraActions"),f=e("../components/templates/Templates");r.get=function(){return o},r.init=function(e){var t;o=new u;var r=[];return(0,s.isDoistUser)(i.default.getState())&&(r=[u.createItem(_("Add section"),function(){e.getCurrentEditor().showSectionAddForm(),o.hide()},{icon:svgs.get("sm1/add_section.svg")}),u.createSeparator()]),(t=o).addItems.apply(t,n(r).concat([u.createItem(_("Sort by date"),function(){c.sortByDate()},{icon:svgs.get("sm1/calendar.svg"),attr:{"data-track":"project|actions_sort_by_date"}}),u.createItem(_("Sort by priority"),function(){c.sortByPriority()},{icon:svgs.get("sm1/priority_flag.svg"),attr:{"data-track":"project|actions_sort_by_priority"}}),u.createItem(_("Sort by name"),function(){c.sortByName()},{icon:svgs.get("sm1/name.svg"),attr:{"data-track":"project|actions_sort_by_name"}}),u.createItem(_("Sort by responsible"),function(){c.sortByResponsible()},{extra_class:"sort_responsible",icon:svgs.get("sm1/member_big.svg"),attr:{"data-track":"project|actions_sort_by_responsible"}}),u.createSeparator()])),o.addItems(u.createItem(_("Import from template"),function(){return f.showImport(e.getCurrentProjectId()),o.hide(),!1},{icon:svgs.get("sm1/download.svg"),attr:{"data-track":"project|actions_import_from_template"}}),u.createItem(_("Export as a template"),function(){return f.showExportTemplate(e.getCurrentProjectId()),o.hide(),!1},{icon:svgs.get("sm1/upload.svg"),attr:{"data-track":"project|actions_export_as_template"}}),u.createSeparator(),u.createItem(_("Email tasks to this project"),function(){return d.showProjectEmail(e.getCurrentProjectId()),!1},{icon:svgs.get("sm1/mail.svg"),attr:{"data-track":"project|actions_email_tasks"}}),u.createItem(_("Project calendar feed"),function(){return d.showCalFeed(e.getCurrentProjectId()),!1},{icon:svgs.get("sm1/list.svg"),attr:{"data-track":"project|actions_project_calendar_feed"}}),u.createSeparator(),u.createItem(_("Show completed tasks"),function(){return o.hide(),e.getCurrentEditor().showHistory(),!1},{icon:svgs.get("sm1/checkbox_checked.svg"),attr:{"data-track":"project|action_show_completed"}})),$AEV(document,"click",o.hide),l.connect("sort_by_done",function(){o.hide()}),o}},{"../components/items_utils/ItemsSortBy.js":34,"../components/project_editor/ProjectExtraActions":63,"../components/templates/Templates":94,"../reducers/user":451,"../stores/store":456}],152:[function(e,t,r){"use strict";var n,o=window.IstMenu,a=e("./HelpersMenuGeneral.js"),i=e("../components/projects_list/ProjectArchive"),s=e("../components/project_editor/ProjectExtraActions"),l=e("../components/sharing/SharingManager"),u=e("../models/ProjectsModel");r.get=function(){return n},r.init=function(e){return n=new o,n.addItems(o.createItem(_("Add project above"),a.menuSaveAndAdd(e,!0),{extra_class:"project_archive_action project_inbox_action",icon:svgs.get("sm1/add_above.svg"),attr:{"data-track":"projects|menu_add_project_above"}}),o.createItem(_("Add project below"),a.menuSaveAndAdd(e,!1),{extra_class:"project_archive_action",icon:svgs.get("sm1/add_below.svg"),attr:{"data-track":"projects|menu_add_project_below"}}),o.createSeparator("project_archive_action"),o.createItem(_("Edit project"),$p(e.saveCurrentItem,e.editCurrentItem),{extra_class:"project_archive_action project_inbox_action",icon:svgs.get("sm1/edit.svg"),attr:{"data-track":"projects|menu_edit"}}),o.createItem(_x("project_menu","Share project"),function(){var e=a.getAndResetCurrent(n);return e&&l.show(e.json.id),!1},{extra_class:"project_archive_action",icon:svgs.get("sm1/add_member.svg"),attr:{"data-track":"projects|menu_share_project"}}),o.createItem(_("Add to favorites"),function(){var e=a.getAndResetCurrent(n);e&&u.update(e.json.id,{is_favorite:1})},{extra_class:"project_add_favorite_action",icon:svgs.get("sm1/heart.svg"),attr:{"data-track":"projects|menu_add_to_favorites"}}),o.createSeparator("project_archive_action project_inbox_action"),o.createItem(_("Email tasks to this project"),function(){var e=a.getAndResetCurrent(n);return s.showProjectEmail(e.json.id)},{extra_class:"project_archive_action",icon:svgs.get("sm1/mail.svg"),attr:{"data-track":"projects|menu_email_tasks"}}),o.createItem(_("Project calendar feed"),function(){var e=a.getAndResetCurrent(n);return s.showCalFeed(e.json.id)},{extra_class:"project_archive_action",icon:svgs.get("sm1/list.svg"),attr:{"data-track":"projects|menu_project_calendar_feed"}}),o.createSeparator("project_archive_action project_inbox_action"),o.createItem(SPAN({id:"menu_archive_text",class:"menu_label"},_("Archive project")),function(){var e=a.getAndResetCurrent(n);if(e){e.json.is_archived?i.unarchive(e):i.archive(e)}return!1},{extra_class:"project_inbox_action",icon:svgs.get("sm1/archive.svg"),attr:{"data-track":"projects|menu_archive"}}),o.createItem(SPAN({id:"menu_delete_text",class:"menu_label"},_("Delete project")),function(){var t=a.getAndResetCurrent(n);return e.deleteCurrentItem(t)},{extra_class:"project_inbox_action danger",icon:svgs.get("sm1/trash.svg"),attr:{"data-track":"projects|menu_delete"}})),n.hide_menu_icon=!0,$AEV(document,"click",n.hide),n}},{"../components/project_editor/ProjectExtraActions":63,"../components/projects_list/ProjectArchive":69,"../components/sharing/SharingManager":87,"../models/ProjectsModel":171,"./HelpersMenuGeneral.js":144}],153:[function(e,t,r){"use strict";var n=window,o=n.Signals,a=window,i=a.IstMenu,s=e("./HelperColorsPriorities.js"),l=["\ud83d\udc4d","\ud83d\udc4e","\u2764\ufe0f","\ud83d\ude04","\ud83d\ude02","\ud83d\ude2e","\ud83d\ude22","\ud83d\ude21","\ud83d\udc4f","\ud83c\udf89"],u={};r.get=function(){return u.Menu},r.getReactions=function(){return l},r.init=function(){var e=void 0;return u.Menu=e=new i,$addClass(e.menu_holder,"reactions_menu"),e.with_arrow=!0,e.arrow_fixed=!1,e.pos_y_offset=7,e.arrow_y_offset=15,e.arrow_x_offset=0,e.addItems(s.createReactions(l,function(e){return o.sendSignal("reaction_added",e),!1})),$AEV(document,"click",e.hide),e.hide_callbacks.push(function(){return $removeClass($$(".reactions_sticky"),"reactions_sticky"),!1}),e}},{"./HelperColorsPriorities.js":142}],154:[function(e,t,r){"use strict";var n=window,o=n.IstMenu,a=null;r.get=function(){return a},r.init=function(e){var t=void 0;return a=new o,a.pos_x_offset=-12,$addClass(a.menu_holder,"reminders_menu"),a.addItems(o.createItem(_("Date and time"),function(){return e.adder.onChangeInterface("absolute")},{attr:{"data-track":"task_form|reminders_date"},icon:svgs.get("sm1/history.svg")}),t=o.createItem(_("Before task"),function(){return e.adder.onChangeInterface("relative")},{icon:svgs.get("sm1/clock.svg")}),o.createItem(_("Location"),function(){return e.adder.onChangeInterface("location")},{attr:{"data-track":"task_form|reminders_location"},icon:svgs.get("sm1/location_mark.svg")})),a.setRelativePossible=function(e){return e?$show(t.view.parentNode):$hide(t.view.parentNode)},$AEV(document,"click",a.hide),a}},{}],155:[function(e,t,r){"use strict";var n=window,o=n.IstMenu,a=window,i=a.Signals,s={};r.get=function(){return s.Menu},r.init=function(){var e=void 0;s.Menu=e=new o;var t=svgs.get("sm1/scheduler_today.svg",{width:20,height:20}),r=""+(new Date).getDate();return t.querySelector("tspan").textContent=r,e.addItems(o.createItem(_("Move to Today"),function(){i.sendSignal("menu_move_to_today")},{attr:{"data-track":"reschedule|move_to_today"},icon:t}),o.createItem(_("Open Smart Schedule"),function(){i.sendSignal("menu_open_smart_schedule")},{attr:{"data-track":"reschedule|open_smart_schedule"},icon:svgs.get("sm1/smart_schedule.svg")})),e.hide_callbacks.push(function(){i.sendSignal("menu_reschedule_hide")}),$AEV(document,"click",e.hide),e}},{}],156:[function(e,t,r){"use strict";var n=window,o=n.IstMenu,a=window,i=a.Signals,s={};r.get=function(){return s.Menu},r.show=function(e,t,r){var n=r&&!!r.show_assign,o=$$(".menu_item_assign",s.Menu.menu);return n?$addClass(o,"show"):$removeClass(o,"show"),s.Menu.show(e,t,r)},r.hide=function(){return s.Menu.hide()},r.init=function(){var e=void 0;return s.Menu=e=new o,$addClass(e.menu_holder,"menu_selecter_more"),e.with_arrow=!0,e.pos_y_offset=3,e.arrow_y_offset=15,e.arrow_x_offset=4,e.addItems(o.createItem(_("Priority"),function(){var e=$$("#item_selecter .menu_item_more")[0];return window.ItemSelecter.showChangePriority(e),!1},{extra_class:"menu_item_priority",icon:svgs.get("sm1/priority_flag.svg")}),o.createItem(_("Assign to someone"),function(){return i.sendSignal("menu_item_assign"),!1},{extra_class:"menu_item_assign",icon:svgs.get("sm1/add_member.svg")}),o.createItem(_("Archive"),function(){return i.sendSignal("menu_selecter_to_history"),!1},{extra_class:"menu_indent menu_item_archive",icon:svgs.get("sm1/archive.svg")}),o.createItem(_("Duplicate"),function(){return i.sendSignal("menu_selecter_duplicate"),!1},{extra_class:"menu_indent menu_item_duplicate",icon:svgs.get("sm1/add_integration.svg")}),o.createItem(_("Delete"),function(){return i.sendSignal("menu_selecter_delete"),!1},{extra_class:"menu_indent menu_item_delete danger",icon:svgs.get("sm1/trash.svg")}),o.createSeparator(),o.createItem(_("Add label"),function(){return i.sendSignal("menu_selecter_add_label"),!1},{extra_class:"menu_indent menu_item_add_label",icon:svgs.get("sm1/add_label.svg")}),o.createItem(_("Remove label"),function(){return i.sendSignal("menu_selecter_remove_label"),!1},{extra_class:"menu_indent menu_item_remove_label",icon:svgs.get("sm1/remove_label.svg")})),$AEV(document,"click",e.hide),e}},{}],157:[function(e,t,r){"use strict";function n(){window.MINI_VERSION?(a.pos_y_offset=0,a.pos_x_offset=5,a.arrow_y_offset=24,a.arrow_x_offset=5):(a.pos_y_offset=0,a.pos_x_offset=10,a.arrow_y_offset=30,a.arrow_x_offset=7)}function o(){var e=UL({class:"menu_buttons priorities"});$add(e,LI({class:"lbl"},_("Apps")));var t=LI({class:"priorities"}),r=function(e,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=svgs.get(e+".svg"),s=i({c:"a_priority app_icon fixed_pos",href:n,target:"_blank"},o),u=A(s,a);l.showSimpleText(u,r,null,null,5),$add(t,u)};return d()||r("sm1/platform_android",_("Android"),"https://play.google.com/store/apps/details?id=com.todoist",{"data-track":"navigation|gear_android_app"}),r("sm1/platform_apple",_("iPhone"),"https://geo.itunes.apple.com/us/app/todoist-to-do-list-task-manager/id572688855",{"data-track":"navigation|gear_ios_app"}),r("sm1/platform_macos",_("macOS"),"https://geo.itunes.apple.com/us/app/todoist-to-do-list-task-manager/id585829637?mt=12",{"data-track":"navigation|gear_mac_app"}),d()||r("sm1/platform_windows",_("Windows"),"/windows",{"data-track":"navigation|gear_windows_app"}),r("sm1/more",_("More")+"...","/downloads",{"data-track":"navigation|gear_more_apps"}),$add(e,t),e}var a,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=window.Signals,l=window.IstTooltip,u=window.IstMenu,c=window.DateUtils,d=e("../components/misc/Misc.js").isMacApp,f=e("../components/opener/WindowOpener.js"),p=e("../models/Config").default,m=e("../mini/Popout"),h=e("../models/SyncEngine"),v=e("../models/VersionUpdater"),y=e("../models/LoadEngine"),g=e("./KeyboardShortcutsDialog");r.get=function(){return a},r.open=function(e){a.toggle(e),window.MINI_VERSION||window.HAS_MINI_ARGUMENT?$show($all("tr","menu_mini_only")):$hide($all("tr","menu_mini_only")),window.MINI_VERSION||window.HAS_MINI_ARGUMENT?$hide($all("tr","menu_hide_in_mini")):$show($all("tr","menu_hide_in_mini")),window.User.is_biz_admin?$show($all("tr","menu_biz_admin")):$hide($all("tr","menu_biz_admin")),d()||(window.User.business_account_id?$hide($all("tr","menu_no_biz_user")):$show($all("tr","menu_no_biz_user")));var t=function(){var e=$("last_synced");if(!e)return void clearTimeout(r);$replace(e,SPAN(BR(),_("Last successful sync:")+" "+c.prettyDate(h.last_synced.getTime(),!0)))},r=setInterval(t,1e3);return t(),!1};var b={en:"https://get.todoist.help/hc/en-us",de:"https://get.todoist.help/hc/de",es:"https://get.todoist.help/hc/es",fr:"https://get.todoist.help/hc/fr",it:"https://get.todoist.help/hc/it",ja:"https://get.todoist.help/hc/ja",ko:"https://get.todoist.help/hc/ko",pl:"https://get.todoist.help/hc/pl",pt_BR:"https://get.todoist.help/hc/pt-br",pt_PT:"https://get.todoist.help/hc/pt-br",ru:"https://get.todoist.help/hc/ru",zh_TW:"https://get.todoist.help/hc/zh-tw",zh_CN:"https://get.todoist.help/hc/zh-cn"};r.init=function(){a=new u,a.with_arrow=!0,a.arrow_fixed=!0,a.show_callbacks.push(n);var e,t;a.addItems(u.createItem(_("Sync"),function(){return h.sync(null,!0,!0),a.hide(),!1},{icon:svgs.get("sm1/sync.svg"),attr:{"data-track":"navigation|gear_sync"}}),t=u.createItem(_("Popout in a window"),function(){return m.launch(),a.hide(),!1},{icon:svgs.get("sm1/popout.svg")}),u.createSeparator("menu_mini_only"),u.createItem(_("Todoist Business Admin"),function(){return window.open("/business/users"),!1},{extra_class:"menu_biz_admin",icon:svgs.get("sm1/job.svg")}),u.createSeparator("menu_biz_admin"),u.createItem(_("Settings"),function(){a.hide(),f.showPrefs()},{icon:svgs.get("sm1/settings.svg"),attr:{"data-track":"navigation|gear_settings"}}),u.createItem(_("Theme"),function(){a.hide(),f.showPrefs("theme")},{extra_class:"menu_theme menu_hide_in_mini",icon:svgs.get("sm1/theme.svg"),attr:{"data-track":"navigation|gear_theme"}}),u.createItem(_("View activity log"),function(){return s.sendSignal("activity_log.show"),a.hide(null,!0),!1},{icon:svgs.get("sm1/activity_log.svg"),attr:{"data-track":"navigation|gear_view_activity_log"}}),u.createItem(_("Print"),function(){return s.sendSignal("open_print_mode"),a.hide(null,!0),!1},{icon:svgs.get("sm1/print.svg"),attr:{"data-track":"navigation|actions_print"}}),u.createSeparator(),u.createItem(_("Todoist Premium"),function(){return window.open("/premium"),!1},{extra_class:"menu_no_biz_user",small_text:_("Reminders, Comments and more\u2026"),icon:svgs.get("sm1/starred.svg")}),u.createItem(_("Todoist Business"),function(){return window.open("/business"),!1},{extra_class:"menu_no_biz_user",icon:svgs.get("sm1/job.svg")}),u.createSeparator("menu_no_biz_user"),u.createItem(_("Support"),function(){return window.open(b[window.LANG]||"https://get.todoist.help"),!1},{icon:svgs.get("sm1/question.svg"),attr:{"data-track":"navigation|gear_support"}}),u.createItem(_("Templates"),function(){return window.open("https://todoist.com/templates/"),!1},{icon:svgs.get("sm1/template.svg"),extra_class:"menu_hide_in_mini",attr:{"data-track":"navigation|gear_templates"}}),u.createItem(_("Blog"),function(){return window.open("https://blog.doist.com/"),!1},{icon:svgs.get("sm1/edit.svg"),attr:{"data-track":"navigation|gear_blog"}}),u.createItem(_("Keyboard shortcuts"),function(){return g.show(),!1},{icon:$isHighDensity()?svgs.get("sm1/keyboard_retina.svg"):svgs.get("sm1/keyboard_non_retina.svg"),attr:{"data-track":"navigation|gear_shortcuts"}}),u.createSeparator(),u.createItem(_("Log out"),function(){y.logout()},{
extra_class:"danger",icon:svgs.get("sm1/leave.svg"),attr:{"data-track":"navigation|logout"}}),u.createSeparator(),{type:"item",view:o(),extra_class:"no_hover"},u.createSeparator(),u.createItem(SPAN(_("New version available"),e=SPAN()),v.loadNewVersion,{extra_class:"menu_new_version"}),u.createSeparator("menu_new_version_separator"),{type:"item",view:SPAN(_("Version ")+" "+p.version,". ",A({href:"/changelog",target:"_blank","data-track":"navigation|gear_view_changelog"},_("View changelog")),SPAN({id:"last_synced"})),extra_class:"no_hover version"}),m.isSupported()||$hide(t.view.parentNode),$AEV(document,"click",a.hide),$hide($all("tr","menu_new_version")),$hide($all("tr","menu_new_version_separator")),s.connect("new_version_available",function(t){$show($all("tr","menu_new_version")),$show($all("tr","menu_new_version_separator")),$setHTML(e," ("+t+")")})}},{"../components/misc/Misc.js":43,"../components/opener/WindowOpener.js":53,"../mini/Popout":159,"../models/Config":162,"../models/LoadEngine":169,"../models/SyncEngine":181,"../models/VersionUpdater":186,"./KeyboardShortcutsDialog":145}],158:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../components/left_menu/LeftMenu"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=e("../utils"),l=window,u=l.Signals,c=function(){function e(){n(this,e),this.recalculate=(0,s.debounce)(this._recalculate,100),this.recalculate=this.recalculate.bind(this),this._recalculate=this._recalculate.bind(this)}return o(e,[{key:"init",value:function(){var e=this;$AEV(window,["resize","scroll"],function(){e.recalculate(),e.timeout_refresh&&clearTimeout(e.timeout_refresh);var t=function(){return u.sendSignal("refresh_interface")};return e.timeout_refresh=setTimeout(t,5)}),u.connect("project_archived",this.recalculate),u.connect("project_unarchived",this.recalculate),u.connect("ist_menu_show",this.recalculate),u.connect("ist_menu_hide",this.recalculate)}},{key:"_recalculate",value:function(){var e=void 0,t=void 0,r=$winSize(),n=$body(),o=$("left_menu");t=o?$("left_menu").offsetHeight:0;var a=r.h,s=Math.max(t,a),l=$("content"),u=$("editor"),c=$("top_bar_inner"),d=r.w;if(d<750||window.PRINT_MODE){window.MINI_VERSION=!0,$addClass(n,"mini_version");var f=d;u&&$setWidth(u,f-65),$setWidth($("react_editor"),f-65),e="0px",$("app_holder").style.marginLeft=e,c&&(c.style.marginLeft=e)}else{if(window.MINI_VERSION=!1,$removeClass(n,"mini_version"),$removeClass($html(),"left_menu_show"),d>980){e=(d-980)/2+"px"}else e="0px";$("app_holder").style.marginLeft=e;var p=l&&l.offsetWidth||0;u&&$setWidth(u,p-70),$setWidth($("react_editor"),p-85),c&&(c.style.marginLeft=e)}var m=0,h=[];h=h.concat($$(".ist_menu")),h=h.concat($$(".GB_Window")),h=h.concat($$(".dialog"));var _=!0,v=!1,y=void 0;try{for(var g,b=h[Symbol.iterator]();!(_=(g=b.next()).done);_=!0){var w=g.value;if(""===w.style.display){var E=$position(w).y+w.offsetHeight;E>m&&(m=E)}}}catch(e){v=!0,y=e}finally{try{!_&&b.return&&b.return()}finally{if(v)throw y}}var k=$first($$(".GB_overlay"));if(k&&s<k.offsetHeight&&k.offsetHeight>m&&(m=k.offsetHeight),m>s&&(s=m),t>s&&(s=t),l&&(l.style.minHeight=s+"px"),d<480?$addClass(n,"super_mini"):$removeClass(n,"super_mini"),o)return i.default.resizeLeftMenu(),window.MINI_VERSION?setTimeout(function(){return $addClass(o,"left_menu_animated")},20):$removeClass(o,"left_menu_animated")}},{key:"isMacAppV6",value:function(){return-1!==navigator.userAgent.indexOf("TDMacApp")}}]),e}();t.exports=new c},{"../components/left_menu/LeftMenu":38,"../utils":484}],159:[function(e,t,r){"use strict";var n={isSupported:function(){var e=window.location.host;return"chrome.todoist.com"===e||"firefox.todoist.com"===e||top!=window},launch:function(){return n._popout(""+window.location,"Todoist",500,560),!1},_popout:function(e,t,r,n){var o=screen.width/2-r/2,a=screen.height/2-n/2;return window.open("/app?mini=2",t,"toolbar=no, scrollbars=yes, width="+r+", height="+n+", top="+a+", left="+o)}};window.Popout=t.exports=n},{}],160:[function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../stores/store"),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=e("../reducers/collaborators"),u=e("../utils/deps"),c=window,d=c.Signals,f=e("./Storage"),p=f.$storage,m=e("./TemporaryIds"),h=e("./SyncEngine"),_=e("../utils/partialMatchName").default,v=(0,u.defineDeps)("Collaborators",["ItemsModel","RemindersModel","ProjectsModel"]),y=function(){function e(){var t=this;o(this,e),this.receiveBridgeUpdate=function(e){var r=e.collaborators;r&&(t.collaborators=r.all,t.projects_active=r.byPID,t.projects_invited=r.invitedByPID,t.syncCachedData({bridgeUpdate:!1}))},this.initState=this.initState.bind(this),this.syncLocalModel=this.syncLocalModel.bind(this),this.searchByName=this.searchByName.bind(this),this.getByEmail=this.getByEmail.bind(this),this.resolveTempId=this.resolveTempId.bind(this),this.addInvite=this.addInvite.bind(this),this._addToInvitedList=this._addToInvitedList.bind(this),this.cleanProjectState=this.cleanProjectState.bind(this),this.deleteFromProject=this.deleteFromProject.bind(this),this.getUserById=this.getUserById.bind(this),this.isProjectShared=this.isProjectShared.bind(this),this.getAll=this.getAll.bind(this),this.getCount=this.getCount.bind(this),this.getInvitedUsers=this.getInvitedUsers.bind(this),this.getActiveUsers=this.getActiveUsers.bind(this),this.clearCache=this.clearCache.bind(this),this.syncCachedData=this.syncCachedData.bind(this),this.sendBridgeUpdate=this.sendBridgeUpdate.bind(this),this.loadData=this.loadData.bind(this),this.loadCachedData=this.loadCachedData.bind(this),this._genericGet=this._genericGet.bind(this),this.initState(),d.connect("load_cached_data",function(){return t.loadCachedData()}),d.connect("resolve_temp.collaborator",function(e,r){return t.resolveTempId(e,r)}),d.connect("clear_local_data",this.initState),d.connect("bridge:redux_update",this.receiveBridgeUpdate)}return a(e,[{key:"initState",value:function(){this.get_all_cache={},this.collaborators={},this.projects_active={},this.projects_invited={}}}]),a(e,[{key:"syncLocalModel",value:function(e,t){var r=this.collaborators,n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value;r[l.id]=l}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}var u=this.projects_active,c=this.projects_invited,f=!0,p=!1,h=void 0;try{for(var _,y=t[Symbol.iterator]();!(f=(_=y.next()).done);f=!0){var g,b=_.value,w=b.user_id,E=b.project_id,k=b.state,S=!1,j=!1;if("active"===k?(g=u[E],g||(g=u[E]={}),g[w]=1,S=!0):"invited"===k?(this._addToInvitedList(E,w),j=!0):"deleted"!==k&&"inactive"!==k||(j=!0,S=!0),j&&(g=u[E])&&g[w]&&delete g[w],S){var T=c[E];T&&T[w]&&delete T[w]}}}catch(e){p=!0,h=e}finally{try{!f&&y.return&&y.return()}finally{if(p)throw h}}if(t.length>0){var O=void 0;for(var I in c){var P=c[I],C=$keys(P);if(0!==C.length){var D=!0,A=!1,M=void 0;try{for(var x,R=C[Symbol.iterator]();!(D=(x=R.next()).done);D=!0){var N=x.value;"string"==typeof N&&0===N.indexOf("_")&&(delete P[N],(O=m.getRealId(N))&&(P[O]=1))}}catch(e){A=!0,M=e}finally{try{!D&&R.return&&R.return()}finally{if(A)throw M}}}else delete c[I]}var $=!0,L=!1,U=void 0;try{for(var V,F=v.ItemsModel.getAll()[Symbol.iterator]();!($=(V=F.next()).done);$=!0){var B=V.value,H=B.responsible_uid;"string"==typeof H&&0===H.indexOf("_")&&(O=m.getRealId(H),B.responsible_uid=O||null)}}catch(e){L=!0,U=e}finally{try{!$&&F.return&&F.return()}finally{if(L)throw U}}d.sendSignal("collaborators_states_updated"),this.clearCache()}this.syncCachedData()}},{key:"searchByName",value:function(e){var t=this;return function(){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=$values(t.collaborators)[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value;_(e,l.full_name)&&r.push(l)}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}()}},{key:"getByEmail",value:function(e){var t=!0,r=!1,n=void 0;try{for(var o,a=$values(this.collaborators)[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;if(i.email===e)return i}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return null}},{key:"resolveTempId",value:function(e,t){var r=this.collaborators,n=r[e];if(n){var o=void 0;delete r[e],n.id=t;var a=this.getByEmail(n.email);a&&(a.id=t);var i=!0,s=!1,l=void 0;try{for(var u,c=$values(v.RemindersModel.model_data)[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var d=u.value;o=!1,d.notify_uid===e&&(d.notify_uid=t,o=!0),o&&v.RemindersModel.syncCachedData()}}catch(e){s=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(s)throw l}}this.syncCachedData()}}},{key:"addInvite",value:function(e,t){var r=void 0,n=this.getByEmail(t);n?(r=null,this._addToInvitedList(e,n.id)):(n={email:t,full_name:t.split("@")[0]},r=n.id=m.generate("collaborator"),this.collaborators[n.id]=n,r=n.id,this._addToInvitedList(e,r));var o=v.ProjectsModel.get(e);o&&(h.queueUpdate({type:"share_project",temp_id:r,args:{project_id:e,email:t,name:o.name}}),d.sendSignal("project_shared",e,t),d.sendSignal("instant_refresh_interface"))}},{key:"_addToInvitedList",value:function(e,t){if(window.User.id!==t){var r=this.projects_invited,o=r[e];o||(o=r[e]={}),o[t]=1;var a=v.ProjectsModel.get(e);a&&!a.shared&&v.ProjectsModel.updateLocalFields(n({},a.id,{shared:!0})),this.clearCache()}}},{key:"cleanProjectState",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!1;this.projects_invited[e]&&(delete this.projects_invited[e],r=!0),this.projects_active[e]&&(delete this.projects_active[e],r=!0),r&&t&&(this.clearCache(),this.syncCachedData())}},{key:"deleteFromProject",value:function(e,t){var r=v.ProjectsModel.get(e),o=t.id;o=m.getRealId(o);var a=this.projects_invited[e];a&&a[o]&&delete a[o];var i=this.projects_active[e];i&&i[o]&&delete i[o],$keys(i).length+$keys(a).length<=1&&(this.cleanProjectState(e,!1),(r=v.ProjectsModel.get(e))&&r.shared&&v.ProjectsModel.updateLocalFields(n({},r.id,{shared:!1}))),h.queueUpdate({type:"delete_collaborator",args:{project_id:e,email:t.email}}),this.clearCache(),d.sendSignal("instant_refresh_interface")}},{key:"getUserById",value:function(e){return this.collaborators[e]}},{key:"isProjectShared",value:function(e){return(0,l.isShared)(s.default.getState(),e)}},{key:"getAll",value:function(e){if(this.get_all_cache[e])return this.get_all_cache[e];var t=this.getInvitedUsers(e),r=this.getActiveUsers(e),n=t.concat(r),o={},a=[];o[window.User.email]=!0;var i=!0,s=!1,l=void 0;try{for(var u,c=n[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var d=u.value;o[d.email]||(a.push(d),o[d.email]=!0)}}catch(e){s=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(s)throw l}}return a=this.sort(a),a.splice(0,0,window.User),this.get_all_cache[e]=a,a}},{key:"getCount",value:function(){return $keys(this.collaborators).length}},{key:"getInvitedUsers",value:function(e){return this._genericGet(e,this.projects_invited)}},{key:"getActiveUsers",value:function(e){return this._genericGet(e,this.projects_active)}},{key:"clearCache",value:function(){this.get_all_cache={}}},{key:"syncCachedData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bridgeUpdate,r=void 0===t||t;p("CollaboratorsU").set(this.collaborators),p("CollaboratorsA").set(this.projects_active),p("CollaboratorsI").set(this.projects_invited),r&&this.sendBridgeUpdate()}},{key:"sendBridgeUpdate",value:function(){d.sendSignal("bridge:model_update",{collaborators:{all:this.collaborators,byPID:this.projects_active,invitedByPID:this.projects_invited}})}},{key:"loadData",value:function(e){var t=!0,r=!1,n=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;this.collaborators[i.id]=i}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}this.syncCachedData()}},{key:"loadCachedData",value:function(){var e=p("CollaboratorsU").get();e&&(this.collaborators=e);var t=p("CollaboratorsA").get();t&&(this.projects_active=t);var r=p("CollaboratorsI").get();r&&(this.projects_invited=r),this.sendBridgeUpdate()}},{key:"_genericGet",value:function(e,t){var r=this.collaborators,n=[];if(t[e]){var o=!0,a=!1,i=void 0;try{for(var s,l=$keys(t[e])[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u=s.value,c=r[u];c&&!c.is_deleted&&n.push(c)}}catch(e){a=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw i}}}return n=this.sort(n)}},{key:"sort",value:function(e){return e.sort(function(e,t){var r=e.full_name.toLowerCase(),n=t.full_name.toLowerCase();return r.localeCompare(n)})}}]),e}();window.Collaborators=new y,t.exports=window.Collaborators},{"../reducers/collaborators":407,"../stores/store":456,"../utils/deps":470,"../utils/partialMatchName":500,"./Storage":179,"./SyncEngine":181,"./TemporaryIds":184}],161:[function(e,t,r){"use strict";var n=[{name:"Berry Red",hex:"#b8255f"},{name:"Red",hex:"#db4035"},{name:"Orange",hex:"#ff9933"},{name:"Yellow",hex:"#fad000"},{name:"Olive Green",hex:"#afb83b"},{name:"Lime Green",hex:"#7ecc49"},{name:"Green",hex:"#299438"},{name:"Mint Green",hex:"#6accbc"},{name:"Teal",hex:"#158fad"},{name:"Sky Blue",hex:"#14aaf5"},{name:"Light Blue",hex:"#96c3eb"},{name:"Blue",hex:"#4073ff"},{name:"Grape",hex:"#884dff"},{name:"Violet",hex:"#af38eb"},{name:"Lavender",hex:"#eb96eb"},{name:"Magenta",hex:"#e05194"},{name:"Salmon",hex:"#ff8d85"},{name:"Charcoal",hex:"#808080"},{name:"Grey",hex:"#b8b8b8"},{name:"Taupe",hex:"#ccac93"}],o={0:35,1:46,2:32,3:33,4:40,5:49,6:44,7:48,8:46,9:32,10:37,11:39,12:45,13:30,14:31,15:36,16:37,17:38,18:39,19:41,20:47,21:47},a={};for(var i in o)a[o[i]]=i;var s={0:36,1:34,2:31,3:45,4:43,5:41,6:38,7:47,8:38,9:37,10:30,11:35,12:47},l={};for(var u in s)l[s[u]]=u;r.get=function(){return n};var c=function(e,t){var r=void 0;return r="project"==e?o:s,t>=30&&t<=49?t:void 0!=r[t]?parseInt(r[t]):47};r.normalizeToNew=c;var d=function(e,t){var r=void 0;return r="project"==e?a:l,"project"==e&&0<=t&&t<=21?t:("label"==e||"filter"==e)&&0<=t&&t<=12?t:void 0!=r[t]?parseInt(r[t]):7};r.normalizeToOld=d,r.getHex=function(e,t){return t=c(e,t),t-=30,n[t].hex},r.DEFAULT_COLOR=47,r.START_INDEX=30},{}],162:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.version=e.version,this.isBeta=e.isBeta,this.smartScheduleDomain=e.smartScheduleDomain,this.loadStartPage=e.loadStartPage,this.disablePromotion=e.disablePromotion,this.onIntialized=e.onIntialized}};r.default=n},{}],163:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.start=void 0;var n=e("../stores/store"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=e("../reducers/tooltip"),i=e("../reducers/clock"),s=e("../utils"),l=e("../logger/Logger.js"),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),c=function(){try{fetch("/API/v7/tooltips/get_scheduled?token="+window.User.token).then(function(e){if(200!=e.status){var t=new Error(e.statusText);throw t.jsonRes=e,t}return e.json()}).then(function(e){e.result&&e.result instanceof Array&&o.default.dispatch((0,a.scheduledUpdated)(Array.from(e.result)))}).catch(function(){})}catch(e){throw u.captureError(e),e}},d=function(){try{fetch("/API/v6/tooltips/get_seen_list?token="+window.User.token).then(function(e){if(200!=e.status){var t=new Error(e.statusText);throw t.jsonRes=e,t}return e.json()}).then(function(e){e.result&&e.result instanceof Array&&o.default.dispatch((0,a.seenUpdated)(e.result))}).catch(function(){})}catch(e){throw u.captureError(e),e}},f=function e(){c(),d(),setTimeout(e,864e5)},p=function(){var e=(0,s.todayISO)();setInterval(function(){var t=(0,s.todayISO)();e!==t&&(e=t,o.default.dispatch((0,i.tick)()))},3e3)};r.start=function(){f(),p()}},{"../logger/Logger.js":141,"../reducers/clock":406,"../reducers/tooltip":448,"../stores/store":456,"../utils":484}],164:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.getOffsetDate=void 0;var a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../utils"),l=e("../logger/Logger"),u=e("moment-timezone"),c=n(u),d=e("../utils/toISODateString"),f=n(d),p=e("../utils/timezones"),m=window.DateUtils,h=function(e){var t=new Date(e);return t.setSeconds(59),t},_=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,v=/^(\d\d\d\d)-(\d\d)-(\d\d)T(\d\d):(\d\d):(\d\d)Z*/,y=r.getOffsetDate=function(e,t,r){return e instanceof Date&&(0,s.isNumber)(t)&&(0,s.isNumber)(r)?new Date(e.getTime()+60*r*1e3-60*t*1e3):null},g=function(){function e(t){var r=t.date,n=t.timezone,i=t.is_recurring,s=t.string,l=t.lang;o(this,e),this.date=r,this.timezone=n||null,this.is_recurring=!!i,this.string=s,this.lang=l;var u=_.exec(r);if(u){var c=u.slice(1,4).map(function(e){return parseInt(e)}),d=a(c,3),f=d[0],m=d[1],h=d[2];return this._date=new Date(f,m-1,h,23,59,59,0),this.with_time=!1,this.timezone_offset=null,Object.freeze(this)}var y=v.exec(r);if(!y)throw new Error("Unsupported date string format: "+r);this.with_time=!0;var g=y.slice(1,7).map(function(e){return parseInt(e)}),b=a(g,6),w=b[0],E=b[1],k=b[2],S=b[3],j=b[4],T=b[5];return n?(this._date=new Date(Date.UTC(w,E-1,k,S,j,T)),this.timezone_offset=(0,p.getTimezoneOffset)(n,this._date,{useUTC:!0})):(this._date=new Date(w,E-1,k,S,j,T),this.timezone_offset=null),Object.freeze(this)}return i(e,[{key:"inheritDate",value:function(e){var t=e.year,r=e.month,n=e.day,o=e.hours,a=e.minutes,i=e.seconds,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=l.withTime,d=l.timezone,h=void 0===d?null:d,_=this._createWritableClone();return(0,s.isNumber)(t)&&(0,s.isNumber)(r)&&(0,s.isNumber)(n)&&(!u||(0,s.isNumber)(o)&&(0,s.isNumber)(a)&&(0,s.isNumber)(i))?(_._date=_._toTimezoneDate(),_._date.setDate(1),_._date.setFullYear(t),_._date.setMonth(r),_._date.setDate(n),u&&(_.timezone=h,_._date.setHours(o,a,i),_.with_time=59!==i),_.with_time&&_.timezone?(_._date=c.default.tz((0,f.default)(_._date),(0,p.getTimezoneName)(_.timezone)),_.timezone_offset=-_._date.utcOffset(),_._date=_._date.toDate()):_.timezone_offset=null,_.is_recurring||(_.string=m.format(_._toTimezoneDate()),_.lang=window.DATEIST_LANG||"en"),_.date=(0,f.default)(_._date,{toUTC:!!_.timezone,dateOnly:!_.with_time}),Object.freeze(_)):Object.freeze(_)}},{key:"changeTime",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.timezone;if(!(0,s.isNumber)(e)||!(0,s.isNumber)(t)||!(0,s.isNumber)(r))return Object.freeze(this._createWritableClone());var a=this._toTimezoneDate();return this.inheritDate({year:a.getFullYear(),month:a.getMonth(),day:a.getDate(),hours:e,minutes:t,seconds:r},{withTime:!0,timezone:o})}},{key:"changeTimezone",value:function(e){var t=this._toTimezoneDate();return this.inheritDate({year:t.getFullYear(),month:t.getMonth(),day:t.getDate(),hours:t.getHours(),minutes:t.getMinutes(),seconds:t.getSeconds()},{withTime:!0,timezone:e})}},{key:"nextRecurrence",value:function(){if(!this.is_recurring)throw new Error("nextRecurrence() can only be called on a recurring DateExt");var t={us_dates:m.isUsDates()&&1||0,am_pm:m.isAmPm()&&1||0,start_day:m.startDay(),next_week:m.nextWeek(),task_date:this._toTimezoneDate()},r="en"==this.lang?["en"]:[this.lang,"en"],n=Dateist.parse_multiple(this.string,r,t);return n.end_reached?[this,!0]:(n.error&&(n=Dateist.parse("tomorrow")),[e.fromDateist(n,{timezone:this.timezone}),!1])}},{key:"postpone",value:function(){if(this.is_recurring){var e=this.nextRecurrence(),t=a(e,2),r=t[0];return t[1]?"END_REACHED":r}var n=new Date,o=void 0;return this.isGreaterThanOrEqual(n)?(o=new Date(this.getTime()),o.setDate(o.getDate()+1)):(o=new Date(n),o.setDate(o.getDate()+1)),this.inheritDate({year:o.getFullYear(),month:o.getMonth(),day:o.getDate()},{timezone:this.timezone})}},{key:"toAPIFormat",value:function(){var e=Object.assign({},this);return delete e.with_time,delete e._date,delete e.timezone_offset,e.date.match(/^(\d\d\d\d)-(\d\d)-(\d\d)T(\d\d):(\d\d):59Z*/)&&(0,l.captureMessageWithTrace)("warning (DateExt): deprecated YYYY-MM-DDTHH:MM:59Z in use",{extra:{date:e}}),e}},{key:"format",value:function(e){var t=e.inTimezoneTime,r=e.onlyTime,n=t?this._toTimezoneDate():this._date;return r?$strip(m.getHourAndMin(n)):m.format(n)}},{key:"isSameDate",value:function(e){return this.getFullYear()==e.getFullYear()&&this.getMonth()==e.getMonth()&&this.getDate()==e.getDate()}},{key:"isGreaterThan",value:function(t){return e.compare(this,t)>0}},{key:"isGreaterThanOrEqual",value:function(t){var r=e.compare(this,t);return r>0||0==r}},{key:"isLessThan",value:function(t){return e.compare(this,t)<0}},{key:"isLessThanOrEqual",value:function(t){var r=e.compare(this,t);return r<0||0==r}},{key:"toDate",value:function(){return new Date(this._date)}},{key:"_toTimezoneDate",value:function(){return this.timezone&&(0,s.isNumber)(this.timezone_offset)?y(this._date,-this._date.getTimezoneOffset(),-this.timezone_offset):this.toDate()}},{key:"dateMin",value:function(){var e=new Date(this._date);return e.setMilliseconds(0),e.setSeconds(0),e.setMinutes(0),e.setHours(0),e}},{key:"_createWritableClone",value:function(){var t=Object.getOwnPropertyDescriptors(this);return t=(0,s.mapValues)(t,function(e){if(e.value instanceof Date){var t=new Date(e.value);return Object.assign({},e,{value:t,writable:!0,configurable:!0})}return Object.assign({},e,{writable:!0,configurable:!0})}),Object.create(e.prototype,t)}},{key:"getFullYear",value:function(){return Date.prototype.getFullYear.call(this._date)}},{key:"getYear",value:function(){return Date.prototype.getYear.call(this._date)}},{key:"getMonth",value:function(){return Date.prototype.getMonth.call(this._date)}},{key:"getDate",value:function(){return Date.prototype.getDate.call(this._date)}},{key:"getDay",value:function(){return Date.prototype.getDay.call(this._date)}},{key:"getHours",value:function(){return Date.prototype.getHours.call(this._date)}},{key:"getMinutes",value:function(){return Date.prototype.getMinutes.call(this._date)}},{key:"getSeconds",value:function(){return Date.prototype.getSeconds.call(this._date)}},{key:"getMilliseconds",value:function(){return Date.prototype.getMilliseconds.call(this._date)}},{key:"getUTCFullYear",value:function(){return Date.prototype.getUTCFullYear.call(this._date)}},{key:"getUTCMonth",value:function(){return Date.prototype.getUTCMonth.call(this._date)}},{key:"getUTCDate",value:function(){return Date.prototype.getUTCDate.call(this._date)}},{key:"getUTCDay",value:function(){return Date.prototype.getUTCDay.call(this._date)}},{key:"getUTCHours",value:function(){return Date.prototype.getUTCHours.call(this._date)}},{key:"getUTCMinutes",value:function(){return Date.prototype.getUTCMinutes.call(this._date)}},{key:"getUTCSeconds",value:function(){return Date.prototype.getUTCSeconds.call(this._date)}},{key:"getUTCMilliseconds",value:function(){return Date.prototype.getUTCMilliseconds.call(this._date)}},{key:"getTimezoneFullYear",value:function(){return Date.prototype.getFullYear.call(this._toTimezoneDate())}},{key:"getTimezoneYear",value:function(){return Date.prototype.getYear.call(this._toTimezoneDate())}},{key:"getTimezoneMonth",value:function(){return Date.prototype.getMonth.call(this._toTimezoneDate())}},{key:"getTimezoneDate",value:function(){return Date.prototype.getDate.call(this._toTimezoneDate())}},{key:"getTimezoneDay",value:function(){return Date.prototype.getDay.call(this._toTimezoneDate())}},{key:"getTimezoneHours",value:function(){return Date.prototype.getHours.call(this._toTimezoneDate())}},{key:"getTimezoneMinutes",value:function(){return Date.prototype.getMinutes.call(this._toTimezoneDate())}},{key:"getTimezoneSeconds",value:function(){return Date.prototype.getSeconds.call(this._toTimezoneDate())}},{key:"getTimezoneMilliseconds",value:function(){return Date.prototype.getMilliseconds.call(this._toTimezoneDate())}},{key:"getTime",value:function(){return Date.prototype.getTime.call(this._date)}},{key:"getTimezoneOffset",value:function(){return Date.prototype.getTimezoneOffset.call(this._date)}},{key:"isInPast",get:function(){var e=new Date;return this.isLessThan(e)}},{key:"isInFuture",get:function(){var e=new Date;return this.isGreaterThan(e)}}],[{key:"fromDateist",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.timezone,o=void 0===n?null:n;if(!t.due_date)throw new Error("Cannot create DateExt with invalid dateist result");var a=t.due_date,i=59!==a.getSeconds(),s=null;i&&o&&(a=c.default.tz((0,f.default)(a),(0,p.getTimezoneName)(o)),s=-a.utcOffset(),a=a.toDate());var l=(0,f.default)(a,{toUTC:!!o,dateOnly:!i}),u={_date:{value:a,enumerable:!0},lang:{value:t.date_lang,enumerable:!0},with_time:{value:i,enumerable:!0},is_recurring:{value:t.is_recurring,enumerable:!0},string:{value:t.date_string,enumerable:!0},date:{value:l,enumerable:!0},timezone:{value:o,enumerable:!0},timezone_offset:{value:s,enumerable:!0}};return u=Object.create(e.prototype,u),Object.freeze(u)}},{key:"fromDate",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.timezone,o=void 0===n?null:n,a=r.withTime,i=void 0!==a&&a;i||(t=h(t),o=null);var s=m.format(t),l=m.getDateistLang(),u=null;o&&(t=c.default.tz((0,f.default)(t),(0,p.getTimezoneName)(o)),u=-t.utcOffset(),t=t.toDate());var d=(0,f.default)(t,{toUTC:!!o,dateOnly:!i}),_={_date:{value:t,enumerable:!0},lang:{value:l,enumerable:!0},with_time:{value:i,enumerable:!0},is_recurring:{value:!1,enumerable:!0},string:{value:s,enumerable:!0},date:{value:d,enumerable:!0},timezone:{value:o,enumerable:!0},timezone_offset:{value:u,enumerable:!0}};return _=Object.create(e.prototype,_),Object.freeze(_)}},{key:"compare",value:function(t,r){var n=t instanceof e?t._date:t,o=r instanceof e?r._date:r;return n.getTime()-o.getTime()}}]),e}();r.default=g},{"../logger/Logger":141,"../utils":484,"../utils/timezones":506,"../utils/toISODateString":508,"moment-timezone":"moment-timezone"}],165:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../stores/subscribeSelected"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=window.Signals,l=window.Dateist,u=function(e){return e.toLowerCase().substring(0,2)},c={da:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsDA-3d799b.js",de:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsDE-5eb94d.js",en:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsEN-7e4d01.js",es:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsES-e3197d.js",fi:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsFI-32ec8e.js",fr:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsFR-ac7b20.js",it:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsIT-a47691.js",ja:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsJA-691945.js",ko:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsKO-6844c9.js",nl:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsNL-73256d.js",pl:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsPL-24adc7.js",pt:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsPT-9b9697.js",ru:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsRU-a1da84.js",sv:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsSV-7bada7.js",zh:"https://d3ptyyxy2at9ui.cloudfront.net/DateistDefsZH-3fb5fd.js"},d=function(){function e(){n(this,e),this.loadStatus={en:Promise.resolve()},window.DATEIST_LANG&&(this.loadStatus[window.DATEIST_LANG]=Promise.resolve())}return o(e,[{key:"init",value:function(e){var t=this;(0,i.default)(e,function(e){return e.dateistLangs},function(e){for(var r in e)e.hasOwnProperty(r)&&t.loadLang(r)})}},{key:"loadLang",value:function(e){if(e=u(e),!c[e])return Promise.reject(new Error("Unable to load unknown lange: "+e));if(this.loadStatus[e])return this.loadStatus[e];var t=new Promise(function(t,r){var n=SCRIPT({src:c[e],async:!0});n.onload=function(){t(),l.cache={},s.sendSignal("refresh_interface")},n.onerror=function(e){r(e)},$add($body(),n)});return this.loadStatus[e]=t,t}}]),e}();r.default=new d},{"../stores/subscribeSelected":457}],166:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../reducers/filters"),i=e("../stores/store").default,s=function(){function e(){n(this,e),this.getById=this.getById.bind(this),this.get=this.get.bind(this),this.getAll=this.getAll.bind(this),this.getByName=this.getByName.bind(this)}return o(e,[{key:"getById",value:function(e){return this.get(e)}},{key:"get",value:function(e){return(0,a.filterGetByID)(i.getState(),e)}},{key:"getAll",value:function(){return(0,a.filterGetAll)(i.getState())}},{key:"getByName",value:function(e){return(0,a.filterGetByName)(i.getState(),e)}}]),e}();t.exports=new s},{"../reducers/filters":412,"../stores/store":456}],167:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../reducers/items"),l=window,u=l.Signals,c=function(){function e(){o(this,e),this.getAll=this.getAll.bind(this),this.getAllOwn=this.getAllOwn.bind(this),this.getById=this.getById.bind(this),this.getBySyncId=this.getBySyncId.bind(this),this.getChildren=this.getChildren.bind(this),this.getByName=this.getByName.bind(this),this.add=this.add.bind(this),this.deleteItem=this.deleteItem.bind(this),this.update=this.update.bind(this),this.updateDayOrders=this.updateDayOrders.bind(this),
this.moveMultiple=this.moveMultiple.bind(this),this.complete=this.complete.bind(this),this.uncomplete=this.uncomplete.bind(this),this.addLabel=this.addLabel.bind(this),this.removeLabel=this.removeLabel.bind(this)}return i(e,null,[{key:"initClass",value:function(){this.prototype.max_indent=5,this.prototype.max_chars_for_content=2048}}]),i(e,[{key:"getAll",value:function(){return(0,s.itemGetUncompleted)(d().getState())}},{key:"getAllOwn",value:function(){return(0,s.itemGetOwn)(d().getState())}},{key:"getById",value:function(e){return(0,s.itemGetByID)(d().getState(),e)}},{key:"getBySyncId",value:function(e){return(0,s.itemGetBySyncID)(e,d().getState())}},{key:"getChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.with_parent,o=void 0!==r&&r,a=t.sorted,i=void 0!==a&&a,l=d().getState(),u=(0,s.itemGetChildren)(e.id,l,{sorted:i});return o?[e].concat(n(u)):u}},{key:"getByName",value:function(e,t){return(0,s.itemGetByName)(e,d().getState(),t)}},{key:"itemGetSectionGroups",value:function(e){return(0,s.itemGetSectionGroups)(e,d().getState())}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d().dispatch((0,s.itemAdd)(e,t))}},{key:"itemGetMaxTopLevelChildOrder",value:function(e){return(0,s.itemGetMaxTopLevelChildOrder)(e,d().getState())}},{key:"deleteItem",value:function(e){return d().dispatch((0,s.itemDelete)(e))}},{key:"update",value:function(e,t){var r=this.getById(e),n=d().dispatch((0,s.itemUpdate)(a({},t,{id:e}))),o=r!==n;return o&&u.sendSignal("item_updated",n),[n,o]}},{key:"updateDayOrders",value:function(e){d().dispatch((0,s.itemUpdateDayOrder)(e))}},{key:"updateDue",value:function(e){return d().dispatch((0,s.itemUpdateDue)(e))}},{key:"moveMultiple",value:function(e,t){return d().dispatch((0,s.itemMoveMultiple)(e,t))}},{key:"complete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d().dispatch((0,s.itemComplete)(e.id,{force_history:t}))}},{key:"uncomplete",value:function(e){return d().dispatch((0,s.itemUncomplete)(e.id)),this.getById(e.id)}},{key:"archive",value:function(e){return d().dispatch((0,s.itemArchive)(e))}},{key:"unarchive",value:function(e){return d().dispatch((0,s.itemUnarchive)(e))}},{key:"addLabel",value:function(e,t){if(!$isIn(t.id,e.labels)){var r=[].concat(e.labels);return r.push(t.id),this.update(e.id,{labels:r})}}},{key:"removeLabel",value:function(e,t){if($isIn(t.id,e.labels)){var r=[].concat(e.labels),n=$index(t.id,r);return r.splice(n,1),this.update(e.id,{labels:r})}}},{key:"getTotalCompletedCount",value:function(){return d().getState().stats.completed_count}},{key:"moveAndReorder",value:function(e,t,r){d().dispatch((0,s.itemMoveAndReorder)(e,t,r))}},{key:"duplicate",value:function(e){window.User.is_premium&&d().dispatch((0,s.itemDuplicate)(e))}}]),e}();c.initClass();var d=function(){return e("../stores/store").default};window.ItemsModel=new c,t.exports=window.ItemsModel},{"../reducers/items":417,"../stores/store":456}],168:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../reducers/labels"),i=e("../utils"),s=window,l=s.Signals,u=e("./UtilModels"),c=e("../stores/store").default,d=function(){function e(){n(this,e),this.syncLocalModel=this.syncLocalModel.bind(this),this.getOrAdd=this.getOrAdd.bind(this),this.getAll=this.getAll.bind(this),this.getById=this.getById.bind(this),this.getDataLabels=this.getDataLabels.bind(this),this.getByName=this.getByName.bind(this),this.add=this.add.bind(this),this.get=this.get.bind(this),this.update=this.update.bind(this),this.deleteLabel=this.deleteLabel.bind(this),this.deleteMany=this.deleteMany.bind(this),this.getLabels=this.getLabels.bind(this),this.updateOrders=this.updateOrders.bind(this)}return o(e,null,[{key:"initClass",value:function(){this.prototype.re_labels=/(^|\s+)@([^\s,]+)/g,this.prototype.max_limit=500}}]),o(e,[{key:"syncLocalModel",value:function(e){e.length>0&&l.sendSignal("labels_updated",e)}},{key:"getOrAdd",value:function(e){e=this.normalizeName(e);var t=this.get(e);if(!t){var r=(0,a.labelGetMaxOrder)(c.getState())+1;t=c.dispatch((0,a.labelAdd)({name:e,item_order:r}))}return t}},{key:"getAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=$values(c.getState().labels);return e&&(t=t.sort(u.sortByItemOrder)),t}},{key:"getById",value:function(e){return(0,a.labelGetByID)(c.getState(),e)}},{key:"getDataLabels",value:function(e){if(!e.labels)return[];var t=[],r=!0,n=!1,o=void 0;try{for(var a,i=e.labels[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value,l=this.getById(s);l&&t.push("@"+l.name)}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}return t}},{key:"getByName",value:function(e){if(arguments.length>1&&void 0!==arguments[1]&&!arguments[1]){var t=(0,a.labelGetByName)(e,{caseSensitive:!1},c.getState());return t?[t]:[]}return(0,a.labelGetBySearch)(c.getState(),e)}},{key:"normalizeName",value:function(e){return e=e.replace(/[<>"=#+\s%!?~:@,()&]+/g,"_")}},{key:"add",value:function(e){return(0,a.labelGetCount)(c.getState())>=this.max_limit?void alert((0,i.format)(_n("For performance reasons you can add at most one label.","For performance reasons you can add at most {n} labels.",this.max_limit),{n:this.max_limit})):(e.item_order||(e.item_order=(0,a.labelGetMaxOrder)(c.getState())+1),c.dispatch((0,a.labelAdd)(e)))}},{key:"get",value:function(e){return(0,a.labelGetByName)(e,{caseSensitive:!1},c.getState())}},{key:"update",value:function(e,t){t.name&&(t.name=this.normalizeName(t.name));var r=this.getById(e);if(r)return c.dispatch((0,a.labelUpdate)(e,t)),r=this.getById(e)}},{key:"deleteLabel",value:function(e){this.getById(e)&&c.dispatch((0,a.labelRemove)(e))}},{key:"deleteMany",value:function(e){var t=!0,r=!1,n=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;this.deleteLabel(i)}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}},{key:"getLabels",value:function(e){var t=this,r=e.content,n=[],o=function(r,o,a){return e.labels_to_ignore&&e.labels_to_ignore[a]?r:(a=t.normalizeName(a.toLowerCase()),t.get(a)?(n.push(a),""):r)};return r=r.replace(this.re_labels,o),[r,n]}},{key:"updateOrders",value:function(e){c.dispatch((0,a.labelUpdateOrders)(e))}}]),e}();d.initClass(),window.LabelsModel=new d,t.exports=window.LabelsModel},{"../reducers/labels":422,"../stores/store":456,"../utils":484,"./UtilModels":185}],169:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../utils/CellStorage"),i=e("../utils/deps"),s=e("./StatePersistence"),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=window,c=u.Signals,d=e("../models/Storage"),f=d.GlobalStorage,p=(0,i.defineDeps)("LoadEngine",["SyncEngine"]),m=function(){function e(){var t=this;n(this,e),this.cleanReload=function(){return t.clearAllCachedData().then(function(){window.location.reload()})},this.loadData=this.loadData.bind(this),this.clearAllCachedData=this.clearAllCachedData.bind(this),this.logout=this.logout.bind(this),c.connect("logout",function(){t.logout()}),c.connect("logout",function(){t.logout()}),c.connect("clean_reload",function(){t.cleanReload()}),c.connect("syncing_data",function(){t.fetched_data_from_server=!0})}return o(e,null,[{key:"initClass",value:function(){this.prototype.fetched_data_from_server=!1}}]),o(e,[{key:"loadData",value:function(){c.sendSignal("load_cached_data");var e=l.default.load(),t=e.notes,r=e.items;return this.shouldCleanReload()?this.cleanReload().then(function(){return new Promise(function(){})}):r.then(function(){return p.SyncEngine.isInitialSync()?p.SyncEngine.sync():(t.then(function(){return p.SyncEngine.sync(null,!0,!0)}),l.default.inIDB("notes")?Promise.resolve():t)})}},{key:"shouldCleanReload",value:function(){return p.SyncEngine.api_version<"v8.0"}},{key:"clearAllCachedData",value:function(){return f.clear_all_cached_and_delayed(),window.localStorage.clear(),c.sendSignal("clear_local_data"),a.idbs.deleteDatabase().catch(function(){})}},{key:"logout",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=function(){e.clearAllCachedData().then(function(){if(t){var e="/Users/logout?csrf="+$cookie.get("csrf");(window.HAS_MINI_ARGUMENT||window.MINI_VERSION)&&(e+="&mini=1"),window.location=e}})};if(0===p.SyncEngine.getQueueAllLength())r();else{var n=function(e){e&&r()};Alerts.confirm(DIV(_("You're in offline mode. Some changes you've made won't be saved. Log out anyway?")),n,_("Log out"),_("Go back"))}}}]),e}();m.initClass();var h=new m;window.logoutTodoist=function(){h.logout()},t.exports=h},{"../models/Storage":179,"../utils/CellStorage":459,"../utils/deps":470,"./StatePersistence":178}],170:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Signals,s=e("./Storage"),l=s.$storage,u=e("./SyncEngine"),c=function(){function e(){var t=this;n(this,e),this.initState=this.initState.bind(this),this.syncLocalModel=this.syncLocalModel.bind(this),this.getNotifications=this.getNotifications.bind(this),this.getUnreadCount=this.getUnreadCount.bind(this),this.markNotesAsRead=this.markNotesAsRead.bind(this),this.syncLastRead=this.syncLastRead.bind(this),this.getLastRead=this.getLastRead.bind(this),this.markAsRead=this.markAsRead.bind(this),this.markRead=this.markRead.bind(this),this.markReadAll=this.markReadAll.bind(this),this.markUnread=this.markUnread.bind(this),this.acceptInvitationBiz=this.acceptInvitationBiz.bind(this),this.rejectInvitationBiz=this.rejectInvitationBiz.bind(this),this.doInvitationGenericBiz=this.doInvitationGenericBiz.bind(this),this.acceptInvitation=this.acceptInvitation.bind(this),this.rejectInvitation=this.rejectInvitation.bind(this),this.doInvitationGeneric=this.doInvitationGeneric.bind(this),this.syncCachedData=this.syncCachedData.bind(this),this.loadCachedData=this.loadCachedData.bind(this),this.initState(),i.connect("clear_local_data",this.initState),i.connect("load_cached_data",function(){t.loadCachedData()})}return o(e,[{key:"initState",value:function(){this.noti_model={},this.last_read_id=0,this.initial_sync=!0}}]),o(e,[{key:"deserializeFields",value:function(e){e.created=new Date(e.created).getTime()}},{key:"syncLocalModel",value:function(e){var t=this.noti_model,r=!0;this.initial_sync?r=!1:u.isInitialSync()&&(r=!1);var n=!0,o=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var c=s.value;this.deserializeFields(c);var d;if(void 0===t[c.notification_key]&&(d=!0),t[c.notification_key]=c,c.is_deleted){t[c.notification_key]&&delete t[c.notification_key]}else r&&d&&i.sendSignal("notify",c)}}catch(e){o=!0,a=e}finally{try{!n&&l.return&&l.return()}finally{if(o)throw a}}var f=this.getNotifications();if(f.length>120){var p=!0,m=!1,h=void 0;try{for(var _,v=f.slice(120)[Symbol.iterator]();!(p=(_=v.next()).done);p=!0){var y=_.value;t[y.notification_key]&&delete t[y.notification_key]}}catch(e){m=!0,h=e}finally{try{!p&&v.return&&v.return()}finally{if(m)throw h}}}this.syncCachedData(),this.initial_sync=!1}},{key:"getNotifications",value:function(){var e=$values(this.noti_model);return e=e.sort(function(e,t){return t.id-e.id})}},{key:"getUnreadCount",value:function(){var e=this.last_read_id,t=0,r=!0,n=!1,o=void 0;try{for(var a,i=this.getNotifications()[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){a.value.id>e&&(t+=1)}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}return t}},{key:"markNotesAsRead",value:function(e){var t={},r=!0,n=!1,o=void 0;try{for(var a,s=this.getNotifications()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l.note_id&&(t[l.note_id]=l)}}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}var u=[],c=!0,d=!1,f=void 0;try{for(var p,m=e[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){var h=p.value,_=t[h.id];_&&1===_.is_unread&&(_.is_unread=0,u.push(_.id),i.sendSignal("noti_updated",_))}}catch(e){d=!0,f=e}finally{try{!c&&m.return&&m.return()}finally{if(d)throw f}}u.length>0&&(this.markRead(u),i.sendSignal("notifications_updated")),t=null}},{key:"syncLastRead",value:function(e){this.last_read_id=e,this.syncCachedData(),i.sendSignal("notifications_updated")}},{key:"getLastRead",value:function(){return this.last_read_id}},{key:"markAsRead",value:function(e){e.id!==this.last_read_id&&(this.last_read_id=e.id,this.last_read_id&&(this.syncCachedData(),u.queueUpdate({type:"live_notifications_set_last_read",args:{id:this.last_read_id}})))}},{key:"markRead",value:function(e){this.syncCachedData(),u.queueUpdate({type:"live_notifications_mark_read",args:{ids:e}})}},{key:"markReadAll",value:function(){this.syncCachedData(),u.queueUpdate({type:"live_notifications_mark_read_all"})}},{key:"markUnread",value:function(e){this.syncCachedData(),u.queueUpdate({type:"live_notifications_mark_unread",args:{ids:e}})}},{key:"acceptInvitationBiz",value:function(e,t,r){this.doInvitationGenericBiz("biz_accept_invitation",e,t,r)}},{key:"rejectInvitationBiz",value:function(e,t,r){this.doInvitationGenericBiz("biz_reject_invitation",e,t,r)}},{key:"doInvitationGenericBiz",value:function(e,t,r,n){var o=function(){r&&r()},a={onSuccess:o,onError:n};u.queueUpdate({type:e,args:{invitation_id:t.invitation_id,invitation_secret:t.invitation_secret}}),u.sync(a,!0),this.noti_model[t.notification_key]&&(delete this.noti_model[t.notification_key],this.syncCachedData())}},{key:"acceptInvitation",value:function(e,t,r){this.doInvitationGeneric("accept_invitation",e,t,r)}},{key:"rejectInvitation",value:function(e,t,r){this.doInvitationGeneric("reject_invitation",e,t,r),this.noti_model[e.notification_key]&&(delete this.noti_model[e.notification_key],this.syncCachedData())}},{key:"doInvitationGeneric",value:function(e,t,r,n){var o=function(){r&&r()},a={onSuccess:o,onError:n};u.queueUpdate({type:e,args:{invitation_id:t.invitation_id,invitation_secret:t.invitation_secret}}),u.sync(a,!0)}},{key:"syncCachedData",value:function(){l("Notifications").set(this.noti_model),l("NotificationsLastReadId").set(this.last_read_id)}},{key:"loadCachedData",value:function(){var e=l("Notifications").get();this.noti_model=e||{},$values(this.noti_model).forEach(this.deserializeFields);var t=l("NotificationsLastReadId").get();this.last_read_id=t||0}}]),e}();window.NotificationsModel=new c,t.exports=window.NotificationsModel},{"./Storage":179,"./SyncEngine":181}],171:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../utils"),l=window,u=l.Signals,c=e("../reducers/projects"),d=c.projectGetByID,f=c.projectGetInbox,p=c.projectGetTeamInbox,m=c.projectGetActiveSorted,h=c.projectGetActiveWithIndent,_=c.projectGetChildren,v=c.projectGetParent,y=c.projectGetByNameSearch,g=c.projectAdd,b=c.projectArchive,w=c.projectArchivedFeteched,E=c.projectFetchArchived,k=c.projectMoveAndReorder,S=c.projectRemove,j=c.projectUnarchive,T=c.projectUpdate,O=c.projectUpdateLocalFields,I=function(){return e("../stores/store").default},P=function(){function e(){o(this,e),this.syncLocalModel=this.syncLocalModel.bind(this),this.get=this.get.bind(this),this.getInbox=this.getInbox.bind(this),this.getTeamInbox=this.getTeamInbox.bind(this),this.getIds=this.getIds.bind(this),this.getAll=this.getAll.bind(this),this.getChildren=this.getChildren.bind(this),this.getParent=this.getParent.bind(this),this.getByName=this.getByName.bind(this),this.add=this.add.bind(this),this.deleteMany=this.deleteMany.bind(this),this.update=this.update.bind(this),this.archive=this.archive.bind(this),this.unarchive=this.unarchive.bind(this)}return i(e,[{key:"model_data",get:function(){return I().getState().projects}}],[{key:"initClass",value:function(){this.prototype.max_indent=4}}]),i(e,[{key:"syncLocalModel",value:function(e,t){}},{key:"get",value:function(e){return d(I().getState(),e)}},{key:"getInbox",value:function(){return f(I().getState())}},{key:"getTeamInbox",value:function(){return p(I().getState())}},{key:"getIds",value:function(){return $keys(I().getState().projects)}},{key:"getAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.with_indent;return void 0!==t&&t?h(I().getState()):m(I().getState())}},{key:"getChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=_(e.id,I().getState());if(t){var o=this.get(e.id);return o?[o].concat(n(r)):[]}return r}},{key:"getParent",value:function(e){return v(I().getState(),e.id)}},{key:"getByName",value:function(e){return y(e,I().getState())}},{key:"add",value:function(e){var t=this.getAll(),r=void 0;return r=window.User.is_premium&&window.User.business_account_id?501:window.User.is_premium?301:81,t.length>=r?void alert((0,s.format)(_n("For performance reasons you can add at most one project. Please archive or delete some of your finished projects.","For performance reasons you can add at most {n} projects. Please archive or delete some of your finished projects.",r),{n:r})):I().dispatch(g(e))}},{key:"moveAndReorder",value:function(e,t){var r=t.noUndo;I().dispatch(k(e,{noUndo:r}))}},{key:"deleteMany",value:function(e){I().dispatch(S.apply(void 0,n(e)))}},{key:"update",value:function(e,t){var r=this.get(e);if(r)return(t.indent||t.item_order||t.parent_id)&&(t=(0,s.omit)(t,["indent","item_order","parent_id"])),I().dispatch(T(e,t)),t.name&&u.sendSignal("project.name.changed",r),a({},r,t)}},{key:"updateLocalFields",value:function(e){e=a({},e);var t=!0,r=!1,n=void 0;try{for(var o,i=(0,s.keys)(e)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var l=o.value;this.get(l)||delete e[l]}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}I().dispatch(O(e))}},{key:"archive",value:function(e){I().dispatch(b(e))}},{key:"unarchive",value:function(e){I().dispatch(j(e))}},{key:"fetchArchivedProject",value:function(e){return I().dispatch(E(e))}},{key:"archivedFeteched",value:function(e){I().dispatch(w(e))}}]),e}();P.initClass(),window.ProjectsModel=new P,t.exports=window.ProjectsModel},{"../reducers/projects":435,"../stores/store":456,"../utils":484}],172:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e){return function(){try{return e.apply(null,arguments)}catch(e){throw E.captureError(e,{tags:{where:"hierachy"},extra:{args:arguments}}),e}}}Object.defineProperty(r,"__esModule",{value:!0}),r.deriveProjectIndentItemOrder=r.deriveProjectParentChildOrder=r.deriveTaskParentChild=r._deriveIndentItemOrder=r.deriveIndentItemOrder=r.deriveParentChildOrder=void 0;var i=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=e("redux"),u=e("lodash/fp/sortBy"),c=n(u),d=e("lodash/fp/groupBy"),f=n(d),p=e("lodash/fp/head"),m=n(p),h=e("lodash/fp/mapValues"),_=n(h),v=e("lodash/fp/partition"),y=n(v),g=e("lodash/values"),b=n(g),w=e("../logger/Logger"),E=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(w),k=(0,c.default)(["item_order","id"]),S=function e(t,r,n){for(var a=t.reduce(function(e,t,r){return t.indent==n+1&&e.push(r),e},[]),i=0;i<a.length;i++){var l=a[i],u=t[l];u=s({},u,{parent_id:r,child_order:i+1}),t[l]=u}a.push(t.length);for(var c=1;c<a.length;c++){var d=a[c],f=a[c-1],p=t[f],m=t.slice(f+1,d);0!=m.length&&(m=e(m,p.id,p.indent),t.splice.apply(t,[f+1,m.length].concat(o(m))))}return t},j=r.deriveParentChildOrder=a(function(e){return e=k(e),e=C(e),S(e,null,0)}),T=r.deriveIndentItemOrder=a(function(e){var t=P(e);return O(t,null,0)}),O=r._deriveIndentItemOrder=function e(t,r,n){var o=t[r];if(!o)return[];for(var a=[],i=0;i<o.length;i++){var l=s({},o[i],{indent:n+1});a.push(l);var u=t[l.id];u&&(u=e(t,l.id,l.indent),a=a.concat(u))}return a=a.map(function(e,t){return s({},e,{item_order:t+1})})},I=(0,l.compose)((0,_.default)(m.default),(0,f.default)("id")),P=(r.deriveTaskParentChild=function(e){return(0,l.compose)(function(e){return S(e,null,0)},C,k)(e)},(0,l.compose)((0,_.default)((0,c.default)(["child_order"])),(0,f.default)("parent_id"))),C=(r.deriveProjectParentChildOrder=function(e){var t=(0,l.compose)((0,y.default)(function(e){return e.inbox_project||e.team_inbox}),b.default)(e),r=i(t,2),n=r[0],o=r[1];return o=(0,l.compose)(I,j)(o),n=I(n),s({},o,n)},r.deriveProjectIndentItemOrder=function(e){var t=(0,l.compose)((0,y.default)(function(e){return e.inbox_project||e.team_inbox}),b.default)(e),r=i(t,2),n=r[0],o=r[1];return o=(0,l.compose)(I,T)(o),n=I(n),s({},o,n)},function(e){if(0===e.length)return e;var t=0,r=!1,n=e.map(function(e){return e.indent<t?(t=e.indent,e):e.indent===t?e:e.indent===t+1?(t=e.indent,e):e.indent>t+1?(e=s({},e,{indent:t+1}),r=!0,e):void 0});return r?n:e})},{"../logger/Logger":141,"lodash/fp/groupBy":"lodash/fp/groupBy","lodash/fp/head":"lodash/fp/head","lodash/fp/mapValues":"lodash/fp/mapValues","lodash/fp/partition":"lodash/fp/partition","lodash/fp/sortBy":"lodash/fp/sortBy","lodash/values":"lodash/values",redux:"redux"}],173:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Signals,s=window,l=s.DateUtils,u=e("./Storage"),c=u.$storage,d=e("./TemporaryIds"),f=e("./SyncEngine"),p=e("./UtilModels"),m=e("../models/DateExt").default,h=function(){function e(){var t=this;n(this,e),this.receiveBridgeUpdate=function(e){var r=e.reminders;r&&(t.model_data=r,t.syncCachedData({bridgeUpdate:!1}))},this.initState=this.initState.bind(this),this.syncLocalModel=this.syncLocalModel.bind(this),this.getAllReminders=this.getAllReminders.bind(this),this.hasReminders=this.hasReminders.bind(this),this.getRemindersByItemId=this.getRemindersByItemId.bind(this),this.resolveTempId=this.resolveTempId.bind(this),this.hasExceededMaxLimit=this.hasExceededMaxLimit.bind(this),this.add=this.add.bind(this),this.addLocation=this.addLocation.bind(this),this._addToModel=this._addToModel.bind(this),this.remove=this.remove.bind(this),this.removeRelative=this.removeRelative.bind(this),this.syncCachedData=this.syncCachedData.bind(this),this.convertDueToDateExt=this.convertDueToDateExt.bind(this),this.removeMissingDueReminder=this.removeMissingDueReminder.bind(this),this.loadCachedData=this.loadCachedData.bind(this),this.handleItemArchive=this.handleItemArchive.bind(this),this.initState(),i.connect("clear_local_data",this.initState),i.connect("load_cached_data",function(){t.loadCachedData()}),i.connect("resolve_temp.reminder",function(e,r){t.resolveTempId(e,r)}),i.connect("bridge:redux_update",this.receiveBridgeUpdate)}return o(e,[{key:"initState",value:function(){this.model_data={},this.cache_has_reminders={}}}],[{key:"initClass",value:function(){this.prototype.loaded=!1}}]),o(e,[{key:"syncLocalModel",value:function(e){var t=this;e.length>0&&(e.forEach(function(e){return e&&t.convertDueToDateExt(e)}),p.syncLocalModel(e,this.model_data),this.syncCachedData())}},{key:"getAllReminders",value:function(){return $values(this.model_data)}},{key:"hasReminders",value:function(e){if(void 0===this.cache_has_reminders[e]){this.getRemindersByItemId(e).length>0?this.cache_has_reminders[e]=!0:this.cache_has_reminders[e]=!1}return this.cache_has_reminders[e]}},{key:"getRemindersByItemId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e=d.getRealId(e);var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=$values(this.model_data)[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value;if(l.item_id===e){if(null!==t&&l.type!==t)continue;r.push(l)}}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}},{key:"resolveTempId",value:function(e,t){var r=this.model_data[e];r&&(r.id=t,delete this.model_data[e],this.model_data[t]=r,d.isTemporary(r.notify_uid)&&(r.notify_uid=d.getRealId(r.notify_uid)),d.isTemporary(r.item_id)&&(r.item_id=d.getRealId(r.item_id)),this.syncCachedData())}},{key:"hasExceededMaxLimit",value:function(){return $values(this.model_data).length>700}},{key:"hasExceededMaxLimitForLocRmd",value:function(){return $values(this.model_data).filter(function(e){return"location"===e.type}).length>=300}},{key:"hasExceededMaxLimitForTimeRmd",value:function(){return $values(this.model_data).filter(function(e){return"location"!==e.type}).length>=700}},{key:"add",value:function(e){var t="relative"!==e.type&&"absolute"!==e.type;if(!this.hasExceededMaxLimit()&&!t){var r={},n=r.id=d.generate("reminder");void 0!==e.minute_offset?r.type="relative":r.type="absolute",e.type=r.type,e.notify_uid&&(r.notify_uid=e.notify_uid),e.service?r.service=e.service:(e.service="default",r.service="default"),this.model_data[n]=r,$update(r,e);var o=Object.assign({},e,{due:e.due?e.due.toAPIFormat():null});return f.queueUpdate({type:"reminder_add",args:o,temp_id:n}),this.syncCachedData(),r}}},{key:"addLocation",value:function(e){var t=void 0,r={};return t=r.id?r.id:r.id=d.generate("reminder"),this.model_data[t]=r,$update(r,e),f.queueUpdate({type:"reminder_add",args:e,temp_id:t}),this.syncCachedData(),r}},{key:"_addToModel",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.model_data[e.id]=e,t&&this.syncCachedData()}},{key:"featureEnabled",value:function(){return!!window.User.is_premium||(window.User.features.restriction||window.User.restriction||0)>0}},{key:"remove",value:function(e){e=d.getRealId(e),this.model_data[e]&&delete this.model_data[e],f.queueUpdate({type:"reminder_delete",args:{id:e}}),this.syncCachedData()}},{key:"removeRelative",value:function(e){var t=!0,r=!1,n=void 0;try{for(var o,a=this.getRemindersByItemId(e,"relative")[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;this.remove(i.id)}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}},{key:"syncCachedData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bridgeUpdate,r=void 0===t||t;this.removeMissingDueReminder(),c("Reminders").set(this.model_data),this.cache_has_reminders={},r&&this.sendBridgeUpdate()}},{key:"sendBridgeUpdate",value:function(){i.sendSignal("bridge:model_update",{reminders:this.model_data})}},{key:"convertDueToDateExt",value:function(e){return!e.due||e.due instanceof m?e:(e.due instanceof Object&&(e.due=new m(e.due)),e)}},{key:"removeMissingDueReminder",value:function(){var e=[];for(var t in this.model_data){var r=this.model_data[t];"absolute"===r.type&&!r.due&&e.push(r)}var n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value;delete this.model_data[l.id]}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return e.length>0}},{key:"loadCachedData",value:function(){var e=c("Reminders").get();this.model_data=e||{};for(var t in this.model_data){var r=this.model_data[t];this.convertDueToDateExt(r)}this.removeMissingDueReminder()&&this.syncCachedData(),this.sendBridgeUpdate(),this.loaded=!0}},{key:"handleItemArchive",value:function(e){var t=$values(this.model_data).filter(function(t){return e.includes(t.item_id)}).map(function(e){return e.id}),r=!0,n=!1,o=void 0;try{for(var a,i=t[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value;delete this.model_data[s]}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}return t.length>0&&this.syncCachedData(),t}}]),e}();h.initClass();var _=function(){function e(){n(this,e),this.getCurItem=this.getCurItem.bind(this),this.commitBuffered=this.commitBuffered.bind(this),this.getCurrentReminders=this.getCurrentReminders.bind(this)}return o(e,[{key:"getCurItem",value:function(){var e={};this.cur_item?$update(e,this.cur_item):(e.id="_buf_rem",e.project_id=this.current_project_id);var t=$all("input","input_due_date");if(t.length>0){var r=t[0].value;try{var n=l.parse(r);n.due_date&&(e.due=m.fromDateist(n))}catch(t){e.due=null}}return e}},{key:"commitBuffered",value:function(e){if(this.reminders.length>0){var t=!0,r=!1,n=void 0;try{for(var o,a=this.reminders[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var i=o.value;i.item_id=e.id,"location"===i.type?v.addLocation(i):v.add(i)}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}}},{key:"getCurrentReminders",value:function(){try{return this.getRemindersByItemId(this.getCurItem().id)}catch(e){return[]}}},{key:"getRemindersByItemId",value:function(e){return this.use_buffered?this.reminders:v.getRemindersByItemId(e)}},{key:"add",value:function(e){return this.use_buffered?(e.id=d.generate("reminder"),this.reminders.push(e)):e="location"===e.type?v.addLocation(e):v.add(e),e}},{key:"remove",value:function(e){if(this.use_buffered){var t=[],r=!0,n=!1,o=void 0;try{for(var a,i=this.reminders[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value;s.id!==e&&t.push(s)}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}this.reminders=t}else v.remove(e)}},{key:"reset",value:function(){this.reminders=[],this.cur_item=null,this.use_buffered=!1}}],[{key:"initClass",value:function(){this.prototype.use_buffered=!1,this.prototype.cur_item=null,this.prototype.current_project_id=null,this.prototype.reminders=[]}}]),e}();_.initClass();var v=new h;t.exports={RemindersModel:v,BufferedRemindersModel:new _},window.RemindersModel=v},{"../models/DateExt":164,"./Storage":179,"./SyncEngine":181,"./TemporaryIds":184,"./UtilModels":185}],174:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}
return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Signals,s=e("./Storage"),l=s.$storage,u=function(){function e(){var t=this;n(this,e),this.initState=this.initState.bind(this),this.syncLocalModel=this.syncLocalModel.bind(this),this.getLastLocations=this.getLastLocations.bind(this),this.syncCachedData=this.syncCachedData.bind(this),this.loadCachedData=this.loadCachedData.bind(this),this.initState(),i.connect("clear_local_data",this.initState),i.connect("load_cached_data",function(){t.loadCachedData()})}return o(e,[{key:"initState",value:function(){this.model_data=[]}}]),o(e,[{key:"syncLocalModel",value:function(e){this.model_data=e,this.syncCachedData()}},{key:"getLastLocations",value:function(){return this.model_data}},{key:"syncCachedData",value:function(){l("RemindersLocation").set(this.model_data)}},{key:"loadCachedData",value:function(){var e=l("RemindersLocation").get();this.model_data=e||[]}}]),e}();t.exports=new u},{"./Storage":179}],175:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../stores/store"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=e("../reducers/sections"),l=function(){function e(){n(this,e)}return o(e,[{key:"getByID",value:function(e){return i.default.getState().sections[e]}},{key:"add",value:function(e){return i.default.dispatch((0,s.sectionAdd)(e))}},{key:"remove",value:function(e){return i.default.dispatch((0,s.sectionRemove)(e))}},{key:"archive",value:function(e){return i.default.dispatch((0,s.sectionArchive)(e))}},{key:"update",value:function(e){return i.default.dispatch((0,s.sectionUpdate)(e))}},{key:"move",value:function(e){return i.default.dispatch((0,s.sectionMove)(e))}},{key:"reorder",value:function(e){return i.default.dispatch((0,s.sectionReorder)(e))}},{key:"getByPID",value:function(e){return(0,s.sectionGetByPID)(e)(i.default.getState())}}]),e}();r.default=new l},{"../reducers/sections":441,"../stores/store":456}],176:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e,t){var r=e instanceof Array;e=r?e:[e];var n="/predict_date";w.default.smartScheduleDomain&&(n="https://"+w.default.smartScheduleDomain+"/v2/predict_date");var o=$requestJSON(n,"POST"),i=e.map(c),s=new Map,p=!0,m=!1,h=void 0;try{for(var _,v=i.entries()[Symbol.iterator]();!(p=(_=v.next()).done);p=!0){var y=f(_.value,2),g=y[0],b=y[1];b.item_id||(b.item_id=-1*(g+1)),s.set(b.item_id,g)}}catch(e){m=!0,h=e}finally{try{!p&&v.return&&v.return()}finally{if(m)throw h}}var E=u(new Date),k={access_token:window.User.token,user_id:window.User.id,items:i,weekly_items:a(),user_time:E,user_lang:window.LANG,client_info:"web app"};o.addCallback(function(n){n.predictions.sort(function(e,t){return s.get(e.item_id)-s.get(t.item_id)});var o=n.predictions.map(function(e){return l(e.due_date)}),a=!0,i=!1,u=void 0;try{for(var c,p=e.entries()[Symbol.iterator]();!(a=(c=p.next()).done);a=!0){var m=f(c.value,2),h=m[0],_=m[1];if(_.due&&_.due.is_recurring&&_.due.isInFuture){var v=_.due.nextRecurrence(),y=f(v,1),g=y[0];o[h]=g.toDate()}}}catch(e){i=!0,u=e}finally{try{!a&&p.return&&p.return()}finally{if(i)throw u}}d(e,o),r?t(o,null):t(o[0],null)}),o.addErrback(function(e){t(null,new Error(e))}),o.sendReq($serialize(k),!0,"application/json")}function a(){return m.filter("7 days").map(function(e){return e.items}).reduce(function(e,t){return e.concat(t)},[]).map(c)}function i(e){return e<10?"0"+e:e}function s(e){return e.getFullYear()+"-"+i(e.getMonth()+1)+"-"+i(e.getDate())}function l(e){var t=E.exec(e);if(!t)return new Date;try{var r=[parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3])],n=r[0],o=r[1],a=r[2];return new Date(n,o,a)}catch(e){return new Date}}function u(e){var t=e.getFullYear(),r=i(e.getMonth()+1),n=i(e.getDate()),o=i(e.getHours()),a=i(e.getMinutes()),s=i(e.getSeconds()),l=e.getTimezoneOffset(),u=i(Math.abs(Math.floor(l/60))),c=i(Math.abs(l%60));return t+"-"+r+"-"+n+"T"+o+":"+a+":"+s+(l>0?"-":"+")+u+":"+c}function c(e){var t=null,r=null;e.due&&(t=e.due.with_time?u(e.due):s(e.due),r=e.due.string);var n=e.date_added?new Date(e.date_added):new Date,o=u(n),a=v.get(e.project_id),i=a&&a.name||_("Undefined"),l=e.labels.map(function(e){var t=g.getById(e);return t?t.name:null}).filter(function(e){return e});return{item_id:e.id?e.id:null,content:e.content,due_date:t,date_string:r,date_added:o,postpone_count:0,priority:e.priority,label_names:l,project_name:i}}function d(e,t){k.clear();var r=!0,n=!1,o=void 0;try{for(var a,i=e.entries()[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=f(a.value,2),l=s[0],u=s[1];k.set(u.id,t[l])}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}}Object.defineProperty(r,"__esModule",{value:!0});var f=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r.predictItemDuedate=o,r.isoDateStr=s,r.isoDateStrToDate=l;var p=e("../filterist"),m=n(p),h=e("./ProjectsModel"),v=n(h),y=e("./LabelsModel"),g=n(y),b=e("../models/Config"),w=function(e){return e&&e.__esModule?e:{default:e}}(b),E=/\s*(\d\d\d\d)-(\d\d)-(\d\d)\s*/i,k=new Map;Signals.connect("item_updated",function(e){try{if(!k.has(e.id))return;var t=k.get(e.id);if(!e.due||e.due.isSameDate(t))return void k.delete(e.id);var r=e.due.with_time?u(e.due):s(e.due),n={access_token:window.User.token,user_id:window.User.id,user_result:[{item_id:e.id,due_date:r}]};fetch("https://"+w.default.smartScheduleDomain+"/v2/predict_date/accuracy_log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).catch(function(){})}catch(e){}})},{"../filterist":133,"../models/Config":162,"./LabelsModel":168,"./ProjectsModel":171}],177:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a={waiting:1,reordering:2},i=function(){function e(){n(this,e),this.set=this.set.bind(this),this.get=this.get.bind(this),this.DragMode=a,this.model_data={drag_and_drop_mode:a.waiting}}return o(e,[{key:"set",value:function(e,t){this.model_data[e]=t}},{key:"get",value:function(e){return this.model_data[e]}}]),e}();t.exports=new i},{}],178:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.attachChangePersister=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../utils"),l=e("../utils/fp"),u=e("../reducers/load"),c=e("../stores/store"),d=function(e){return e&&e.__esModule?e:{default:e}}(c),f=function(){function e(){var t;a(this,e),this.storages=(t={},o(t,"settings.theme",$storage("LocalSettings.theme")),o(t,"tooltip.scheduled",$storage("TooltipStore.scheduledTipList")),o(t,"tooltip.seen",$storage("TooltipStore.seenList")),o(t,"filters",$storage("Filters")),o(t,"labels",$storage("Labels")),o(t,"projects",$storage("Projects")),o(t,"sections",$storage("sections")),o(t,"stats",$storage("stats")),o(t,"user",$storage("User")),t),this.cellStorages={notes:new s.CellStorage("notes"),items:new s.CellStorage("items")}}return i(e,[{key:"inIDB",value:function(e){return this.cellStorages[e]&&this.cellStorages[e].usingIndexedDB}},{key:"load",value:function(){var e=(0,s.mapValues)(this.storages,function(e){return e.get()});return d.default.dispatch((0,u.loadLocalData)(e)),this.loadStatus=(0,s.mapValues)(this.cellStorages,function(e,t){return e.get().then(function(e){d.default.dispatch((0,u.loadLocalData)(o({},t,e)))})}),this.attachStorePersister(),this.loadStatus}},{key:"attachStorePersister",value:function(){var e=this;[].concat(n((0,s.keys)(this.storages)),n((0,s.keys)(this.cellStorages))).forEach(function(t){var r=e.storages[t]||e.cellStorages[t];p(d.default,(0,l.get)(t),r)})}}]),e}(),p=r.attachChangePersister=function(e,t,r){var n=t(e.getState());return e.subscribe(function(){var o=t(e.getState());n!==o&&(void 0===o||null===o?r.clear():r.set(o),n=o)})};r.default=new f},{"../reducers/load":425,"../stores/store":456,"../utils":484,"../utils/fp":477}],179:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=void 0;try{a=e("../logger/Logger")}catch(e){a=null}var i=function(){function e(){n(this,e),this.set_delayed=this.set_delayed.bind(this),this.get=this.get.bind(this),this.remove=this.remove.bind(this),this._clear_delayed_set=this._clear_delayed_set.bind(this),this.commitAllDelayed=this.commitAllDelayed.bind(this),this.commitAll=this.commitAll.bind(this),this._commit=this._commit.bind(this),this.clear_all_cached_and_delayed=this.clear_all_cached_and_delayed.bind(this),this.cache={},this.delayed_set={},this.manual_commit=!1}return o(e,[{key:"set_delayed",value:function(e,t){var r=this;if(void 0===t)return void this.remove(e);if(this.cache[e]=t,this._clear_delayed_set(e),!0!==this.manual_commit){var n=function(){r._commit(e,r.cache[e]),r.delayed_set[e]&&delete r.delayed_set[e]};this.delayed_set[e]=setTimeout(n,.5)}return t}},{key:"get",value:function(e){var t=void 0;if(void 0!==this.cache[e])return this.cache[e];var r=localStorage.getItem(e);if(null===r)return null;if("undefined"===r)return this.remove(e),null;try{t=window.JSON.parse(r)}catch(r){throw a&&a.captureError(new Error("$storage deserialize error"),{extra:{storage_key:e,value:t,error:r.message}}),r}return this.cache[e]=t,t}},{key:"remove",value:function(e){localStorage.removeItem(e),this.cache[e]&&delete this.cache[e],this._clear_delayed_set(e)}},{key:"_clear_delayed_set",value:function(e){this.delayed_set[e]&&(clearTimeout(this.delayed_set[e]),delete this.delayed_set[e])}},{key:"commitAllDelayed",value:function(){for(var e in this.cache){var t=this.cache[e];this.set_delayed(e,t)}}},{key:"commitAll",value:function(){for(var e in this.cache){var t=this.cache[e];this._commit(e,t)}}},{key:"_commit",value:function(e,t){var r=JSON.stringify(t);r!==localStorage.getItem(e)&&localStorage.setItem(e,r)}},{key:"clear_all_cached_and_delayed",value:function(e){for(e in this.cache)this._clear_delayed_set(e);this.cache={},this.delayed_set={}}}]),e}(),s=new i,l=function(e){return{set:function(t){return s.set_delayed(e,t)},get:function(){return s.get(e)},clear:function(){s.remove(e)}}};window.$storage=l,window.GlobalStorage=s,void 0!==r&&null!==r&&(r.$storage=l,r.GlobalStorage=s)},{"../logger/Logger":141}],180:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("./SyncLogs"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=e("../reducers/sync"),l=window,u=l.Signals,c=e("./Storage"),d=c.$storage,f=e("./Storage"),p=f.GlobalStorage,m=e("./Collaborators"),h=e("./LabelsModel"),_=e("./Reminders"),v=_.RemindersModel,y=e("./RemindersLocationModel"),g=e("./NotificationsModel"),b=e("../stores/store").default,w=e("../logger/Logger"),E=function(e){try{e()}catch(e){var t=w.captureError(e,{tags:{where:"SyncData"}});i.default.log(a.LOG_PIPE_ERR,{eventID:t,error:e.message})}},k=function(){function e(){var t=this;n(this,e),this.syncLocalData=this.syncLocalData.bind(this),u.connect("sync_local_data",function(e){t.syncLocalData(e)})}return o(e,[{key:"syncLocalData",value:function(e){try{p.manual_commit=!0,u.sendSignal("syncing_data",e),E(function(){e.full_sync?b.dispatch((0,s.receiveFullSyncUpdate)(e)):b.dispatch((0,s.receiveSyncUpdate)(e))}),e.day_orders_timestamp&&d("DayOrdersTimestamp").set(e.day_orders_timestamp),e.collaborators&&e.collaborators.length>0&&E(function(){return m.syncLocalModel(e.collaborators,e.collaborator_states)}),e.labels&&E(function(){return h.syncLocalModel(e.labels)}),e.reminders&&E(function(){return v.syncLocalModel(e.reminders)}),e.locations&&E(function(){return y.syncLocalModel(e.locations)}),e.live_notifications&&E(function(){return g.syncLocalModel(e.live_notifications)}),void 0!==e.live_notifications_last_read_id&&E(function(){return g.syncLastRead(e.live_notifications_last_read_id)}),u.sendSignal("refresh_interface"),p.manual_commit=!1,p.commitAllDelayed()}catch(e){w.captureError(e,{tags:{critical:"sync"}})}}}]),e}();t.exports=new k},{"../logger/Logger":141,"../reducers/sync":447,"../stores/store":456,"./Collaborators":160,"./LabelsModel":168,"./NotificationsModel":170,"./Reminders":173,"./RemindersLocationModel":174,"./Storage":179,"./SyncLogs":182}],181:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../utils"),s=e("./SyncLogs"),l=n(s),u=e("../logger/Logger"),c=n(u),d=window,f=d.Signals,p=e("./Storage"),m=p.$storage,h=e("./TemporaryIds"),_=e("./VersionUpdater"),v=e("./SyncQueue"),y=e("./UtilModels"),g=e("../models/Config").default,b=function(){function e(){var t=this;o(this,e),this.queueUpdate=this.queueUpdate.bind(this),this.scheduleSync=this.scheduleSync.bind(this),this.getSyncState=this.getSyncState.bind(this),this.getQueueAllLength=this.getQueueAllLength.bind(this),this.getQueueSuccessLength=this.getQueueSuccessLength.bind(this),this.getQueueErrorLength=this.getQueueErrorLength.bind(this),this.queueIncludesErrors=this.queueIncludesErrors.bind(this),this.sync=this.sync.bind(this),this._setSyncingState=this._setSyncingState.bind(this),this._setGlobalError=this._setGlobalError.bind(this),this._processSyncQueue=this._processSyncQueue.bind(this),this._queueWithoutErrorMeta=this._queueWithoutErrorMeta.bind(this),this.sync_queue=new v,this.number_of_errors=0,this.max_notes=5,this.sync_states={idle:1,syncing:2},this.sync_timeouts={mini:400,full:1500},this.last_synced=new Date,this.client_id=(0,i.GUID)(),this.sync_token=null,this.api_version=null,f.connect("load_cached_data",function(){t.loadCachedData()}),f.connect("clear_local_data",function(){m("TimestampS2").clear(),t.sync_token="*"})}return a(e,[{key:"isInitialSync",value:function(){if(void 0===this.sync_token)throw new Error("SyncEngine.isInitialSync() error: cached data should be loaded prior to the call");return"*"===this.sync_token}},{key:"loadCachedData",value:function(){var e=m("TimestampS2").get();if(e){this.sync_token=e;var t=m("SyncAPIVersion").get();this.api_version=t||"v7.4"}else this.sync_token="*",this.api_version="v8.0",m("SyncAPIVersion").set(this.api_version);c.default.setTagsContext({api_version:this.api_version})}},{key:"updateSyncToken",value:function(e){e.sync_token&&(this.sync_token=e.sync_token,m("TimestampS2").set(this.sync_token))}},{key:"syncCachedData",value:function(){localStorage.setItem("SyncAPIVersion",this.api_version)}},{key:"queueUpdate",value:function(e){this.sync_queue.add(e),this.scheduleSync()}},{key:"scheduleSync",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e||(e=window.MINI_VERSION?this.sync_timeouts.mini:this.sync_timeouts.full);var t=Date.now()+e;this.scheduled_sync_time&&this.scheduled_sync_time>t||(this.scheduled_sync_timeout&&clearTimeout(this.scheduled_sync_timeout),this.scheduled_sync_timeout=setTimeout(this.sync,e),this.scheduled_sync_time=t)}},{key:"getSyncState",value:function(){return this.sync_state}},{key:"getQueueAllLength",value:function(){return this.sync_queue.get().length}},{key:"getQueueSuccessLength",value:function(){var e=0,t=!0,r=!1,n=void 0;try{for(var o,a=this.sync_queue.get()[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){o.value.last_error||e++}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return e}},{key:"getQueueErrorLength",value:function(){var e=0,t=!0,r=!1,n=void 0;try{for(var o,a=this.sync_queue.get()[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){o.value.last_error&&e++}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}return e}},{key:"queueIncludesErrors",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,o=this.sync_queue.get()[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){if(n.value.last_error)return!0}}catch(e){t=!0,r=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw r}}return!1}},{key:"sync",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,r=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2]),n=void 0,o=void 0;if(this.sync_timeout&&(clearTimeout(this.sync_timeout),this.sync_timeout=null),this.current_req)return void(this.sync_timeout=setTimeout($p(this.sync,e,!1),this.sync_timeouts.full));!0===r&&this._setSyncingState(this.sync_states.syncing);var a=this.sync_queue.get();a=a.slice(0,20),this.sync_queue.assignUnqiueIds(a);var i=$arrayCopy(a),s="/API/"+this.api_version+"/sync";this.current_req=n=$requestJSON(s,"POST",{headers:{"X-Todoist-Webapp-Version":g.version,"X-Todoist-Client-ID":this.client_id}});var l=void 0,u=void 0,c=new Promise(function(e,t){l=e,u=t});n.addCallback(function(r,n){if(t.current_req=null,t._setGlobalError(null),!y.checkIfAPIDeprecated(n)){var o=r.temp_id_mapping;o&&h.setRealIds(o);var a=r.user&&r.user.id;if(a&&window.User&&a!==window.User.id)return y.checkIfErrorIsLogout("Not logged in");if(r.full_sync&&f.sendSignal("clear_local_data"),_.check(r),t._processSyncQueue(i,r),t._setSyncingState(t.sync_states.idle),t.number_of_errors=0,0===t.getQueueSuccessLength()?(f.sendSignal("sync_local_data",r),t.updateSyncToken(r),f.sendSignal("sync_engine_synced")):(f.sendSignal("sync_local_data",{temp_id_mapping:r.temp_id_mapping}),t.scheduleSync()),o){0===t.getQueueAllLength()-i.length&&h.clearOld()}e&&e.onSuccess&&e.onSuccess(r),0===t.getQueueErrorLength()&&(t.last_synced=new Date),l()}}),n.addErrback(function(r,n){if(t.current_req=null,!y.checkIfErrorIsLogout(r,n)&&!y.checkIfAPIDeprecated(n)){t._setGlobalError([r,n]),t._setSyncingState(t.sync_states.idle),t.number_of_errors++;var o=t.number_of_errors*(1e3+1e3*Math.floor(11*Math.random()));o>6e4&&(o=6e4),t.timeout=o,t.scheduleSync(o),e&&e.onError&&e.onError(r),u(r)}});var d=!0,p=!1,m=void 0;try{for(var v,b=i[Symbol.iterator]();!(d=(v=b.next()).done);d=!0){var w=v.value;this._setRealIds(w)}}catch(e){p=!0,m=e}finally{try{!d&&b.return&&b.return()}finally{if(p)throw m}}return o="add.todoist.com"===window.location.host?["labels","projects","locations","user","collaborators","notification_settings"]:["all"],n.sendReq({resource_types:o,commands:this._queueWithoutErrorMeta(i),day_orders_timestamp:this._getDayOrdersTimestamp(),collaborators_timestamp:this._getCollaboratorsTimestamp(),sync_token:this.sync_token||"*",with_web_static_version:!0,limit_notes:1,max_notes:this.max_notes,with_dateist_version:1},void 0,"application/json"),c}},{key:"_setSyncingState",value:function(e){this.sync_state=e,f.sendSignal("sync_state_changed")}},{key:"_setGlobalError",value:function(e){this.global_error=e,f.sendSignal("sync_state_changed")}},{key:"_setRealIds",value:function(e){var t=h.getRealId;e.temp_id&&(e.temp_id=t(e.temp_id));for(var r in e.args)switch(r){case"id":e.args.id=t(e.args.id);break;case"ids":e.args.ids=e.args.ids.map(function(e){return t(e)});break;case"project_id":e.project_id=t(e.project_id)}}},{key:"_getDayOrdersTimestamp",value:function(){return m("DayOrdersTimestamp").get()||""}},{key:"_getCollaboratorsTimestamp",value:function(){return m("CollaboratorsTimestamp").get()||""}},{key:"_processSyncQueue",value:function(e,t){var r=void 0,n=[],o=t.sync_status;if(o){var a=!0,u=!1,c=void 0;try{for(var d,f=e[Symbol.iterator]();!(a=(d=f.next()).done);a=!0){r=d.value;var p=o[r.uuid];if(p&&p.error_tag){if("ALREADY_PROCESSED"===p.error_tag)continue;r.last_error||(r.last_error=p),r.retry_count?r.retry_count++:r.retry_count=1,r.retry_count<100&&n.push(r)}}}catch(e){u=!0,c=e}finally{try{!a&&f.return&&f.return()}finally{if(u)throw c}}}this.sync_queue.deleteItems(e);var m=!0,h=!1,_=void 0;try{for(var v,y=n[Symbol.iterator]();!(m=(v=y.next()).done);m=!0)r=v.value,this.sync_queue.add(r)}catch(e){h=!0,_=e}finally{try{!m&&y.return&&y.return()}finally{if(h)throw _}}try{if(n.length>0){var g=(0,i.uniq)(n.map(function(e){return e.type}));l.default.log(s.LOG_CMD_ERR,{cmds:g})}}catch(e){}}},{key:"_queueWithoutErrorMeta",value:function(e){var t=[],r=!0,n=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value,l=$update({},s);l.last_error&&delete l.last_error,t.push(l)}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}return t}},{key:"uniqueIdOn",get:function(){return this.api_version>="v7.5"}}]),e}();window.SyncEngine=new b,t.exports=window.SyncEngine},{"../logger/Logger":141,"../models/Config":162,"../utils":484,"./Storage":179,"./SyncLogs":182,"./SyncQueue":183,"./TemporaryIds":184,"./UtilModels":185,"./VersionUpdater":186}],182:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0}),r.LOG_CMD_ERR=r.LOG_PIPE_DEFER=r.LOG_PIPE_ERR=r.LOG_RESP_ERR=void 0;var a,i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("../utils/fp"),u=window,c=u.Signals,d=r.LOG_RESP_ERR="re",f=r.LOG_PIPE_ERR="pe",p=r.LOG_PIPE_DEFER="pd",m=r.LOG_CMD_ERR="ce",h=(a={},o(a,d,"Error HTTP response received"),o(a,f,"Data pipeline error"),o(a,p,"Data pipeline process deferred due to unsync commands"),o(a,m,"Commands error"),a),_=function(){function t(){var e=this;n(this,t),this.logs=[],c.connect("load_cached_data",function(){return e.loadCachedData()})}return s(t,[{key:"loadCachedData",value:function(){try{var e=$storage("synclogs/errors").get();if(!e)return;this.logs=e.map(function(e){var t={code:e.c,timestamp:e.t};return e.e&&(t.extra=e.e),t}),this.logs=this.logs.filter(function(e){return e.code!==p}),this.logs=this.logs.filter(function(e){return e.code!==d}),this.logs=this.logs.map(function(e){return e.code===d&&(0,l.get)("extra.error",e)&&(e=i({},e),delete e.extra),e})}catch(e){}}},{key:"syncCachedData",value:function(){var e=this.logs.map(function(e){var t={c:e.code,t:e.timestamp};return e.extra&&(t.e=e.extra),t});$storage("synclogs/errors").set(e)}},{key:"log",value:function(e,t){var r=Date.now(),n={code:e,timestamp:r,extra:t};n.extra||delete n.extra,this.logs.push(n),this.logs=this.logs.slice(0,50),this.syncCachedData(),c.sendSignal("synclogs_updated",n)}},{key:"get",value:function(){return this.logs}},{key:"getReport",value:function(){var t=e("./SyncEngine"),r=t.sync_queue.get(),n=r.filter(function(e){return e.last_error}),o=r.filter(function(e){return!e.last_error}).length,a=n.length,s=this.logs.map(function(e){return e=i({},e),e.msg=h[e.code],e.isoTime=new Date(e.timestamp).toISOString(),delete e.code,e}),l=t.last_synced;return{reportCreatedAt:(new Date).toISOString(),logs:s,queueLength:r.length,firstRunCmdCount:o,failedCmdCount:a,lastSyncAt:l,failedCmds:n}}},{key:"errorLogTest",value:function(){try{throw new Error("SyncLogs error log test")}catch(e){this.log(f,{error:e})}}}]),t}(),v=new _;window.SyncLogs=v,r.default=v},{"../utils/fp":477,"./SyncEngine":181}],183:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("./Storage"),i=a.$storage,s=function(){function e(){n(this,e),this.get=this.get.bind(this),this.add=this.add.bind(this),this.assignUnqiueIds=this.assignUnqiueIds.bind(this),this.save=this.save.bind(this),this.deleteItems=this.deleteItems.bind(this),this.clear=this.clear.bind(this),this.get()||this.clear()}return o(e,[{key:"get",value:function(){var e=i("Queue").get();return null===e&&(e=[],i("Queue").set(e)),e}},{key:"add",value:function(e){var t=this.get();e.uuid||(e.uuid=this.guid()),t.push(e),this.save(t)}},{key:"assignUnqiueIds",value:function(e){var t=!1,r=!0,n=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value;s.uuid||(s.uuid=this.guid(),t=!0)}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}t&&this.save(e)}},{key:"save",value:function(e){i("Queue").set(e)}},{key:"deleteItems",value:function(e){var t=this.get(),r=!0,n=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value,l=function(e){return e.uuid===s.uuid};$arrayRemove(t,s,l)}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}this.save(t)}},{key:"clear",value:function(){i("Queue").set([])}},{key:"guid",value:function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}]),e}();t.exports=s},{"./Storage":179}],184:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Signals,s=e("./Storage"),l=s.$storage,u=function(){function e(){var t=this;n(this,e),this.generate=this.generate.bind(this),this.getRealId=this.getRealId.bind(this),this.getRealIds=this.getRealIds.bind(this),this.setRealIds=this.setRealIds.bind(this),this.clearOld=this.clearOld.bind(this),this.listenAll=this.listenAll.bind(this),this.waitToResolve=this.waitToResolve.bind(this),this.syncCachedData=this.syncCachedData.bind(this),this.loadCachedData=this.loadCachedData.bind(this),this.temp_counter=(new Date).getTime(),i.connect("load_cached_data",function(){t.loadCachedData()})}return o(e,null,[{key:"initClass",value:function(){this.prototype.listeners_all=[]}}]),o(e,[{key:"generate",value:function(e){var t="_"+this.temp_counter++;return this.cur_temp_ids[t]=e,this.syncCachedData(),t}},{key:"isTemporary",value:function(e){if($isString(e)){if(0===e.indexOf("_"))return!0;if(0===e.indexOf("$"))return!0}return!1}},{key:"getRealId",value:function(e){this.real_id_mapping||this.loadCachedData();var t=this.real_id_mapping[e];return t&&t||e}},{key:"getRealIds",value:function(e){this.real_id_mapping||this.loadCachedData();var t=[],r=!0,n=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value;t.push(this.real_id_mapping[s]||s)}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}return t}},{key:"setRealIds",value:function(e){var t=void 0;if(0!==$keys(e).length){for(var r in e)t=e[r],this.real_id_mapping[r]=t,this.real_id_list.push(r);for(r in e){t=e[r];var n=this.cur_temp_ids[r];if(i.sendSignal("resolve_temp."+n,r,t),this.listeners_all.length>0){var o=!0,a=!1,s=void 0;try{for(var l,u=this.listeners_all[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){(0,l.value)(r,t)}}catch(e){a=!0,s=e}finally{try{!o&&u.return&&u.return()}finally{if(a)throw s}}}}for(;this.real_id_list.length>250;){var c=this.real_id_list.shift();this.real_id_mapping[c]&&delete this.real_id_mapping[c]}this.syncCachedData()}}},{key:"clearOld",value:function(){this.cur_temp_ids={},this.syncCachedData()}},{key:"listenAll",value:function(e){this.listeners_all.push(e)}},{key:"waitToResolve",value:function(e,t){var r=this.getRealId(e);return this.isTemporary(r)?setTimeout($p(this.waitForResolve,e,t),500):t(r),!1}},{key:"syncCachedData",value:function(){l("RealIdMapping").set(this.real_id_mapping),l("RealIdList").set(this.real_id_list),l("CurTempIds").set(this.cur_temp_ids)}},{key:"loadCachedData",value:function(){var e=l("RealIdMapping").get();this.real_id_mapping=e||{};var t=l("RealIdList").get();this.real_id_list=t||[];var r=l("CurTempIds").get();this.cur_temp_ids=r||{}}}]),e}();u.initClass(),window.TemporaryIds=new u,t.exports=window.TemporaryIds,r.default=u},{"./Storage":179}],185:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("../utils/deps"),i=window,s=i.Signals,l=(0,a.defineDeps)("UtilModels",["SyncEngine"]),u=function(){function e(){n(this,e),this.daySort=this.daySort.bind(this),this.gSortByGeneric=this.gSortByGeneric.bind(this),this.checkIfAPIDeprecated=this.checkIfAPIDeprecated.bind(this),this.checkIfErrorIsLogout=this.checkIfErrorIsLogout.bind(this),this.normalizeIndent=this.normalizeIndent.bind(this),this.sortByDate=$p(this.gSortByGeneric,"time"),this.sortByPriority=$p(this.gSortByGeneric,"priority"),this.sortByResponsible=$p(this.gSortByGeneric,"assigned_by_uid")}return o(e,[{key:"getChildren",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];r&&n.push(t);var o=$index(t,e,function(e){return e.id===t.id});if(-1!==o){var a=e.slice(o+1,+e.length+1||void 0),i=!0,s=!1,l=void 0;try{for(var u,c=a[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var d=u.value;if(d.indent<=t.indent)break;n.push(d)}}catch(e){s=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(s)throw l}}}return n}},{key:"getParent",value:function(e,t){var r=[],n=!0,o=!1,a=void 0;try{
for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value;if(l.id===t.id)break;r.push(l)}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}r.reverse();var u=!0,c=!1,d=void 0;try{for(var f,p=r[Symbol.iterator]();!(u=(f=p.next()).done);u=!0){var m=f.value;if(m.indent<t.indent)return m}}catch(e){c=!0,d=e}finally{try{!u&&p.return&&p.return()}finally{if(c)throw d}}return null}},{key:"daySort",value:function(e,t){return e.priority>t.priority?-1:e.priority<t.priority?1:-1!==e.day_order&&-1!==t.day_order?this.gSortByGeneric("day_order",t,e):e.project_id!==t.project_id?this.gSortByGeneric("project_id",t,e):this.sortByItemOrder(e,t)}},{key:"sortByItemOrder",value:function(e,t){return e.item_order<t.item_order?-1:e.item_order===t.item_order?0:1}},{key:"gSortByGeneric",value:function(e,t,r){if(!t[e]||!r[e])return 1;var n=t[e],o=r[e];return n===o?this.sortByItemOrder(t,r):n>o?-1:1}},{key:"syncLocalModel",value:function(e,t){var r=void 0,n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var u=i.value;u&&(r=t[u.id],r?$update(r,u):r=u,t[u.id]=r)}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}var c=!0;if(l.SyncEngine.queueIncludesErrors()&&(c=!1),c){var d=!0,f=!1,p=void 0;try{for(var m,h=$keys(t)[Symbol.iterator]();!(d=(m=h.next()).done);d=!0){var _=m.value;r=t[_];var v=!1;_.indexOf&&-1!==_.indexOf("_")&&(v=!0),r.is_deleted&&(v=!0),v&&delete t[_]}}catch(e){f=!0,p=e}finally{try{!d&&h.return&&h.return()}finally{if(f)throw p}}}}},{key:"checkIfAPIDeprecated",value:function(e){try{if(e&&410===e.status)return alert(_("You're using an old version of Todoist. To make sure the app keeps working, update to the latest version.")),!0;var t=e.getResponseHeader("warning");if(t){var r=t.match(/119.+([\d]{4}-[\d]{2}-[\d]{2})/),n=r?r[1]:(new Date).toLocaleString(),o=_("Just a reminder that you're using an old version of Todoist that will stop working on {date}. To continue using Todoist, update to the latest version.").replace("{date}",n);return alert(o),!0}}catch(e){}return!1}},{key:"checkIfErrorIsLogout",value:function(e,t){var r=!1;if(-1!==e.indexOf("Not logged in")&&(r=!0),-1!==e.indexOf("Token not correct")&&(r=!0),-1!==e.indexOf("403 Forbidden")&&(r=!0),t&&403===t.status&&(r=!0),r&&!window.ACCOUNT_DELETED)return alert(_("It seems like our session has expired. Please re-login."),function(){return s.sendSignal("logout")}),!0}},{key:"normalizeIndent",value:function(e,t){e.indent>=t&&(e.indent=t),e.indent<1&&(e.indent=1)}}]),e}();window.UtilModels=t.exports=new u},{"../utils/deps":470}],186:[function(e,t,r){"use strict";var n=window,o=n.Signals,a=e("../models/Config").default,i=e("../logger/Logger");r.check=function(e){try{var t=a.version,r=a.isBeta?e.web_static_beta_version:e.web_static_version;if(t===r)return;if(!window.applicationCache)return;if(applicationCache.status===applicationCache.UNCACHED)return o.sendSignal("new_version_available",r),void localStorage.setItem("LastVersionUpdate",r);if([applicationCache.CHECKING,applicationCache.DOWNLOADING].includes(applicationCache.status))return;if(applicationCache.status===applicationCache.UPDATEREADY)return o.sendSignal("new_version_available",r),void localStorage.setItem("LastVersionUpdate",r);var n=function e(){o.sendSignal("new_version_available",r),localStorage.setItem("LastVersionUpdate",r);try{applicationCache.swapCache()}catch(e){}applicationCache.removeEventListener(e)};applicationCache.addEventListener("updateready",n);try{applicationCache.update()}catch(e){}}catch(e){i.captureError(e)}},r.reloadIfVersionUpdated=function(){try{var e=localStorage.getItem("LastVersionUpdate");return!!e&&(localStorage.removeItem("LastVersionUpdate"),(e=JSON.parse(e))!==a.version&&(s(),!0))}catch(e){i.captureError(e)}};var s=function(){localStorage.removeItem("LastVersionUpdate"),window.location.reload(!0)};r.loadNewVersion=s},{"../logger/Logger":141,"../models/Config":162}],187:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=e("../stores/store"),i=n(a),s=e("../stores/subscribeSelected"),l=n(s),u=e("../utils/fp"),c=e("../utils"),d=e("../models/SyncEngine"),f=n(d),p=e("../logger/Logger"),m=n(p),h=function e(){var t=this;o(this,e),this.connect=function(e){try{if(!e)throw new Error("WebSocketManager: cannot connect() with invalid url: "+t.url);if(t.url===e&&t.socket&&(0===t.socket.readyState||1===t.socket.readyState))return;t.socket&&t.disconnectExisting(),t.url=e,t.socket=new WebSocket(t.url),t.socket.addEventListener("message",t.handleMessage),t.socket.addEventListener("close",t.handleClose),t.socket.addEventListener("error",t.handleError)}catch(e){m.default.captureError(e,{tags:{where:"websockert"}})}},this.disconnectExisting=function(){try{t.socket.removeEventListener("message",t.handleMessage),t.socket.removeEventListener("close",t.handleClose),t.socket.removeEventListener("error",t.handleError),t.socket.close(),t.socket=null}catch(e){}},this.handleMessage=function(e){var r=JSON.parse(e.data);switch(r.type){case"token_reset":t.debouncedSync();break;case"sync_needed":r.client_id!==f.default.client_id&&t.debouncedSync()}},this.scheduleReconnect=function(){t.url&&!t.reconnectTimeout&&(t.reconnectTimeout=setTimeout(function(){t.reconnectTimeout=null,t.connect(t.url)},5e3))},this.handleClose=function(){return t.scheduleReconnect()},this.handleError=function(){return t.scheduleReconnect()},this.healthCheck=function(){t.socket&&3!==t.socket.readyState||t.scheduleReconnect()},this.debouncedSync=(0,c.debounce)(function(){f.default.scheduleSync()},1e3),(0,l.default)(i.default,(0,u.get)("user.websocket_url"),function(e){e&&t.connect(e)}),setInterval(this.healthCheck,3e5)};r.default=new h},{"../logger/Logger":141,"../models/SyncEngine":181,"../stores/store":456,"../stores/subscribeSelected":457,"../utils":484,"../utils/fp":477}],188:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(){var e=b;(b=g.getState().user)&&b!=e&&(window.User=b,window.Settings={AMPM:1==b.time_format,US_DATES:1==b.date_format,START_PAGE:b.start_page,START_DAY:b.start_day?b.start_day:1,NEXT_WEEK:b.next_week?b.next_week:1},(0,s.isAsianLang)()&&(window.Settings.US_DATES=!0))}Object.defineProperty(r,"__esModule",{value:!0}),r.printProjectTasks=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("../components/misc/Misc.js"),l=e("../components/opener/WindowOpener.js"),u=n(l),c=e("../logger/Logger"),d=n(c),f=e("../reducers/tooltip"),p=e("../reducers/stats"),m=e("../reducers/user"),h=e("../reducers/selectors"),_=e("../reducers/items"),v=e("../utils/fp"),y=window.Signals,g=e("../stores/store").default,b=void 0;g.subscribe(a),void 0===window.todoist&&(window.todoist={}),window.todoist.updateUser=function(e){g.dispatch((0,m.receivedUserUpdate)(e))},window.todoist.markTooltipUnseen=function(e){g.dispatch((0,f.markUnseen)(e))},window.todoist.openSettingWindow=function(e){u.showPrefs(e)},window.todoist.testSentry=function(){try{throw new Error("Sentry setup test")}catch(e){d.captureError(e)}},window.todoist.showTrialTooltip=function(){var e=i({},window.User,{is_premium:!1,free_trail_expires:void 0});g.dispatch((0,m.receivedUserUpdate)(e)),g.dispatch((0,f.scheduledUpdated)([].concat(o(g.getState().tooltip.scheduled),[f.TOOLTIP_PREMIUM_TRIAL])))},window.todoist.showPremiumWillExpireTooltip=function(){g.dispatch((0,f.scheduledUpdated)([].concat(o(g.getState().tooltip.scheduled),[f.TOOLTIP_PREMIUM_EXPIRING])))},window.todoist.showCompleteFirstTaskTooltip=function(){var e=new Date;e.setDate(e.getDate()-1),g.dispatch((0,m.receivedUserUpdate)({join_date:e})),g.dispatch((0,f.markUnseen)(f.TOOLTIP_COMPLETE_FIRST_TASK)),y.sendSignal("refresh_interface")},window.todoist.scheduleTooltip=function(e){g.dispatch((0,f.scheduledUpdated)([].concat(o(g.getState().tooltip.scheduled),[e])))},window.todoist.resetTodayCompletedCount=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;g.dispatch((0,p.resetTodayCount)(e))},window.todoist.resetThisWeekCount=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;g.dispatch((0,p.resetThisWeekCount)(e))},window.todoist.markTooltipUnseen=function(e){g.dispatch((0,f.markUnseen)(e))},window.todoist.store=g,window.todoist.printProjectList=function(){var e=$values(g.getState().projects);e.sort(function(e,t){return e.item_order-t.item_order}),console.table(e,["id","name","item_order","indent","parent_id","child_order"])};var w=r.printProjectTasks=function(e){var t=(0,_.itemGetSectionGroups)(e,g.getState()),r=(0,v.compose)(v.flatten,(0,v.map)(function(e){return[].concat(o(t[e]),[{}])}),function(e){return[null].concat(o(e))},(0,v.map)(function(e){return e.id}),(0,v.sortBy)("child_order"),(0,v.filter)(function(t){return t.project_id===e}),(0,v.get)("sections"))(g.getState());console.table(r,["id","content","project_id","section_id","item_order","indent","parent_id","child_order"])};window.todoist.printProjectTasks=w,window.todoist.printInbox=function(){window.todoist.printProjectTasks(g.getState().user.inbox_project)},window.todoist.printSortedProjectList=function(){var e=(0,h.sortedProjects)(g.getState());console.table(e,["id","name","item_order","indent","parent_id","child_order"])}},{"../components/misc/Misc.js":43,"../components/opener/WindowOpener.js":53,"../logger/Logger":141,"../reducers/items":417,"../reducers/selectors":444,"../reducers/stats":446,"../reducers/tooltip":448,"../reducers/user":451,"../stores/store":456,"../utils/fp":477}],189:[function(e,t,r){!function(n,o){"object"==typeof r&&"object"==typeof t?t.exports=o(e("prop-types"),e("react"),e("classnames")):"function"==typeof define&&define.amd?define("reactist",["prop-types","react","classnames"],o):"object"==typeof r?r.reactist=o(e("prop-types"),e("react"),e("classnames")):n.reactist=o(n["prop-types"],n.React,n.classnames)}(window,function(e,t,r){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(t){return e[t]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=9)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r=function(e,t){var r=e[1]||"",n=e[3];if(!n)return r;if(t&&"function"==typeof btoa){var o=(a=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */");return[r].concat(n.sources.map(function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"})).concat([o]).join("\n")}var a;return[r].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r}).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},o=0;o<this.length;o++){var a=this[o][0];"number"==typeof a&&(n[a]=!0)}for(o=0;o<e.length;o++){var i=e[o];"number"==typeof i[0]&&n[i[0]]||(r&&!i[2]?i[2]=r:r&&(i[2]="("+i[2]+") and ("+r+")"),t.push(i))}},t}},function(e,t,r){function n(e,t){for(var r=0;r<e.length;r++){var n=e[r],o=p[n.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](n.parts[a]);for(;a<n.parts.length;a++)o.parts.push(u(n.parts[a],t))}else{var i=[];for(a=0;a<n.parts.length;a++)i.push(u(n.parts[a],t));p[n.id]={id:n.id,refs:1,parts:i}}}}function o(e,t){for(var r=[],n={},o=0;o<e.length;o++){var a=e[o],i=t.base?a[0]+t.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};n[i]?n[i].parts.push(s):r.push(n[i]={id:i,parts:[s]})}return r}function a(e,t){var r=h(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=y[y.length-1];if("top"===e.insertAt)n?n.nextSibling?r.insertBefore(t,n.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),y.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=h(e.insertAt.before,r);r.insertBefore(t,o)}}function i(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=y.indexOf(e);t>=0&&y.splice(t,1)}function s(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=function(){return r.nc}();n&&(e.attrs.nonce=n)}return l(t,e.attrs),a(e,t),t}function l(e,t){Object.keys(t).forEach(function(r){e.setAttribute(r,t[r])})}function u(e,t){var r,n,o,u;if(t.transform&&e.css){if(!(u="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=u}if(t.singleton){var d=v++;r=_||(_=s(t)),n=c.bind(null,r,d,!1),o=c.bind(null,r,d,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",l(t,e.attrs),a(e,t),t}(t),n=function(e,t,r){var n=r.css,o=r.sourceMap,a=void 0===t.convertToAbsoluteUrls&&o;(t.convertToAbsoluteUrls||a)&&(n=g(n)),o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var i=new Blob([n],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(i),s&&URL.revokeObjectURL(s)}.bind(null,r,t),o=function(){i(r),r.href&&URL.revokeObjectURL(r.href)}):(r=s(t),n=function(e,t){var r=t.css,n=t.media;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}.bind(null,r),o=function(){i(r)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}function c(e,t,r,n){var o=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=w(t,o);else{var a=document.createTextNode(o),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(a,i[t]):e.appendChild(a)}}var d,f,p={},m=(d=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===f&&(f=d.apply(this,arguments)),f}),h=function(e){var t={};return function(e,r){if("function"==typeof e)return e();if(void 0===t[e]){var n=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,r);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),_=null,v=0,y=[],g=r(5);e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=m()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=o(e,t);return n(r,t),function(e){for(var a=[],i=0;i<r.length;i++){var s=r[i];(l=p[s.id]).refs--,a.push(l)}for(e&&n(o(e,t),t),i=0;i<a.length;i++){var l;if(0===(l=a[i]).refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete p[l.id]}}}};var b,w=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")})},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,n=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var o,a=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?e:(o=0===a.indexOf("//")?a:0===a.indexOf("/")?r+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")})}},,function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.r(t),r(10);var u=r(1),c=r.n(u),d=r(0),f=r.n(d),p=r(2),m=r.n(p),h=function(e,t,r,n,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=e.height,s=e.width,l=t.height,u=t.width,c=r.height,d=r.width,f=n.x,p=n.y,m=_(n,r,t),h=v(n,r,t),y=m>=0&&m+u<=s,g=h>=0&&h+l<=i;return"top"===o?y&&p-l-a>=0:"right"===o?g&&f+d+u+a<=s:"left"===o?g&&f-u-a>=0:"bottom"===o&&y&&p+c+l+a<=i},_=function(e,t,r){return e.x+(t.width-r.width)/2},v=function(e,t,r){return e.y+(t.height-r.height)/2},y=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return"top"===e?function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:_(t,e,r),y:t.y-r.height-n}}(t,r,n,o):"right"===e?function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:t.x+e.width+n,y:v(t,e,r)}}(t,r,n,o):"bottom"===e?function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:_(t,e,r),y:t.y+e.height+n}}(t,r,n,o):"left"===e?function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:t.x-r.width-n,y:v(t,e,r)}}(t,r,n,o):r},g=function(e){function t(){var e,r,o,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var u=arguments.length,c=new Array(u),d=0;d<u;d++)c[d]=arguments[d];return o=this,i=(e=a(t)).call.apply(e,[this].concat(c)),r=!i||"object"!==n(i)&&"function"!=typeof i?s(o):i,l(s(s(r)),"_updatePopoverPosition",function(){for(var e=r.props,t=e.position,n=e.allowVaguePositioning,o=e.gapSize,a=r.wrapper.getBoundingClientRect(),i=r.popover.getBoundingClientRect(),s=document.documentElement,l=r.wrapper,u=!1;!u;)"absolute"!==getComputedStyle(l).getPropertyValue("position")&&l!==s&&l.parentElement?l=l.parentElement:u=!0;for(var c=l.getBoundingClientRect(),d={height:c.height,width:c.width},f={height:i.height,width:i.width},p={height:a.height,width:a.width},m={x:a.left-c.left,y:a.top-c.top},_={x:a.left,y:a.top},v="auto"===t?["top","right","bottom","left","top"]:"vertical"===t?["top","bottom"]:"horizontal"===t?["left","right"]:[t],g=0;g<v.length;g++){var b=v[g];if(h(d,f,p,m,b,o)||g===v.length-1){var w=y(b,p,_,f,o);r.popover.style.top="".concat(w.y,"px"),r.popover.style.left="".concat(w.x,"px"),n&&(w.x<0&&(r.popover.style.left="".concat(2*o,"px")),w.y+f.height>d.height&&(r.popover.style.top="".concat(d.height-f.height-2*o,"px"))),b!==t&&(r.popover.className=r._getClassNameForPosition(b));break}}}),l(s(s(r)),"_getClassNameForPosition",function(e){var t=r.props,n=t.visible,o=t.withArrow,a=t.arrowClassName,i=m()("reactist popover",{visible:n});return n&&o?m()(i,a,{arrow_top:"bottom"===e,arrow_right:"left"===e,arrow_bottom:"auto"===e||"top"===e,arrow_left:"right"===e}):i}),l(s(s(r)),"_updatePopoverRef",function(e){r.popover=e,"function"==typeof r.props.popoverRef&&r.props.popoverRef(e)}),l(s(s(r)),"_updateWrapperRef",function(e){r.wrapper=e,"function"==typeof r.props.wrapperRef&&r.props.wrapperRef(e)}),r}var r,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(t,c.a.Component),r=t,(u=[{key:"componentDidMount",value:function(){this.props.visible&&this._updatePopoverPosition()}},{key:"componentDidUpdate",value:function(e){if(this.wrapper&&this.props.visible){var t=e.position!==this.props.position,r=e.allowVaguePositioning!==this.props.allowVaguePositioning,n=e.visible!==this.props.visible,o=e.withArrow!==this.props.withArrow,a=e.gapSize!==this.props.gapSize,i=e.content!==this.props.content;(t||r||n||o||a||i)&&this._updatePopoverPosition()}}},{key:"render",value:function(){var e=this.props,t=e.position,r=e.wrapperClassName,n=e.popoverClassName,o=e.onMouseEnter,a=e.onMouseLeave,i=e.onClick,s=e.trigger,l=e.content,u=this._getClassNameForPosition(t),d=m()("reactist popover__content",n),f=m()("reactist popover__wrapper",r);return c.a.createElement("span",{className:f,onMouseEnter:o,onMouseLeave:a,onClick:i,ref:this._updateWrapperRef},s,c.a.createElement("span",{className:u,ref:this._updatePopoverRef},c.a.createElement("span",{className:d},l)))}}])&&o(r.prototype,u),t}();g.displayName="Popover",g.defaultProps={position:"auto",gapSize:5},g.propTypes={position:f.a.oneOf(["auto","top","right","bottom","left","horizontal","vertical"]),allowVaguePositioning:f.a.bool,visible:f.a.bool.isRequired,content:f.a.oneOfType([f.a.string,f.a.arrayOf(f.a.node),f.a.node]).isRequired,trigger:f.a.oneOfType([f.a.string,f.a.arrayOf(f.a.node),f.a.node]),onClick:f.a.func,onMouseEnter:f.a.func,onMouseLeave:f.a.func,wrapperClassName:f.a.string,popoverClassName:f.a.string,arrowClassName:f.a.string,withArrow:f.a.bool,gapSize:f.a.number,wrapperRef:f.a.func,popoverRef:f.a.func},t.default=g},,function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.r(t),r(12);var u=r(1),c=r.n(u),d=r(0),f=r.n(d),p=r(2),m=r.n(p),h=r(7),_=function(e){function t(){var e,r,o,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var u=arguments.length,c=new Array(u),d=0;d<u;d++)c[d]=arguments[d];return o=this,i=(e=a(t)).call.apply(e,[this].concat(c)),r=!i||"object"!==n(i)&&"function"!=typeof i?s(o):i,l(s(s(r)),"state",{visible:!1}),l(s(s(r)),"_show",function(){r._delayAction(function(){r.setState(function(){return{visible:!0}}),r.props.hideOnScroll&&r._initScrollListener()},r.props.delayShow)}),l(s(s(r)),"_hide",function(){r._delayAction(function(){r._clearDelayTimeout(),r.setState(function(){return{visible:!1}}),r.props.hideOnScroll&&r._removeScrollListener()},r.props.delayHide)}),l(s(s(r)),"_updateTooltipRef",function(e){r.tooltip=e}),l(s(s(r)),"_updateWrapperRef",function(e){r.wrapper=e}),r}var r,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(t,c.a.Component),r=t,(u=[{key:"shouldComponentUpdate",value:function(e,t){return this.state.visible!==t.visible||this.props.position!==e.position||this.props.text!==e.text||this.props.hideOnScroll!==e.hideOnScroll||this.props.delayShow!==e.delayShow||this.props.delayHide!==e.delayHide||this.props.gapSize!==e.gapSize||this.props.children!==e.children}},{key:"componentWillUnmount",value:function(){this._clearDelayTimeout(),this._removeScrollListener()}},{key:"_initScrollListener",value:function(){document.addEventListener("scroll",this._hide,!0)}},{key:"_removeScrollListener",value:function(){document.removeEventListener("scroll",this._hide,!0)}},{key:"_clearDelayTimeout",value:function(){this.delayTimeout&&clearTimeout(this.delayTimeout)}},{key:"_delayAction",value:function(e,t){this._clearDelayTimeout(),this.delayTimeout=setTimeout(e,t)}},{key:"render",value:function(){var e=this,t=this.props,r=t.position,n=t.allowVaguePositioning,o=t.wrapperClassName,a=t.tooltipClassName,i=t.text,s=t.children,l=t.gapSize,u=t.inverted,d=t.withArrow,f=m()("reactist tooltip__wrapper",o),p=m()("reactist tooltip__text",a,{inverted:u}),_=m()("reactist tooltip__arrow",{inverted:u});if(!i)return c.a.createElement("div",{className:f},s);var v=c.a.Children.map(s,function(t){return c.a.isValidElement(t)?c.a.cloneElement(t,{onClick:function(r){e._hide(),"function"==typeof t.props.onClick&&t.props.onClick(r)}}):t});return c.a.createElement(h.default,{position:r,visible:this.state.visible,trigger:v,content:i,popoverClassName:p,wrapperClassName:f,arrowClassName:_,onMouseEnter:this._show,onMouseLeave:this._hide,allowVaguePositioning:n,gapSize:l,popoverRef:this._updateTooltipRef,wrapperRef:this._updateWrapperRef,withArrow:d})}}])&&o(r.prototype,u),t}();_.displayName="Tooltip",_.defaultProps={position:"auto",hideOnScroll:!0,delayShow:500,delayHide:0,allowVaguePositioning:!1,inverted:!1,withArrow:!0,gapSize:5},_.propTypes={position:f.a.oneOf(["auto","top","right","bottom","left","horizontal","vertical"]),allowVaguePositioning:f.a.bool,text:f.a.oneOfType([f.a.string,f.a.arrayOf(f.a.node),f.a.node]).isRequired,hideOnScroll:f.a.bool,delayShow:f.a.number,delayHide:f.a.number,children:f.a.oneOfType([f.a.string,f.a.arrayOf(f.a.node),f.a.node]),wrapperClassName:f.a.string,tooltipClassName:f.a.string,inverted:f.a.bool,gapSize:f.a.number,withArrow:f.a.bool},t.default=_},function(e,t,r){var n=r(11);"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};r(4)(n,o),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(3)(!1)).push([e.i,".reactist.popover {\n  white-space: normal;\n  z-index: 1000;\n  position: fixed;\n  top: 0;\n  left: 0;\n  display: none;\n  visibility: hidden;\n  opacity: 0;\n  transition: opacity 0.1s linear;\n}\n.reactist.popover__wrapper {\n  display: inline-block;\n  max-width: 100%;\n  cursor: unset;\n}\n.reactist.popover .popover__content {\n  max-width: 100%;\n  display: inline-flex;\n  border-radius: 3px;\n  color: #202020;\n  background-color: white;\n  border: 1px solid #dcdcdc;\n  box-shadow: 0 1px 8px 0 rgba(0, 0, 0, 0.08);\n}\n.reactist.popover.visible {\n  display: initial;\n  visibility: visible;\n  opacity: 1;\n}\n.reactist.popover.arrow_top:before {\n  position: absolute;\n  content: '';\n  height: 0;\n  width: 0;\n  top: -5px;\n  left: calc(50% - 5px);\n  border-left: 5px solid transparent;\n  border-right: 5px solid transparent;\n  border-bottom: 5px solid #dcdcdc;\n}\n.reactist.popover.arrow_top:after {\n  position: absolute;\n  content: '';\n  height: 0;\n  width: 0;\n  top: -4px;\n  left: calc(50% - 5px);\n  border-left: 5px solid transparent;\n  border-right: 5px solid transparent;\n  border-bottom: 5px solid white;\n}\n.reactist.popover.arrow_right:before {\n  position: absolute;\n  content: '';\n  height: 0;\n  width: 0;\n  bottom: calc(50% - 5px);\n  right: -5px;\n  border-left: 5px solid #dcdcdc;\n  border-bottom: 5px solid transparent;\n  border-top: 5px solid transparent;\n}\n.reactist.popover.arrow_right:after {\n  position: absolute;\n  content: '';\n  height: 0;\n  width: 0;\n  bottom: calc(50% - 5px);\n  right: -4px;\n  border-left: 5px solid white;\n  border-bottom: 5px solid transparent;\n  border-top: 5px solid transparent;\n}\n.reactist.popover.arrow_bottom:before {\n  position: absolute;\n  content: '';\n  height: 0;\n  width: 0;\n  bottom: -5px;\n  left: calc(50% - 5px);\n  border-left: 5px solid transparent;\n  border-right: 5px solid transparent;\n  border-top: 5px solid #dcdcdc;\n}\n.reactist.popover.arrow_bottom:after {\n  position: absolute;\n  content: '';\n  height: 0;\n  width: 0;\n  bottom: -4px;\n  left: calc(50% - 5px);\n  border-left: 5px solid transparent;\n  border-right: 5px solid transparent;\n  border-top: 5px solid white;\n}\n.reactist.popover.arrow_left:before {\n  position: absolute;\n  content: '';\n  height: 0;\n  width: 0;\n  bottom: calc(50% - 5px);\n  left: -5px;\n  border-right: 5px solid #dcdcdc;\n  border-bottom: 5px solid transparent;\n  border-top: 5px solid transparent;\n}\n.reactist.popover.arrow_left:after {\n  position: absolute;\n  content: '';\n  height: 0;\n  width: 0;\n  bottom: calc(50% - 5px);\n  left: -4px;\n  border-right: 5px solid white;\n  border-bottom: 5px solid transparent;\n  border-top: 5px solid transparent;\n}\n",""])},function(e,t,r){var n=r(13);"string"==typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};r(4)(n,o),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(3)(!1)).push([e.i,".reactist.tooltip__wrapper {\n  display: inline-block;\n  max-width: 100%;\n  cursor: unset;\n}\n.reactist.tooltip__wrapper .reactist.tooltip__text {\n  font-size: 0.81rem;\n  color: #202020;\n  font-weight: 400;\n  line-height: 1.6;\n  text-align: center;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  max-width: 100%;\n  padding: 5px 10px;\n  max-width: 250px;\n}\n.reactist.tooltip__wrapper .reactist.tooltip__text:not(.inverted) {\n  background-color: #333333;\n  color: white;\n  border: none;\n}\n.reactist.tooltip__wrapper .reactist.tooltip__arrow:not(.inverted).arrow_top:before {\n  border-bottom-color: #333333;\n}\n.reactist.tooltip__wrapper .reactist.tooltip__arrow:not(.inverted).arrow_top:after {\n  display: none;\n}\n.reactist.tooltip__wrapper .reactist.tooltip__arrow:not(.inverted).arrow_right:before {\n  border-left-color: #333333;\n}\n.reactist.tooltip__wrapper .reactist.tooltip__arrow:not(.inverted).arrow_right:after {\n  display: none;\n}\n.reactist.tooltip__wrapper .reactist.tooltip__arrow:not(.inverted).arrow_bottom:before {\n  border-top-color: #333333;\n}\n.reactist.tooltip__wrapper .reactist.tooltip__arrow:not(.inverted).arrow_bottom:after {\n  display: none;\n}\n.reactist.tooltip__wrapper .reactist.tooltip__arrow:not(.inverted).arrow_left:before {\n  border-right-color: #333333;\n}\n.reactist.tooltip__wrapper .reactist.tooltip__arrow:not(.inverted).arrow_left:after {\n  display: none;\n}\n",""])}])})},{classnames:"classnames","prop-types":"prop-types",react:"react"}],190:[function(e,t,r){"use strict";function n(e,t){
if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e),this.onContentSave=this.onContentSave.bind(this),this.onContollerHide=this.onContollerHide.bind(this),this.reset=this.reset.bind(this)}return o(e,[{key:"onContentSave",value:function(e){if(e=$strip(e),-1!==e.indexOf("@")&&(e=" "+e+" "),"gmail"===this.type)return"[[gmail="+this.link_id+", "+e+" ]]";if("thunderbird"===this.type){return"[[thunderbird\n "+e.replace(/\n/g,"")+"\n"+this.link_id.replace(/\n/g,"")+" \n ]]"}if("outlook"===this.type)return"[[outlook="+this.link_id+", "+e+" ]]";if("spark"===this.type)return e+" "+this.link_id;if(this.type){var t=e;t=t.replace(/\[/g,"("),t=t.replace(/\]/g,")");var r=this.link_id;return r=r.replace(/\(/g,"["),r=r.replace(/\)/g,"]"),"["+t+"]("+r+")"}return e}},{key:"onContentShow",value:function(){return this.title}},{key:"onContollerHide",value:function(){this.type=null,this.link_id="",this.title=""}},{key:"reset",value:function(){this.onContollerHide()}},{key:"setupByContent",value:function(e){var t=void 0,r=e.match(/mail.google.com\/mail/g);r&&1===r.length&&(t=e.match(/(https?:\/\/mail.google.com\/mail\/[^\s]+) \(([^\)]+)\)/),t&&t[0]===e&&(this.link_id=t[1],this.title=e.replace(t[0],t[2]),this.type="gmail_new"),t||(t=e.match(/\[([^\]]+)\]\((https?:\/\/mail.google.com\/mail\/[^\s]+)\)/))&&t[0]===e&&(this.link_id=t[2],this.title=t[1],this.type="gmail_new")),r=e.match(/twist(?:app)?.com\/a/g),r&&1===r.length&&(t=e.match(/(https?:\/\/[^\s]*twist(?:app)?.com\/a\/[^\s]+) \(([^\)]+)\)/),t&&t[0]===e&&(this.link_id=t[1],this.title=e.replace(t[0],t[2]),this.type="twist"),t||(t=e.match(/\[([^\]]+)\]\((https?:\/\/[^\s]*twist(?:app)?.com\/a\/[^\s]+)\)/))&&t[0]===e&&(this.link_id=t[2],this.title=t[1],this.type="twist")),-1!==e.indexOf("[[gmail=")&&(t=e.match(/\[\[gmail=(.+?),\s*(.+?)\]\]/))&&t[0]===e&&(this.link_id=t[1],this.title=t[2],this.type="gmail"),-1!==e.indexOf("[[thunderbird")&&(t=e.match(/\[\[thunderbird\n?([^\n]+)\n([^\n]+)\n\s*\]\]/))&&t[0]===e&&(this.link_id=t[2],this.title=t[1],this.type="thunderbird"),-1!==e.indexOf("[[outlook=")&&(t=e.match(/\[\[outlook=(.+?),\s*(.+?)\]\]/))&&t[0]===e&&(this.link_id=t[1],this.title=t[2],this.type="outlook"),(r=e.match(/readdle-spark:\/\//g))&&1===r.length&&(t=e.match(/\[\(.+\)\]\((readdle-spark:[^\s]+)\)/))&&(this.link_id=t[0],this.title=e.replace(t[0],""),this.type="spark")}},{key:"annotateWithIcon",value:function(e){var t=e.parentNode;if(t){var r=void 0;$addClass(t,"has_content_icon"),r="twist"===this.type?"sm1/twist.svg":"generic"===this.type?"sm1/attachment.svg":"sm1/email.svg";var n=svgs.get(r,{className:"content-icon",width:24,height:24});$ATT(t,n)}}}],[{key:"initClass",value:function(){this.prototype.type=null,this.prototype.link_id="",this.prototype.title=""}}]),e}();a.initClass(),t.exports={GContentTransformers:a,ContentTransformers:new a}},{}],191:[function(e,t,r){"use strict";var n={isGmailDomain:function(e){return-1!=e.indexOf("mail.google.com")||-1!=e.indexOf("googlemail.com")},isCurHrefGmail:function(e){var t=n;if(!e)return!1;if(t.isGmailDomain(e)){if(t.getGmailRealId(e))return!0}return!1},getGmailRealId:function(e){if(!n.isGmailDomain(e))return null;try{var t=e.split("/"),r=t[t.length-1];if(-1==r.indexOf(".")&&-1==r.indexOf("#")&&-1==r.indexOf("/")&&r.length>=16)return r}catch(e){}return null},getThreadId:function(e){var t=e.match(/th=(.{16,})/);return t?t[1]:(t=e.match(/\/([^\/.]{16,})/),t?t[1]:null)}};window.GmailPlugin=n,t.exports=n},{}],192:[function(e,t,r){"use strict";var n=e("./GmailPlugin.js"),o=e("../components/misc/Util.js").postMessageToWindow,a={init:function(){window.linkRedirecter=function(e){$log(e);var t=e.getAttribute("thunder_id");if(t){var r=JSON.stringify({type:"switchEmail",id:t});return top.postMessage(r,"*")}if(window.CUR_HREF&&window.CUR_HREF.href){var a=n.getThreadId(e.href),i=window.CUR_HREF.href.match(/^(.+)#/);if(n.isGmailDomain(e.href)&&a&&i){if("T_FIREFOX_MESSAGE"==window.CUR_HREF.type){var s=i[1]+"#inbox/"+a,l=JSON.stringify({type:"switchLocation",url:s});try{top.postMessage(l,"*")}catch(e){}return!1}return!top.postMessage||(o(top,"SWITCH_URL:"+e.href),!1)}}return!0}}};t.exports=a},{"../components/misc/Util.js":44,"./GmailPlugin.js":191}],193:[function(e,t,r){"use strict";var n=e("./PluginVersion.js"),o=e("./RatingsTooltip");window.CUR_HREF={};var a=function(e){if(e&&e.data&&e.data.indexOf){var t=void 0;if(-1!==e.data.indexOf("--/--")){var r=e.data.split("--/--");if(window.CUR_HREF.href===r[0])return;window.CUR_HREF={href:r[0],title:r[1]},n.notifyExternalServices()}if(-1!==e.data.indexOf("GCHROME_MESSAGE")){if(t=JSON.parse(e.data),window.CUR_HREF.href===t.href)return;window.CUR_HREF=t,n.notifyExternalServices()}-1!==e.data.indexOf("USER_TOOLTIP")&&(t=JSON.parse(e.data),o.show(t))}};r.init=function(){window.attachEvent?window.attachEvent("onmessage",a):window.addEventListener("message",a,!1)}},{"./PluginVersion.js":194,"./RatingsTooltip":195}],194:[function(e,t,r){"use strict";function n(e){window.CUR_HREF=e,p.notifyExternalServices()}function o(){return window.CUR_HREF?window.CUR_HREF.href:null}var a=window.LibEdit,i=window.Signals,s=e("../components/quick_add/QuickAdd"),l=e("../components/project_editor/ProjectEditorManager"),u=e("../components/richtext_editor/NatrualLanguageParsing"),c=e("../external_services/OutlookIntegration.js"),d=e("../plugin_version/ContentTransformers").ContentTransformers,f=e("./GmailPlugin.js");window.CURRENT_EXERNAL_SERVICE=null,window.CUR_HREF=null;var p={init:function(){try{window.addEventListener("message",function(e){if(e){var t=e.data;if(t&&$isString(t)){if("GB_hide"==t)return void GB_hide();-1==t.indexOf("SET_CURRENT_ADD")&&-1==t.indexOf("THUNDERBIRD_MESSAGE")&&-1==t.indexOf("T_FIREFOX_MESSAGE")||n(JSON.parse(t)),-1==t.indexOf("SHOW_QUICK_ADD")&&-1==t.indexOf("GMAIL_MESSAGE_ADD")||(window.CUR_HREF=JSON.parse(t),setTimeout(function(){p.addToGenericController(!0)},100))}}},!1)}catch(e){}i.connect("PluginVersion.notifyExternalServices",this.notifyExternalServices),i.connect("PluginVersion.addToGenericController",$p(this.addToGenericController,!0))},addToGenericController:function(e){void 0===e&&(e=!1);var t=l.current_section_list;if(t&&!1===p.force_quick_add)t.addNewItem(!1,function(){var e=$gc(l.current_form,null,"richtext_editor");p.addToTextArea(e)});else if(!s.shown){s.support_annotation=!1,s.toggle();var r=$child($("quick_add_task"),null,"richtext_editor");c.current_email_obj?c.addToTextArea(r):p.addToTextArea(r)}return!1},addToTextArea:function(e){if(u.truncate_links=!0,window.CUR_HREF&&window.CUR_HREF.unique_id){var t=window.CUR_HREF;return-1!=t.unique_id.indexOf("TODOIST_WARN_USER_MESSAGE_NOT_SELECTED")?(alert(_("Please select an email first before adding it as a task.")),!1):(d.type="thunderbird",d.link_id=t.unique_id,d.title=p.normalizeTitle(t.subject),d.annotateWithIcon(e),a.insertAtCursor(e,t.subject.replace(/\n/g,""),!0),e.onchanged&&e.onchanged(),!1)}if(!o())return!1;if(f.getGmailRealId(o())){var r=window.CUR_HREF.title;r=r.replace(/[-\s]+[^\s]+@[^\s]+ - [^-]+$/,"");try{r=p._stripTitle(r)}catch(e){}d.type="gmail_new",d.link_id=window.CUR_HREF.href,d.title=p.normalizeTitle(r),d.annotateWithIcon(e),a.insertAtCursor(e,r,!0)}else{var n=p.getTitleAndUrl(),i=n[0],s=n[1];s.match(/twist(?:app)?.com\/a/g)?d.type="twist":d.type="generic",d.link_id=s,d.title=i,d.annotateWithIcon(e),a.insertAtCursor(e,i,!0)}return!1},getTitleAndUrl:function(){var e=p._stripTitle(window.CUR_HREF.title);-1!=e.indexOf("(")&&(e=e.replace(/\(/g,"["),e=e.replace(/\)/g,"]"));var t=o();return-1!=t.indexOf("teamcom.io")&&(e=e.replace(/^\[\d+\]\s+/,""),e=e.replace(" | TeamCom","")),[p.normalizeTitle(e),t]},normalizeTitle:function(e){return e.length>140&&(e=e.substring(0,140)+"..."),e.replace(/\n/g," ")},notifyExternalServices:function(){var e,t=!1,r=!0,n=_("Add email as task"),a=null;if(c.current_email_obj?(t=!0,e=c.addToTextArea):window.CUR_HREF&&window.CUR_HREF.unique_id?(t=!0,e=p.addToTextArea):o()&&(t=!0,f.isCurHrefGmail(o())||(n=window.CUR_HREF.action_text||_("Add website as task"),r=!1),e=p.addToTextArea,a=window.CUR_HREF.attach_text),setTimeout(p.notifyExternalServices,500),t){var s=window.CURRENT_EXERNAL_SERVICE;if(s&&s.annotate_fn==e&&s.annotate_add_text==n)return;window.CURRENT_EXERNAL_SERVICE={annotate_fn:e,annotate_add_text:n,is_email:r},a&&(window.CURRENT_EXERNAL_SERVICE.annotate_attach_text=a)}else window.CURRENT_EXERNAL_SERVICE=null;i.sendSignal("external_service_annotation",window.CURRENT_EXERNAL_SERVICE)},_stripTitle:function(e){return e=e.replace(/\s\s+/g," ").replace(/"/g,""),e=e.replace(/\[/g,"(").replace(/\]/g,")"),$strip(e)}};window.PluginVersion=p,t.exports=p},{"../components/project_editor/ProjectEditorManager":61,"../components/quick_add/QuickAdd":73,"../components/richtext_editor/NatrualLanguageParsing":85,"../external_services/OutlookIntegration.js":128,"../plugin_version/ContentTransformers":190,"./GmailPlugin.js":191}],195:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=window,i=a.Alerts,s=window,l=s.IstButton,u=window,c=u.GB_showHTML,d=window,f=d.GB_hide,p=e("../components/misc/Util.js"),m=p.postMessageToWindow,h=function(){function e(){n(this,e),this.show=this.show.bind(this),this.tooltip_shown=!1}return o(e,[{key:"show",value:function(e){var t=this,r=void 0,n=void 0,o=void 0,a=void 0;if(!this.tooltip_shown&&!$queryArgument("print_mode")){var s=e.message||"rate_chrome_plugin";"rate_chrome_plugin"===s?n=_("If you enjoy using Todoist for Chrome, would you mind taking a moment and rate us?<br><br>"+_("It won't take more than a minute. Thanks for your support!")):"rate_firefox_plugin"===s&&(n=_("If you enjoy using Todoist for Firefox, would you mind taking a moment and rate us?<br><br>"+_("It won't take more than a minute. Thanks for your support!")));var u=i.renderHolder(n);$add(u.icon,svgs.get("sm1/todoist_logo.svg")),$add(u.buttons,BR(),r=l.createButton(_("Rate it now"),null,"red")),$AEV(r,"click",function(){return window.open(e.action_url),t.disableTooltip(s)}),$add(u.buttons,BR(),BR()),$add(u.buttons,a=A({href:"#",c:"cancel",s:"margin-right: 10px;"},_("Remind me later")),o=A({href:"#",c:"cancel"},_("No, Thanks"))),$AEV(a,"click",$p(this.reset,s)),$AEV(o,"click",$p(this.disableTooltip,s)),$AEV([r,a,o],"click",f),c("",u.frame,180,330,{callback_fn:function(){return null}}),this.tooltip_shown=!0}}},{key:"disableTooltip",value:function(e){e&&-1!==e.indexOf("firefox")?m(top,"DISABLE_TOOLTIP:firefox_rating"):m(top,"DISABLE_TOOLTIP:chrome_rating")}},{key:"reset",value:function(e){e&&-1!==e.indexOf("firefox")?m(top,"DISABLE_TOOLTIP:firefox_rating"):m(top,"RESET_TOOLTIP:chrome_rating")}}]),e}();t.exports=new h},{"../components/misc/Util.js":44}],196:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.onClick,r=e.children;return i.default.createElement("div",{id:"labels_list_manager",className:"left_list_manager_holder"},i.default.createElement("div",{className:"left_list_man actions"},i.default.createElement(c.default,{onClick:t,element:"span",className:"action sel_add_project link_add"},i.default.createElement("span",{className:"icon_add"},i.default.createElement(f.default,null)),r)))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("./Button"),c=n(u),d=e("./icons/PlusIcon"),f=n(d);o.propTypes={onClick:l.default.func,children:l.default.node}},{"./Button":198,"./icons/PlusIcon":291,"prop-types":"prop-types",react:"react"}],197:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.user,r=e.size,n=void 0;if(t.image_id)n=u+"/"+t.image_id+"_"+r+".jpg";else{var o=r==d?18:30,a=$encode({fullName:t.full_name|t.email.split("@")[0],email:t.email,size:2*o});n=c+"?"+a}return i.default.createElement("img",{className:"user_avatar "+r,src:n})}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u="https://dcff1xvirvpfp.cloudfront.net",c="https://avatars.doist.com",d="small";o.propTypes={user:l.default.oneOfType([l.default.shape({image_id:l.default.string}),l.default.shape({full_name:l.default.string}),l.default.shape({email:l.default.string})]).isRequired,size:l.default.oneOf([d,"medium","large"]).isRequired},o.SIZE_SMALL=d,o.SIZE_MEDIUM="medium",o.SIZE_LARGE="large",r.default=o},{"prop-types":"prop-types",react:"react"}],198:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function a(e){var t=e.children,r=e.className,n=e.disabled,a=void 0!==n&&n,l=e.element,c=void 0===l?"button":l,d=e.onClick,f=e.type,p=void 0===f?"button":f,m=o(e,["children","className","disabled","element","onClick","type"]);"submit"===p&&"button"!==c&&(console.warn('A non-button element cannot have type="submit"'),c="button");var h="button"===c?{type:p}:{role:"button",tabIndex:0,onKeyDown:i(d)};return u.default.createElement(c,s({},h,m,{onClick:d,className:r,disabled:a,"aria-disabled":a?"true":void 0}),t)}function i(e){return e?function(t){t.keyCode!==f&&t.keyCode!==p||(t.preventDefault(),e(t))}:void 0}Object.defineProperty(r,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=a;var l=e("react"),u=n(l),c=e("prop-types"),d=n(c);a.propTypes={children:d.default.node.isRequired,className:d.default.string,disabled:d.default.bool,element:d.default.oneOf(["button","div","span"]),onClick:d.default.func,type:d.default.oneOf(["submit","button"])};var f=13,p=32},{"prop-types":"prop-types",react:"react"}],199:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){$addClass(e,"hovering")}function l(e){$removeClass(e,"hovering")}function u(e){$AEV(e,"mouseover",$p(s,e)),$AEV(e,"mouseout",$p(l,e))}Object.defineProperty(r,"__esModule",{value:!0});var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),d=e("react"),f=n(d),p=e("prop-types"),m=n(p),h=e("../models/Colors"),_=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(h),v=function(e,t){for(var r=UL({class:"menu_buttons colors"}),n=LI({class:"colors"}),o=0;o<e.length;o++)!function(r){var o=e[r],a=A({c:"object_color","data-index":r+_.START_INDEX},svgs.get("sm1/check_mark_big.svg"));a.style.backgroundColor=o.hex,a.onclick=function(){t(r)},u(a),IstTooltip.showSimpleText(a,o.name,null,0,5),$add(n,a)}(o);$add(r,n);var a=new IstMenu;return $addClass(a.menu_holder,"color_picker"),a.pos_y_offset=15,a.pos_x_offset=5,a.addItems({type:"item",view:r,extra_class:"no_hover"}),$AEV(document,"click",a.hide),a},y=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.showColorMenu=function(e){r.colorMenu.show({},e);var t=$$("li.colors",r.colorMenu.menu_holder)[0],n=$$("[data-index='"+r.props.color+"']",t)[0];$addClass(n,"selected_color")},r.onColorSelect=function(e){var t=e+_.START_INDEX;r.colorMenu.hide(),r.props.onChange(t);var n=$$("li.colors",r.colorMenu.menu_holder)[0],o=$AF(n.childNodes);$map(o,function(e){$removeClass(e,"selected_color")}),$addClass(o[e],"selected_color")},r.colors=_.get(),r.colorMenu=v(r.colors,r.onColorSelect),r}return i(t,e),c(t,[{key:"componentWillUnmount",value:function(){$REV(document,"click",this.colorMenu.hide),this.colorMenu.remove()}},{key:"render",value:function(){var e=this.props,t=e.children,r=e.color,n={color:_.getHex("filter",r)};return f.default.createElement("div",{onClick:this.showColorMenu,className:"div_color counter_color menu_icon","data-track":"labels|add_or_edit_color",id:"color_selector",style:n},t)}}]),t}(f.default.Component);y.propTypes={color:m.default.number,children:m.default.node,onChange:m.default.func},r.default=y},{"../models/Colors":161,"prop-types":"prop-types",react:"react"}],200:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("./reactist/TopNotifier"),p=n(f),m=e("./productivity_stat/MedalIcon"),h=n(m),v=e("../utils/format"),y=n(v),g=e("../constants/themes"),b=[_("Well done, {user_name}!"),_("You conquered the day, {user_name}!"),_("Nice work, {user_name}!"),_("Mischief managed.")],w=function(e){var t=(new Date).getDate()%b.length;return(0,y.default)(b[t],{user_name:e})},E=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"shouldComponentUpdate",value:function(e){return this.props.open!==e.open}},{key:"header",value:function(){var e=this.props.goal,t=void 0===e?0:e,r=_n("Daily goal completed: {num_completed}/{num_goal} task","Daily goal completed: {num_completed}/{num_goal} tasks",t);return(0,y.default)(r,{num_completed:t,num_goal:t})}},{key:"render",value:function(){var e=this.props,t=e.open,r=void 0!==t&&t,n=e.theme,o=void 0===n?0:n,a=e.userName,i=void 0===a?"":a,s=e.onClick,l=e.onClose,c=(0,g.colorInHex)(o);return o!==g.THEME_SUNFLOWER&&o!==g.THEME_NEUTRAL||(c=(0,g.colorInHex)(g.THEME_NOIR)),o===g.THEME_DARK&&(c=g.DARK_THEME_ICON_COLOR),u.default.createElement(p.default,{open:r,onClose:l,autoHideDuration:6e3,onClick:s},r?u.default.createElement("div",{className:"goal_notifier"},u.default.createElement(h.default,{className:"icon",width:50,color:c}),u.default.createElement("div",{className:"content"},u.default.createElement("h1",null,this.header()),u.default.createElement("p",null,w(i)),u.default.createElement("a",{className:"cta"},_("View Detailed Stats")))):null)}}]),t}(u.default.Component);E.propTypes={theme:d.default.number,userName:d.default.string,goal:d.default.number,onClick:d.default.func,onClose:d.default.func,open:d.default.bool},r.default=E},{"../constants/themes":99,"../utils/format":474,"./productivity_stat/MedalIcon":331,"./reactist/TopNotifier":345,"prop-types":"prop-types",react:"react"}],201:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("react-dom"),d=n(c),f=e("prop-types"),p=n(f),m=e("classnames"),h=n(m),_=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.el=document.createElement("div"),r.el.className=(0,h.default)("dialog",e.className),document.body.appendChild(r.el),r.handleDocumentClick=r.handleDocumentClick.bind(r),r.setUnderlaySize=r.setUnderlaySize.bind(r),r.setPosition=r.setPosition.bind(r),r}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;this.props.hasUnderlay&&(this.setUnderlaySize(),window.addEventListener("scroll",this.setUnderlaySize)),this.setPosition(),window.addEventListener("resize",this.setPosition),setTimeout(function(){return window.addEventListener("click",e.handleDocumentClick)},0)}},{key:"componentWillUnmount",value:function(){this.el.parentNode&&document.body.removeChild(this.el),window.removeEventListener("scroll",this.setUnderlaySize,!1),window.removeEventListener("resize",this.setPosition,!1),window.removeEventListener("click",this.handleDocumentClick,!1)}},{key:"handleDocumentClick",value:function(e){var t=$eventElm(e);this.props.hasUnderlay&&t!==this.el||!this.props.hasUnderlay&&$parent(t,"div","dialog")||this.props.onHide(e)}},{key:"setUnderlaySize",value:function(){this.el.style.width="100%",this.el.style.height=$scrollTop()+$winSize().h+"px",this.el.style.visibility="visible"}},{key:"setPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.position,t=this.props,r=t.anchor,n=t.anchorGap,o=t.align,a=t.hasUnderlay,i=t.isFixed,s=t.isPositionFluid,l=t.width,u=t.nose,c=document.body.scrollWidth,d=$scrollTop(),f=void 0;a?(f=this.content,f.style.position="fixed"):f=this.el,f.style.width=l+"px";var p=f.getBoundingClientRect(),m=p.height,h=void 0,_=void 0;if(r){var v=r.getBoundingClientRect();switch(_=v.left+v.width/2-l/2,i?(h=0,f.style.position="fixed"):(h=d,f.style.position="absolute"),e){case"top":"bottom"===o?h+=v.bottom-m:"top"===o&&(h+=v.top-m);break;case"right":h+=v.top,_+=v.width/2+l/2;break;case"bottom":default:"bottom"===o?h+=v.bottom+(u?10:0):"top"===o&&(h+=v.top+(u?10:0))}}else switch(e){case"center":default:h=$winSize().h/2-m/2,_=$winSize().w/2-l/2}var y=$winSize().h+d,g=h+m,b=g>y;if(s&&b)switch(e){case"bottom":default:return this.setPosition("top")}_=Math.max(0,Math.min(_,c-l-12)),f.style.top=h+n+"px",f.style.left=_+"px",f.style.visibility="visible",b&&$fx.scrollToPos(g-window.innerHeight+20);var w=window.GB_getLast&&window.GB_getLast();w&&(this.el.style.zIndex=w.cur_zindex+501)}},{key:"render",value:function(){var e=this,t=this.props,r=t.contentClassName,n=t.children,o=t.nose,a=t.position,i=(0,h.default)("dialog-content",r);return d.default.createPortal(u.default.createElement("div",{ref:function(t){return e.content=t},className:i},o&&u.default.createElement("div",{className:"dialog_nose dialog_nose_"+a}),n),this.el)}}]),t}(u.default.PureComponent);_.propTypes={anchor:p.default.object,anchorGap:p.default.number,align:p.default.oneOf(["top","bottom"]),className:p.default.string,contentClassName:p.default.string,position:p.default.oneOf(["center","top","bottom","right"]),width:p.default.number,hasUnderlay:p.default.bool,isFixed:p.default.bool,isPositionFluid:p.default.bool,onHide:p.default.func,nose:p.default.bool,children:p.default.node},_.defaultProps={anchorGap:0,align:"bottom",position:"center",width:100,hasUnderlay:!1,isFixed:!1,isPositionFluid:!1,onHide:function(){},nose:!1},r.default=_},{classnames:"classnames","prop-types":"prop-types",react:"react","react-dom":"react-dom"}],202:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../constants/constants.js"),p=window,m=p.Formatter,h=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.updateTitle(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.updateTitle(e)}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"updateTitle",value:function(e){var t=e.mainView,r=e.filters,n=e.labels,o=e.projects,a="Todoist";switch(t.type){case f.MAIN_VIEW_TYPE_TODAY:a=_("Today")+": Todoist";break;case f.MAIN_VIEW_TYPE_7_DAYS:a=_("Next 7 days")+": Todoist";break;case f.MAIN_VIEW_TYPE_LABEL:if(!n[t.id])break;a=$strip(n[t.id].name)+": Todoist";break;case f.MAIN_VIEW_TYPE_FILTER:if(!r[t.id])break;a=$strip(r[t.id].name)+": Todoist";break;case f.MAIN_VIEW_TYPE_PROJECT:if(t.ids&&1!==t.ids.length)break;var i=t.ids[0],s=o[i];if(!s)break;a=$strip(s.name)+": Todoist";break;case f.MAIN_VIEW_TYPE_QUERY:a=t.query+": Todoist";break;case f.MAIN_VIEW_TYPE_ACTIVITY_LOG:a=_("Activity")+": Todoist"}a=m.formatSimple(a,{only_text:!0,as_html:!1}),document.title=a}},{key:"render",value:function(){return this.props.children||null}}]),t}(u.default.Component);h.propTypes={mainView:d.default.object,filters:d.default.object,labels:d.default.object,projects:d.default.object,children:d.default.node},h.defaultProps={mainView:{},filters:{},labels:{},projects:{}},r.default=h},{"../constants/constants.js":98,"prop-types":"prop-types",react:"react"}],203:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("react-dnd"),p=e("@doist/react-dnd-html5-backend"),m=p.NativeTypes.FILE,h=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={isDragging:!1,isHovering:!1},i=r,a(n,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.canDrop,r=e.isOver,n=e.connectDropTarget,o=e.children,a=e.onDrop,i=e.wholeScreen,s=o({isDragging:t,isHovering:r});return u.default.createElement("div",null,i&&u.default.createElement(_,{onDrop:a}),n(s))}}]),t}(u.default.Component);h.propTypes={onDrop:d.default.func,dropTarget:d.default.object,children:d.default.func,wholeScreen:d.default.bool,connectDropTarget:d.default.func,isOver:d.default.bool,canDrop:d.default.bool},h.defaultProps={wholeScreen:!0},r.default=(0,f.DropTarget)(m,{drop:function(e,t){e.onDrop&&e.onDrop(t.getItem().files)}},function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop()}})(h);var _=(0,f.DropTarget)(m,{drop:function(e,t){e.onDrop&&e.onDrop(t.getItem().files)}},function(e,t){return{connectDropTarget:e.dropTarget(),canDrop:t.canDrop()}})(function(e){var t=e.connectDropTarget,r=e.canDrop,n=r?{position:"fixed",zIndex:0,top:0,left:0,right:0,bottom:0}:{};return t(u.default.createElement("div",{style:n}))})},{"@doist/react-dnd-html5-backend":"@doist/react-dnd-html5-backend","prop-types":"prop-types",react:"react","react-dnd":"react-dnd"}],204:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){for(var t=e.parentNode;;){if(!t){t=e.nextSibling;break}if(t.parentNode===document.body)break;t=t.parentNode}return t}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("react"),c=n(u),d=e("prop-types"),f=n(d),p=function(e){function t(){var e,r,n,i;o(this,t);for(var l=arguments.length,u=Array(l),c=0;c<l;c++)u[c]=arguments[c];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.uploadFiles=function(e){var t=n.props.onUpload,r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var l=i.value,u=new GFile;u.file=l,u.temporaryId=Math.random(),u.upload(),t(u)}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}},n.uploadFromGoogleDrive=function(){GoogleDrive.picker?GoogleDrive.show():(GoogleDrive.filesSelected=n.driveSelected,GoogleDrive.load())},n.uploadFromDropBox=function(){if(window.Dropbox)return void n.chooseFromDropbox();var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.id="dropboxjs",e.setAttribute("data-app-key","o8lsvx1nvnswy6q"),e.src="https://www.dropbox.com/static/api/2/dropins.js",document.body.appendChild(e),
e.addEventListener("load",n.chooseFromDropbox)},n.chooseFromDropbox=function(){var e=n.props.onUpload;window.Dropbox.choose({success:function(t){var r=!0,n=!1,o=void 0;try{for(var a,i=t[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var s=a.value,l=new GFile,u={file_url:s.link,file_name:s.name,file_size:s.bytes};s.thumbnailLink&&(u.image=s.thumbnailLink.replace("=96","=800"),u.image_width=800,u.image_height=800),l.setUploadContent(u),e(l)}}catch(e){n=!0,o=e}finally{try{!r&&i.return&&i.return()}finally{if(n)throw o}}},multiselect:!0,iframe:!0});var t=document.querySelector('iframe[src*="dropbox"]');if(t){s(t).style.zIndex=1e5}},n.driveSelected=function(e){var t=n.props.onUpload,r=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var l=i.value,u=new GFile,c={file_url:l.url,file_name:l.name,file_underlying_type:l.mimeType};u.setUploadContent(c),t(u)}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}},i=r,a(n,i)}return i(t,e),l(t,[{key:"render",value:function(){return this.props.children({uploadFiles:this.uploadFiles,uploadFromGoogleDrive:this.uploadFromGoogleDrive,uploadFromDropBox:this.uploadFromDropBox})}}]),t}(c.default.Component);p.propTypes={onUpload:f.default.func,children:f.default.func},r.default=p},{"prop-types":"prop-types",react:"react"}],205:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.dateStr,r=e.overrideClassName,n=f.default.fromDate(new Date(t)),o=new Date,a=new Date;a.setDate(a.getDate()+1);var s=DateistDateHelpers.day_diff(o,n.toDate()),l=DateUtils.humanizeDayDiff(s,n.toDate()),u=r||(0,c.default)("date",{date_future:s<=7&&s>=-7,date_overdue:n.isLessThan(o),date_today:n.isSameDate(o),date_tom:n.isSameDate(a)});return i.default.createElement("span",{className:u},l)}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("classnames"),c=n(u),d=e("../models/DateExt"),f=n(d);o.propTypes={dateStr:l.default.string.isRequired,overrideClassName:l.default.string},r.default=o},{"../models/DateExt":164,classnames:"classnames","prop-types":"prop-types",react:"react"}],206:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("react"),a=n(o),i=e("prop-types"),s=n(i),l=e("./icons"),u=function(e){var t=e.karmaLv,r=e.lang,n=c(e),o=n.title,i=n.subtitle,s=n.content,l=n.facebookText,u=n.twitterText;return a.default.createElement("div",{className:"karma_promo karma_cls_1 GB_iframe_html"},a.default.createElement("h1",null,o),a.default.createElement("h2",null,i),a.default.createElement("h3",null,s),a.default.createElement("div",{className:"bottom_holder"},a.default.createElement("div",{className:"share_icons"},d({facebook:!0,karmaLv:t,text:l,lang:r}),d({twitter:!0,karmaLv:t,lang:r,text:u}),d({googlePlus:!0,karmaLv:t,lang:r}))),a.default.createElement("a",{href:"/karma",className:"karma_help",target:"_blank"},_("Todoist Karma Help")))};u.propTypes={karmaLv:s.default.number,totalCompletedCount:s.default.number,lastMonthCompletedCount:s.default.number,topPercent:s.default.number,lang:s.default.string};var c=function(e){var t=e.karmaLv,r=e.totalCompletedCount,n=e.lastMonthCompletedCount,o=e.topPercent,a=void 0,i=void 0,s=void 0,l=void 0,u=void 0;return 1===t?(a=_("Novice Level"),i=_("You keep progressing- great work!"),s=_("With 500 points, you've reached the Novice Todoist Karma level."),l=_("My @Todoist Karma gets better everyday :) With 500 points, I'm now a Novice!"),u=_("My Todoist Karma gets better everyday :) With 500 points, I'm now a Novice. What about you?")):2===t?(a=_("Intermediate Level"),i=_("Congratulations, you completed a total of %s tasks!").replace("%s",r),s=_("Be proud, your productivity is increasing every day! Keep it up and achieve anything."),l=_("I've completed %s tasks to reach Intermediate @Todoist Karma!").replace("%s",r),u=_("I've completed %s tasks to reach Todoist Karma's Intermediate level! Try Todoist and become more productive.").replace("%s",r)):3===t?(a=_("Professional Level"),i=_("You completed %s tasks last month").replace("%s",n),s=_("Feeling more productive than ever? Don't quit now, you're nearly half way to Enlightened!"),l=_("In the last month, I completed %s tasks to reach @Todoist Karma's Professional level!").replace("%s",n),u=_("Last month, I completed %s tasks and reached Todoist Karma's Professional level. Don't stop me now!").replace("%s",n)):4===t?(a=_("Expert Level"),i=_("Your productivity truly has no bounds"),s=_("Stay focused, be productive and keep progressing. You'll be Enlightened in no time!"),l=_("I've completed %s tasks, and now I'm a productivity @Todoist Expert!").replace("%s",r),u=_("Last month, I completed %s tasks and reached Todoist Karma's Professional level. Don't stop me now!")):5===t?(a=_("Master Level"),i=_("We salute you, Master Todoist user!"),s=_("You've reached an important threshold\u2013 over 10,000 impressive karma points."),l=_("With more than 10,000 points, I'm now a @Todoist Karma Master! #ProductivityMaster"),u=_("With more than 10,000 points, I'm now a Todoist Karma Master! #ProductivityMaster")):6===t?(a=_("Grand Master Level"),i=_("You're just one level from Enlightenment"),s=_("Be proud- your Karma has skyrocketed to over 20,000 points after completing %s tasks.").replace("%s",r),l=_("I'm the #productivity Grand Master \u2013 with over 20k @Todoist Karma points!"),u=_("I'm the #productivity Grand Master \u2013 with over 20k Todoist Karma points and %s completed tasks!").replace("%s",r)):7===t&&(a=_("Enlightened Level"),i=_("You did it. You're now in the exclusive %s%% of Todoist users!").replace("%s",o).replace("%%","%"),s=_("You've completed an impressive total of %s tasks!").replace("%s",r),l=_("I have joined the exclusive %s of Todoist users! Reaching @Todoist Karma Enlightenment!").replace("%s",o),u=_("I have joined the exclusive %s of Todoist users! Reaching Todoist Karma Enlightenment!").replace("%s",o)),{title:a,subtitle:i,content:s,twitterText:l,facebookText:u}},d=function(e){var t=e.facebook,r=e.twitter,n=e.googlePlus,o=e.karmaLv,i=e.text,s=e.lang,u="https://"+location.host+"/karma/"+s+"/"+o+"/2?lang="+s,c=void 0,d=void 0,f=void 0,p={FacebookIcon:l.FacebookIcon,TwitterIcon:l.TwitterIcon,GooglePlusIcon:l.GooglePlusIcon};return t&&(c="https://www.facebook.com/sharer.php?u="+u,d="facebook",f=p.FacebookIcon),n&&(c="https://plus.google.com/share?url="+u,d="gplus",f=p.GooglePlusIcon),r&&(c=i+" "+u,c=$urlencode(c),c="https://twitter.com/home?status="+c,d="twitter",f=p.TwitterIcon),a.default.createElement("a",{href:c,className:d,target:"_blank",rel:"noopener noreferrer"},a.default.createElement(f,null))};r.default=u},{"./icons":300,"prop-types":"prop-types",react:"react"}],207:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.isSelected,r=e.className,n=e.onContextMenu,o=e.onMenuClick,a=e.children,s=e.leftIcon,l=e.color,u={color:c.getHex("filter",l)};return i.default.createElement("div",{className:(r||"")+" "+(t?"current":""),onContextMenu:n},i.default.createElement("table",{cellPadding:"0",cellSpacing:"0",className:"item_table"},i.default.createElement("tbody",null,i.default.createElement("tr",null,i.default.createElement("td",{className:"td_color"},i.default.createElement("div",{className:"div_color counter_color",style:u},s)),i.default.createElement("td",{className:"name"},a),i.default.createElement("td",{className:"menu"},i.default.createElement("div",{onClick:o,className:"icon menu gear_menu"},i.default.createElement(d.MoreSmallIcon,null)))))))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("../models/Colors"),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(u),d=e("./icons");o.propTypes={isSelected:l.default.bool,className:l.default.string,onContextMenu:l.default.func,onMenuClick:l.default.func,children:l.default.node,leftIcon:l.default.element,color:l.default.number}},{"../models/Colors":161,"./icons":300,"prop-types":"prop-types",react:"react"}],208:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("./reactist/Portal"),d=n(c),f=e("prop-types"),p=n(f),m=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.container=u.default.createRef(),n.addClickListener=function(e){var t=n.props,r=t.onClickOutside;if(t.show){for(var o=e.target;o;){if(o===n.container.current)return;o=o.parentElement}r(e)}},i=r,a(n,i)}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;this.props.show&&setTimeout(function(){window.addEventListener("click",e.addClickListener)},0)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.addClickListener)}},{key:"componentDidUpdate",value:function(e){var t=this;!e.show&&this.props.show&&setTimeout(function(){window.addEventListener("click",t.addClickListener)},0),e.show&&!this.props.show&&window.removeEventListener("click",this.addClickListener)}},{key:"render",value:function(){var e=this.props,t=e.show,r=e.children,n=e.basic,o="modal_container "+(n?"modal_container_basic":"");return u.default.createElement(d.default,{open:t},u.default.createElement("div",{className:"modal_overlay"},u.default.createElement("div",{ref:this.container,className:o},r)))}}]),t}(u.default.Component);m.propTypes={show:p.default.bool,children:p.default.node,onClickOutside:p.default.func,basic:p.default.bool},m.defaultProps={basic:!1},r.default=m},{"./reactist/Portal":343,"prop-types":"prop-types",react:"react"}],209:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){e===m.TYPE_ITEM_NOTE?_.default.showTaskComment():_.default.showProjectComment()}function a(e){function t(e){if(!e.ctrl)return n<=0&&!c?(b(),void o(l)):void(l===m.TYPE_ITEM_NOTE?p.default.showItemNotes(a.id,null,a.sync_id):p.default.showProjectNotes(a.id))}var r=e.notesCount,n=void 0===r?0:r,a=e.noteParent,i=e.noteType,l=void 0===i?w:i,u=e.isUserPremium,c=void 0!==u&&u,f=(0,d.default)("clickable","note_icon",{note_icon_hidden:0===n&&l===m.TYPE_ITEM_NOTE}),h=l===m.TYPE_PROJECT_NOTE?"project|comments":"task|comments";return s.default.createElement("span",{className:f,"data-track":h,"data-note-type":l,"data-note-parent-id":a.id,role:"button",tabIndex:0,onClick:t},s.default.createElement(y.default,null),n>0&&s.default.createElement("span",{className:"clickable note_count sel_note_count"},a.has_more_notes?n+"+":n))}Object.defineProperty(r,"__esModule",{value:!0});var i=e("react"),s=n(i),l=e("prop-types"),u=n(l),c=e("classnames"),d=n(c),f=e("../components/notes/Notes"),p=n(f),m=e("../reducers/notes/notesConstants"),h=e("../containers/premium_promo/PremiumOnlyModal"),_=n(h),v=e("./icons/NotesIcon"),y=n(v),g=window,b=g.GB_hide,w=m.TYPE_ITEM_NOTE;a.propTypes={noteParent:u.default.object.isRequired,noteType:u.default.oneOf([m.TYPE_ITEM_NOTE,m.TYPE_PROJECT_NOTE]),notesCount:u.default.number,isUserPremium:u.default.bool},r.default=a},{"../components/notes/Notes":46,"../containers/premium_promo/PremiumOnlyModal":120,"../reducers/notes/notesConstants":430,"./icons/NotesIcon":290,classnames:"classnames","prop-types":"prop-types",react:"react"}],210:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=e("react"),d=n(c),f=e("prop-types"),p=n(f),m=function(e){function t(){var e,r,n,o;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.onChange=function(e){var t=n.props,r=t.onChange,o=t.nodeRef,a=e.target.value;r(a),n.hiddenTextArea.value=a,o.current.style.height=n.hiddenTextArea.scrollHeight+"px"},o=r,i(n,o)}return s(t,e),u(t,[{key:"componentDidMount",value:function(){var e=this.props.nodeRef;this.hiddenTextArea=document.createElement("textarea"),this.hiddenTextArea.style.position="absolute",this.hiddenTextArea.style.left="-9999px",document.body.append(this.hiddenTextArea);var t=getComputedStyle(e.current).width;this.hiddenTextArea.style.width=t,this.hiddenTextArea.value=e.current.value,e.current.style.height=this.hiddenTextArea.scrollHeight+"px"}},{key:"componentWillUnmount",value:function(){try{document.body.removeChild(this.hiddenTextArea)}catch(e){}}},{key:"render",value:function(){var e=this.props,t=(e.onChange,e.nodeRef),r=o(e,["onChange","nodeRef"]);return d.default.createElement("textarea",l({},r,{ref:t,onChange:this.onChange}))}}]),t}(d.default.Component);m.propTypes={value:p.default.string,onChange:p.default.func,nodeRef:p.default.object},r.default=m},{"prop-types":"prop-types",react:"react"}],211:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=e("../utils"),d=e("react"),f=n(d),p=e("prop-types"),m=n(p),h=e("./spinners"),_=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleReportExportClick=function(){r.setState({reportExporting:!0}),r.props.onReportExportClick().then(function(e){r.setState({reportExporting:!1,reportExportLink:e})}).catch(function(e){r.setState({reportExporting:!1,reportExportError:e})})},r.handleUnsyncExportClick=function(){r.setState({unsyncExporting:!0}),r.props.onUnsyncExportClick().then(function(e){r.setState({unsyncExporting:!1,unsyncExportLink:e})}).catch(function(e){r.setState({unsyncExporting:!1,unsyncExportError:e})})},r.state={reportExporting:!1,reportExportError:null,reportExportLink:null,unsyncExporting:!1,unsyncExportError:null,unsyncExportLink:null},r}return s(t,e),u(t,[{key:"renderSyncLogs",value:function(){var e=[].concat(o(this.props.logs));e.reverse();var t=e.map(function(e,t){return f.default.createElement("tr",{className:"level_error",key:e.timestamp+"."+t},f.default.createElement("td",{className:"time"},e.isoTime),f.default.createElement("td",null,"[ERROR] ",e.msg))});return 0==t.length&&(t=f.default.createElement("tr",null,f.default.createElement("td",{className:"time"}),f.default.createElement("td",null,"No error events recorded"))),f.default.createElement("div",null,f.default.createElement("h4",null,"Sync error history logs (most recent on the top)"),f.default.createElement("table",{className:"sync_logs"},f.default.createElement("tbody",null,t)))}},{key:"renderStatus",value:function(){var e=this.props,t=e.queueLength,r=e.firstRunCmdCount,n=e.failedCmdCount,o=e.lastSyncAt,a=e.unsync,i=void 0;o&&(i=o.toString());var s=(0,c.flatten)((0,c.values)(a)).length,u=void 0;return s>0&&(u=(0,c.toPairs)(a).map(function(e){var t=l(e,2),r=t[0],n=t[1];return 0==n.length?null:r+": "+n.length}).filter(function(e){return e}).join(" "),u="("+u+")"),f.default.createElement("div",null,f.default.createElement("h4",null,"System summery"),f.default.createElement("table",{className:"status_table"},f.default.createElement("tbody",null,f.default.createElement("tr",null,f.default.createElement("td",null,"Last sync"),f.default.createElement("td",null,i)),f.default.createElement("tr",null,f.default.createElement("td",null,"Sync queue length"),f.default.createElement("td",null,t)),f.default.createElement("tr",null,f.default.createElement("td",null,"First run commands count"),f.default.createElement("td",null,r)),f.default.createElement("tr",null,f.default.createElement("td",null,"Failed commands count"),f.default.createElement("td",null,n)),f.default.createElement("tr",null,f.default.createElement("td",null,"Unsynced objects count"),f.default.createElement("td",null,s," ",u)))))}},{key:"renderReportDownload",value:function(){return this.state.reportExportLink?f.default.createElement("section",null,f.default.createElement("a",{href:this.state.reportExportLink,target:"_blank",rel:"noopener noreferrer"},"Download")):f.default.createElement("section",null,f.default.createElement("a",{className:"ist_button",onClick:this.handleReportExportClick},"Download Error Logs"),this.state.reportExporting?f.default.createElement(h.RingSpinner,null):null)}},{key:"renderUnsyncExport",value:function(){return 0===(0,c.flatten)((0,c.values)(this.props.unsync)).length?null:this.state.unsyncExportLink?f.default.createElement("section",null,f.default.createElement("a",{href:this.state.unsyncExportLink,target:"_blank",rel:"noopener noreferrer"},"Download")):f.default.createElement("section",null,f.default.createElement("a",{className:"ist_button",onClick:this.handleUnsyncExportClick},"Download Unsynced Datas"),this.state.unsyncExporting?f.default.createElement(h.RingSpinner,null):null)}},{key:"render",value:function(){return f.default.createElement("div",{className:"debug_tool"},this.renderStatus(),this.renderSyncLogs(),this.renderReportDownload(),this.renderUnsyncExport())}}]),t}(f.default.Component);_.propTypes={logs:m.default.array.isRequired,unsync:m.default.shape({items:m.default.array,projects:m.default.array,notes:m.default.array,reminders:m.default.array,labels:m.default.array}).isRequired,lastSyncAt:m.default.object,queueLength:m.default.number,firstRunCmdCount:m.default.number,failedCmdCount:m.default.number,onReportExportClick:m.default.func,onUnsyncExportClick:m.default.func},r.default=_},{"../utils":484,"./spinners":401,"prop-types":"prop-types",react:"react"}],212:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.text,r=e.keyval,n=(0,c.compose)((0,c.map)(function(e){var t=a(e,2),r=t[0];return{name:r,value:t[1],re:new RegExp("\\{\\s*"+r+"\\s*\\}","g")}}),c.toPairs)(r),o=(0,c.compose)((0,c.sortBy)("startIndex"),(0,c.filter)(function(e){return e}),c.flatten,(0,c.map)(function(e){for(var r=e.name,n=e.value,o=e.re,a=[],i=void 0;null!==(i=o.exec(t));)a.push({name:r,value:n,re:o,startIndex:i.index,endIndex:i.index+i[0].length});return a}))(n),i=[],l=0,u=!0,d=!1,f=void 0;try{for(var p,m=o[Symbol.iterator]();!(u=(p=m.next()).done);u=!0){var h=p.value,_=h.startIndex,v=h.endIndex,y=h.value,g=t.slice(l,_);i.push(g),i.push(y),l=v}}catch(e){d=!0,f=e}finally{try{!u&&m.return&&m.return()}finally{if(d)throw f}}var b=t.slice(l,t.length);return i.push(b),s.default.createElement.apply(s.default,[s.default.Fragment,null].concat(i))}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r.default=o;var i=e("react"),s=n(i),l=e("prop-types"),u=n(l),c=e("../utils/fp");o.propTypes={text:u.default.string,keyval:u.default.object}},{"../utils/fp":477,"prop-types":"prop-types",react:"react"}],213:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=e("../utils/fp"),d=e("react"),f=n(d),p=e("prop-types"),m=n(p),h=e("classnames"),v=n(h),y=e("./icons"),g=e("../components/formatter/Formatter"),b=n(g),w=e("../models/Colors"),E=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(w),k=void 0,S=function(e,t){k||(k=new IstMenu,k.addItems(IstMenu.createItem(_("Hide from favorites"),function(){k.onUnfavorite&&k.onUnfavorite(),k.hide()},{icon:svgs.get("sm1/heart_strike.svg")})),$AEV(document,"click",function(e){k.shown&&k.hide(e)})),k.onUnfavorite=t,k.shown&&k.hide(),k.show({},e,{pos_y_offset:10})},j=function(e){function t(){var e,r,n,o;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.handleClick=function(){var e=n.props,t=e.menu,r=e.item;return n.props.onClick({menu:t,id:r.id})},n.handleMenuClick=function(e){e.stopPropagation(),S(e,n.handleUnfavorite)},n.handleContextMenu=function(e){if(e.shift)return!0;e.preventDefault(),S(e,n.handleUnfavorite)},n.handleUnfavorite=function(){var e=n.props,t=e.menu,r=e.item;n.props.onUnfavorite({menu:t,id:r.id})},o=r,i(n,o)}return s(t,e),u(t,[{key:"render",value:function(){var e,t=this.props,r=t.icon,n=t.item,a=t.isSelected,i=t.count,s=t.menu,l=(e={className:(0,v.default)("favorite_item",a?"current":null)},o(e,"data-id",n.id),o(e,"data-type",s+"_list_item"),o(e,"onClick",this.handleClick),o(e,"onContextMenu",this.handleContextMenu),e),u=b.default.formatSimple(n.name,{only_text:!1,as_html:!0,with_links:!1,cache_prefix:"top_menu_item"}),c="project"==s?{color:E.getHex("project",n.color)}:{color:E.getHex("filter",n.color)};return f.default.createElement("li",l,f.default.createElement("span",{className:"item_icon",style:c},r),f.default.createElement("span",{className:"item_content"},f.default.createElement("span",{dangerouslySetInnerHTML:{__html:u}}),f.default.createElement("small",{className:"item_counter"},i||null)),f.default.createElement("span",{className:"item_menu icon menu gear_menu",onClick:this.handleMenuClick},f.default.createElement(y.MoreSmallIcon,null)))}}]),t}(f.default.PureComponent);j.propTypes={menu:m.default.oneOf(["project","label","filter"]).isRequired,item:m.default.shape({id:m.default.any,name:m.default.string}).isRequired,count:m.default.number,isSelected:m.default.bool,onUnfavorite:m.default.func,onClick:m.default.func};var T=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleTodayClick=function(){r.props.onSelect({menu:"today"})},r.handle7DaysClick=function(){r.props.onSelect({menu:"7days"})},r.handleInboxClick=function(){r.props.onSelect({menu:"project",id:r.props.inboxPID})},r.handleTeamInboxClick=function(){r.props.onSelect({menu:"project",id:r.props.teamInboxPID})},r.handleFavoriteItemClick=function(e){var t=e.menu,n=e.id;return r.props.onSelect({menu:t,id:n})},r.sharedProjectIcon=f.default.createElement(y.ProjectIcon,{isShared:!0}),r.personalProjectIcon=f.default.createElement(y.ProjectIcon,{isShared:!1}),r.labelIcon=f.default.createElement(y.LabelIcon,null),r.filterIcon=f.default.createElement(y.FilterIcon,null),r}return s(t,e),u(t,[{key:"renderProjectItem",value:function(){var e=this,t=this.props,r=t.projects,n=t.projectCount,o=t.collaboratorsByPID;return r?r.map(function(t){var r="project"===(0,c.get)("props.selected.menu",e)&&(0,c.get)("props.selected.id",e)===t.id,a=!!o[t.id],i=a?e.sharedProjectIcon:e.personalProjectIcon,s={menu:"project",item:t,count:n[t.id],isSelected:r,onUnfavorite:e.props.onUnfavorite,onClick:e.handleFavoriteItemClick,icon:i};return f.default.createElement(j,l({key:t.id},s))}):null}},{key:"renderLabelItem",value:function(){var e=this,t=this.props,r=t.labels,n=t.labelCount;return r?r.map(function(t){var r="label"===(0,c.get)("props.selected.menu",e)&&(0,c.get)("props.selected.id",e)===t.id,o={menu:"label",item:t,count:n[t.id],isSelected:r,onUnfavorite:e.props.onUnfavorite,onClick:e.handleFavoriteItemClick,icon:e.labelIcon};return f.default.createElement(j,l({key:t.id},o))}):null}},{key:"renderFilterItems",value:function(){var e=this,t=this.props,r=t.filters,n=t.filterCount;return r?r.map(function(t){var r="filter"===(0,c.get)("props.selected.menu",e)&&(0,c.get)("props.selected.id",e)===t.id,o={menu:"filter",item:t,count:n[t.id],isSelected:r,onUnfavorite:e.props.onUnfavorite,onClick:e.handleFavoriteItemClick,icon:e.filterIcon};return f.default.createElement(j,l({key:t.id},o))}):null}},{key:"render",value:function(){var e=this.props,t=e.selected,r=e.inboxPID,n=e.teamInboxPID,o=e.projectCount,a=e.overdueCount,i=e.todayCount,s=e.sevenDaysCount,l=e.clock,u=i+a,c=s+a,d=function(e,r){return(0,v.default)("filter",!t||t.menu!==e||r&&t.id!==r?null:"current")};return f.default.createElement("div",null,f.default.createElement("ul",{id:"top_filters"},f.default.createElement("li",{className:d("project",r),id:"filter_inbox",onClick:this.handleInboxClick,"data-id":r,"data-track":"navigation|inbox"},f.default.createElement("span",{className:"item_icon"},f.default.createElement(y.InboxIcon,null)),f.default.createElement("span",{className:"item_content"},_("Inbox"),f.default.createElement("small",{className:"item_counter"},o[r]||null))),n?f.default.createElement("li",{className:d("project",n),id:"filter_team_inbox",onClick:this.handleTeamInboxClick,"data-id":n,"data-track":"navigation|team_inbox"},f.default.createElement("span",{className:"item_icon"},f.default.createElement(y.TeamInboxIcon,null)),f.default.createElement("span",{className:"item_content"},_("Team Inbox"),f.default.createElement("small",{className:"item_counter"},o[n]||null))):null,f.default.createElement("li",{className:d("today"),onClick:this.handleTodayClick,"data-track":"navigation|today"},f.default.createElement("span",{className:"item_icon",style:{position:"relative",top:"1px"}},f.default.createElement(y.TodayIcon,{dateString:l})),f.default.createElement("span",{className:"item_content"},_("Today"),f.default.createElement("small",{className:(0,v.default)("item_counter",a>0?"overdue_color":null)},u||null))),f.default.createElement("li",{className:d("7days"),onClick:this.handle7DaysClick,"data-track":"navigation|next_7_days"},f.default.createElement("span",{className:"item_icon",style:{position:"relative",top:"1px"}},f.default.createElement(y.Next7DaysIcon,null)),f.default.createElement("span",{className:"item_content"},_("Next 7 days"),f.default.createElement("small",{className:"item_counter"},c||null))),this.renderProjectItem(),this.renderLabelItem(),this.renderFilterItems()))}}]),t}(f.default.Component);T.propTypes={onTodayClick:m.default.func,on7DaysClick:m.default.func,onProjectClick:m.default.func,onSelect:m.default.func,inboxPID:m.default.number,teamInboxPID:m.default.number,selected:m.default.PropTypes.shape({menu:m.default.oneOf(["today","7days","project","label","filter"]),id:m.default.oneOfType([m.default.number,m.default.string])}),collaboratorsByPID:m.default.object,projects:m.default.array,labels:m.default.array,filters:m.default.array,todayCount:m.default.number.isRequired,sevenDaysCount:m.default.number.isRequired,overdueCount:m.default.number.isRequired,projectCount:m.default.object.isRequired,labelCount:m.default.object,filterCount:m.default.object,onUnfavorite:m.default.func,clock:m.default.string.isRequired},r.default=T},{"../components/formatter/Formatter":22,"../models/Colors":161,"../utils/fp":477,"./icons":300,classnames:"classnames","prop-types":"prop-types",react:"react"}],214:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),
t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("./reactist/TopNotifier"),p=n(f),m=e("./productivity_stat/TrophyIcon"),h=n(m),v=e("../utils/format"),y=n(v),g=e("../constants/themes"),b=[_("You did it, {user_name}!"),_("Nice work, {user_name}!"),_("Nicely done, {user_name}!"),_("You conquered the week!"),_("Treat yourself. You deserve it, {user_name}!")],w=function(e){var t=(new Date).getDate()%b.length;return(0,y.default)(b[t],{user_name:e})},E=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"shouldComponentUpdate",value:function(e){return this.props.open!==e.open}},{key:"header",value:function(){var e=this.props.goal,t=void 0===e?0:e,r=_n("Weekly goal completed: {num_completed}/{num_goal} task","Weekly goal completed: {num_completed}/{num_goal} tasks",t);return(0,y.default)(r,{num_completed:t,num_goal:t})}},{key:"render",value:function(){var e=this.props,t=e.open,r=void 0!==t&&t,n=e.theme,o=void 0===n?0:n,a=e.userName,i=void 0===a?"":a,s=e.onClick,l=e.onClose,c=(0,g.colorInHex)(o);return o!==g.THEME_SUNFLOWER&&o!==g.THEME_NEUTRAL||(c=(0,g.colorInHex)(g.THEME_NOIR)),o===g.THEME_DARK&&(c=g.DARK_THEME_ICON_COLOR),u.default.createElement(p.default,{open:r,onClose:l,autoHideDuration:6e3,onClick:s},r?u.default.createElement("div",{className:"goal_notifier"},u.default.createElement(h.default,{className:"icon",width:50,color:c}),u.default.createElement("div",{className:"content"},u.default.createElement("h1",null,this.header()),u.default.createElement("p",null,w(i)),u.default.createElement("a",{className:"cta"},_("View Detailed Stats")))):null)}}]),t}(u.default.Component);E.propTypes={theme:d.default.number,userName:d.default.string,goal:d.default.number,open:d.default.bool,onClick:d.default.func,onClose:d.default.func},r.default=E},{"../constants/themes":99,"../utils/format":474,"./productivity_stat/TrophyIcon":335,"./reactist/TopNotifier":345,"prop-types":"prop-types",react:"react"}],215:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.project,r=d.default.getHex("project",t.color),n=p.default.format(t.name);return s.default.createElement("div",{className:"project","data-track":"activity_log|select_project"},s.default.createElement("span",{className:"clickable project_item"},s.default.createElement("span",{className:"project_item__name",dangerouslySetInnerHTML:{__html:n}}),s.default.createElement("span",{className:"project_item__color",style:{backgroundColor:r,color:r}})))}function a(e){var t=e.activity,r=e.user,n=e.isUserPremium,a=t.project,i=t.initiator,l=t.object_type+":"+t.event_type,u=E[l],c=g.getHourAndMin(new Date(t.event_date));return s.default.createElement("li",{className:"event"},s.default.createElement("div",{className:"avatar"},s.default.createElement(h.default,{user:i,size:h.default.SIZE_MEDIUM}),null!=u&&s.default.createElement("div",{className:"avatar_event_icon",dangerouslySetInnerHTML:{__html:u}})),s.default.createElement("div",{className:"text"},s.default.createElement(v.default,{activity:t,user:r,isUserPremium:n}),s.default.createElement("span",{className:"activity_time"},c),null!=a&&s.default.createElement(o,{project:a})))}Object.defineProperty(r,"__esModule",{value:!0});var i=e("react"),s=n(i),l=e("prop-types"),u=n(l),c=e("../../models/Colors"),d=n(c),f=e("../../components/formatter/Formatter"),p=n(f),m=e("../Avatar"),h=n(m),_=e("./ActivityEventContent"),v=n(_),y=window,g=y.DateUtils,b=["added","updated","deleted","completed","uncompleted","archived","unarchived","shared","left"],w=u.default.shape({id:u.default.number.isRequired,object_type:u.default.oneOf(["item","note","project"]).isRequired,event_type:u.default.oneOf(b).isRequired,event_date:u.default.string.isRequired,initiator_id:u.default.number,parent_item_id:u.default.number,parent_project_id:u.default.number,extra_data:u.default.object.isRequired}),E={"item:added":svgs.getString("sm1/notification_assigned.svg"),"item:updated":svgs.getString("sm1/notification_updated.svg"),"item:completed":svgs.getString("sm1/notification_completed.svg"),"item:uncompleted":svgs.getString("sm1/notification_uncompleted.svg"),"item:deleted":svgs.getString("sm1/notification_deleted.svg"),"note:added":svgs.getString("sm1/notification_commented.svg")};a.propTypes={activity:w.isRequired,user:u.default.object.isRequired,isUserPremium:u.default.bool.isRequired},r.default=a},{"../../components/formatter/Formatter":22,"../../models/Colors":161,"../Avatar":197,"./ActivityEventContent":216,"prop-types":"prop-types",react:"react"}],216:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.activity,r=e.user,n=e.isUserPremium,o=t.object_type+":"+t.event_type,a=h[o];if(!a)return console.error("Unsupported activity kind '"+o+"'"),null;var s=null===t.initiator_id||t.initiator_id===r.id?"you":null!=t.initiator?"user":"someone";return i.default.createElement(a,{activity:t,user:r,userNoun:s,isUserPremium:n})}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("./SimpleActivityEventContent"),c=n(u),d=e("./UpdatedActivityEventContent"),f=n(d),p=e("./CommentActivityEventContent"),m=n(p),h={"item:added":c.default,"item:deleted":c.default,"item:completed":c.default,"item:uncompleted":c.default,"item:updated":f.default,"note:added":m.default};o.propTypes={activity:l.default.object,user:l.default.object,isUserPremium:l.default.bool},r.default=o},{"./CommentActivityEventContent":219,"./SimpleActivityEventContent":221,"./UpdatedActivityEventContent":222,"prop-types":"prop-types",react:"react"}],217:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function a(e,t){var r=t.user,n=t.collaborators,o=void 0===n?{}:n,a=t.items,i=void 0===a?{}:a,l=t.projects,u=void 0===l?{}:l;return e.map(function(e){var t=e.initiator_id,n=e.parent_item_id,a=e.parent_project_id,l=e.extra_data.responsible_uid;return s({},e,{initiator:t?o[t]:r,target_user:l?o[l]:void 0,parent_item:n?i[n]:void 0,parent_project:a?u[a]:void 0})})}function i(e){var t=e.user,r=e.isUserPremium,n=e.activities,a=void 0===n?[]:n,i=e.isLoading,s=void 0!==i&&i,c=e.weeksAgoPage,d=void 0===c?1:c,f=e.onLoadMore,m=o(e,["user","isUserPremium","activities","isLoading","weeksAgoPage","onLoadMore"]),h=!s&&0===a.length,y=!r||h,b=j(a,t,m.collaborators,m.items,m.projects),E=Object.keys(b),S=1===d?_("No activity in the past week."):p.default.format(_("No activity in the past {count} weeks."),{count:d});return u.default.createElement("div",{id:"activity_app"},u.default.createElement("div",{id:"activity_show"},y?u.default.createElement(k.default,{isUserPremium:r}):E.map(function(e){return u.default.createElement(l.Fragment,{key:e},u.default.createElement(v.AgendaDayHeader,{isSubsection:!0,dateStr:e}),u.default.createElement("ul",{className:"items",id:"day_ul_"+e},b[e].map(function(e){return u.default.createElement(g.default,{key:e.id,activity:e,user:t,isUserPremium:r})})))}),h&&u.default.createElement("span",{className:"load_more no_results"},S),!y&&u.default.createElement(w.default,{isLoading:s,activities:a,weeksAgoPage:d,onLoadMore:f})))}Object.defineProperty(r,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../../components/format_html/FormatHtml"),p=n(f),m=e("../../utils/fp"),h=e("../../utils"),v=e("../agenda"),y=e("./ActivityEvent"),g=n(y),b=e("./LoadMore"),w=n(b),E=e("./ActivityLogEmptyState"),k=n(E),S=(0,m.compose)((0,m.groupBy)(function(e){return(0,h.toISODateString)(new Date(e.event_date),{toUTC:!0,dateOnly:!0})}),function(e){return e.reverse()},(0,m.sortBy)(function(e){return e.event_date})),j=(0,h.memoize)(function(e,t,r,n,o){return S(a(e,{user:t,collaborators:r,items:n,projects:o}))});i.propTypes={user:d.default.object.isRequired,isUserPremium:d.default.bool,activities:d.default.array,isLoading:d.default.bool,weeksAgoPage:d.default.number,collaborators:d.default.object,items:d.default.object,projects:d.default.object,onLoadMore:d.default.func},i.defaultProps={isUserPremium:!1},r.default=i},{"../../components/format_html/FormatHtml":21,"../../utils":484,"../../utils/fp":477,"../agenda":226,"./ActivityEvent":215,"./ActivityLogEmptyState":218,"./LoadMore":220,"prop-types":"prop-types",react:"react"}],218:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.isUserPremium,r=_("See all changes that have been made in your account, by you or your collaborators.{next_line}Free users can still view their completed tasks inside any project.").split("{next_line}"),n=a(r,2),o=n[0],i=n[1],l=_("<a>Upgrade to Todoist Premium</a> for instant access to this and a lot of other features.").replace("<a>",'<a href="/premium" target="_blank">');return s.default.createElement("div",{className:"blank_state_text"},s.default.createElement("b",null,t?_("You don't have any events"):_("The activity log is a premium feature")),s.default.createElement("div",null,o,s.default.createElement("br",null),i),!t&&s.default.createElement("div",{className:"text"},s.default.createElement("span",{dangerouslySetInnerHTML:{__html:l}})))}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e("react"),s=n(i),l=e("prop-types"),u=n(l);o.propTypes={isUserPremium:u.default.bool.isRequired},r.default=o},{"prop-types":"prop-types",react:"react"}],219:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){var t=e.activity,r=e.userNoun;if("added"!==t.event_type)return null;var n=t.initiator,a=t.extra_data,i=t.parent_item,l=t.parent_project,u=(0,c.renderHtml)($trim(a.content,160),{className:"object",tag:"div",key:"comment"});if(null!=t.parent_item_id){var h,_=i?d:f,v=i?(0,c.renderTask)({activity:i}):void 0,y=(h={},o(h,r,(0,c.renderUser)({user:n,noun:r})),o(h,"task",v),o(h,"comment",u),h);return s.default.createElement("div",null,s.default.createElement(c.Phrase,{template:_[r],values:y}))}if(null!=t.parent_project_id){var g,b=l?p:m,w=(g={},o(g,r,(0,c.renderUser)({user:n,noun:r})),o(g,"project",l?(0,c.renderHtml)(l.name,{className:"object",key:"project"}):void 0),o(g,"comment",u),g);return s.default.createElement("div",null,s.default.createElement(c.Phrase,{template:b[r],values:w}))}return null}Object.defineProperty(r,"__esModule",{value:!0});var i=e("react"),s=n(i),l=e("prop-types"),u=n(l),c=e("./activityEventContentHelpers"),d={you:_("{you} added a comment to {task}: {comment}"),user:_("{user} added a comment to {task}: {comment}"),someone:_("{someone} added a comment to {task}: {comment}")},f={you:_("{you} added a comment: {comment}"),user:_("{user} added a comment: {comment}"),someone:_("{someone} added a comment: {comment}")},p={you:_("{you} added a project comment to {project}: {comment}"),user:_("{user} added a project comment to {project}: {comment}"),someone:_("{someone} added a project comment to {project}: {comment}")},m={you:_("{you} added a project comment: {comment}"),user:_("{user} added a project comment: {comment}"),someone:_("{someone} added a project comment: {comment}")};a.propTypes={activity:u.default.object,userNoun:u.default.string},r.default=a},{"./activityEventContentHelpers":223,"prop-types":"prop-types",react:"react"}],220:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.noMoreResults,r=e.weeksAgoPage;return t?_("That's it. No more history to load."):1===r?_("Load more history from last week..."):p.default.format(_("Load more history from {count} weeks ago..."),{count:r})}function a(e){var t=e.activities,r=e.weeksAgoPage,n=e.onLoadMore,a=e.isLoading;if(void 0!==a&&a)return s.default.createElement(m.DotsSpinner,null);var i=null==n&&t.length>0,l=o({noMoreResults:i,weeksAgoPage:r}),u=(0,d.default)("load_more",{no_more_results:i});return s.default.createElement("span",{className:u,role:"button",tabIndex:0,onClick:n,"data-track":"activity_log|load_more"},l)}Object.defineProperty(r,"__esModule",{value:!0});var i=e("react"),s=n(i),l=e("prop-types"),u=n(l),c=e("classnames"),d=n(c),f=e("../../components/format_html/FormatHtml"),p=n(f),m=e("../spinners");a.propTypes={activities:u.default.array.isRequired,weeksAgoPage:u.default.number,isLoading:u.default.bool,onLoadMore:u.default.func},r.default=a},{"../../components/format_html/FormatHtml":21,"../spinners":401,classnames:"classnames","prop-types":"prop-types",react:"react"}],221:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){var t,r=e.activity,n=e.userNoun,a=e.isUserPremium,i=r.initiator,l=r.extra_data,u=p[r.event_type+"_task"];return s.default.createElement("div",null,s.default.createElement(f.Phrase,{template:u[n],values:(t={},o(t,n,(0,f.renderUser)({user:i,noun:n})),o(t,"task",(0,f.renderTask)({activity:r})),t)}),s.default.createElement(d.default,{noteParent:{id:r.object_id},notesCount:l.note_count,isUserPremium:a}))}Object.defineProperty(r,"__esModule",{value:!0});var i=e("react"),s=n(i),l=e("prop-types"),u=n(l),c=e("../NotesButton"),d=n(c),f=e("./activityEventContentHelpers"),p={added_task:{you:_("{you} added a task: {task}"),user:_("{user} added a task: {task}"),someone:_("{someone} added a task: {task}")},deleted_task:{you:_("{you} deleted a task: {task}"),user:_("{user} deleted a task: {task}"),someone:_("{someone} deleted a task: {task}")},completed_task:{you:_("{you} completed a task: {task}"),user:_("{user} completed a task: {task}"),someone:_("{someone} completed a task: {task}")},uncompleted_task:{you:_("{you} uncompleted a task: {task}"),user:_("{user} uncompleted a task: {task}"),someone:_("{someone} uncompleted a task: {task}")}};a.propTypes={activity:u.default.object,userNoun:u.default.string,isUserPremium:u.default.bool},r.default=a},{"../NotesButton":209,"./activityEventContentHelpers":223,"prop-types":"prop-types",react:"react"}],222:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){var t=e.activity,r=e.user,n=e.userNoun,a=e.isUserPremium,i=t.extra_data,l=t.initiator,u=s.default.createElement(p.default,{noteParent:{id:t.object_id},notesCount:i.note_count,isUserPremium:a});if(void 0!==i.last_content){var c,f=(c={},o(c,n,(0,m.renderUser)({user:l,noun:n})),o(c,"task",(0,m.renderTask)({activity:t})),o(c,"old",(0,m.renderHtml)(i.last_content,{className:"through",key:"old"})),c);return s.default.createElement("div",null,s.default.createElement(m.Phrase,{template:v[n],values:f}),u)}if(void 0!==i.due_date){var _,w=null===i.due_date?g:null===i.last_due_date?y:b,E=(_={},o(_,n,(0,m.renderUser)({user:l,noun:n})),o(_,"task",(0,m.renderTask)({activity:t})),o(_,"due_date",null!==i.due_date&&s.default.createElement(d.default,{key:"due_date",dateStr:i.due_date,overrideClassName:"bold"})),_);return s.default.createElement("div",null,s.default.createElement(m.Phrase,{template:w[n],values:E}),u)}return void 0!==i.responsible_uid?s.default.createElement(h.default,{activity:t,user:r,userNoun:n,notesButton:u}):null}Object.defineProperty(r,"__esModule",{value:!0});var i=e("react"),s=n(i),l=e("prop-types"),u=n(l),c=e("../ItemDueDate"),d=n(c),f=e("../NotesButton"),p=n(f),m=e("./activityEventContentHelpers"),h=n(m),v={you:_("{you} changed the name of {old} to {task}"),user:_("{user} changed the name of {old} to {task}"),someone:_("{someone} changed the name of {old} to {task}")},y={you:_("{you} set the due date of {task} to {due_date}"),user:_("{user} set the due date of {task} to {due_date}"),someone:_("{someone} set the due date of {task} to {due_date}")},g={you:_("{you} removed the due date of {task}"),user:_("{user} removed the due date of {task}"),someone:_("{someone} removed the due date of {task}")},b={you:_("{you} changed the due date of {task} to {due_date}"),user:_("{user} changed the due date of {task} to {due_date}"),someone:_("{someone} changed the due date of {task} to {due_date}")};a.propTypes={activity:u.default.object,user:u.default.object,userNoun:u.default.string,isUserPremium:u.default.bool},r.default=a},{"../ItemDueDate":205,"../NotesButton":209,"./activityEventContentHelpers":223,"prop-types":"prop-types",react:"react"}],223:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function a(e,t){var r=t.tag,n=void 0===r?"span":r,a=o(t,["tag"]),i=p.default.format(e).replace(/^\*\s+/g,"");return d.default.createElement(n,u({},a,{dangerouslySetInnerHTML:{__html:i}}))}function i(e){var t=e.activity;if(!t)return null;var r=t.event_type,n=t.extra_data;return a(t.content||n.content,{className:"deleted"===r||"completed"===r?"object through":"object",key:"task"})}function s(e){var t=e.user,r=e.noun,n=e.key,o=void 0===n?"user":n,a="user"===r||"to_user"===r?p.default.formatSimple(t.full_name.split(" ")[0]):v[r];return d.default.createElement("span",{key:o,className:"user"},a)}function l(e){var t=e.template,r=e.values;return d.default.createElement(c.Fragment,null,h.default.format(t,r))}Object.defineProperty(r,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.renderHtml=a,r.renderTask=i,r.renderUser=s,r.Phrase=l;var c=e("react"),d=n(c),f=e("../../components/formatter/Formatter"),p=n(f),m=e("../../components/format_html/FormatHtml"),h=n(m),v={you:_("You"),someone:_("Someone"),to_someone:_("someone"),to_someone_else:_("someone else"),to_yourself:_("yourself"),to_you:_("you")}},{"../../components/format_html/FormatHtml":21,"../../components/formatter/Formatter":22,react:"react"}],224:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){var t=e.user;return{user:t,items:e.items,projects:e.projects,collaborators:e.collaborators.all,isUserPremium:(0,v.isPremium)(t)}}Object.defineProperty(r,"__esModule",{value:!0}),r.Container=r.ActivityLog=void 0;var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},d=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r.mapStateToProps=u;var f=e("react"),p=n(f),m=e("prop-types"),h=n(m),_=e("react-redux"),v=e("../../reducers/user"),y=e("./ActivityLog"),g=n(y),b=30,w=function(e){function t(){var e,r,n,o;i(this,t);for(var l=arguments.length,u=Array(l),d=0;d<l;d++)u[d]=arguments[d];return r=n=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.state={isLoading:!1,weeksAgoPage:1,offset:0,activities:void 0},n.getRequestParams=function(){var e=n.props,t=e.user,r=e.filterBy,o=n.state,a=o.offset,i=o.weeksAgoPage,s=i<2?void 0:{page:i},l=null!=r.object_type&&null!=r.object_id||null!=r.event_type;return c({},r,{object_event_types:l?void 0:["item:","note:added"],annotate_notes:!0,token:t.token,limit:b,offset:a},s)},n.onLoadMore=function(){n.props.isUserPremium&&(n.setState({isLoading:!0}),fetch("/API/v8.0/activity/get",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n.getRequestParams())}).then(function(e){if(200===e.status)return e.json();throw e}).then(n.processNewData))},n.processNewData=function(e){var t=e.count,r=e.events;n.setState(function(e){var n=e.offset+r.length===t;return{isLoading:!1,offset:n?0:e.offset+b,weeksAgoPage:e.weeksAgoPage+(n?1:0),activities:null!=e.activities?[].concat(a(e.activities),a(r)):r}})},o=r,s(n,o)}return l(t,e),d(t,[{key:"componentDidMount",value:function(){this.onLoadMore()}},{key:"render",value:function(){var e=this.props,t=(e.filterBy,o(e,["filterBy"])),r=this.state,n=r.activities,a=r.weeksAgoPage,i=r.isLoading;return p.default.createElement(g.default,c({},t,{activities:n,isLoading:i,weeksAgoPage:a,onLoadMore:this.onLoadMore}))}}]),t}(f.Component);w.propTypes={user:h.default.object.isRequired,isUserPremium:h.default.bool,items:h.default.object,projects:h.default.object,collaborators:h.default.object,filterBy:h.default.shape({object_type:h.default.oneOf(["project","item","note"]),object_id:h.default.number,event_type:h.default.string,parent_project_id:h.default.number})},w.defaultProps={isUserPremium:!1,items:{},projects:{},collaborators:{},filterBy:{}},r.ActivityLog=g.default,r.Container=w,r.default=(0,_.connect)(u)(w)},{"../../reducers/user":451,"./ActivityLog":217,"prop-types":"prop-types",react:"react","react-redux":"react-redux"}],225:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=m.day_diff(new Date,e),r=0===t?_("Today"):1===t?_("Tomorrow"):p.getWeekDay(e.getDay());try{d.default.query(r)}catch(t){console.error("Error opening the agenda"),window.oldAlert("Should open agenda for "+e.toDateString())}}function a(e){var t=e.dateStr,r=e.isSubsection,n=void 0!==r&&r,a=e.withWeekday,i=void 0===a||a,l=new Date(t);return s.default.createElement("h2",{className:n?"subsection_header":"section_header"},s.default.createElement("span",{role:"button",tabIndex:0,onClick:function(){return o(l)}},p.prettyDate(t)),s.default.createElement("span",{className:"subsection_header__date"},p.formatView(l,i)))}Object.defineProperty(r,"__esModule",{value:!0});var i=e("react"),s=n(i),l=e("prop-types"),u=n(l),c=e("../../components/agenda/AgendaUtils"),d=n(c),f=window,p=f.DateUtils,m=f.DateistDateHelpers;a.propTypes={dateStr:u.default.string.isRequired,isSubsection:u.default.bool,withWeekday:u.default.bool},r.default=a},{"../../components/agenda/AgendaUtils":8,"prop-types":"prop-types",react:"react"}],226:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./AgendaDayHeader");Object.defineProperty(r,"AgendaDayHeader",{enumerable:!0,get:function(){return n(o).default}})},{"./AgendaDayHeader":225}],227:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("react-redux"),d=e("prop-types"),f=n(d),p=e("classnames"),m=n(p),h=e("../../stores/store"),_=n(h),v=e("./EmptyStateFooter"),y=n(v),g=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.emptyState=u.default.createRef(),r.footer=u.default.createRef(),r.state={offsetBottom:null,style:{opacity:e.shouldFadeIn?0:1}},r.setFooterPosition=r.setFooterPosition.bind(r),r.setPosition=r.setPosition.bind(r),r}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;this.positionTimeout=setTimeout(function(){var t=e.footer.current;e.props.isWindowCentered||e.props.isStickyFooterForced?t&&(t.style.position="absolute",e.props.isWindowCentered||(Signals.connect("refresh_interface",e.setFooterPosition),e.setFooterPosition())):t&&(t.style.visibility="visible"),e.props.isWindowCentered&&(Signals.connect("refresh_interface",e.setPosition),e.setPosition()),e.setState({style:{opacity:1}})},0)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.positionTimeout),Signals.disconnect("refresh_interface",this.setPosition)}},{key:"setFooterPosition",value:function(){var e=this.footer.current;if(e){var t=$winSize().h-(this.emptyState.current.offsetTop+this.emptyState.current.offsetHeight)-24;t<e.offsetHeight&&(t=e.offsetHeight+20),e.style.bottom=-t+"px",e.style.marginLeft=-e.offsetWidth/2+"px",e.style.left="50%",e.style.visibility="visible"}}},{key:"setPosition",value:function(){var e=this.emptyState.current,t=.4*$winSize().h-.4*e.offsetHeight;e.style.marginTop=0;var r=t-e.offsetTop;e.style.marginTop=r<0?0:r+"px",this.setFooterPosition()}},{key:"render",value:function(){var e=this,t=(0,m.default)("empty-state",this.props.className);return u.default.createElement(c.Provider,{store:_.default},u.default.createElement("div",{ref:this.emptyState,className:t,style:this.state.style},u.default.Children.map(this.props.children,function(t){return t&&t.type===y.default?u.default.cloneElement(t,{forwardRef:e.footer}):t})))}}]),t}(u.default.PureComponent);g.propTypes={className:f.default.string,isWindowCentered:f.default.bool,isStickyFooterForced:f.default.bool,shouldFadeIn:f.default.bool,children:f.default.node},g.defaultProps={isWindowCentered:!0,isStickyFooterForced:!1,shouldFadeIn:!0},r.default=g},{"../../stores/store":456,"./EmptyStateFooter":230,classnames:"classnames","prop-types":"prop-types",react:"react","react-redux":"react-redux"}],228:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"empty-state-body"},this.props.children)}}]),t}(u.default.PureComponent);f.propTypes={children:d.default.node},r.default=f},{"prop-types":"prop-types",react:"react"}],229:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.children,r=e.onClick;return u.default.createElement("button",{className:"empty-state-button",onClick:r},t)}}]),t}(u.default.PureComponent);f.propTypes={onClick:d.default.func,children:d.default.node},f.defaultProps={onClick:function(){}},r.default=f},{"prop-types":"prop-types",react:"react"}],230:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.children,r=e.forwardRef,n=e.link;return i.default.createElement("a",{className:"empty-state-footer",ref:r,href:n,rel:"noopener noreferrer",target:"_blank"},i.default.createElement(c.default,null),i.default.createElement("span",null,t))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("./icons/HelpIcon"),c=n(u);o.propTypes={forwardRef:l.default.object,link:l.default.string,children:l.default.node},o.propTypes={forwardRef:function(){}},r.default=o},{"./icons/HelpIcon":239,"prop-types":"prop-types",react:"react"}],231:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){
function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"empty-state-header"},this.props.children)}}]),t}(u.default.PureComponent);f.propTypes={children:d.default.node},r.default=f},{"prop-types":"prop-types",react:"react"}],232:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../../../components/themes/Themes"),p=n(f),m=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleThemeChange=r.handleThemeChange.bind(r),r}return i(t,e),s(t,[{key:"componentDidMount",value:function(){Signals.connect("theme_changed",this.handleThemeChange)}},{key:"componentWillUnmount",value:function(){Signals.disconnect("theme_changed",this.handleThemeChange)}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"handleThemeChange",value:function(){this.forceUpdate()}},{key:"render",value:function(){var e=p.default.theme_id_to_name[this.props.theme]||"todoist";return u.default.createElement("div",{className:"empty-state-illustration",dangerouslySetInnerHTML:{__html:svgs.getString("theme_"+e+"/"+this.props.path)}})}}]),t}(u.default.Component);m.propTypes={path:d.default.string.isRequired,theme:d.default.number},r.default=m},{"../../../components/themes/Themes":95,"prop-types":"prop-types",react:"react"}],233:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("react-redux"),o=e("./EmptyStateIllustration"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=function(e){return{theme:e.user.theme}};r.default=(0,n.connect)(i)(a.default)},{"./EmptyStateIllustration":232,"react-redux":"react-redux"}],234:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./container"),o=function(e){return e&&e.__esModule?e:{default:e}}(n);r.default=o.default},{"./container":233}],235:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.children,r=e.link,n=e.onClick;return u.default.createElement("a",{href:r,className:"empty-state-link",onClick:n},t)}}]),t}(u.default.PureComponent);f.propTypes={link:d.default.string,onClick:d.default.func,children:d.default.node},f.defaultProps={link:"#",onClick:function(){}},r.default=f},{"prop-types":"prop-types",react:"react"}],236:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("@doist/reactist/lib/Tooltip"),p=n(f),m=e("./icons/BulbIcon"),h=n(m),_=e("./EmptyStateTooltipContent"),v=n(_),y=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.children,r=e.tips;return u.default.createElement(p.default,{wrapperClassName:"empty-state-tooltip",tooltipClassName:"empty-state-tooltip-content",delayShow:0,position:"top",text:u.default.createElement(v.default,{label:t,tips:r}),gapSize:14},u.default.createElement("span",{className:"empty-state-tooltip-label"},u.default.createElement(h.default,null),u.default.createElement("span",null,t)))}}]),t}(u.default.PureComponent);y.propTypes={tips:d.default.arrayOf(d.default.string),children:d.default.node},v.default.defaultProps={tips:[]},r.default=y},{"./EmptyStateTooltipContent":237,"./icons/BulbIcon":238,"@doist/reactist/lib/Tooltip":189,"prop-types":"prop-types",react:"react"}],237:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("./icons/BulbIcon"),p=n(f),m=e("./icons/TickIcon"),h=n(m),_=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.label,r=e.tips;return u.default.createElement("div",null,u.default.createElement("span",{className:"empty-state-tooltip-header"},u.default.createElement(p.default,null),t),u.default.createElement("ul",{className:"empty-state-tooltip-tips"},r.map(function(e,t){return u.default.createElement("li",{key:t,className:"empty-state-tooltip-tip"},u.default.createElement(h.default,null),u.default.createElement("span",{dangerouslySetInnerHTML:{__html:e}}))})))}}]),t}(u.default.PureComponent);_.propTypes={label:d.default.string.isRequired,tips:d.default.arrayOf(d.default.string)},_.defaultProps={tips:[]},r.default=_},{"./icons/BulbIcon":238,"./icons/TickIcon":240,"prop-types":"prop-types",react:"react"}],238:[function(e,t,r){"use strict";function n(){var e=(0,i.UUID)(),t=(0,i.UUID)();return a.default.createElement("svg",{width:"24",height:"24"},a.default.createElement("defs",null,a.default.createElement("path",{d:"M10.08 16h3.84c.85-2.15 2.58-3.17 2.58-5.5C16.5 8 14.5 6 12 6s-4.5 2-4.5 4.5c0 2.33 1.73 3.35 2.58 5.5zm3.57 1h-3.3l.37 1.84c.02.1.1.16.2.16h2.17a.2.2 0 0 0 .2-.16l.36-1.84zm-5.46-2.32l-.42-.62c-.88-1.29-1.27-2.24-1.27-3.56C6.5 7.45 8.95 5 12 5s5.5 2.45 5.5 5.5c0 1.32-.4 2.27-1.27 3.56l-.42.62c-.59.85-.9 1.4-1.08 2.02l-.47 2.34c-.1.56-.6.96-1.17.96H10.9a1.2 1.2 0 0 1-1.17-.96l-.46-2.3a7.23 7.23 0 0 0-1.09-2.06zm13.24-.82a.5.5 0 1 1-.38.93l-1.85-.77a.5.5 0 0 1 .38-.92l1.85.76zM19.58 7.9a.5.5 0 0 1-.38-.92l1.85-.77a.5.5 0 1 1 .38.93l-1.85.76zm-4.06-4.6a.5.5 0 0 1-.92-.38l.76-1.85a.5.5 0 1 1 .93.38l-.77 1.85zM9.4 2.92a.5.5 0 0 1-.92.38L7.7 1.45a.5.5 0 1 1 .93-.38l.76 1.85zM4.8 6.98a.5.5 0 0 1-.38.92l-1.85-.76a.5.5 0 1 1 .38-.93l1.85.77zm-1.85 7.8a.5.5 0 0 1-.38-.92l1.85-.76a.5.5 0 0 1 .38.92l-1.85.77z",id:e})),a.default.createElement("g",{fill:"none",fillRule:"evenodd"},a.default.createElement("path",{d:"M0 0h24v24H0z"}),a.default.createElement("mask",{id:t,fill:"#fff"},a.default.createElement("use",{xlinkHref:"#"+e})),a.default.createElement("g",{mask:"url(#"+t+")",fill:"#FF9233"},a.default.createElement("path",{d:"M0 0h24.12v24.12H0z"}))))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=e("../../../components/misc/Util")},{"../../../components/misc/Util":44,react:"react"}],239:[function(e,t,r){"use strict";function n(){return a.default.createElement("svg",{width:"17",height:"17"},a.default.createElement("path",{d:"M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16zm0-1A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm-.1-2.5c-.46 0-.8-.35-.8-.85s.34-.86.8-.86c.48 0 .8.36.8.86s-.32.85-.8.85zM5.5 5.87c.06-1.32.9-2.37 2.53-2.37 1.47 0 2.47.95 2.47 2.21 0 .96-.47 1.64-1.22 2.11-.73.46-.94.8-.94 1.45v.4H7.32V9.1c0-.8.37-1.36 1.16-1.86.68-.43.94-.82.94-1.47 0-.76-.56-1.32-1.43-1.32-.87 0-1.43.55-1.5 1.42H5.5z",id:"tick-a"}))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o)},{react:"react"}],240:[function(e,t,r){"use strict";function n(){return a.default.createElement("svg",{width:"24",height:"24"},a.default.createElement("path",{d:"M7.35 12.15a.5.5 0 0 0-.7.7l3 3c.2.2.5.2.7 0l7-7a.5.5 0 1 0-.7-.7L10 14.79l-2.65-2.64z",fill:"#000",fillRule:"nonzero",fillOpacity:".54"}))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o)},{react:"react"}],241:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./states/FilterIncorrect");Object.defineProperty(r,"EmptyStateFilterIncorrect",{enumerable:!0,get:function(){return n(o).default}});var a=e("./states/FilterNew");Object.defineProperty(r,"EmptyStateFilterNew",{enumerable:!0,get:function(){return n(a).default}});var i=e("./states/FilterZero");Object.defineProperty(r,"EmptyStateFilterZero",{enumerable:!0,get:function(){return n(i).default}});var s=e("./states/InboxNew");Object.defineProperty(r,"EmptyStateInboxNew",{enumerable:!0,get:function(){return n(s).default}});var l=e("./states/InboxZero");Object.defineProperty(r,"EmptyStateInboxZero",{enumerable:!0,get:function(){return n(l).default}});var u=e("./states/LabelNew");Object.defineProperty(r,"EmptyStateLabelNew",{enumerable:!0,get:function(){return n(u).default}});var c=e("./states/LabelZero");Object.defineProperty(r,"EmptyStateLabelZero",{enumerable:!0,get:function(){return n(c).default}});var d=e("./states/Next7Days");Object.defineProperty(r,"EmptyStateNext7Days",{enumerable:!0,get:function(){return n(d).default}});var f=e("./states/Notifications");Object.defineProperty(r,"EmptyStateNotifications",{enumerable:!0,get:function(){return n(f).default}});var p=e("./states/Productivity");Object.defineProperty(r,"EmptyStateProductivity",{enumerable:!0,get:function(){return n(p).default}});var m=e("./states/ProjectCelebration");Object.defineProperty(r,"EmptyStateProjectCelebration",{enumerable:!0,get:function(){return n(m).default}});var h=e("./states/ProjectComments");Object.defineProperty(r,"EmptyStateProjectComments",{enumerable:!0,get:function(){return n(h).default}});var _=e("./states/ProjectNew");Object.defineProperty(r,"EmptyStateProjectNew",{enumerable:!0,get:function(){return n(_).default}});var v=e("./states/ProjectZero");Object.defineProperty(r,"EmptyStateProjectZero",{enumerable:!0,get:function(){return n(v).default}});var y=e("./states/SearchResults");Object.defineProperty(r,"EmptyStateSearchResults",{enumerable:!0,get:function(){return n(y).default}});var g=e("./states/Sharing");Object.defineProperty(r,"EmptyStateSharing",{enumerable:!0,get:function(){return n(g).default}});var b=e("./states/TaskComments");Object.defineProperty(r,"EmptyStateTaskComments",{enumerable:!0,get:function(){return n(b).default}});var w=e("./states/TodayDayOff");Object.defineProperty(r,"EmptyStateTodayDayOff",{enumerable:!0,get:function(){return n(w).default}});var E=e("./states/TodayDefault");Object.defineProperty(r,"EmptyStateTodayDefault",{enumerable:!0,get:function(){return n(E).default}});var k=e("./states/TodayNew");Object.defineProperty(r,"EmptyStateTodayNew",{enumerable:!0,get:function(){return n(k).default}});var S=e("./states/TodayVacation");Object.defineProperty(r,"EmptyStateTodayVacation",{enumerable:!0,get:function(){return n(S).default}});var j=e("./states/TodayZero");Object.defineProperty(r,"EmptyStateTodayZero",{enumerable:!0,get:function(){return n(j).default}})},{"./states/FilterIncorrect":242,"./states/FilterNew":243,"./states/FilterZero":244,"./states/InboxNew":245,"./states/InboxZero":246,"./states/LabelNew":247,"./states/LabelZero":248,"./states/Next7Days":249,"./states/Notifications":250,"./states/Productivity":251,"./states/ProjectCelebration":252,"./states/ProjectComments":253,"./states/ProjectNew":254,"./states/ProjectZero":255,"./states/SearchResults":256,"./states/Sharing":257,"./states/TaskComments":258,"./states/TodayDayOff":259,"./states/TodayDefault":260,"./states/TodayNew":261,"./states/TodayVacation":262,"./states/TodayZero":265}],242:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.query,r=e.symbol,n=e.onButtonClick,o=[_("See all your tasks for the month ahead (query: <b>30 days</b>)"),_("Focus on the most important things you need to do today (query: <b>today & p1</b>)"),_("View tasks that are waiting on something else for them to be completed (query: <b>@pending</b>)")],a=r?_("That filter query isn't quite right:"):_("Sorry, Todoist couldn't understand that filter query.");return i.default.createElement(f.default,null,i.default.createElement(k.default,{path:"incorrect_filter_query.svg"}),i.default.createElement(w.default,null,a),r&&i.default.createElement(m.default,null,(0,c.default)(_('Todoist didn\'t recognize "{string}" in "{query}".'),{query:t,string:r})),i.default.createElement(v.default,{onClick:n},_("Edit Query")),i.default.createElement(j.default,{tips:o},_("Filter examples")),i.default.createElement(g.default,{link:"https://support.todoist.com/hc/articles/205248842"},_("How to create filters")))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("../../../utils/format"),c=n(u),d=e("../EmptyState"),f=n(d),p=e("../EmptyStateBody"),m=n(p),h=e("../EmptyStateButton"),v=n(h),y=e("../EmptyStateFooter"),g=n(y),b=e("../EmptyStateHeader"),w=n(b),E=e("../EmptyStateIllustration"),k=n(E),S=e("../EmptyStateTooltip"),j=n(S);o.propTypes={query:l.default.string,symbol:l.default.string,onButtonClick:l.default.func},o.defaultProps={onButtonClick:function(){}},r.default=o},{"../../../utils/format":474,"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateButton":229,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,"../EmptyStateTooltip":236,"prop-types":"prop-types",react:"react"}],243:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){var e=[_("See today's highest priority tasks using <b>Today & P1</b>."),_("View unscheduled tasks using <b>No date</b>."),_("Preview the month ahead using <b>30 days</b>."),_("Review every task <b>Assigned to:me</b>.")];return i.default.createElement(l.default,null,i.default.createElement(v.default,{path:"filter.svg"}),i.default.createElement(m.default,null,_("No tasks in this filter at the moment")),i.default.createElement(c.default,null,_("Create custom task views filtered by priority, label, due date, and more.")),i.default.createElement(g.default,{tips:e},_("How can I use filters?")),i.default.createElement(f.default,{link:"https://support.todoist.com/hc/articles/360000031059"},_("How to best use filters")))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("../EmptyState"),l=n(s),u=e("../EmptyStateBody"),c=n(u),d=e("../EmptyStateFooter"),f=n(d),p=e("../EmptyStateHeader"),m=n(p),h=e("../EmptyStateIllustration"),v=n(h),y=e("../EmptyStateTooltip"),g=n(y)},{"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,"../EmptyStateTooltip":236,react:"react"}],244:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){return i.default.createElement(l.default,null,i.default.createElement(m.default,{path:"filter.svg"}),i.default.createElement(f.default,null,_("No tasks in this filter at the moment")),i.default.createElement(c.default,{link:"https://support.todoist.com/hc/articles/360000031059"},_("How to best use filters")))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("../EmptyState"),l=n(s),u=e("../EmptyStateFooter"),c=n(u),d=e("../EmptyStateHeader"),f=n(d),p=e("../EmptyStateIllustration"),m=n(p)},{"../EmptyState":227,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,react:"react"}],245:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../../../stores/store"),p=n(f),m=e("../EmptyState"),h=n(m),v=e("../EmptyStateBody"),y=n(v),g=e("../EmptyStateButton"),b=n(g),w=e("../EmptyStateFooter"),E=n(w),k=e("../EmptyStateHeader"),S=n(k),j=e("../EmptyStateIllustration"),T=n(j),O=e("../../../reducers/tooltip"),I=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"componentDidMount",value:function(){p.default.dispatch((0,O.markSeen)(O.TOOLTIP_EMPTY_STATE_INBOX))}},{key:"render",value:function(){return u.default.createElement(h.default,null,u.default.createElement(T.default,{path:"inbox_new.svg"}),u.default.createElement(S.default,null,_("Declutter your mind")),u.default.createElement(y.default,null,_("Not sure where to organize a new task? Add it to your Inbox and come back to it later.")),u.default.createElement(b.default,{onClick:this.props.onButtonClick},_("Add a task")),u.default.createElement(E.default,{link:"https://support.todoist.com/hc/articles/360000028960"},_("How to best use the Inbox")))}}]),t}(u.default.PureComponent);I.propTypes={onButtonClick:d.default.func},I.defaultProps={onButtonClick:function(){}},r.default=I},{"../../../reducers/tooltip":448,"../../../stores/store":456,"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateButton":229,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,"prop-types":"prop-types",react:"react"}],246:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return i.default.createElement(c.default,null,i.default.createElement(w.default,{path:"inbox_zero.svg"}),i.default.createElement(g.default,null,_("All clear")),i.default.createElement(f.default,null,_("Looks like everything's organized in the right place.")),i.default.createElement(m.default,{onClick:e.onButtonClick},_("Add a task")),i.default.createElement(v.default,{link:"https://support.todoist.com/hc/articles/360000028960"},_("How to best use the Inbox")))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("../EmptyState"),c=n(u),d=e("../EmptyStateBody"),f=n(d),p=e("../EmptyStateButton"),m=n(p),h=e("../EmptyStateFooter"),v=n(h),y=e("../EmptyStateHeader"),g=n(y),b=e("../EmptyStateIllustration"),w=n(b);o.propTypes={onButtonClick:l.default.func},o.defaultProps={onButtonClick:function(){}},r.default=o},{"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateButton":229,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,"prop-types":"prop-types",react:"react"}],247:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){var e=[_("Focus on <b>@work</b> tasks only."),_("See your most <b>@important</b> tasks."),_("Find out what's <b>@in_progress</b>."),_("Get a quick view of your <b>@errand</b> tasks.")];return i.default.createElement(l.default,null,i.default.createElement(v.default,{path:"label.svg"}),i.default.createElement(m.default,null,_("No tasks with this label at the moment")),i.default.createElement(c.default,null,_("Categorize your tasks with labels so you can focus on the right tasks at the right time.")),i.default.createElement(g.default,{tips:e},_("How can I use labels?")),i.default.createElement(f.default,{link:"https://support.todoist.com/hc/articles/360000029000"},_("How to best use labels")))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("../EmptyState"),l=n(s),u=e("../EmptyStateBody"),c=n(u),d=e("../EmptyStateFooter"),f=n(d),p=e("../EmptyStateHeader"),m=n(p),h=e("../EmptyStateIllustration"),v=n(h),y=e("../EmptyStateTooltip"),g=n(y)},{"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,"../EmptyStateTooltip":236,react:"react"}],248:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){return i.default.createElement(l.default,null,i.default.createElement(m.default,{path:"label.svg"}),i.default.createElement(f.default,null,_("No tasks with this label at the moment")),i.default.createElement(c.default,{link:"https://support.todoist.com/hc/articles/360000029000"},_("How to best use labels")))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("../EmptyState"),l=n(s),u=e("../EmptyStateFooter"),c=n(u),d=e("../EmptyStateHeader"),f=n(d),p=e("../EmptyStateIllustration"),m=n(p)},{"../EmptyState":227,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,react:"react"}],249:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("../../../stores/store"),d=n(c),f=e("../EmptyState"),p=n(f),m=e("../EmptyStateBody"),h=n(m),v=e("../EmptyStateFooter"),y=n(v),g=e("../EmptyStateHeader"),b=n(g),w=e("../EmptyStateIllustration"),E=n(w),k=e("../../../reducers/tooltip"),S=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"componentDidMount",value:function(){d.default.dispatch((0,k.markSeen)(k.TOOLTIP_EMPTY_STATE_NEXT_7DAYS))}},{key:"render",value:function(){return u.default.createElement(p.default,{className:"empty-state-7days",isWindowCentered:!1},u.default.createElement(E.default,{path:"next7_days.svg"}),u.default.createElement(b.default,null,_("Get a bird's eye view of your week")),u.default.createElement(h.default,null,_("This is your timeline for the next 7 days. You can drag and drop tasks between days to change their due date.")),u.default.createElement(y.default,{link:"https://support.todoist.com/hc/articles/360000031019"},_("How to plan your week")))}}]),t}(u.default.PureComponent);r.default=S},{"../../../reducers/tooltip":448,"../../../stores/store":456,"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,react:"react"}],250:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){return i.default.createElement(l.default,{isWindowCentered:!1},i.default.createElement(v.default,{path:"notifications.svg"}),i.default.createElement(m.default,null,_("Stay up-to-date")),i.default.createElement(c.default,null,_("Get notified here about changes in your shared projects.")),i.default.createElement(f.default,{link:"https://support.todoist.com/hc/articles/360000269065"},_("Learn about notifications")))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("../EmptyState"),l=n(s),u=e("../EmptyStateBody"),c=n(u),d=e("../EmptyStateFooter"),f=n(d),p=e("../EmptyStateHeader"),m=n(p),h=e("../EmptyStateIllustration"),v=n(h)},{"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,react:"react"}],251:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return i.default.createElement(c.default,{className:"empty-state-productivity",isWindowCentered:!1},i.default.createElement(w.default,{path:"productivity.svg"}),i.default.createElement(g.default,null,_("See tangible progress")),i.default.createElement(f.default,null,_("Set daily and weekly goals, review your productivity trends, and watch your Karma points grow.")),i.default.createElement(m.default,{onClick:e.onButtonClick},_("Set your goals")),i.default.createElement(v.default,{link:"https://support.todoist.com/hc/articles/206209959"},_("Learn about Karma")))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("../EmptyState"),c=n(u),d=e("../EmptyStateBody"),f=n(d),p=e("../EmptyStateButton"),m=n(p),h=e("../EmptyStateFooter"),v=n(h),y=e("../EmptyStateHeader"),g=n(y),b=e("../EmptyStateIllustration"),w=n(b);o.propTypes={onButtonClick:l.default.func},o.defaultProps={onButtonClick:function(){}},r.default=o},{"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateButton":229,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,"prop-types":"prop-types",react:"react"}],252:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.onButtonClick,r=e.onLinkClick;return i.default.createElement(c.default,null,i.default.createElement(g.default,{path:"project_celebration.svg"}),i.default.createElement(v.default,null,_("Nothing left to do in this project")),i.default.createElement(f.default,null,_("Nice work!")),i.default.createElement(m.default,{onClick:t},_("Add a task")),i.default.createElement(w.default,{onClick:r},_("Archive project")))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("../EmptyState"),c=n(u),d=e("../EmptyStateBody"),f=n(d),p=e("../EmptyStateButton"),m=n(p),h=e("../EmptyStateHeader"),v=n(h),y=e("../EmptyStateIllustration"),g=n(y),b=e("../EmptyStateLink"),w=n(b);o.propTypes={onButtonClick:l.default.func,onLinkClick:l.default.func},o.defaultProps={onButtonClick:function(){},onLinkClick:function(){}},r.default=o},{"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateButton":229,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,"../EmptyStateLink":235,"prop-types":"prop-types",react:"react"}],253:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){return i.default.createElement(l.default,{isWindowCentered:!1},i.default.createElement(f.default,{path:"project_comments.svg"}),i.default.createElement(c.default,null,_("Keep high-level information organized in one place with project comments.")))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("../EmptyState"),l=n(s),u=e("../EmptyStateBody"),c=n(u),d=e("../EmptyStateIllustration"),f=n(d)},{"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateIllustration":234,react:"react"}],254:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){var e=[_("Separate work tasks from personal ones."),_("Create a step-by-step plan toward a goal."),_("Collaborate with teammates."),_("Share a to-do list with a loved one."),_("Save things to read or watch later.")];return i.default.createElement(l.default,{className:"empty-state-project-new"},i.default.createElement(v.default,{path:"project_new.svg"}),i.default.createElement(m.default,null,_("Keep your tasks organized in projects")),i.default.createElement(c.default,null,_("Group your tasks by goal or area of your life. Drag and drop to rearrange tasks or create sub-tasks.")),i.default.createElement(g.default,{tips:e},_("How can I use projects?")),i.default.createElement(f.default,{link:"https://support.todoist.com/hc/articles/360000031039"},_("How to best use projects")))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("../EmptyState"),l=n(s),u=e("../EmptyStateBody"),c=n(u),d=e("../EmptyStateFooter"),f=n(d),p=e("../EmptyStateHeader"),m=n(p),h=e("../EmptyStateIllustration"),v=n(h),y=e("../EmptyStateTooltip"),g=n(y)},{"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,
"../EmptyStateTooltip":236,react:"react"}],255:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return i.default.createElement(c.default,null,i.default.createElement(g.default,{path:"project_zero.svg"}),i.default.createElement(v.default,null,_("What will you accomplish?")),i.default.createElement(f.default,{onClick:e.onButtonClick},_("Add a task")),i.default.createElement(m.default,{link:"https://support.todoist.com/hc/articles/360000031039"},_("How to best use projects")))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("../EmptyState"),c=n(u),d=e("../EmptyStateButton"),f=n(d),p=e("../EmptyStateFooter"),m=n(p),h=e("../EmptyStateHeader"),v=n(h),y=e("../EmptyStateIllustration/"),g=n(y);o.propTypes={onButtonClick:l.default.func},o.defaultProps={onButtonClick:function(){}},r.default=o},{"../EmptyState":227,"../EmptyStateButton":229,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration/":234,"prop-types":"prop-types",react:"react"}],256:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.headerText,r=e.onButtonClick,n=e.shouldFadeIn,o=e.withAction,a=[_("<b>date</b> to find all tasks with that due date"),_("<b>p1</b> to find all tasks with priority 1"),_("<b>@label</b> to find all tasks with that label")];return i.default.createElement(c.default,{className:"empty-state-search",isWindowCentered:!1,shouldFadeIn:n,isStickyFooterForced:!0},i.default.createElement(g.default,{path:"search_results.svg"}),i.default.createElement(v.default,null,t),o&&i.default.createElement(f.default,{onClick:r},_("Search completed tasks")),i.default.createElement(w.default,{tips:a},_("Refine your search with queries")),i.default.createElement(m.default,{link:"https://support.todoist.com/hc/articles/360000394949"},_("How to best use search")))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("../EmptyState"),c=n(u),d=e("../EmptyStateButton"),f=n(d),p=e("../EmptyStateFooter"),m=n(p),h=e("../EmptyStateHeader"),v=n(h),y=e("../EmptyStateIllustration"),g=n(y),b=e("../EmptyStateTooltip"),w=n(b);o.propTypes={headerText:l.default.string.isRequired,withAction:l.default.bool,shouldFadeIn:l.default.bool,onButtonClick:l.default.func},o.defaultProps={withAction:!0,shouldFadeIn:!0,onButtonClick:function(){}},r.default=o},{"../EmptyState":227,"../EmptyStateButton":229,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,"../EmptyStateTooltip":236,"prop-types":"prop-types",react:"react"}],257:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){return i.default.createElement(l.default,{isWindowCentered:!1},i.default.createElement(v.default,{path:"sharing.svg"}),i.default.createElement(m.default,null,_("Organize work together")),i.default.createElement(c.default,null,_("Assign tasks and due dates, discuss details in task comments, and keep everyone on the same page.")),i.default.createElement(f.default,{link:"https://support.todoist.com/hc/articles/360000031079"},_("How to collaborate with others")))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("../EmptyState"),l=n(s),u=e("../EmptyStateBody"),c=n(u),d=e("../EmptyStateFooter"),f=n(d),p=e("../EmptyStateHeader"),m=n(p),h=e("../EmptyStateIllustration"),v=n(h)},{"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,react:"react"}],258:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){return i.default.createElement(l.default,{isWindowCentered:!1},i.default.createElement(f.default,{path:"task_comments.svg"}),i.default.createElement(c.default,null,_("Add relevant notes, links, files, photos, or anything else here.")))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("../EmptyState"),l=n(s),u=e("../EmptyStateBody"),c=n(u),d=e("../EmptyStateIllustration"),f=n(d)},{"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateIllustration":234,react:"react"}],259:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){return i.default.createElement(l.default,null,i.default.createElement(m.default,{path:"today_off.svg"}),i.default.createElement(f.default,null,_("Enjoy your day off")),i.default.createElement(c.default,{link:"https://support.todoist.com/hc/articles/360000410829#Settings"},_("Learn more about Days Off")))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("../EmptyState"),l=n(s),u=e("../EmptyStateFooter"),c=n(u),d=e("../EmptyStateHeader"),f=n(d),p=e("../EmptyStateIllustration"),m=n(p)},{"../EmptyState":227,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,react:"react"}],260:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return i.default.createElement(c.default,null,i.default.createElement(g.default,{path:"today.svg"}),i.default.createElement(v.default,null,_("What tasks are on your mind?")),i.default.createElement(f.default,{onClick:e.onButtonClick},_("Add a task")),i.default.createElement(m.default,{link:"https://support.todoist.com/hc/articles/360000030999"},_("How to plan your day")))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("../EmptyState"),c=n(u),d=e("../EmptyStateButton"),f=n(d),p=e("../EmptyStateFooter"),m=n(p),h=e("../EmptyStateHeader"),v=n(h),y=e("../EmptyStateIllustration"),g=n(y);o.propTypes={onButtonClick:l.default.func},o.defaultProps={onButtonClick:function(){}},r.default=o},{"../EmptyState":227,"../EmptyStateButton":229,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,"prop-types":"prop-types",react:"react"}],261:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=[_("Each morning, take a few minutes to clear your mind and plan your day."),_("Decide what you can do today and postpone the rest for later."),_("Set priorities and start with your most important task first.")];return i.default.createElement(c.default,null,i.default.createElement(w.default,{path:"today_new.svg"}),i.default.createElement(g.default,null,_("Get a clear view of the day ahead")),i.default.createElement(f.default,null,_("All your tasks that are due today will show up here.")),i.default.createElement(m.default,{onClick:e.onButtonClick},_("Add a task")),i.default.createElement(k.default,{tips:t},_("Establish a daily habit")),i.default.createElement(v.default,{link:"https://support.todoist.com/hc/articles/360000030999"},_("How to plan your day")))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("../EmptyState"),c=n(u),d=e("../EmptyStateBody"),f=n(d),p=e("../EmptyStateButton"),m=n(p),h=e("../EmptyStateFooter"),v=n(h),y=e("../EmptyStateHeader"),g=n(y),b=e("../EmptyStateIllustration"),w=n(b),E=e("../EmptyStateTooltip"),k=n(E);o.propTypes={onButtonClick:l.default.func},o.defaultProps={onButtonClick:function(){}},r.default=o},{"../EmptyState":227,"../EmptyStateBody":228,"../EmptyStateButton":229,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,"../EmptyStateTooltip":236,"prop-types":"prop-types",react:"react"}],262:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){return i.default.createElement(c.default,null,i.default.createElement(v.default,{path:"today_vacation.svg"}),i.default.createElement(m.default,null,_("Enjoy your time away")),i.default.createElement(g.default,{onClick:e.onButtonClick},_("Turn off Vacation Mode")),i.default.createElement(f.default,{link:"https://support.todoist.com/hc/articles/208044525"},_("Learn more about Vacation Mode")))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("../EmptyState"),c=n(u),d=e("../EmptyStateFooter"),f=n(d),p=e("../EmptyStateHeader"),m=n(p),h=e("../EmptyStateIllustration"),v=n(h),y=e("../EmptyStateLink"),g=n(y);o.propTypes={onButtonClick:l.default.func},o.defaultProps={onButtonClick:function(){}},r.default=o},{"../EmptyState":227,"../EmptyStateFooter":230,"../EmptyStateHeader":231,"../EmptyStateIllustration":234,"../EmptyStateLink":235,"prop-types":"prop-types",react:"react"}],263:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.completedTodayCount,r=e.uncompletedSevenDaysCount,n=e.onFacebookClick,o=e.onProductivityClick,a=e.onTwitterClick,s=new Date,l=s.getHours(),u=void 0,d=void 0,p=void 0;return u=l>=4&&l<12?_("Enjoy your day."):l>=12&&l<20?_("Enjoy your afternoon."):_("Enjoy your night."),t>=5?(d=u,p=i.default.createElement("span",{onClick:o},_("Today you completed %s tasks and reached #TodoistZero!").replace("%s",t))):(d=0===r?_("You're all done for the week! #TodoistZero"):_("You're all done for today! #TodoistZero"),p=u),i.default.createElement(c.default,null,i.default.createElement(v.default,{path:"today_zero.svg"}),i.default.createElement(f.default,null,d),p&&i.default.createElement(m.default,null,p),i.default.createElement("div",{className:"sharing"},i.default.createElement("span",{className:"sharing-twitter",dangerouslySetInnerHTML:{__html:svgs.getString("sm1/twitter.svg")},onClick:a}),i.default.createElement("span",{className:"sharing-facebook",dangerouslySetInnerHTML:{__html:svgs.getString("sm1/facebook.svg")},onClick:n})))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("../../EmptyState"),c=n(u),d=e("../../EmptyStateHeader"),f=n(d),p=e("../../EmptyStateBody"),m=n(p),h=e("../../EmptyStateIllustration"),v=n(h);o.propTypes={completedTodayCount:l.default.number,uncompletedSevenDaysCount:l.default.number,onFacebookClick:l.default.func,onProductivityClick:l.default.func,onTwitterClick:l.default.func},o.defaultProps={completedTodayCount:0,uncompletedSevenDaysCount:0,onFacebookClick:function(){},onProductivityClick:function(){},onTwitterClick:function(){}},r.default=o},{"../../EmptyState":227,"../../EmptyStateBody":228,"../../EmptyStateHeader":231,"../../EmptyStateIllustration":234,"prop-types":"prop-types",react:"react"}],264:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("react-redux"),o=e("../../../../reducers/counts"),a=e("../../../../reducers/stats"),i=e("./TodayZero"),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(e){return{completedTodayCount:(0,a.completedToday)(e),uncompletedSevenDaysCount:(0,o.countSevenDays)(e)}};r.default=(0,n.connect)(l)(s.default)},{"../../../../reducers/counts":408,"../../../../reducers/stats":446,"./TodayZero":263,"react-redux":"react-redux"}],265:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./container"),o=function(e){return e&&e.__esModule?e:{default:e}}(n);r.default=o.default},{"./container":264}],266:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("../../utils"),u=e("react"),c=n(u),d=e("prop-types"),f=n(d),p=e("../icons"),m=e("../ColorPicker"),h=n(m),v=e("../Button"),y=n(v),g=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={name:e.name||"",query:e.query||"",color:void 0===e.color?7:e.color},r.onNameChange=r.onNameChange.bind(r),r.onQueryChange=r.onQueryChange.bind(r),r.handleSubmit=r.handleSubmit.bind(r),r.onInputKeyDown=r.onInputKeyDown.bind(r),r}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.nameInput.focus()}},{key:"onNameChange",value:function(e){this.setState({name:e.target.value})}},{key:"onQueryChange",value:function(e){this.setState({query:e.target.value})}},{key:"onInputKeyDown",value:function(e){e.keyCode==l.ASCII.ESC&&this.props.onCancel()}},{key:"validate",value:function(){var e=this;if(!this.props.inputValidator)return!0;var t=this.props.inputValidator(this.state);if(!t)return!0;var r=(0,l.keys)(t)[0],n=t[r];return alert(n,function(){"name"==r&&e.nameInput.focus(),"query"==r&&e.queryInput.focus()}),!1}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.validate()&&this.props.onSubmit(this.state.name,this.state.query,this.state.color)}},{key:"render",value:function(){var e=this,t=this.props.name&&this.props.query;return c.default.createElement("form",{className:"FilterEditor",onSubmit:this.handleSubmit},c.default.createElement("table",{width:"100%"},c.default.createElement("tbody",null,c.default.createElement("tr",null,c.default.createElement("td",{colSpan:"2",className:"form_content"},c.default.createElement("table",null,c.default.createElement("tbody",null,c.default.createElement("tr",null,c.default.createElement("td",{className:"text_box_holder"},c.default.createElement(h.default,{color:this.state.color,onChange:function(t){return e.setState({color:t})}},c.default.createElement(p.FilterIcon,null)),c.default.createElement("span",{className:"desc"},_("Name your filter")),c.default.createElement("input",{tabIndex:"1",type:"text",value:this.state.name,onChange:this.onNameChange,className:"input_name",onKeyDown:this.onInputKeyDown,ref:function(t){e.nameInput=t}}),c.default.createElement("span",{className:"desc"},_("Query:")),c.default.createElement("input",{type:"text",name:"ta_query",className:"query",tabIndex:"2",autoComplete:"off",placeholder:_("Filter query"),value:this.state.query,onChange:this.onQueryChange,onKeyDown:this.onInputKeyDown,ref:function(t){e.queryInput=t}}),c.default.createElement("a",{href:"/Help/Filtering",className:"help_icon",target:"_blank","data-track":"filters|add_or_edit_help"},c.default.createElement(p.HelpIcon,null)))))))))),c.default.createElement("table",{className:"td_submit_area"},c.default.createElement("tbody",null,c.default.createElement("tr",null,c.default.createElement("td",{className:"td_submit"},c.default.createElement(y.default,{"data-track":t?"filters|edit_confirm":"filters|add_confirm",tabIndex:"3",type:"submit",className:"ist_button ist_button_red submit_btn"},this.props.submitBtnStr),c.default.createElement(y.default,{element:"span",className:"cancel",tabIndex:"4",onClick:this.props.onCancel,"data-track":t?"filters|edit_cancel":"filters|add_cancel"},_("Cancel"))),c.default.createElement("td",{className:"td_extra"})))))}}]),t}(c.default.Component);g.propTypes={isPremium:f.default.bool,name:f.default.string,query:f.default.string,submitBtnStr:f.default.string,color:f.default.number,onCancel:f.default.func.isRequired,inputValidator:f.default.func,onSubmit:f.default.func.isRequired},g.defaultProps={submitBtnStr:_("Add Filter")},r.default=g},{"../../utils":484,"../Button":198,"../ColorPicker":199,"../icons":300,"prop-types":"prop-types",react:"react"}],267:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("../../utils"),u=e("prop-types"),c=n(u),d=e("react"),f=n(d),p=e("classnames"),m=n(p),h=e("../../utils/format"),v=n(h),y=e("../../components/formatter/Formatter.js"),g=n(y),b=e("./FilterListItemSortable"),w=n(b),E=e("./FilterListItemDragLayer"),k=n(E),S=e("./FilterEditor"),j=n(S),T=e("../icons/PlusIcon"),O=n(T),I=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleShowEditorStream=function(e){r.props.onAddClick&&!r.props.onAddClick()||r.setState(function(){return{showAddEditor:e}})},r.onFavoriteClick=function(e){r.props.onFavoriteClick&&r.props.onFavoriteClick(e)},r.state={filters:e.filters,selectedItemID:null,inEditFilterID:null,showAddEditor:!1,isDragging:!1},r.filtersBeforeDrag=null,r.moveItem=r.moveItem.bind(r),r.findIndex=r.findIndex.bind(r),r.dragBegin=r.dragBegin.bind(r),r.dragEnd=r.dragEnd.bind(r),r.selectItem=r.selectItem.bind(r),r.handleAddLinkClick=r.handleAddLinkClick.bind(r),r.hideAddEditor=r.hideAddEditor.bind(r),r.onFilterAdd=r.onFilterAdd.bind(r),r.onEditClick=r.onEditClick.bind(r),r.onDelClick=r.onDelClick.bind(r),r.validateEditorInput=r.validateEditorInput.bind(r),r.props.showEditorStream&&r.props.showEditorStream(r.handleShowEditorStream),r}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;Signals.connect("filterlist_open_edit",function(t){e.setState({inEditFilterID:t},function(){var e=$gc($("filters_list_holder"),"form","FilterEditor");if(e){var t=$("left_menu"),r=e.getBoundingClientRect();t.scrollTop=r.bottom}})})}},{key:"componentWillReceiveProps",value:function(e){this.state.isDragging||this.setState(function(){return{filters:e.filters}})}},{key:"findIndex",value:function(e){return(0,l.findIndex)(this.state.filters,function(t){return t&&t.id==e})}},{key:"dragBegin",value:function(){this.filtersBeforeDrag=this.state.filters.slice(),this.setState(function(){return{isDragging:!0}})}},{key:"dragEnd",value:function(e){var t=this;this.setState({isDragging:!1});var r=this.state.filters.reduce(function(e,r,n){return e||r!==t.filtersBeforeDrag[n]},!1);this.filtersBeforeDrag=null,r&&this.props.onOrderChanged&&this.props.onOrderChanged(this.state.filters),this.props.selectedFilterID!==e&&this.props.onItemSelected(e)}},{key:"moveItem",value:function(e,t){if(e!=t){var r=this.state.filters[e],n=this.state.filters.slice();n.splice(e,1),n.splice(t,0,r),this.setState(function(){return{filters:n}})}}},{key:"selectItem",value:function(e){this.props.onItemSelected&&this.props.onItemSelected(e.id)}},{key:"handleAddLinkClick",value:function(){this.props.onAddClick&&!this.props.onAddClick()||this.setState(function(){return{showAddEditor:"bottom"}})}},{key:"hideAddEditor",value:function(){this.setState(function(){return{showAddEditor:!1}})}},{key:"onFilterAdd",value:function(e,t,r){this.setState(function(){return{showAddEditor:!1}}),this.props.onFilterAdd(e,t,r)}},{key:"onEditClick",value:function(e){this.props.onEditClick&&!this.props.onEditClick()||this.setState({inEditFilterID:e.id})}},{key:"onDelClick",value:function(e){var t=this;if(!this.props.onDeleteClick||this.props.onDeleteClick()){var r=g.default.formatSimple(e.name,{only_text:!0,as_html:!1,with_link:!1}),n=SPAN($setHTML(SPAN(),(0,v.default)(_("Are you sure you want to delete {item_name}?"),{item_name:"<b>"+r+"</b>"})));Alerts.confirm(n,function(r){r&&t.props.onDelete(e)},_("Delete"))}}},{key:"validateEditorInput",value:function(e){var t=e.name,r=e.query,n={};return t||(n.name=_("Name cannot be empty")),r?r.length>1024&&(n.query=(0,v.default)(_n("Filter queries are limited to 1 character.","Filter queries are limited to {n} characters.",1024),{n:1024})):n.query=_("Query cannot be empty"),0===(0,l.keys)(n).length?null:n}},{key:"renderListItem",value:function(e){var t=this.props.selectedFilterID&&this.props.selectedFilterID===e.id&&!this.state.isDragging,r=this.props.filterCount[e.id]||0;return f.default.createElement(w.default,{filter:e,count:r,key:e.id,isSelected:t,onClick:this.selectItem,disableSort:!this.props.isPremium,id:e.id,findIndex:this.findIndex,moveItem:this.moveItem,dragBegin:this.dragBegin,dragEnd:this.dragEnd,onFavoriteMenuClick:this.onFavoriteClick,onEditMenuClick:this.onEditClick,onDelMenuClick:this.onDelClick})}},{key:"renderUpdateEditor",value:function(e){var t=this,r=function(){t.setState({inEditFilterID:null})},n=function(r,n,o){if(t.setState({inEditFilterID:null}),t.props.onUpdate){var a={};r!==e.name&&(a.name=r),n!==e.query&&(a.query=n),o!==e.color&&(a.color=o),t.props.onUpdate(e.id,a)}};return f.default.createElement("li",{className:"manager",key:e.id},f.default.createElement(j.default,{isPremium:this.props.isPremium,name:e.name,query:e.query,color:e.color,onSubmit:n,onCancel:r,submitBtnStr:_("Save"),inputValidator:this.validateEditorInput}))}},{key:"render",value:function(){var e=this;if(null===this.state.filters)return null;var t=f.default.createElement("div",{id:"filters_list_manager",className:"left_list_manager_holder"},f.default.createElement("div",{className:"left_list_man actions"},f.default.createElement("a",{className:"action sel_add_project link_add","data-track":"filters|add",onClick:this.handleAddLinkClick},f.default.createElement("span",{className:"icon_add"},f.default.createElement(O.default,null)),_("Add Filter")))),r=void 0;0!=this.state.filters.length||this.state.showAddEditor||(r=f.default.createElement("li",{className:"empty"},_("Your list of filters will show up here.")));var n=(0,m.default)(["FilterList",this.state.isDragging?"is_dragging":null]),o=f.default.createElement("li",{className:"manager"},f.default.createElement(j.default,{isPremium:this.props.isPremium,onSubmit:this.onFilterAdd,onCancel:this.hideAddEditor,inputValidator:this.validateEditorInput}));return f.default.createElement("div",{className:n},f.default.createElement("ul",{id:"filters_list",className:"generic_left_list"},"top"===this.state.showAddEditor?o:null,this.state.filters.map(function(t,r){return t.id===e.state.inEditFilterID?e.renderUpdateEditor(t):e.renderListItem(t,r)}),r,"bottom"===this.state.showAddEditor?o:null,f.default.createElement(k.default,null)),this.state.showAddEditor?null:t)}}]),t}(f.default.Component);I.propTypes={filters:c.default.array,filterCount:c.default.object,selectedFilterID:c.default.oneOfType([c.default.number,c.default.string]),isPremium:c.default.bool,onUpdate:c.default.func,onItemSelected:c.default.func,onOrderChanged:c.default.func,onFilterAdd:c.default.func,onDelete:c.default.func,onAddClick:c.default.func,onDeleteClick:c.default.func,onEditClick:c.default.func,onFavoriteClick:c.default.func,showEditorStream:c.default.func},I.defaultProps={filterCount:{}},r.default=I},{"../../components/formatter/Formatter.js":22,"../../utils":484,"../../utils/format":474,"../icons/PlusIcon":291,"./FilterEditor":266,"./FilterListItemDragLayer":269,"./FilterListItemSortable":270,classnames:"classnames","prop-types":"prop-types",react:"react"}],268:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("classnames"),d=n(c),f=e("prop-types"),p=n(f),m=e("../../components/formatter/Formatter.js"),h=n(m),v=e("../icons"),y=e("../ListItem"),g=n(y),b=window.IstMenu,w=void 0,E={},k=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{onEditClick:null,onDelClick:null,onHide:null,onFavoriteClick:null};w||(w=new b,w.addItems(b.createItem(_("Edit filter"),function(){E.onEditClick&&E.onEditClick(),w.hide()},{icon:svgs.get("sm1/edit.svg"),attr:{"data-track":"filters|menu_edit"}}),b.createItem(_("Add to favorites"),function(){E.onFavoriteClick&&E.onFavoriteClick(),w.hide()},{extra_class:"filter_menu_favorite",icon:svgs.get("sm1/heart.svg"),attr:{"data-track":"filters|menu_add_to_favorites"}}),b.createSeparator(),b.createItem(_("Delete filter"),function(){E.onDelClick&&E.onDelClick(),w.hide()},{extra_class:"danger",icon:svgs.get("sm1/trash.svg"),attr:{"data-track":"filters|menu_delete"}})),$AEV(document,"click",function(e){w.shown&&w.hide(e)})),w.shown&&w.hide(),e.is_favorite?$hide($all("tr","filter_menu_favorite",w.menu_holder)):$show($all("tr","filter_menu_favorite",w.menu_holder)),E=r,w.hide_callbacks=[function(){return E.onHide&&E.onHide()}],w.show({},t)},S=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onMenuHide=function(){r.setState({menuOn:!1})},r.onEditClick=function(){r.props.onEditMenuClick(r.props.filter)},r.onDelClick=function(){r.props.onDelMenuClick(r.props.filter)},r.onFavoriteClick=function(){r.props.onFavoriteMenuClick(r.props.filter)},r.handleMenuClick=function(e){e.stopPropagation(),k(r.props.filter,e,r.menuHandlers),r.setState({menuOn:!0})},r.handleContextMenu=function(e){if(e.shift)return!0;e.preventDefault(),k(r.props.filter,e,r.menuHandlers),r.setState({menuOn:!0})},r.menuHandlers={onEditClick:r.onEditClick,onDelClick:r.onDelClick,onHide:r.onMenuHide,onFavoriteClick:r.onFavoriteClick},r.state={menuOn:!1},r}return i(t,e),s(t,[{key:"componentWillUnmount",value:function(){E==this.menuHandlers&&(E={})}},{key:"render",value:function(){var e=this.props.count,t=h.default.formatSimple(this.props.filter.name,{only_text:!1,as_html:!0,with_links:!1,cache_prefix:"flist_"}),r=(0,d.default)(["FilterListItem",this.state.menuOn?"on_menu_active":null]);return u.default.createElement(g.default,{className:r,leftIcon:u.default.createElement(v.FilterIcon,null),color:this.props.filter.color,onContextMenu:this.handleContextMenu,onMenuClick:this.handleMenuClick},u.default.createElement("span",{dangerouslySetInnerHTML:{__html:t}}),e>0?u.default.createElement("div",{className:"counter_count"},e):null)}}]),t}(u.default.PureComponent);S.propTypes={className:p.default.string,filter:p.default.object.isRequired,onEditMenuClick:p.default.func,onFavoriteMenuClick:p.default.func,onDelMenuClick:p.default.func,count:p.default.number},r.default=S},{"../../components/formatter/Formatter.js":22,"../ListItem":207,"../icons":300,classnames:"classnames","prop-types":"prop-types",react:"react"}],269:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=e.initialOffset,r=e.currentOffset;if(!t||!r)return{};var n={x:r.x,y:r.y},o=n.x,a=n.y,i="translate("+o+"px, "+a+"px)";return{transform:i,WebkitTransform:i,width:e.dragItem.componentWidth}}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("react-dnd"),c=e("react"),d=n(c),f=e("prop-types"),p=n(f),m=e("classnames"),h=n(m),_=e("./FilterListItem"),v=n(_),y=e("../../constants/constants"),g={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"},b=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"render",value:function(){if(!this.props.isDragging||this.props.itemType!==y.DragTypes.FilterListItemSortable)return null;var e=(0,h.default)(["list_item_draglayer"]);return d.default.createElement("div",{style:g},d.default.createElement("div",{className:e,style:s(this.props)},d.default.createElement("div",{className:"dnd_handle"},d.default.createElement("img",{src:"https://d3ptyyxy2at9ui.cloudfront.net/drag-065a21.svg",width:"8",height:"14",className:"svg_icon_drag"})),d.default.createElement(v.default,{filter:this.props.dragItem.filter})))}}]),t}(d.default.Component);b.propTypes={initialOffset:p.default.shape({x:p.default.number.isRequired,y:p.default.number.isRequired}),currentOffset:p.default.shape({x:p.default.number.isRequired,y:p.default.number.isRequired}),isDragging:p.default.bool.isRequired,dragItem:p.default.object,itemType:p.default.string};var w=function(e){return{dragItem:e.getItem(),itemType:e.getItemType(),initialOffset:e.getInitialSourceClientOffset(),currentOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}};r.default=(0,u.DragLayer)(w)(b)},{"../../constants/constants":98,"./FilterListItem":268,classnames:"classnames","prop-types":"prop-types",react:"react","react-dnd":"react-dnd"}],270:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("../../utils"),u=e("classnames"),c=n(u),d=e("react"),f=n(d),p=e("react-dom"),m=e("prop-types"),h=n(m),_=e("react-dnd"),v=e("@doist/react-dnd-html5-backend"),y=e("../../constants/constants"),g=e("./FilterListItem"),b=n(g),w=e("../../utils/shallowEqual"),E=n(w),k=e("../../logger/Logger"),S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(k),j=e("../icons"),T=function(e){return(0,l.mapValues)(e,function(e){return function(){
try{return e.apply(void 0,arguments)}catch(e){S.captureError(e,{tags:{react:"filter"}})}}})},O=T({beginDrag:function(e,t,r){var n=(0,p.findDOMNode)(r).getBoundingClientRect();return e.dragBegin(e.id),{id:e.id,filter:e.filter,componentWidth:n.width}},endDrag:function(e){e.dragEnd(e.id)}}),I=T({hover:function(e,t,r){var n=e.findIndex(t.getItem().id),o=e.findIndex(e.id),a=void 0;if(n===o)a=n;else{var i=(0,p.findDOMNode)(r).getBoundingClientRect(),s=(i.bottom-i.top)/2,l=t.getClientOffset(),u=l.y-i.top;a=n<o&&u<s||n>o&&u>s?n:o}e.moveItem(n,a)}}),P=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={dragHandlePressing:!1},r.onDragHandlePress=r.onDragHandlePress.bind(r),r.onDragHandleRelease=r.onDragHandleRelease.bind(r),r.onClick=r.onClick.bind(r),r}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.props.connectDragPreview((0,v.getEmptyImage)(),{captureDraggingState:!0})}},{key:"onClick",value:function(){this.props.onClick(this.props.filter)}},{key:"onDragHandlePress",value:function(){this.setState({dragHandlePressing:!0})}},{key:"onDragHandleRelease",value:function(){this.setState({dragHandlePressing:!1})}},{key:"componentWillReceiveProps",value:function(e){e.isDragging&&this.state.dragHandlePressing&&this.setState({dragHandlePressing:!1})}},{key:"render",value:function(){if(this.props.disableSort){var e=(0,c.default)(["FilterListItemSortable",this.props.isSelected?"is_selected":null]);return f.default.createElement("li",{onClick:this.onClick,className:e},f.default.createElement(b.default,{filter:this.props.filter,count:this.props.count,onFavoriteMenuClick:this.props.onFavoriteMenuClick,onEditMenuClick:this.props.onEditMenuClick,onDelMenuClick:this.props.onDelMenuClick}))}var t=this.props,r=t.connectDragSource,n=t.connectDropTarget,o=t.isDragging,a=(0,c.default)(["FilterListItemSortable",o?"drop_placeholder_mode":null,!o&&this.state.dragHandlePressing?"drag_start":null,this.props.isSelected?"is_selected":null]);return n(f.default.createElement("li",{onClick:this.onClick,className:a},r(f.default.createElement("div",{className:"dnd_handle",onMouseDown:this.onDragHandlePress,onMouseUp:this.onDragHandleRelease},f.default.createElement(j.DragAndDropIcon,null))),f.default.createElement(b.default,{filter:this.props.filter,count:this.props.count,onEditMenuClick:this.props.onEditMenuClick,onFavoriteMenuClick:this.props.onFavoriteMenuClick,onDelMenuClick:this.props.onDelMenuClick})))}}]),t}(f.default.PureComponent);P.propTypes={filter:h.default.object.isRequired,count:h.default.number,isSelected:h.default.bool,onClick:h.default.func,onEditMenuClick:h.default.func,onDelMenuClick:h.default.func,onFavoriteMenuClick:h.default.func,disableSort:h.default.bool,id:h.default.oneOfType([h.default.number,h.default.string]).isRequired,moveItem:h.default.func,findIndex:h.default.func,dragBegin:h.default.func,dragEng:h.default.func,connectDragPreview:h.default.func,connectDragSource:h.default.func,connectDropTarget:h.default.func,isDragging:h.default.bool};var C={arePropsEqual:function(e,t){return(0,E.default)(e,t)}};r.default=(0,l.flow)((0,_.DragSource)(y.DragTypes.FilterListItemSortable,O,function(e,t){return{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging()}},C),(0,_.DropTarget)(y.DragTypes.FilterListItemSortable,I,function(e){return{connectDropTarget:e.dropTarget()}},C))(P)},{"../../constants/constants":98,"../../logger/Logger":141,"../../utils":484,"../../utils/shallowEqual":503,"../icons":300,"./FilterListItem":268,"@doist/react-dnd-html5-backend":"@doist/react-dnd-html5-backend",classnames:"classnames","prop-types":"prop-types",react:"react","react-dnd":"react-dnd","react-dom":"react-dom"}],271:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("react"),a=n(o),i=e("prop-types"),s=n(i),l=e("../../components/formatter/Formatter"),u=n(l),c=function(e){var t=e.text,r=u.default.formatSimple(t,{only_text:!0,as_html:!0,with_links:!1});return a.default.createElement("span",{dangerouslySetInnerHTML:{__html:r}})};c.propTypes={text:s.default.string},r.default=c},{"../../components/formatter/Formatter":22,"prop-types":"prop-types",react:"react"}],272:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:"24",height:"24",viewBox:"0 0 24 24"},e),a.default.createElement("g",{fill:"none",fillRule:"evenodd"},a.default.createElement("path",{d:"M0 0h24v24H0z"}),a.default.createElement("path",{d:"M5.235 12.754l7.857-7.856a3.064 3.064 0 1 1 4.334 4.335l-7.495 7.495a1.916 1.916 0 0 1-2.709-2.71l6.953-6.953.813.813-6.953 6.953a.768.768 0 0 0 0 1.084.768.768 0 0 0 1.083 0l7.495-7.495a1.916 1.916 0 0 0-2.709-2.71l-7.856 7.857a3.064 3.064 0 1 0 4.335 4.335l7.314-7.315.813.813-7.315 7.314a4.212 4.212 0 0 1-5.96 0 4.212 4.212 0 0 1 0-5.96z",fill:"currentColor"})))});r.default=i},{react:"react"}],273:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:24,height:24},e),a.default.createElement("path",{fill:"currentColor",d:"M16 5H8v1.5a.5.5 0 0 1-1 0V5h-.44c-.66 0-.86.04-1.07.15a.82.82 0 0 0-.34.34C5.04 5.7 5 5.9 5 6.57V9h14V6.56c0-.66-.04-.86-.15-1.07a.82.82 0 0 0-.35-.34c-.2-.11-.4-.15-1.06-.15H17v1.5a.5.5 0 1 1-1 0V5zm1-1h.44c.89 0 1.21.1 1.54.27.32.17.58.43.75.75.18.33.27.65.27 1.54v10.88c0 .89-.1 1.21-.27 1.54a1.8 1.8 0 0 1-.75.75c-.33.18-.65.27-1.54.27H6.56c-.89 0-1.21-.1-1.54-.27a1.82 1.82 0 0 1-.75-.75c-.18-.33-.27-.65-.27-1.54V6.56c0-.89.1-1.21.27-1.54.17-.32.43-.58.75-.75.33-.18.65-.27 1.54-.27H7V2.5a.5.5 0 0 1 1 0V4h8V2.5a.5.5 0 1 1 1 0V4zm2 6H5v7.44c0 .66.04.86.15 1.07a.82.82 0 0 0 .34.34c.21.11.41.15 1.07.15h10.88c.66 0 .86-.04 1.07-.15a.82.82 0 0 0 .34-.35c.11-.2.15-.4.15-1.06V10zm-3 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"}))});r.default=i},{react:"react"}],274:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a.default.createElement("svg",n({className:"icon_close",width:"12px",height:"12px",viewBox:"0 0 12 12"},e),a.default.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a.default.createElement("path",{id:"path_close",d:"M5.70710678,4.29289322 L1.41421356,0 L0,1.41421356 L4.29289322,5.70710678 L0,10 L1.41421356,11.4142136 L5.70710678,7.12132034 L10,11.4142136 L11.4142136,10 L7.12132034,5.70710678 L11.4142136,1.41421356 L10,0 L5.70710678,4.29289322 Z",fill:"#B3B3B3",fillRule:"nonzero"})))});r.default=i},{react:"react"}],275:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},e),a.default.createElement("g",{fill:"none",fillRule:"evenodd"},a.default.createElement("path",{d:"M0 0h24v24H0z"}),a.default.createElement("rect",{width:"14",height:"1",x:"5",y:"6",fill:"currentColor",rx:".5"}),a.default.createElement("path",{fill:"currentColor",d:"M10 9h1v8h-1V9zm3 0h1v8h-1V9z"}),a.default.createElement("path",{stroke:"currentColor",d:"M17.5 6.5h-11V18A1.5 1.5 0 0 0 8 19.5h8a1.5 1.5 0 0 0 1.5-1.5V6.5zm-9 0h7V5A1.5 1.5 0 0 0 14 3.5h-4A1.5 1.5 0 0 0 8.5 5v1.5z"})))});r.default=i},{react:"react"}],276:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:"24",height:"24"},e),a.default.createElement("g",{fill:"currentColor",fillRule:"evenodd"},a.default.createElement("g",{transform:"translate(4 3)"},a.default.createElement("rect",{width:"17",height:"1",y:"14",rx:".5"}),a.default.createElement("path",{d:"M9 10.293l2.146-2.147a.5.5 0 0 1 .708.708L9.207 11.5a1 1 0 0 1-1.414 0L5.146 8.854a.5.5 0 0 1 .708-.708L8 10.293V1a.5.5 0 0 1 1 0v9.293z"}))))});r.default=i},{react:"react"}],277:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:24,height:24},e),a.default.createElement("path",{d:"M9.5 9a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm-5-5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm0 5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z",fill:"currentColor",fillRule:"evenodd"}))});r.default=i},{react:"react"}],278:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:"24",height:"24"},e),a.default.createElement("g",{fill:"none",fillRule:"evenodd"},a.default.createElement("path",{fill:"currentColor",d:"M9.5 19h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z"}),a.default.createElement("path",{stroke:"currentColor",d:"M4.42 16.03a1.5 1.5 0 0 0-.43.9l-.22 2.02a.5.5 0 0 0 .55.55l2.02-.21a1.5 1.5 0 0 0 .9-.44L18.7 7.4a1.5 1.5 0 0 0 0-2.12l-.7-.7a1.5 1.5 0 0 0-2.13 0L4.42 16.02z"})))});r.default=i},{react:"react"}],279:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:"24",height:"24"},e),a.default.createElement("g",{fill:"currentColor"},a.default.createElement("path",{d:"M9.375 11.75a1.125 1.125 0 1 1 0-2.25 1.125 1.125 0 0 1 0 2.25zm5.25 0a1.125 1.125 0 1 1 0-2.25 1.125 1.125 0 0 1 0 2.25zm.603 1.75a3.335 3.335 0 0 1-6.456 0h6.456z"}),a.default.createElement("path",{d:"M12 19a7 7 0 1 0 0-14 7 7 0 0 0 0 14zm0 1a8 8 0 1 1 0-16 8 8 0 0 1 0 16z"})))});r.default=i},{react:"react"}],280:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:24,height:24},e),a.default.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M19.12 20h-4.08v-6.2h2.08l.31-2.41h-2.39V9.85c0-.7.2-1.18 1.2-1.18h1.27V6.51c-.22-.03-.98-.1-1.86-.1-1.84 0-3.1 1.13-3.1 3.2v1.78h-2.09v2.41h2.09V20H4.88a.88.88 0 0 1-.88-.88V4.88c0-.49.4-.88.88-.88h14.24c.48 0 .88.4.88.88v14.24a.88.88 0 0 1-.88.88z"}))});r.default=i},{react:"react"}],281:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("react"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=o.default.memo(function(){return o.default.createElement("svg",{width:24,height:24},o.default.createElement("path",{fill:"currentColor",d:"M12 4c1 5 5 5 5 9a5 5 0 0 1-5 5c-2.8 0-5-2-5-5 0-4 4-4 5-9z"}))});r.default=a},{react:"react"}],282:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:24,height:24},e),a.default.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.35 11.21h6.1c.43 3.12-.85 7.79-6.1 7.79C4.85 19 2 16.09 2 12.5S4.84 6 8.35 6c1.65 0 3.15.64 4.28 1.7-1.33 1.28-1.29 1.35-1.81 1.89a3.56 3.56 0 0 0-2.47-.95 3.76 3.76 0 0 0-3.7 3.86 3.77 3.77 0 0 0 3.7 3.86c2.06 0 2.9-.9 3.44-2.58H8.35v-2.57zm11.45.13H22v1.61h-2.2v2.32h-1.57v-2.32h-2.27v-1.6h2.27V9.08h1.57v2.25z"}))});r.default=i},{react:"react"}],283:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:24,height:24},e),a.default.createElement("g",{fill:"none",fillRule:"evenodd"},a.default.createElement("path",{fill:"currentColor",d:"M11.9 16.5c-.46 0-.8-.35-.8-.85s.34-.86.8-.86c.48 0 .8.36.8.86s-.32.85-.8.85zM9.5 9.87c.06-1.32.9-2.37 2.54-2.37 1.46 0 2.46.95 2.46 2.21 0 .96-.47 1.64-1.22 2.11-.73.46-.94.8-.94 1.45v.4h-1.02v-.57c0-.8.37-1.36 1.16-1.86.68-.43.94-.82.94-1.47 0-.76-.56-1.32-1.43-1.32-.87 0-1.43.55-1.5 1.42H9.5z"}),a.default.createElement("circle",{cx:12,cy:12,r:7.5,stroke:"currentColor"})))});r.default=i},{react:"react"}],284:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:"24",height:"24"},e),a.default.createElement("g",{fill:"none",fillRule:"evenodd"},a.default.createElement("path",{fill:"currentColor",d:"M6 20h12a2 2 0 0 0 2-2v-4h-4.4l-.635 1.41a1 1 0 0 1-.912.59H9.947a1 1 0 0 1-.912-.59L8.4 14H4v4a2 2 0 0 0 2 2z"}),a.default.createElement("path",{stroke:"currentColor",d:"M4.526 13.004a.5.5 0 0 0-.026.158V18A1.5 1.5 0 0 0 6 19.5h12a1.5 1.5 0 0 0 1.5-1.5v-4.838a.5.5 0 0 0-.026-.158l-2.16-6.478A1.5 1.5 0 0 0 15.893 5.5H8.108a1.5 1.5 0 0 0-1.423 1.026l-2.16 6.478z"})))});r.default=i},{react:"react"}],285:[function(e,t,r){"use strict";function n(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function o(e){var t=n(e,[]);return s.default.createElement("svg",a({xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28"},t),s.default.createElement("g",{fill:"none",fillRule:"evenodd",transform:"translate(.93 .93)"},s.default.createElement("path",{d:"M0 0h26.13v26.13H0z"}),s.default.createElement("path",{fill:"currentColor",d:"M13.07 25.2a12.13 12.13 0 1 1 0-24.27 12.13 12.13 0 0 1 0 24.27zm0-.94a11.2 11.2 0 1 0 0-22.4 11.2 11.2 0 0 0 0 22.4z"}),s.default.createElement("path",{fill:"currentColor",d:"M12.13 7.47H14V14h-1.87z"}),s.default.createElement("circle",{cx:"13.07",cy:"17.03",r:"1.17",fill:"currentColor"})))}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=o;var i=e("react"),s=function(e){return e&&e.__esModule?e:{default:e}}(i)},{react:"react"}],286:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("react"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=o.default.memo(function(){return o.default.createElement("svg",{width:24,height:24},o.default.createElement("path",{fill:"currentColor",d:"M5 8.67C5 7.75 5.84 7 6.87 7h8.19c.52 0 1.18.3 1.48.67l2.92 3.66c.3.37.3.97 0 1.34l-2.92 3.66c-.3.37-.96.67-1.48.67h-8.2C5.85 17 5 16.25 5 15.33V8.67z"}))});r.default=a},{react:"react"}],287:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:"24",height:"24"},e),a.default.createElement("path",{d:"M13 16.5V19h2.5a.5.5 0 1 1 0 1h-6a.5.5 0 1 1 0-1H12v-2.5c-.8 0-1.6-.3-2.2-.6-.7-.4-1.3-1-1.7-1.7-.4-.8-.6-1.6-.6-2.6V9a.5.5 0 0 1 1 0v2.6c0 .8.2 1.5.5 2.1.3.6.7 1 1.3 1.3.6.3 1.3.5 2.1.5h.2c.8 0 1.5-.2 2.1-.5.6-.3 1-.7 1.3-1.3.3-.6.5-1.3.5-2.1V9a.5.5 0 1 1 1 0v2.6c0 1-.2 1.8-.6 2.6-.4.7-1 1.3-1.7 1.7-.6.3-1.4.5-2.2.6zM12.5 3C13.9 3 15 4.1 15 5.5v6a2.5 2.5 0 1 1-5 0v-6C10 4.1 11.1 3 12.5 3z",fill:"currentColor",fillRule:"evenodd"}))});r.default=i},{react:"react"}],288:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:15,height:3},e),a.default.createElement("path",{d:"M1.5 3a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm6 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm6 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z",fill:"currentColor",fillRule:"evenodd"}))});r.default=i},{react:"react"}],289:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:24,height:24},e),a.default.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M20 8v9.436c0 .892-.093 1.215-.267 1.54a1.81 1.81 0 0 1-.756.757c-.326.174-.65.267-1.54.267H6.563c-.892 0-1.215-.093-1.54-.267a1.817 1.817 0 0 1-.757-.756c-.174-.326-.267-.65-.267-1.54V6a2 2 0 0 1 2-2h1V2.5a.5.5 0 0 1 1 0V4h8V2.5a.5.5 0 1 1 1 0V4h1a2 2 0 0 1 2 2v2zM6.564 8c-.662 0-.864.039-1.07.149a.818.818 0 0 0-.345.346C5.039 8.7 5 8.902 5 9.564v7.872c0 .662.039.864.149 1.07a.818.818 0 0 0 .346.345c.205.11.407.149 1.069.149h10.872c.662 0 .864-.039 1.07-.149a.818.818 0 0 0 .345-.346c.11-.205.149-.407.149-1.069V9.564c0-.662-.039-.864-.149-1.07a.818.818 0 0 0-.346-.345C18.3 8.039 18.098 8 17.436 8H6.564zM8 13a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm4 0a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm4 0a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm-8 4a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm4 0a1 1 0 1 1 0-2 1 1 0 0 1 0 2zm4 0a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"}))});r.default=i},{react:"react"}],290:[function(e,t,r){"use strict";function n(){return a.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24","data-svgs-path":"sm1/comments.svg"},a.default.createElement("path",{fill:"none",stroke:"currentColor",d:"M16.5 18.58V16.5h.94c.73 0 1.01-.05 1.3-.2.24-.14.42-.32.55-.56.16-.29.21-.57.21-1.3V7.56c0-.73-.05-1.01-.2-1.3a1.32 1.32 0 0 0-.56-.55c-.29-.16-.57-.21-1.3-.21H6.56c-.73 0-1.01.05-1.3.2a1.32 1.32 0 0 0-.55.56c-.16.29-.21.57-.21 1.3v6.88c0 .73.05 1.01.2 1.3.14.24.32.42.56.55.29.16.57.21 1.3.21h5.6l3.55 2.49a.5.5 0 0 0 .79-.41z"}))}Object.defineProperty(r,"__esModule",{value:!0});var o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o);r.default=n},{react:"react"}],291:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:13,height:13},e),a.default.createElement("path",{d:"M6 6V.5a.5.5 0 0 1 1 0V6h5.5a.5.5 0 1 1 0 1H7v5.5a.5.5 0 1 1-1 0V7H.5a.5.5 0 0 1 0-1H6z",fill:"currentColor",fillRule:"evenodd"}))});r.default=i},{react:"react"}],292:[function(e,t,r){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.default.createElement("svg",a({width:"24",height:"24"},e),s.default.createElement("g",{fill:"none",fillRule:"evenodd",transform:"translate(5 5)"},s.default.createElement("mask",{id:"mask",fill:"#fff"},s.default.createElement("path",{d:"M0 12.3C0 9.8 3.2 8 7 8s7 1.8 7 4.3c0 1-.7 1.7-2 1.7H2c-1.3 0-2-.6-2-1.8zM7 0a3.5 3.5 0 1 1 0 7 3.5 3.5 0 0 1 0-7z"})),s.default.createElement("g",{mask:"url(#mask)"},s.default.createElement("path",{fill:"currentColor",d:"M-5-5h24v24H-5z"}))))}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s.default.createElement("svg",a({width:"24",height:"24"},e),s.default.createElement("path",{d:"M12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10z",fill:"currentColor",fillRule:"nonzero"}))}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("react"),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=e("../../models/Colors"),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(l),c=s.default.memo(function(e){var t=e.color,r=e.isShared,a=t?{color:u.getHex("project",t)}:{};return r?s.default.createElement(n,{style:a}):s.default.createElement(o,{style:a})});r.default=c},{"../../models/Colors":161,react:"react"}],293:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},e),a.default.createElement("g",{fill:"currentColor"},a.default.createElement("path",{d:"M9.375 11.75a1.125 1.125 0 1 1 0-2.25 1.125 1.125 0 0 1 0 2.25zm5.25 0a1.125 1.125 0 1 1 0-2.25 1.125 1.125 0 0 1 0 2.25zm.603 1.75a3.335 3.335 0 0 1-6.456 0h6.456z"}),a.default.createElement("path",{d:"M12 19a7 7 0 1 0 0-14 7 7 0 0 0 0 14zm0 1a8 8 0 1 1 0-16 8 8 0 0 1 0 16z"})))});r.default=i},{react:"react"}],294:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:24,height:24},e),a.default.createElement("path",{d:"M15.724 13.603l-.707-.708L16.739 11h-3.618l-.5-.501.77-4.243-2.387 2.626-.708-.707L15 3l-1.09 6-.033.179-.15.821H19l-3.276 3.603zm-2.02 2.222L9 21l1.09-6 .033-.179.15-.821H5l3.276-3.603.707.708L7.261 13h3.618l.5.501-.77 4.243 2.387-2.626.708.707zm5.442 4.029a.5.5 0 0 0 .708-.708l-15-15a.5.5 0 0 0-.708.708l15 15z",fill:"currentColor"}))});r.default=i},{react:"react"}],295:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:24,height:24},e),a.default.createElement("g",{fill:"none",fillRule:"evenodd"},a.default.createElement("path",{fill:"currentColor",d:"M6 20h12a2 2 0 0 0 2-2v-4h-4.4l-.635 1.41a1 1 0 0 1-.912.59H9.947a1 1 0 0 1-.912-.59L8.4 14H4v4a2 2 0 0 0 2 2z"}),a.default.createElement("path",{stroke:"currentColor",d:"M4.526 13.004a.5.5 0 0 0-.026.158V18A1.5 1.5 0 0 0 6 19.5h12a1.5 1.5 0 0 0 1.5-1.5v-4.838a.5.5 0 0 0-.026-.158l-2.16-6.478A1.5 1.5 0 0 0 15.893 5.5H8.108a1.5 1.5 0 0 0-1.423 1.026l-2.16 6.478z"}),a.default.createElement("path",{fill:"currentColor",d:"M13.766 9.75c0 .968-.792 1.75-1.766 1.75a1.758 1.758 0 0 1-1.766-1.75c0-.965.792-1.75 1.766-1.75a1.76 1.76 0 0 1 1.766 1.75zM12 12.608c.728 0 1.905.245 2.699.708l-.428 1.058a1 1 0 0 1-.927.626h-2.688a1 1 0 0 1-.927-.626L9.3 13.316c.794-.463 1.971-.708 2.699-.708z"})))});r.default=i},{react:"react"}],296:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("react"),o=function(e){return e&&e.__esModule?e:{default:e}}(n);r.default=o.default.memo(function(e){var t=e.dateString,r=t.split("-"),n=r[r.length-1];return o.default.createElement("svg",{width:24,height:24},o.default.createElement("g",{fill:"currentColor",fillRule:"evenodd"},o.default.createElement("path",{d:"M20 8v9.436c0 .892-.093 1.215-.267 1.54a1.81 1.81 0 0 1-.756.757c-.326.174-.65.267-1.54.267H6.563c-.892 0-1.215-.093-1.54-.267a1.817 1.817 0 0 1-.757-.756c-.174-.326-.267-.65-.267-1.54V6a2 2 0 0 1 2-2h1V2.5a.5.5 0 0 1 1 0V4h8V2.5a.5.5 0 1 1 1 0V4h1a2 2 0 0 1 2 2v2zM6.564 8c-.662 0-.864.039-1.07.149a.818.818 0 0 0-.345.346C5.039 8.7 5 8.902 5 9.564v7.872c0 .662.039.864.149 1.07a.818.818 0 0 0 .346.345c.205.11.407.149 1.069.149h10.872c.662 0 .864-.039 1.07-.149a.818.818 0 0 0 .345-.346c.11-.205.149-.407.149-1.069V9.564c0-.662-.039-.864-.149-1.07a.818.818 0 0 0-.346-.345C18.3 8.039 18.098 8 17.436 8H6.564z"}),o.default.createElement("text",{fontFamily:"-apple-system, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'",fontSize:9,transform:"translate(4 2)"},o.default.createElement("tspan",{x:7.7,y:14.5,textAnchor:"middle"},n))))})},{react:"react"}],297:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:24,height:24},e),a.default.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M20.92 4.3a7.85 7.85 0 0 1-2.54 1A3.94 3.94 0 0 0 15.47 4a4.04 4.04 0 0 0-3.89 5.02 11.23 11.23 0 0 1-8.23-4.27 4.17 4.17 0 0 0-.54 2.06c0 1.42.7 2.67 1.78 3.4a3.92 3.92 0 0 1-1.81-.5v.04a4.07 4.07 0 0 0 3.2 4.01 3.89 3.89 0 0 1-1.8.08 4 4 0 0 0 3.73 2.84A7.88 7.88 0 0 1 2 18.38a11.11 11.11 0 0 0 6.12 1.83c7.34 0 11.35-6.23 11.35-11.64v-.53a8.19 8.19 0 0 0 1.98-2.12 7.82 7.82 0 0 1-2.29.64 4.08 4.08 0 0 0 1.76-2.26"}))});r.default=i},{react:"react"}],298:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:24,height:24},e),a.default.createElement("path",{fill:e.color,d:"M12.707 12.707l-1.414-1.414-2.117-2.117c3.646-3.484 7.75-4.978 9.188-3.54 1.438 1.438-.056 5.542-3.54 9.188l-2.117-2.117zM10.586 12L12 13.414l-4.95 4.95a1 1 0 0 1-1.414-1.414l4.95-4.95zm5.763-7.882c-2.254.192-5.208 1.79-7.88 4.35L5.635 5.636a9.004 9.004 0 0 1 10.713-1.518zm3.533 3.533a9.004 9.004 0 0 1-1.518 10.713l-2.832-2.832c2.56-2.673 4.158-5.627 4.35-7.88z"}))});r.default=i},{react:"react"}],299:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=a.default.memo(function(e){return a.default.createElement("svg",n({width:"24",height:"24"},e),a.default.createElement("g",{fill:"none",fillRule:"evenodd"},a.default.createElement("path",{fill:"#FF9801",d:"M13.77 4.8l7.3 12.17A2 2 0 0 1 19.36 20H4.75a2 2 0 0 1-1.72-3.03l7.3-12.17a2 2 0 0 1 3.44 0z"}),a.default.createElement("path",{fill:"#FFF",d:"M10.88 8.41h2.35l-.2 5.92h-1.95l-.2-5.92zm-.07 7.91c0-.7.45-1.11 1.24-1.11s1.26.4 1.26 1.11c0 .7-.47 1.11-1.26 1.11s-1.24-.4-1.24-1.1z"})))});r.default=i},{react:"react"}],300:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./CalendarIcon");Object.defineProperty(r,"CalendarIcon",{enumerable:!0,get:function(){return n(o).default}});var a=e("./Close");Object.defineProperty(r,"Close",{enumerable:!0,get:function(){return n(a).default}});var i=e("./DragAndDropIcon");Object.defineProperty(r,"DragAndDropIcon",{enumerable:!0,get:function(){return n(i).default}});var s=e("./FacebookIcon");Object.defineProperty(r,"FacebookIcon",{enumerable:!0,get:function(){return n(s).default}});var l=e("./FilterIcon");Object.defineProperty(r,"FilterIcon",{enumerable:!0,get:function(){return n(l).default}});var u=e("./GooglePlusIcon");Object.defineProperty(r,"GooglePlusIcon",{enumerable:!0,get:function(){return n(u).default}});var c=e("./HelpIcon");Object.defineProperty(r,"HelpIcon",{enumerable:!0,get:function(){return n(c).default}});var d=e("./InboxIcon");Object.defineProperty(r,"InboxIcon",{enumerable:!0,get:function(){return n(d).default}});var f=e("./LabelIcon");Object.defineProperty(r,"LabelIcon",{enumerable:!0,get:function(){return n(f).default}});var p=e("./MoreSmallIcon");Object.defineProperty(r,"MoreSmallIcon",{enumerable:!0,get:function(){return n(p).default}});var m=e("./Next7DaysIcon");Object.defineProperty(r,"Next7DaysIcon",{enumerable:!0,get:function(){return n(m).default}});var h=e("./PlusIcon");Object.defineProperty(r,"PlusIcon",{enumerable:!0,get:function(){return n(h).default}});var _=e("./ProjectIcon");Object.defineProperty(r,"ProjectIcon",{enumerable:!0,get:function(){return n(_).default}});var v=e("./SmartScheduleStrikeIcon");Object.defineProperty(r,"SmartScheduleStrikeIcon",{enumerable:!0,get:function(){return n(v).default}});var y=e("./TeamInboxIcon");Object.defineProperty(r,"TeamInboxIcon",{enumerable:!0,get:function(){return n(y).default}});var g=e("./TodayIcon");Object.defineProperty(r,"TodayIcon",{enumerable:!0,get:function(){return n(g).default}});var b=e("./TwitterIcon");Object.defineProperty(r,"TwitterIcon",{enumerable:!0,get:function(){return n(b).default}});var w=e("./ReactionIcon")
;Object.defineProperty(r,"ReactionIcon",{enumerable:!0,get:function(){return n(w).default}});var E=e("./EditIcon");Object.defineProperty(r,"EditIcon",{enumerable:!0,get:function(){return n(E).default}});var k=e("./DeleteIcon");Object.defineProperty(r,"DeleteIcon",{enumerable:!0,get:function(){return n(k).default}});var S=e("./AttachmentIcon");Object.defineProperty(r,"AttachmentIcon",{enumerable:!0,get:function(){return n(S).default}});var j=e("./MicrophoneIcon");Object.defineProperty(r,"MicrophoneIcon",{enumerable:!0,get:function(){return n(j).default}});var T=e("./EmojiIcon");Object.defineProperty(r,"EmojiIcon",{enumerable:!0,get:function(){return n(T).default}});var O=e("./DownloadIcon");Object.defineProperty(r,"DownloadIcon",{enumerable:!0,get:function(){return n(O).default}});var I=e("./WarningIcon");Object.defineProperty(r,"WarningIcon",{enumerable:!0,get:function(){return n(I).default}});var P=e("./InfoIcon");Object.defineProperty(r,"InfoIcon",{enumerable:!0,get:function(){return n(P).default}})},{"./AttachmentIcon":272,"./CalendarIcon":273,"./Close":274,"./DeleteIcon":275,"./DownloadIcon":276,"./DragAndDropIcon":277,"./EditIcon":278,"./EmojiIcon":279,"./FacebookIcon":280,"./FilterIcon":281,"./GooglePlusIcon":282,"./HelpIcon":283,"./InboxIcon":284,"./InfoIcon":285,"./LabelIcon":286,"./MicrophoneIcon":287,"./MoreSmallIcon":288,"./Next7DaysIcon":289,"./PlusIcon":291,"./ProjectIcon":292,"./ReactionIcon":293,"./SmartScheduleStrikeIcon":294,"./TeamInboxIcon":295,"./TodayIcon":296,"./TwitterIcon":297,"./WarningIcon":299}],301:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../side_panel/SidePanel"),p=n(f),m=e("../reactist/Tabs"),h=e("../icons/ProjectIcon"),v=n(h),y=e("../formatter/PlainText"),g=n(y),b=e("../activity_log"),w=n(b),E=e("../../containers/Notes"),k=n(E),S=e("../../reducers/notes/notesConstants"),j=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.project;return u.default.createElement("div",{className:"item_detail_header"},u.default.createElement("h4",{className:"project_name"},u.default.createElement(v.default,{color:e.color}),u.default.createElement(g.default,{text:e.name})))}}]),t}(u.default.Component);j.propTypes={project:d.default.object.isRequired};var T=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.handleOnClosed=function(){n.props.onClosed()},n.handleTabChange=function(e){n.setState({tab:e})},i=r,a(n,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.project,r=e.item;return u.default.createElement(p.default,{width:600,onClosed:this.handleOnClosed},u.default.createElement("div",{className:"item_detail"},u.default.createElement(j,{project:t}),u.default.createElement("div",{className:"item_overview"}),u.default.createElement(m.Tabs,{className:"item_detail_tabs",onChange:this.onTabChange,spreadLayout:!0},u.default.createElement(m.Tab,{className:"item_detail_tab",value:"subtasks",title:_("Subtasks")}),u.default.createElement(m.Tab,{className:"item_detail_tab",value:"comments",title:_("Comments")},u.default.createElement(k.default,{item:r,type:S.TYPE_ITEM_NOTE,projectId:t.id,parentId:r.id})),u.default.createElement(m.Tab,{className:"item_detail_tab",value:"activity",title:_("Activity")},u.default.createElement(w.default,{filterBy:{object_type:"item",object_id:r.id}})))))}}]),t}(u.default.Component);T.propTypes={item:d.default.object,project:d.default.object.isRequired,onClosed:d.default.func.isRequired},r.default=T},{"../../containers/Notes":109,"../../reducers/notes/notesConstants":430,"../activity_log":224,"../formatter/PlainText":271,"../icons/ProjectIcon":292,"../reactist/Tabs":344,"../side_panel/SidePanel":395,"prop-types":"prop-types",react:"react"}],302:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../ColorPicker"),p=n(f),m=e("../icons"),h=e("../Button"),v=n(h),y=e("../../utils"),g=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={color:n.props.color||47,value:n.props.value||""},n.onChange=function(e){n.setState({value:e.target.value})},n.onInputKeyDown=function(e){e.keyCode==y.ASCII.ESC&&n.props.onCancel()},n.onColorChange=function(e){n.setState({color:e})},n.onSubmit=function(e){e.preventDefault();var t=n.state,r=t.value,o=t.color;n.props.onSubmit({value:r,color:o})},i=r,a(n,i)}return i(t,e),s(t,[{key:"renderWrapper",value:function(e){return u.default.createElement("table",{width:"100%"},u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("td",{colSpan:"2",className:"form_content text_box_holder"},e))))}},{key:"render",value:function(){var e=this.state,t=e.value,r=e.color,n=this.props,o=n.id,a=n.onCancel;return u.default.createElement("form",{className:"form_content",onSubmit:this.onSubmit},this.renderWrapper(u.default.createElement("div",{className:"text_box_holder"},u.default.createElement(p.default,{color:r,onChange:this.onColorChange},u.default.createElement("div",{style:{paddingTop:"26px",marginLeft:"5px"},className:"div_color counter_color menu_icon","data-track":"labels|add_or_edit_color"},u.default.createElement(m.LabelIcon,null))),u.default.createElement("input",{autoFocus:!0,value:t,onChange:this.onChange,onKeyDown:this.onInputKeyDown,autoComplete:"off",className:"richtext_editor",placeholder:_("Name your label")}))),u.default.createElement("div",{className:"td_submit"},u.default.createElement(v.default,{type:"submit",className:"ist_button ist_button_red submit_btn"},o?_("Save"):_("Add Label")),u.default.createElement(v.default,{className:"cancel",element:"span",onClick:a},_("Cancel"))))}}]),t}(u.default.Component);g.propTypes={id:d.default.number,color:d.default.number,value:d.default.string,onCancel:d.default.func,onSubmit:d.default.func},r.default=g},{"../../utils":484,"../Button":198,"../ColorPicker":199,"../icons":300,"prop-types":"prop-types",react:"react"}],303:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("./LabelWithMenu"),p=n(f),m=e("./LabelEditor"),h=n(m),v=e("../icons"),y=e("../sortable/Sortable"),g=(0,y.createSortableClass)("BottomLabelsList"),b=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.onRearrange=function(e){(0,n.props.onReorder)(e.reduce(function(e,t,r){return r+1!==t.item_order&&(e[t.id]=r+1),e},{}))},n.handleUpdate=function(e){var t=e.id,r=e.value,o=e.color,a=e.first,i=n.props,s=i.onCloseEdit,l=i.onLabelUpdate,u=i.onLabelCreate,c=i.labels,d=i.onReorder,f=i.onLabelSelect;if(t&&!r)return void s();if(t||r){if(t)return l({id:t,name:r,color:o}),f({id:t}),void s();if(a){var p=u({name:r,color:o,item_order:1});return d(c.reduce(function(e,t){return e[t.id]=t.item_order+1,e},{})),f(p),void s()}f(u({name:r,color:o,item_order:c.reduce(function(e,t){return t.item_order>e?t.item_order:e},0)+1})),s()}},n.deriveItemProps=function(e){var t=n.props,r=t.editing,o=t.onEdit,a=t.onCloseEdit,i=t.selectedLabelID,s=t.onFavoriteMenuClick,l=t.onDelMenuClick,u=t.onLabelSelect,c=t.labelCount;return{isEditing:r===e.id,isSelected:i===e.id,count:c[e.id]||0,onEdit:o,onCloseEdit:a,onFavoriteMenuClick:s,onDelMenuClick:l,onLabelSelect:u}},n.renderDragLabel=function(e){var t=n.props.labelCount[e.id];return u.default.createElement("li",{className:"clickable menu_clickable LabelListItem dragLabel",key:e.id,onClick:function(){return n.props.onLabelSelect(e)}},u.default.createElement(p.default,{label:e,color:e.color,leftIcon:u.default.createElement(v.LabelIcon,null)},n.renderLabelName(e),u.default.createElement("div",{className:"counter_count"},t>0&&u.default.createElement("div",{className:"counter_count"},t))))},n.renderLabel=function(e,t,r,o,a,i){var s=t.isEditing,l=t.isSelected,c=t.onEdit,d=t.onCloseEdit,f=t.onFavoriteMenuClick,m=t.onDelMenuClick,_=t.onLabelSelect,y=t.count;if(s)return u.default.createElement("li",{ref:i,key:e.id,className:"manager LabelListItem"},u.default.createElement(h.default,{id:e.id,color:e.color,onSubmit:function(t){var r=t.value,o=t.color;n.handleUpdate({id:e.id,value:r,color:o})},onCancel:d,value:e.name}));var g=r(u.default.createElement("div",{className:"dnd_handle"},u.default.createElement(v.DragAndDropIcon,null)));return u.default.createElement("li",{style:a,ref:i,className:"LabelListItem "+(o?"is_dragging":""),key:e.id,onClick:function(){return _(e)}},g,u.default.createElement(p.default,{onFavoriteMenuClick:f,onDelMenuClick:m,isSelected:l,onEditMenuClick:function(){return c(e.id)},label:e,color:e.color,leftIcon:u.default.createElement(v.LabelIcon,null)},n.renderLabelName(e),y>0&&u.default.createElement("div",{className:"counter_count"},y)))},i=r,a(n,i)}return i(t,e),s(t,[{key:"renderLabels",value:function(e){var t=this.props,r=t.editing,n=t.selectedLabelID,o=t.labelCount;return u.default.createElement(g,{id:"labels_list",editing:r,selectedLabelID:n,labelCount:o,onChange:this.onRearrange,renderListItem:this.renderLabel,renderDragLayer:this.renderDragLabel,deriveItemProps:this.deriveItemProps,items:e})}},{key:"renderLabelName",value:function(e){var t=e.name,r=t.match(/[^ ]{20}.+?/g);if(r){var n=!0,o=!1,a=void 0;try{for(var i,s=r[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value;t=t.replace(l,l.substr(0,21)+" <br />")}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}}return u.default.createElement("span",{dangerouslySetInnerHTML:{__html:t}})}},{key:"render",value:function(){var e=this,t=this.props,r=t.labels,n=t.editing,o=t.onCloseEdit;if(!t.isPremium)return u.default.createElement("ul",{id:"labels_list",className:"items generic_left_list"},u.default.createElement("li",{className:"empty"},_("Your list of labels will show up here.")));var a=u.default.createElement("li",{className:"manager"},u.default.createElement(h.default,{onSubmit:function(t){var r=t.value,o=t.color;e.handleUpdate({value:r,color:o,first:"top"===n})},onCancel:o}));return u.default.createElement("ul",{id:"labels_list",className:"items generic_left_list"},"top"===n&&a,this.renderLabels(r),"bottom"===n&&a)}}]),t}(u.default.Component);b.propTypes={isPremium:d.default.bool,editing:d.default.oneOfType([d.default.oneOf(["top","bottom"]),d.default.number]),onEdit:d.default.func,onCloseEdit:d.default.func,labels:d.default.array,labelCount:d.default.object,selectedLabelID:d.default.oneOfType([d.default.number,d.default.string]),onReorder:d.default.func,onDelMenuClick:d.default.func,onFavoriteMenuClick:d.default.func,onLabelCreate:d.default.func,onLabelUpdate:d.default.func,onLabelSelect:d.default.func},r.default=b},{"../icons":300,"../sortable/Sortable":396,"./LabelEditor":302,"./LabelWithMenu":304,"prop-types":"prop-types",react:"react"}],304:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=e("react"),d=n(c),f=e("prop-types"),p=n(f),m=e("../ListItem"),h=n(m),v=e("../../utils/format"),y=n(v),g=e("../../components/formatter/Formatter.js"),b=n(g),w=void 0,E={},k=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{onEditClick:null,onDelClick:null,onHide:null,onFavoriteClick:null};w||(w=new IstMenu,w.addItems(IstMenu.createItem(_("Edit label"),function(){E.onEditClick&&E.onEditClick(),w.hide()},{icon:svgs.get("sm1/edit.svg"),attr:{"data-track":"labels|menu_edit"}}),IstMenu.createItem(_("Add to favorites"),function(){E.onFavoriteClick&&E.onFavoriteClick(),w.hide()},{extra_class:"label_add_favorite_action",icon:svgs.get("sm1/heart.svg"),attr:{"data-track":"labels|menu_add_to_favorites"}}),IstMenu.createSeparator(),IstMenu.createItem(_("Delete label"),function(){E.onDelClick&&E.onDelClick(),w.hide()},{extra_class:"danger",icon:svgs.get("sm1/trash.svg"),attr:{"data-track":"labels|menu_delete"}})),$AEV(document,"click",function(e){w.shown&&w.hide(e)})),w.shown&&w.hide(),e.is_favorite?$hide($all("tr","label_add_favorite_action",w.menu_holder)):$show($all("tr","label_add_favorite_action",w.menu_holder)),E=r,w.hide_callbacks=[function(){return E.onHide&&E.onHide()}],w.show({},t)},S=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onMenuHide=function(){r.setState({menuOn:!1})},r.onEditClick=function(){r.props.onEditMenuClick(r.props.label)},r.onDelClick=function(){var e=r.props,t=e.label,n=e.onDelMenuClick,o=b.default.formatSimple(t.name,{only_text:!0,as_html:!1,with_link:!1}),a=SPAN($setHTML(SPAN(),(0,y.default)(_("Are you sure you want to delete {item_name}?"),{item_name:"<b>"+o+"</b>"})));Alerts.confirm(a,function(e){e&&n(t)},_("Delete"))},r.onFavoriteClick=function(){r.props.onFavoriteMenuClick(r.props.label)},r.onMenuClick=function(e){e.stopPropagation(),k(r.props.label,e,r.menuHandlers),r.setState({menuOn:!0})},r.onContextMenu=function(e){if(e.shift)return!0;e.preventDefault(),k(r.props.label,e,r.menuHandlers),r.setState({menuOn:!0})},r.menuHandlers={onEditClick:r.onEditClick,onDelClick:r.onDelClick,onHide:r.onMenuHide,onFavoriteClick:r.onFavoriteClick},r.state={menuOn:!1},r}return s(t,e),u(t,[{key:"componentWillUnmount",value:function(){E==this.menuHandlers&&(E={})}},{key:"render",value:function(){var e=this.props,t=(e._label,e.children),r=o(e,["_label","children"]);return d.default.createElement(h.default,l({},r,{onContextMenu:this.onContextMenu,onMenuClick:this.onMenuClick}),t)}}]),t}(d.default.Component);S.propTypes={label:p.default.object,children:p.default.node,onFavoriteMenuClick:p.default.func,onDelMenuClick:p.default.func,onEditMenuClick:p.default.func},r.default=S},{"../../components/formatter/Formatter.js":22,"../../utils/format":474,"../ListItem":207,"prop-types":"prop-types",react:"react"}],305:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../icons/PlusIcon"),p=n(f),m=e("../reactist/ExpansionPanel"),h=n(m),v=e("../reactist/ExpansionPanelSummary"),y=n(v),g=e("../../containers/LabelList"),b=n(g),w=e("../AddItem"),E=n(w),k=e("../Button"),S=n(k),j=e("../../containers/premium_promo/PremiumOnlyModal"),T=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(j),O=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={editing:null},n.addTopLabel=function(e){if(e.stopPropagation(),n.props.onTogglePanel(null,!0),!n.props.isPremium)return void T.showLabel();n.setState({editing:"top"})},n.addBottomLabel=function(){if(!n.props.isPremium)return void T.showLabel();n.setState({editing:"bottom"})},n.onEdit=function(e){n.setState({editing:e})},n.onCloseEdit=function(){n.setState({editing:null})},i=r,a(n,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.state.editing,t=this.props,r=t.expanded,n=t.onTogglePanel,o=t.isPremium,a=u.default.createElement(E.default,{onClick:this.addBottomLabel},_("Add Label"));return u.default.createElement(h.default,{expanded:r,onChange:n},u.default.createElement(y.default,{track:"navigation|labels_panel"},u.default.createElement("h5",null,_("Labels")),u.default.createElement(S.default,{className:"adder_icon",element:"span",onClick:this.addTopLabel,"data-track":"navigation|labels_quick_add"},u.default.createElement(p.default,null))),u.default.createElement(b.default,{isPremium:o,editing:e,onEdit:this.onEdit,onCloseEdit:this.onCloseEdit,handleEdit:this.handleEdit}),"top"!==e&&"bottom"!==e&&a)}}]),t}(u.default.Component);O.propTypes={expanded:d.default.bool,isPremium:d.default.bool,onTogglePanel:d.default.func},r.default=O},{"../../containers/LabelList":107,"../../containers/premium_promo/PremiumOnlyModal":120,"../AddItem":196,"../Button":198,"../icons/PlusIcon":291,"../reactist/ExpansionPanel":340,"../reactist/ExpansionPanelSummary":341,"prop-types":"prop-types",react:"react"}],306:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("./Website"),p=n(f),m=e("./Image"),h=n(m),_=e("./Icon"),v=n(_),y=e("./Audio"),g=n(y),b=e("../../../containers/ErrorBoundary"),w=n(b),E=e("../utils"),k=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"getFileType",value:function(){var e=this.props.attachment;return e.file_underlying_type||e.file_type||""}},{key:"getFileName",value:function(){var e=this.props.attachment;return"string"==typeof e.file_name?e.file_name.toLowerCase()||"":""}},{key:"getFileURL",value:function(){var e=this.props.attachment;return"string"==typeof e.file_url?e.file_url.toLowerCase()||"":""}},{key:"renderIconAttachment",value:function(e){var t=this.props.attachment;return u.default.createElement(v.default,{attachment:t,icon:e})}},{key:"isWebsite",value:function(e){var t=e.resourceType,r=e.attachment;return("website"===t||"rich"===t)&&r.title&&r.url}},{key:"isImage",value:function(e){var t=e.attachment;return(t.file_url||t.url)&&(t.image||t.tn_m)}},{key:"isOutlook",value:function(e){return"outlook/mail"===e.resourceType}},{key:"isLink",value:function(e){return 0===e.ftype.indexOf("td/hyperlink")}},{key:"isEmail",value:function(e){return 0===e.ftype.indexOf("td/")}},{key:"isAudio",value:function(e){var t=e.attachment,r=e.ftype;return t.file_url&&(-1!==t.file_url.indexOf("cloudfront.net")||-1!==t.file_url.indexOf("files.todoist.com"))&&-1!==r.indexOf("audio/")&&(0,E.canPlayAudio)(r)}},{key:"isPDF",value:function(e){return-1!==e.ftype.indexOf("pdf")}},{key:"isExcel",value:function(e){var t=e.fname,r=e.ftype;return-1!==t.indexOf(".xl")||-1!==r.indexOf("spreadsheet")}},{key:"isCode",value:function(e){var t=e.fname;return-1!==t.indexOf(".py")||-1!==t.indexOf(".php")||-1!==t.indexOf(".java")||-1!==t.indexOf(".rb")||-1!==t.indexOf(".js")}},{key:"isExtemail",value:function(e){var t=e.ftype,r=e.furl,n=e.attachment;return-1!==t.indexOf("/extemail")||-1!==r.indexOf(".email.")||"email"===n.resource_type}},{key:"renderContent",value:function(){var e=this.props.attachment;if(!e)return null;var t=this.getFileType(),r=this.getFileName(),n=this.getFileURL(),o=e.resource_type||"file",a={ftype:t,fname:r,furl:n,resourceType:o,attachment:e};return this.isWebsite(a)?u.default.createElement(p.default,{attachment:e}):this.isImage(a)?u.default.createElement(h.default,{attachment:e}):this.isOutlook(a)?this.renderIconAttachment("ft_outlook_mail"):this.isLink(a)?this.renderIconAttachment("ft_link"):this.isEmail(a)?this.renderIconAttachment("ft_email"):this.isAudio(a)?u.default.createElement(g.default,{attachment:e}):this.isPDF(a)?this.renderIconAttachment("ft_pdf"):this.isExcel(a)?this.renderIconAttachment("ft_excel"):-1!==r.indexOf(".doc")||-1!==t.indexOf("document")?this.renderIconAttachment("ft_word"):-1!==r.indexOf(".pp")?this.renderIconAttachment("ft_pp"):-1!==r.indexOf(".zip")?this.renderIconAttachment("ft_zip"):-1!==r.indexOf(".psd")?this.renderIconAttachment("ft_psd"):-1!==r.indexOf(".sketch")?this.renderIconAttachment("ft_sketch"):-1!==r.indexOf(".aep")?this.renderIconAttachment("ft_aep"):-1!==r.indexOf(".ai")?this.renderIconAttachment("ft_ai"):this.isCode(a)?this.renderIconAttachment("ft_code"):this.isExtemail(a)?this.renderIconAttachment("ft_extemail"):0===t.indexOf("text/")?this.renderIconAttachment("ft_text"):this.renderIconAttachment("ft_generic")}},{key:"render",value:function(){return u.default.createElement(w.default,{showErrorMsg:!1},this.renderContent())}}]),t}(u.default.Component);k.propTypes={attachment:d.default.object},r.default=k},{"../../../containers/ErrorBoundary":102,"../utils":325,"./Audio":307,"./Icon":308,"./Image":309,"./Website":310,"prop-types":"prop-types",react:"react"}],307:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.attachment,r={__html:svgs.getString("sm1/audio_stop.svg",{className:"icon_stop"})},n={__html:svgs.getString("sm1/audio_play.svg",{className:"icon_play"})},o={__html:svgs.getString("sm1/link.svg")};return i.default.createElement(c.default,{duration:t.file_duration,src:t.file_url},function(e){var a=e.play,s=e.stop,l=e.time,u=e.isPlaying;return i.default.createElement("div",{className:"audio_player"},i.default.createElement("span",{className:"play_control"},u&&i.default.createElement("span",{onClick:s,dangerouslySetInnerHTML:r}),!u&&i.default.createElement("span",{onClick:a,dangerouslySetInnerHTML:n})),i.default.createElement("span",{className:"timer"},(0,d.formatTime)(l)),i.default.createElement("a",{href:t.file_url,className:"audio_link",rel:"noopener noreferrer",target:"_blank",dangerouslySetInnerHTML:o}))})}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("../AudioPlayer"),c=n(u),d=e("../utils");o.propTypes={attachment:l.default.object}},{"../AudioPlayer":312,"../utils":325,"prop-types":"prop-types",react:"react"}],308:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.attachment,r=e.icon;if("ft_outlook_mail"===r)return s.default.createElement("div",{className:"file_attachment"},s.default.createElement("span",{className:"text"},$trim(t.file_name||"",50)));if("ft_email"===r){var n=d.default.format(t.file_url);return s.default.createElement("div",{className:"file_attachment link_attachment",dangerouslySetInnerHTML:{__html:n}})}var o=svgs.getString("ft/"+r+".svg",{className:"file_icon"});return s.default.createElement("div",{className:"file_attachment"},s.default.createElement("a",{onClick:"ft_extemail"===r?function(){return a(t)}:void 0,href:t.file_url,target:"_blank",rel:"noopener noreferrer"},s.default.createElement("span",{dangerouslySetInnerHTML:{__html:o}}),s.default.createElement("span",{className:"text"},$trim(t.file_name||"",50))))}function a(e){GB_show(e.file_name,e.file_url,500,800);var t=DIV({c:"orginal_link"},A({href:e.file_url,target:"_blank"},_("View in another window"))),r=$last(GB_CURRENT);return $addAfter(t,r.iframe),!1}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var i=e("react"),s=n(i),l=e("prop-types"),u=n(l),c=e("../../../components/formatter/Formatter"),d=n(c);o.propTypes={attachment:u.default.object,icon:u.default.string}},{"../../../components/formatter/Formatter":22,"prop-types":"prop-types",react:"react"}],309:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("react"),c=n(u),d=e("@doist/reactist/lib/Tooltip"),f=n(d),p=e("prop-types"),m=n(p),h=e("../../Modal"),v=n(h),y=e("../../icons"),g=e("../utils"),b=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={showBigImage:!1},n.showBigImage=function(e){e.preventDefault(),n.setState({showBigImage:!0})},n.hideBigImage=function(){n.setState({showBigImage:!1})},i=r,a(n,i)}return i(t,e),l(t,[{key:"renderBigImage",value:function(){var e=this.props.attachment,t=this.state.showBigImage;return c.default.createElement(v.default,{basic:!0,show:t,onClickOutside:this.hideBigImage},c.default.createElement("div",{className:"comments_attachment_big_image_container"},c.default.createElement("img",{onClick:this.hideBigImage,className:"comments_attachment_big_image",src:e.image}),c.default.createElement("div",null,c.default.createElement("a",{href:e.file_url,rel:"noreferrer noopener",target:"_blank"},_("View full size in another window")))))}},{key:"getImageSource",value:function(){var e=this.props.attachment,t=Array.from((0,g.calculateOptimalDimension)(e.image_width||300,e.image_height||200,300,200)),r=s(t,2),n=r[0],o=r[1];return-1===e.image.indexOf("resizeist")?"https://image-resize.todoist.com/?url="+encodeURIComponent(e.image)+"&width="+n+"&height="+o+"&fallback=true":e.image}},{key:"render",value:function(){var e=this.props.attachment;return c.default.createElement(c.default.Fragment,null,this.renderBigImage(),c.default.createElement("div",{className:"comments_attachment_container"},c.default.createElement("a",{href:e.file_url,onClick:this.showBigImage,className:"file_attachment with_preview",rel:"noreferrer noopener",target:"_blank"},c.default.createElement("img",{className:"comments_attachment_image",src:this.getImageSource()})),c.default.createElement("a",{href:e.file_url,target:"_blank",rel:"noopener noreferrer",className:"comments_attachment_download"},c.default.createElement(f.default,{delayShow:0,text:_("Download"),position:"bottom"
},c.default.createElement(y.DownloadIcon,null)))))}}]),t}(c.default.Component);b.propTypes={attachment:m.default.object},r.default=b},{"../../Modal":208,"../../icons":300,"../utils":325,"@doist/reactist/lib/Tooltip":189,"prop-types":"prop-types",react:"react"}],310:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.attachment,r=u.default.createElement(i,{attachment:t}),n=u.default.createElement(a,{attachment:t}),o="file_attachment "+(r?"has_image":"")+" "+(n?"has_content":"");return u.default.createElement("div",{className:o},u.default.createElement("a",{href:t.url,target:"_blank",rel:"noreferrer noopener"},r,n))}function a(e){var t=e.attachment;return t.image&&-1!==t.image.indexOf(".gif")?null:u.default.createElement("div",{className:"content_holder"},t.title&&u.default.createElement("div",{className:"text"},$trim(t.title,65)),t.description&&u.default.createElement("div",{className:"desc_text"},$trim(t.description,200)))}function i(e){var t=e.attachment;if(!t.image)return null;var r=Array.from((0,f.calculateOptimalDimension)(t.image_width,t.image_height,120,90)),n=s(r,2),o=n[0],a=n[1],i=-1===t.image.indexOf("resizeist")?"https://image-resize.todoist.com/?url="+encodeURIComponent(t.image)+"&width="+o+"&height="+a+"&fallback=true":t.image;return u.default.createElement("div",{className:"image_holder"},u.default.createElement("img",{src:i}))}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r.default=o;var l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../utils");o.propTypes={attachment:d.default.object},a.propTypes={attachment:d.default.object},i.propTypes={attachment:d.default.object}},{"../utils":325,"prop-types":"prop-types",react:"react"}],311:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./Attachment"),o=function(e){return e&&e.__esModule?e:{default:e}}(n);r.default=o.default},{"./Attachment":306}],312:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../Modal"),p=n(f),m=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={error:null,showError:!1,isPlaying:!1,time:0},n.audioRef=u.default.createRef(),n.handleStop=function(){clearInterval(n.timer);var e=n.audioRef.current;if(e)try{n.setState({isPlaying:!1,time:0}),e.pause(),e.currentTime=0}catch(e){}},n.handlePlay=function(){if(n.state.error)return void n.setState({showError:!0});var e=n.audioRef.current;e&&(e.play(),n.setState({isPlaying:!0}),n.handleStartTimer())},n.handleErrorModalClosing=function(){n.setState({showError:!1})},i=r,a(n,i)}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;this.audioRef.current.addEventListener("error",function(){e.setState({error:!0})})}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"handleStartTimer",value:function(){var e=this,t=this.props.duration;this.timer=setInterval(function(){e.setState(function(r){var n=r.time,o=n+1;return o>Math.ceil(t)?(setTimeout(e.handleStop,0),void clearInterval(e.timer)):{time:o}})},1e3)}},{key:"renderErrorModal",value:function(){var e=this.props.src,t=this.state.showError;return u.default.createElement(p.default,{show:t},u.default.createElement("div",{style:{width:"285px"}},u.default.createElement("span",null,_("There was an error loading the audio file. Maybe your browser does not support audio playback.")," ",u.default.createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer"},_("Direct link to the file."))),u.default.createElement("button",{onClick:this.handleErrorModalClosing},_("OK"))))}},{key:"render",value:function(){var e=this.props,t=e.children,r=e.src,n=this.state,o=n.isPlaying,a=n.time,i=t({time:a,isPlaying:o,play:this.handlePlay,stop:this.handleStop});return u.default.createElement(u.default.Fragment,null,i,u.default.createElement("audio",{volume:1,controls:!1,style:{display:"none"},ref:this.audioRef,src:r}))}}]),t}(u.default.Component);m.propTypes={duration:d.default.number,src:d.default.string,children:d.default.func},r.default=m},{"../Modal":208,"prop-types":"prop-types",react:"react"}],313:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.base_url="https://dcff1xvirvpfp.cloudfront.net/",i=r,a(n,i)}return i(t,e),s(t,[{key:"renderAnonymous",value:function(){var e=this.props,t=e.size,r=e.className;return u.default.createElement("img",{src:"https://d3ptyyxy2at9ui.cloudfront.net/circular_profile-4f3966.svg",className:"user_avatar "+(r||"")+" "+t})}},{key:"getSrc",value:function(){var e=this.props,t=e.user,r=e.size,n=e.theme;if(t.image_id)return""+this.base_url+t.image_id+"_"+r+".jpg";var o=50;"small"===r&&(o=18);var a=11===n?"1f1f1f":"ffffff";return"https://avatars.doist.com/?"+$encode({fullName:t.full_name||t.email.split("@")[0],email:t.email,size:2*o,bg:a})}},{key:"render",value:function(){var e=this.props,t=e.user,r=e.size,n=e.className;return t?u.default.createElement("img",{src:this.getSrc(),className:"user_avatar "+(n||"")+" "+r}):this.renderAnonymous()}}]),t}(u.default.Component);f.propTypes={user:d.default.object,size:d.default.oneOf(["small","medium"]),className:d.default.string,theme:d.default.number},f.defaultProps={size:"medium"},r.default=f},{"prop-types":"prop-types",react:"react"}],314:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../Modal"),p=n(f),m=e("../icons"),h=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={showDeleteConfirmation:!1},n.handleDeleteConfirmationShow=function(){n.setState({showDeleteConfirmation:!0})},n.handleDeleteConfirmationHide=function(){n.setState({showDeleteConfirmation:!1})},n.handleDelete=function(){n.props.onDelete(),n.handleDeleteConfirmationHide()},i=r,a(n,i)}return i(t,e),s(t,[{key:"renderDeleteConfirmation",value:function(){var e=this.state.showDeleteConfirmation;return u.default.createElement(p.default,{show:e,onClickOutside:this.handleDeleteConfirmationHide},u.default.createElement("div",{style:{width:"285px"},className:"alert_holder"},u.default.createElement("div",{className:"icon_holder"},u.default.createElement(m.InfoIcon,{width:28,height:28})),u.default.createElement("div",{className:"text_holder"},_("Are you sure you want to delete this?")),u.default.createElement("div",{className:"button_holder"},u.default.createElement("a",{className:"ist_button ist_button_red",onClick:this.handleDelete},u.default.createElement("span",null,_("Delete"))),u.default.createElement("button",{onClick:this.handleDeleteConfirmationHide,className:"ist_button_grey_hallow"},_("Cancel")))))}},{key:"render",value:function(){var e=this.props.children;return u.default.createElement(u.default.Fragment,null,e({showDeleteConfirmation:this.handleDeleteConfirmationShow}),this.renderDeleteConfirmation())}}]),t}(u.default.Component);h.propTypes={children:d.default.func,onDelete:d.default.func},r.default=h},{"../Modal":208,"../icons":300,"prop-types":"prop-types",react:"react"}],315:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../ResizableTextArea"),p=n(f),m=e("../icons"),h=e("../Dialog"),v=n(h),y=e("./Emojis"),g=n(y),b=e("../DropFiles"),w=n(b),E=e("../FileUploader"),k=n(E),S=e("./Recorder"),j=n(S),T=e("../Modal"),O=n(T),I=e("./File"),P=n(I),C=e("./NotifySelector"),D=n(C),A=e("../../containers/premium_promo/PremiumOnlyModal"),M=e("../../reducers/notes/notesConstants"),x=e("./utils"),R=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));N.call(r);var n=(0,x.getUsersToNotify)(e);return r.state={text:"",isWriting:!1,showFileAttaching:!1,showRecording:!1,showEmojisTooltip:!1,files:[],premiumError:null,usersToNotify:n},r}return i(t,e),s(t,[{key:"renderCommentActions",value:function(){var e=this.state.showEmojisTooltip;return u.default.createElement("div",{className:"comments_textarea_buttons textarea_buttons"},u.default.createElement("div",null,u.default.createElement("button",{type:"button",onClick:this.handleFileAttaching,className:"ist_button ist_button_upload_btn ist_button_mini"},u.default.createElement(m.AttachmentIcon,null)),u.default.createElement("button",{type:"button",onClick:this.handleRecording,className:"ist_button ist_button_upload_btn ist_button_mini"},u.default.createElement(m.MicrophoneIcon,null)),u.default.createElement("div",{style:{position:"relative"},className:"comments_textarea_button"},u.default.createElement("button",{ref:this.emojisButton,type:"button",onClick:this.handleEmojisTooltip,className:"ist_button ist_button_upload_btn ist_button_mini"},u.default.createElement(m.EmojiIcon,null)),e&&u.default.createElement(v.default,{anchor:this.emojisButton.current,onHide:this.handleEmojisTooltip,position:"right",width:222,isPositionFluid:!0,hasUnderlay:!0},u.default.createElement("div",{className:"comments_tooltip"},u.default.createElement(g.default,{onClick:this.handleEmojiSelect}))))),u.default.createElement("div",{className:"comments_textarea_submit"},u.default.createElement("button",{type:"submit",className:"ist_button ist_button_red sel_submit_note","data-track":"comments|add_comment"},_("Add Comment"))))}},{key:"renderRecording",value:function(){return u.default.createElement("div",{className:"comments_drop_container"},u.default.createElement(j.default,{onUpload:this.handleUpload,onClose:this.handleRecording}))}},{key:"renderFileAttaching",value:function(){var e=this,t=this.props.isPremium,r=t?void 0:this.handleFileUploadError;return u.default.createElement(k.default,{onUpload:this.handleUpload},function(n){var o=n.uploadFiles,a=n.uploadFromGoogleDrive,i=n.uploadFromDropBox;return u.default.createElement("div",{className:"comments_drop_container"},u.default.createElement("div",{className:"comments_drop_close",onClick:e.handleFileAttaching},u.default.createElement(m.Close,{width:"18",height:"18"})),u.default.createElement("h4",{className:"comments_drop_title"},_("Drag & drop files here")),u.default.createElement("ul",{className:"comments_drop_links"},u.default.createElement("li",{onClick:r,className:"comments_drop_link"},t&&u.default.createElement("input",{onChange:function(e){return o(e.target.files)},className:"comments_drop_computer",name:"file",type:"file",multiple:!0}),_("Computer")),u.default.createElement("li",{className:"comments_drop_link",onClick:i},_("Dropbox")),u.default.createElement("li",{onClick:a,className:"comments_drop_link"},_("Google Drive"))))})}},{key:"renderFiles",value:function(){var e=this,t=this.state.files;return 0===t.length?null:t.map(function(r){var n=function(){e.setState({files:t.filter(function(e){return e!==r})})};return u.default.createElement(P.default,{key:r.temporaryId,fileObject:r,onDelete:n})})}},{key:"renderPremiumModal",value:function(){var e=this.state.premiumError;return u.default.createElement(O.default,{show:Boolean(e),onClickOutside:this.handlePremiumModalClosing},u.default.createElement("div",{style:{width:"450px"}},u.default.createElement(A.PremiumModal,{feature:e,onClose:this.handlePremiumModalClosing})))}},{key:"renderDragging",value:function(e){var t=e?"comments_drop_container__hover":"";return u.default.createElement("div",{className:"comments_drop_container "+t},u.default.createElement("h4",{className:"comments_drop_title"},_("Drag & drop files here")))}},{key:"render",value:function(){var e=this,t=this.state,r=t.isWriting,n=t.text,o=t.showFileAttaching,a=t.showRecording,i=t.usersToNotify,s=this.props,l=s.user,c=s.collaborators;return r||n?u.default.createElement(k.default,{onUpload:this.handleUpload},function(t){var r=t.uploadFiles;return u.default.createElement("div",{className:"note_submit"},e.renderPremiumModal(),u.default.createElement("form",{onSubmit:e.handleSubmit},u.default.createElement(w.default,{onDrop:r},function(t){var s=t.isDragging,d=t.isHovering;return u.default.createElement("div",null,u.default.createElement("div",{className:"comments_textarea_holder"},u.default.createElement(p.default,{onPaste:function(t){return e.handlePaste(t,r)},onKeyDown:e.handleKeydown,onChange:e.handleTextChange,nodeRef:e.textarea,placeholder:_("Write a comment"),value:n}),u.default.createElement("div",{className:"files_view"},e.renderFiles()),a&&e.renderRecording(),o&&e.renderFileAttaching(),e.renderCommentActions(),s&&e.renderDragging(d)),u.default.createElement("div",null,u.default.createElement(D.default,{onChange:e.handleNotifyUsersUpdate,user:l,collaborators:c,usersToNotify:i})))})))}):u.default.createElement(k.default,{onUpload:this.handleUpload},function(t){var r=t.uploadFiles;return u.default.createElement(w.default,{onDrop:function(t){e.setState({isWriting:!0}),r(t)}},function(t){var r=t.isDragging,n=t.isHovering;return r?u.default.createElement("div",{className:"comments_textarea_holder"},e.renderDragging(n)):u.default.createElement("div",{className:"comments_editor_img",onClick:e.handleShowEditor},_("Write a comment"))})})}}]),t}(u.default.Component);R.propTypes={type:d.default.oneOf([M.TYPE_PROJECT_NOTE,M.TYPE_ITEM_NOTE]).isRequired,isPremium:d.default.bool.isRequired,onSubmit:d.default.func.isRequired,user:d.default.object.isRequired,collaborators:d.default.array.isRequired,notes:d.default.array.isRequired,item:d.default.object,project:d.default.object};var N=function(){var e=this;this.textarea=u.default.createRef(),this.emojisButton=u.default.createRef(),this.handleShowEditor=function(){e.setState({isWriting:!0},function(){e.textarea.current&&e.textarea.current.focus()})},this.handleSubmit=function(t){t.preventDefault();var r=e.props,n=r.onSubmit,o=r.isPremium,a=r.type,i=e.state,s=i.text,l=i.files,u=i.usersToNotify;if(!o)return void e.setState({premiumError:a===M.TYPE_PROJECT_NOTE?"FEATURE_PROJECT_COMMENT":"FEATURE_TASK_COMMENT"});n({text:s,usersToNotify:u,files:l}),e.setState({text:"",files:[]},function(){e.textarea.current&&e.textarea.current.focus()})},this.handleTextChange=function(t){e.setState({text:t})},this.handleEmojisTooltip=function(){e.setState(function(e){return{showEmojisTooltip:!e.showEmojisTooltip}})},this.handleFileAttaching=function(){e.setState(function(e){return{showFileAttaching:!e.showFileAttaching}})},this.handleRecording=function(){if(!e.props.isPremium)return void e.setState({premiumError:"FEATURE_AUDIO_RECORDING"});e.setState(function(e){return{showRecording:!e.showRecording}})},this.handleEmojiSelect=function(t){var r=e.textarea.current,n=r.value,o=r.selectionStart,a=r.selectionEnd,i=n.slice(0,o)+t+n.slice(a);e.setState({text:i,emojisTooltip:!1},function(){r.focus(),r.selectionStart=r.selectionEnd=o+t.length})},this.handleUpload=function(t){e.setState(function(e){return{showFileAttaching:!1,showRecording:!1,files:e.files.concat(t)}})},this.handleFileUploadError=function(){e.setState({premiumError:"FEATURE_SHARED_PROJECT_FILE_UPLOAD"})},this.handlePremiumModalClosing=function(){e.setState({premiumError:null})},this.handlePaste=function(e,t){if(e&&e.clipboardData){var r=e.clipboardData;if(r.types&&r.items){var n=[];r.types.forEach(function(e,t){if("text/plain"!==e){var o=r.items[t].getAsFile();o&&n.push(o)}}),n.length>0&&(e.preventDefault(),t(n))}}},this.handleKeydown=function(t){if((t.ctrlKey||t.metaKey)&&13==t.keyCode)return t.preventDefault(),e.handleSubmit(t),!1},this.handleNotifyUsersUpdate=function(t){e.setState({usersToNotify:t})}};r.default=R},{"../../containers/premium_promo/PremiumOnlyModal":120,"../../reducers/notes/notesConstants":430,"../Dialog":201,"../DropFiles":203,"../FileUploader":204,"../Modal":208,"../ResizableTextArea":210,"../icons":300,"./Emojis":316,"./File":317,"./NotifySelector":321,"./Recorder":324,"./utils":325,"prop-types":"prop-types",react:"react"}],316:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("react"),c=n(u),d=e("prop-types"),f=n(d),p=[[":-D","\ud83d\ude03"],[":-)","\ud83d\ude0a"],[";-)","\ud83d\ude09"],[";-D","\ud83d\ude02"],["^_^","\ud83d\ude01"],["(love)","\ud83d\ude0d"],[":-o","\ud83d\ude2e"],[":-P","\ud83d\ude0b"],[":-S","\ud83d\ude15"],[":-(","\ud83d\ude1e"],["-_-;","\ud83d\ude13"],["O:-)","\ud83d\ude07"],["X-(","\ud83d\ude21"],["}:-)","\ud83d\ude08"],[":-X","\ud83d\ude37"],[":-|","\ud83d\ude10"],[":-/","\ud83d\ude15"],[":'-(","\ud83d\ude22"],["(+1)","\ud83d\udc4d"],["(-1)","\ud83d\udc4e"],["(heart)","\u2764\ufe0f"],["(star)","\u2b50\ufe0f"],["(doh)","\ud83d\ude2b"]],m=function(e){function t(){var e,r,n,i;o(this,t);for(var l=arguments.length,u=Array(l),d=0;d<l;d++)u[d]=arguments[d];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.renderEmoji=function(e){var t=s(e,2),r=t[0],o=t[1],a=n.props.onClick;return c.default.createElement("li",{onClick:function(){return a(r)},className:"comments_emojis_element",key:r},o)},i=r,a(n,i)}return i(t,e),l(t,[{key:"render",value:function(){var e=p.map(this.renderEmoji);return c.default.createElement("ul",{className:"comments_emojis_list"},e)}}]),t}(c.default.Component);m.propTypes={onClick:f.default.func},r.default=m},{"prop-types":"prop-types",react:"react"}],317:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../icons"),p=e("../spinners"),m=e("@doist/reactist/lib/Tooltip"),h=n(m),v=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.cb=function(){return r.forceUpdate()},r.fv={remove:function(){},updateProgress:r.cb,uploadDone:function(){}},e.fileObject.addView(r.fv),e.fileObject.addCallback(r.cb),r}return i(t,e),s(t,[{key:"componentWillUnmount",value:function(){var e=this,t=this.props.fileObject;t.removeView(this.fv),t.callbacks=t.callbacks.filter(function(t){return t!==e.cb})}},{key:"getFileName",value:function(e){var t=e.file.name||e.file.fileName;return t||(e.file_server_info?e.file_server_info.title:"file")}},{key:"render",value:function(){var e=this.props,t=e.fileObject,r=e.onDelete,n=this.getFileName(t),o=!t.processed,a=t.progress_prct&&t.progress_prct<100&&u.default.createElement("b",{className:"progress_bar"},t.progress_prct,"%"),i=_("Could not upload the file due to an unknown error. Click to try again.");return u.default.createElement("div",{className:"file_to_upload"},u.default.createElement("span",{className:"icon"},u.default.createElement(f.DeleteIcon,{onClick:r})),u.default.createElement("span",{className:"filename"},n),o&&u.default.createElement("div",{className:"comments_drop_spinner"},u.default.createElement(p.RingSpinner,{width:16,height:16})),a,t.error&&u.default.createElement("b",{className:"progress_bar"},u.default.createElement(h.default,{delayShow:0,text:i,position:"top"},u.default.createElement(f.WarningIcon,{className:"comments_drop_warning",onClick:function(){return t.upload()},style:{marginRight:"8px"}}))))}}]),t}(u.default.Component);v.propTypes={fileObject:d.default.object,onDelete:d.default.func},r.default=v},{"../icons":300,"../spinners":401,"@doist/reactist/lib/Tooltip":189,"prop-types":"prop-types",react:"react"}],318:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../../containers/Avatar"),p=n(f),m=e("./Attachment"),h=n(m),v=e("@doist/reactist/lib/Tooltip"),y=n(v),g=e("../Dialog"),b=n(g),w=e("./ReactionsList"),E=n(w),k=e("./Reactions"),S=n(k),j=e("./NoteEditing"),T=n(j),O=e("./DeleteConfirmation"),I=n(O),P=e("../icons"),C=e("./utils"),D=e("../../components/formatter/Formatter"),A=n(D),M=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={showMenuReactions:!1},n.reactionsRef=u.default.createRef(),n.toggleReactionsMenu=function(){n.setState(function(e){return{showMenuReactions:!e.showMenuReactions}})},n.handleEdit=function(){var e=n.props,t=e.note;(0,e.onEditing)(t.id)},n.handleRemoveNote=function(){var e=n.props;(0,e.onRemoveNote)(e.note.id)},n.handleRemoveNote=function(){var e=n.props;(0,e.onRemoveNote)(e.note.id)},i=r,a(n,i)}return i(t,e),s(t,[{key:"renderReactions",value:function(e){var t=this.props,r=t.collaborators,n=t.user,o=t.onAddReaction,a=t.onRemoveReaction;return u.default.createElement(S.default,{note:e,user:n,collaborators:r,onAddReaction:o,onRemoveReaction:a})}},{key:"renderPossibleReactions",value:function(e){var t=this.props,r=t.note,n=t.user,o=t.onAddReaction,a=t.onRemoveReaction;return u.default.createElement(E.default,{onSelect:e,note:r,user:n,onAddReaction:o,onRemoveReaction:a})}},{key:"renderCommentActions",value:function(e){var t=this.props.user,r=this.state.showMenuReactions,n=e.posted_uid===t.id,o=n&&u.default.createElement(y.default,{delayShow:0,text:_("Edit"),position:"bottom"},u.default.createElement("span",{onClick:this.handleEdit,className:"menu_icon comments_actions_action"},u.default.createElement(P.EditIcon,{className:"comments_actions_icon"}))),a=n&&u.default.createElement(I.default,{onDelete:this.handleRemoveNote},function(e){var t=e.showDeleteConfirmation;return u.default.createElement(y.default,{delayShow:0,text:_("Delete"),position:"bottom"},u.default.createElement("span",{onClick:t,className:"menu_icon comments_actions_action"},u.default.createElement(P.DeleteIcon,{className:"comments_actions_icon"})))});return u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:"comments_actions"},o,a,u.default.createElement("span",{className:"menu_icon comments_actions_action",ref:this.reactionsRef},u.default.createElement(y.default,{delayShow:0,text:_("Add reaction"),position:"bottom"},u.default.createElement(P.ReactionIcon,{onClick:this.toggleReactionsMenu,className:"comments_actions_icon"})),r&&u.default.createElement(b.default,{nose:!0,anchor:this.reactionsRef.current,onHide:this.toggleReactionsMenu,width:258,hasUnderlay:!0},u.default.createElement("div",{className:"comments_tooltip"},this.renderPossibleReactions(this.toggleReactionsMenu))))))}},{key:"renderNote",value:function(){var e=this.props,t=e.collaborators,r=e.note,n=t.find(function(e){return e.id===r.posted_uid}),o=(0,C.getShortName)(n)||_("Someone"),a=window.DateUtils.formatView(r.posted),i=A.default.format(r.content,{as_html:!0,attachment:r.file_attachment}),s={opacity:r.is_buffer_obj?.6:1};return u.default.createElement("div",{style:s,className:"note_text has_avatar"},u.default.createElement(p.default,{user:n,size:"medium"}),u.default.createElement("div",{className:"comments_meta note_meta"},u.default.createElement("span",{className:"user_name"},o),u.default.createElement("span",{className:"time"},a),this.renderCommentActions(r)),u.default.createElement("span",{className:"note_content",dangerouslySetInnerHTML:{__html:i}}),u.default.createElement(h.default,{attachment:r.file_attachment}),this.renderReactions(r))}},{key:"renderEditing",value:function(){var e=this.props,t=e.onEditingClose,r=e.note,n=e.onUpdateNote,o=e.collaborators,a=e.user,i=r.posted_uid===a.id?a:o[r.posted_uid];return u.default.createElement("div",{className:"note_text has_avatar"},u.default.createElement(p.default,{user:i,size:"medium"}),u.default.createElement("div",{style:{marginLeft:"40px"}},u.default.createElement(T.default,{onEditingClose:t,onUpdateNote:n,note:r})))}},{key:"render",value:function(){return this.props.editing?this.renderEditing():this.renderNote()}}]),t}(u.default.Component);M.propTypes={user:d.default.object.isRequired,collaborators:d.default.array.isRequired,note:d.default.object.isRequired,onAddReaction:d.default.func.isRequired,onRemoveReaction:d.default.func.isRequired,onRemoveNote:d.default.func.isRequired,onUpdateNote:d.default.func.isRequired,editing:d.default.bool.isRequired,onEditing:d.default.func.isRequired,onEditingClose:d.default.func.isRequired},r.default=M},{"../../components/formatter/Formatter":22,"../../containers/Avatar":100,"../Dialog":201,"../icons":300,"./Attachment":311,"./DeleteConfirmation":314,"./NoteEditing":319,"./Reactions":322,"./ReactionsList":323,"./utils":325,"@doist/reactist/lib/Tooltip":189,"prop-types":"prop-types",react:"react"}],319:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called")
;return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../ResizableTextArea"),p=n(f),m=e("../Button"),h=n(m),v=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={showConfirmUpdating:!1,editingText:n.props.note.content},n.editTextarea=u.default.createRef(),n.handleSubmit=function(e){var t=n.props,r=t.onUpdateNote,o=t.note,a=n.state.editingText;e.preventDefault(),r(o.id,a)},n.handleKeydown=function(e){if((e.ctrlKey||e.metaKey)&&13==e.keyCode)return e.preventDefault(),n.handleSubmit(e),!1},i=r,a(n,i)}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.editTextarea.current&&this.editTextarea.current.focus()}},{key:"render",value:function(){var e=this,t=this.props.onEditingClose,r=this.state.editingText;return u.default.createElement("form",{onSubmit:this.handleSubmit},u.default.createElement("div",{className:"comments_textarea_holder"},u.default.createElement(p.default,{nodeRef:this.editTextarea,onKeyDown:this.handleKeydown,onChange:function(t){return e.setState({editingText:t})},placeholder:_("Write a comment"),value:r})),u.default.createElement("div",{className:"btn_area"},u.default.createElement(h.default,{className:"ist_button comments_textarea_cancel",onClick:t},_("Cancel")),u.default.createElement(h.default,{className:"ist_button ist_button_red",type:"submit"},_("Update"))))}}]),t}(u.default.Component);v.propTypes={note:d.default.object.isRequired,onUpdateNote:d.default.func.isRequired,onEditingClose:d.default.func.isRequired},r.default=v},{"../Button":198,"../ResizableTextArea":210,"prop-types":"prop-types",react:"react"}],320:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../emptyState"),p=e("./Note"),m=n(p),h=e("./Editor"),_=n(h),v=e("../../reducers/notes/notesConstants"),y=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),g.call(n),i=r,a(n,i)}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.scrollNotes()}},{key:"componentDidUpdate",value:function(e){e.notes.length<this.props.notes.length&&this.scrollNotes()}},{key:"renderEmpty",value:function(){var e=this.props.type,t=e===v.TYPE_PROJECT_NOTE?u.default.createElement(f.EmptyStateProjectComments,null):u.default.createElement(f.EmptyStateTaskComments,null);return u.default.createElement("div",{className:"comments_list_container"},t)}},{key:"renderContent",value:function(){var e=this,t=this.props,r=t.notes,n=t.collaborators,o=t.user,a=t.onAddReaction,i=t.onRemoveReaction,s=t.onRemoveNote,l=this.state.editing;return 0===r.length?this.renderEmpty():u.default.createElement("div",{ref:this.notesContainer,className:"comments_list_container notes_list"},r.map(function(t){return u.default.createElement(m.default,{key:t.id,editing:l===t.id,onEditing:e.handleEditing,onEditingClose:e.handleEditingClose,onAddReaction:a,onRemoveReaction:i,onRemoveNote:s,onUpdateNote:e.handleUpdateNote,user:o,note:t,collaborators:n})}))}},{key:"render",value:function(){var e=this.props,t=e.type,r=e.isPremium,n=e.user,o=e.collaborators,a=e.notes,i=e.item,s=e.project;return u.default.createElement("div",{className:"comments_container notes_holder"},this.renderContent(),u.default.createElement("div",{className:"comments_editor_container"},u.default.createElement(_.default,{item:i,project:s,notes:a,user:n,collaborators:o,type:t,isPremium:r,onSubmit:this.handleSubmitNote})))}}]),t}(u.default.Component);y.propTypes={type:d.default.oneOf([v.TYPE_PROJECT_NOTE,v.TYPE_ITEM_NOTE]),parentId:d.default.number,item:d.default.object,project:d.default.object,notes:d.default.array,user:d.default.object,collaborators:d.default.array,isPremium:d.default.bool,onAddReaction:d.default.func,onRemoveReaction:d.default.func,onRemoveNote:d.default.func,onAddNote:d.default.func,onUpdateNote:d.default.func};var g=function(){var e=this;this.state={editing:null},this.notesContainer=u.default.createRef(),this.scrollNotes=function(){var t=e.notesContainer.current;t&&(t.scrollTop=t.scrollHeight)},this.handleSubmitNote=function(t){var r=t.text,n=t.usersToNotify,o=t.files,a=e.props,i=a.onAddNote,s=a.type,l=a.parentId;(r||o&&o.length>0)&&i({parentId:l,type:s,content:r,files:o,usersToNotify:n})},this.handleEditing=function(t){e.setState({editing:t})},this.handleEditingClose=function(){e.setState({editing:null})},this.handleUpdateNote=function(){var t;e.setState({editing:null}),(t=e.props).onUpdateNote.apply(t,arguments)}};r.default=y},{"../../reducers/notes/notesConstants":430,"../emptyState":241,"./Editor":315,"./Note":318,"prop-types":"prop-types",react:"react"}],321:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("./Avatar"),p=n(f),m=e("../Button"),h=n(m),v=e("@doist/reactist/lib/Tooltip"),y=n(v),g=e("./utils"),b=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={isExpanded:!1},n.handleExpanding=function(){n.setState(function(e){return{isExpanded:!e.isExpanded}})},i=r,a(n,i)}return i(t,e),s(t,[{key:"renderUsers",value:function(e){var t=e.users,r=this.props,n=r.usersToNotify,o=r.onChange;return t.map(function(e){var t=n.some(function(t){return t===e.id}),r="user_"+e.id,a=function(){o(t?n.filter(function(t){return t!==e.id}):n.concat(e.id))};return u.default.createElement("div",{key:e.id,className:"user"},u.default.createElement("input",{id:r,type:"checkbox",checked:t,onChange:a}),u.default.createElement("label",{htmlFor:r},u.default.createElement(p.default,{user:e,size:"small"}),u.default.createElement("span",{className:"truncated"},(0,g.getShortName)(e))))})}},{key:"renderTooltip",value:function(e){var t=this.props,r=t.usersToNotify,n=t.collaborators,o=r.map(function(e){var t=n.find(function(t){return t.id===e}),r=(0,g.getShortName)(t)||_("Someone");return u.default.createElement("div",{key:e,className:"people_holder reacted_people",style:{textAlign:"left"}},u.default.createElement("div",{className:"user"},u.default.createElement(p.default,{className:"comments_reactions_avatar",user:t,size:"small"}),u.default.createElement("span",null,r)))});return u.default.createElement(y.default,{delayShow:0,text:u.default.createElement("div",null,o),position:"top"},e)}},{key:"renderText",value:function(e){var t=this,r=e.isEverybodyChecked,n=this.props,o=n.usersToNotify,a=n.collaborators,i=void 0,s=void 0;if(0===o.length)i=_("Notify <b>Nobody</b> about my comment");else if(r)i=_("Notify <b>Everybody</b> about my comment");else if(1===o.length){var l=a.find(function(e){return e.id===o[0]});i=_("Notify <b>%s</b> about my comment").replace("%s",(0,g.getShortName)(l))}else i=_("Notify <b>%s people</b> about my comment").replace("%s",o.length),s=!0;return i.replace(/(.*)<b>(.+)<\/b>(.*)/,function(e,r,n,o){var a=u.default.createElement("b",null,n);i=u.default.createElement(u.default.Fragment,null,r,s?t.renderTooltip(a):a,o)}),i}},{key:"renderSingleUserNotify",value:function(e){var t=this.props,r=t.usersToNotify,n=t.onChange,o=r.some(function(t){return t===e.id}),a=function(){var t=o?[]:[e.id];n(t)},i=_("Notify %s about my comment").replace("%s",(0,g.getShortName)(e));return u.default.createElement("div",{style:{textAlign:"right"}},u.default.createElement("div",{className:"who_to_notify"},u.default.createElement("input",{type:"checkbox",value:"notify_person",id:"notify_person",checked:o,onChange:a}),u.default.createElement("label",{htmlFor:"notify_person"},i)))}},{key:"render",value:function(){var e=this.props,t=e.collaborators,r=e.user,n=e.usersToNotify,o=e.onChange,a=this.state.isExpanded,i=t.filter(function(e){return e.id!==r.id});if(0===i.length)return null;if(1===i.length)return this.renderSingleUserNotify(i[0]);var s=i.some(function(e){return n.some(function(t){return t===e.id})}),l=i.every(function(e){return n.some(function(t){return t===e.id})}),c=function(){o(l?[]:i.map(function(e){return e.id}))},d=this.renderText({isEverybodyChecked:l});return u.default.createElement("div",{style:{textAlign:"right"}},u.default.createElement("div",{className:"who_to_notify "+(a?"expanded":"")},u.default.createElement("div",{className:"save_holder"},u.default.createElement(h.default,{element:"span",onClick:this.handleExpanding,className:"hide_button"},_("Hide"))),u.default.createElement("span",{className:"desc_text"},d),u.default.createElement(h.default,{element:"span",onClick:this.handleExpanding,className:"change"},_("Change")),u.default.createElement("div",{className:"selecter"},u.default.createElement("span",{className:"top_selecter"},u.default.createElement("input",{type:"checkbox",onChange:c,checked:s,id:"notify_toggle"}),u.default.createElement("label",{htmlFor:"notify_toggle"},_("Notify the following people"),":")),u.default.createElement("div",{className:"people people_holder"},this.renderUsers({users:i})))))}}]),t}(u.default.Component);b.propTypes={user:d.default.object.isRequired,collaborators:d.default.array.isRequired,usersToNotify:d.default.array.isRequired,onChange:d.default.func.isRequired},r.default=b},{"../Button":198,"./Avatar":313,"./utils":325,"@doist/reactist/lib/Tooltip":189,"prop-types":"prop-types",react:"react"}],322:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../../containers/Avatar"),p=n(f),m=e("@doist/reactist/lib/Tooltip"),h=n(m),v=e("../Dialog"),y=n(v),g=e("./ReactionsList"),b=n(g),w=e("./utils"),E=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.reactionsContainer=u.default.createRef(),n.state={showReactions:!1},n.toggleReactionsMenu=function(){n.setState(function(e){return{showReactions:!e.showReactions}})},i=r,a(n,i)}return i(t,e),s(t,[{key:"renderReactionsList",value:function(){var e=this.props,t=e.note,r=e.user,n=e.onAddReaction,o=e.onRemoveReaction;return this.state.showReactions&&u.default.createElement(y.default,{nose:!0,anchor:this.reactionsContainer.current,onHide:this.toggleReactionsMenu,position:"bottom",width:258,isPositionFluid:!0,hasUnderlay:!0},u.default.createElement("div",{className:"comments_tooltip"},u.default.createElement(b.default,{onSelect:this.toggleReactionsMenu,note:t,user:r,onAddReaction:n,onRemoveReaction:o})))}},{key:"render",value:function(){var e=this.props,t=e.note,r=e.collaborators,n=e.user,o=e.onAddReaction,a=e.onRemoveReaction;if(!t.reactions||t.reactions&&0===Object.keys(t.reactions).length)return null;var i=Object.keys(t.reactions).map(function(e){var i=t.reactions[e],s=i.includes(n.id),l="reaction_holder "+(s?"reacted":""),c=i.map(function(e){var t=r.find(function(t){return t.id===e}),n=(0,w.getShortName)(t)||"someone";return u.default.createElement("div",{key:e,className:"people_holder reacted_people"},u.default.createElement("div",{className:"user"},u.default.createElement(p.default,{className:"comments_reactions_avatar",user:t,size:"small"}),u.default.createElement("span",null,n)))}),d=u.default.createElement(u.default.Fragment,null,u.default.createElement("div",null,c));return u.default.createElement("span",{onClick:function(){(s?a:o)(t.id,e)},key:e,className:l},u.default.createElement(h.default,{delayShow:0,text:d,position:"bottom"},u.default.createElement("span",{className:"only_emojis"},u.default.createElement("span",{className:"emoji"},e)),u.default.createElement("span",{className:"reactions_count"},i.length)))});return u.default.createElement("div",{className:"comments_actions_line reactions_line"},i,u.default.createElement(h.default,{delayShow:0,text:_("Add reaction"),position:"bottom"},u.default.createElement("span",{ref:this.reactionsContainer,style:{position:"relative"},className:"reaction_holder reaction_plus form_action_icon menu_icon"},u.default.createElement("span",{onClick:this.toggleReactionsMenu},"+"),this.renderReactionsList())))}}]),t}(u.default.Component);E.propTypes={note:d.default.object.isRequired,user:d.default.object.isRequired,collaborators:d.default.array.isRequired,onAddReaction:d.default.func.isRequired,onRemoveReaction:d.default.func.isRequired},r.default=E},{"../../containers/Avatar":100,"../Dialog":201,"./ReactionsList":323,"./utils":325,"@doist/reactist/lib/Tooltip":189,"prop-types":"prop-types",react:"react"}],323:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=["\ud83d\udc4d","\ud83d\udc4e","\u2764\ufe0f\ufe0f","\ud83d\ude04","\ud83d\ude02","\ud83d\ude2e","\ud83d\ude22","\ud83d\ude21","\ud83d\udc4f","\ud83c\udf89"],p=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.renderReaction=function(e){var t=n.props,r=t.note,o=t.onSelect,a=t.user,i=t.onRemoveReaction,s=t.onAddReaction,l=function(){(r.reactions&&r.reactions[e]&&r.reactions[e].includes(a.id)?i:s)(r.id,e),o()};return u.default.createElement("li",{onClick:l,key:e,className:"comments_reactions_element"},u.default.createElement("span",{className:"only_emojis"},u.default.createElement("span",{className:"emoji"},e)))},i=r,a(n,i)}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("ul",{className:"comments_reactions_list"},f.map(this.renderReaction))}}]),t}(u.default.Component);p.propTypes={note:d.default.object,onSelect:d.default.func,user:d.default.object,onRemoveReaction:d.default.func,onAddReaction:d.default.func},r.default=p},{"prop-types":"prop-types",react:"react"}],324:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../Modal"),p=n(f),m=e("./AudioPlayer"),h=n(m),v=e("../icons"),y=e("./utils");navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var g=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={time:0,isRecording:!1,error:!1,audioURL:null},n.handleAttach=function(){var e=n.props.onUpload,t=n.state.time;n.audioBlob.name="voice"+(new Date).getTime()+".wav";var r=new window.GFile;r.file=n.audioBlob,r.duration=t,r.upload(),e(r)},n.handleErrorClose=function(){n.setState({error:!1})},n.handleRetake=function(){n.setState({time:0,audioURL:null},n.handleRecord)},n.handleRecord=function(){var e=function(e){n.setState({isRecording:!0}),window.AudioContext=window.AudioContext||window.webkitAudioContext;var t=new window.AudioContext,r=t.createMediaStreamSource(e);n.recorder=new window.Recorder(r,e),n.recorder.record(),n.handleStartTimer()},t=function(){n.setState({error:!0})};navigator.getUserMedia?navigator.getUserMedia({audio:!0},e,t):t()},n.handleStopRecord=function(){n.setState({isRecording:!1},function(){n.recorder.stop(),n.handleStopTimer(),n.recorder.exportWAV(function(e){n.audioBlob=e;var t=URL.createObjectURL(e);n.setState({audioURL:t})})})},i=r,a(n,i)}return i(t,e),s(t,[{key:"componentWillUnmount",value:function(){this.state.isRecording&&this.handleStopRecord()}},{key:"handleStartTimer",value:function(){var e=this;this.timer=setInterval(function(){e.setState(function(t){var r=t.time,n=r+1;return n>240?(e.handleStopTimer(),void e.handleStopRecord()):{time:n}})},1e3)}},{key:"handleStopTimer",value:function(){clearInterval(this.timer)}},{key:"renderErrorModal",value:function(){var e=this.state.error;return u.default.createElement(p.default,{show:e,onClickOutside:this.handleErrorClose},u.default.createElement("div",{style:{width:"285px"}},_("Your browser does not seem to support HTML5 Audio recording :-("),u.default.createElement("div",{className:"button_holder"},u.default.createElement("button",{className:"ist_button ist_button_red",onClick:this.handleErrorClose},_("OK")))))}},{key:"renderButtons",value:function(e){var t=e.play,r=e.isPlaying,n=e.stop,o=this.state,a=o.isRecording,i=o.audioURL,s=!a&&!i&&u.default.createElement("div",{className:"comments_drop_link",onClick:this.handleRecord},_("Record")),l=a&&u.default.createElement("div",{className:"comments_drop_link",onClick:this.handleStopRecord},_("Stop")),c=i&&u.default.createElement("div",{className:"comments_drop_link",onClick:this.handleRetake},_("Retake")),d=i&&u.default.createElement("div",{className:"comments_drop_link",onClick:r?n:t},_(r?"Stop":"Play")),f=i&&u.default.createElement("div",{className:"comments_drop_link",onClick:this.handleAttach},_("Attach"));return u.default.createElement("div",{className:"comments_drop_links"},s,l,c,d,f)}},{key:"render",value:function(){var e=this,t=this.props.onClose,r=this.state,n=r.audioURL,o=r.time;return u.default.createElement(u.default.Fragment,null,u.default.createElement(h.default,{src:n,duration:o},function(r){var n=r.play,a=r.isPlaying,i=r.stop,s=r.time;return u.default.createElement(u.default.Fragment,null,e.renderErrorModal(),u.default.createElement("div",{className:"comments_drop_close",onClick:t},u.default.createElement(v.Close,{width:"18",height:"18"})),u.default.createElement("h4",{className:"comments_drop_title"},(0,y.formatTime)(a?s:o)),e.renderButtons({play:n,isPlaying:a,stop:i}))}))}}]),t}(u.default.Component);g.propTypes={onUpload:d.default.func,onClose:d.default.func},r.default=g},{"../Modal":208,"../icons":300,"./AudioPlayer":312,"./utils":325,"prop-types":"prop-types",react:"react"}],325:[function(e,t,r){"use strict";function n(e){if(!e)return"";var t=e.full_name.split(" ");return t.length>1?t[0]+" "+t[1].substring(0,1)+".":t[0]}function o(e){var t=document.createElement("audio");return Boolean(t.canPlayType&&t.canPlayType(e).replace(/no/,""))}function a(e,t,r,n){var o=void 0;return e/t>r/n?e<=r?[e,t]:(o=r/e,[r,Math.floor(t*o)]):t<=n?[e,t]:(o=n/t,[Math.floor(e*o),n])}function i(e){var t=Math.floor(e/60),r=e%60;return(t<10?"0"+t:t)+":"+(r<10?"0"+r:r)}function s(e){var t=e.user,r=e.collaborators,n=e.notes,o=e.type,a=e.item,i=[],s=function(e){var n=r.map(function(e){return e.id});e&&e!==t.id&&n.includes(e)&&!i.includes(e)&&i.push(e)};if(0!==n.length){var u=n[n.length-1];(u.uids_to_notify||[]).concat(u.posted_uid).forEach(s)}else o===l.TYPE_ITEM_NOTE?(s(a.assigned_by_uid),s(a.responsible_uid)):r.forEach(function(e){return s(e.id)});return i}Object.defineProperty(r,"__esModule",{value:!0}),r.getShortName=n,r.canPlayAudio=o,r.calculateOptimalDimension=a,r.formatTime=i,r.getUsersToNotify=s;var l=e("../../reducers/notes/notesConstants")},{"../../reducers/notes/notesConstants":430}],326:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("../../utils/fp"),u=e("redux"),c=e("react"),d=n(c),f=e("prop-types"),p=n(f),m=e("../../models/Colors"),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(m),v=e("../../utils/isoToDate"),y=n(v),g=e("../../utils/highDefCanvas"),b=n(g),w=window,E=w.DateUtils,k=window,S=k.IstTooltip,j=function(e){var t=(0,y.default)(e);return E.getWeekdayShort(t)},T=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.canvas=null,r.chartHolder=null;var n=r.props,i=n.stat,s=n.goal,c=n.width,d=(0,u.compose)(l.sum,(0,l.map)(function(e){return e.completed})),f=(0,u.compose)(l.max,(0,l.map)(d),(0,l.map)(function(e){return e.items}))(i);return r.pxPerCount=(c-55)/(0,l.max)([f,s]),r.goalLineHeight=20*r.props.stat.length+10,r}return i(t,e),s(t,[{key:"componentDidUpdate",value:function(){this.drawCanvas()}},{key:"componentDidMount",value:function(){this.drawCanvas();var e=this.props,t=e.goal,r=e.stat,n=t*this.pxPerCount-7,o=4==r.length,a=o?SPAN(_("Weekly Goal"),": ",B(t)):SPAN(_("Daily Goal"),": ",B(t));S.showSimpleText(this.chartHolder,a,null,-1,n)}},{key:"drawCanvas",value:function(){var e=this.props,t=e.goal,r=e.stat,n=20*r.length+10,o=this.canvas.getContext("2d");(0,b.default)(this.canvas,o);var a=this.pxPerCount*t,i=n-4;o.strokeStyle="#a5a5a5",o.fillStyle="#a5a5a5",o.lineWidth=1.5,o.beginPath(),o.moveTo(a,4),o.lineTo(a,i),o.stroke(),o.closePath(),o.beginPath(),o.arc(a,4,2,0,2*Math.PI,!1),o.fill(),o.closePath(),o.beginPath(),o.arc(a,i,2,0,2*Math.PI,!1),o.fill(),o.closePath()}},{key:"renderSingleBar",value:function(e,t,r){var n=r&&10===r.length,o=n?j(r):null;if(0===e.length)return d.default.createElement("li",{key:r},d.default.createElement("div",{className:"project_colors"},d.default.createElement("div",{key:0,className:"project_viz",style:{width:"1px"}})),n?d.default.createElement("span",{className:"short_date"},o):null,d.default.createElement("b",null,"0"));var a=e.map(function(e,t){var r=e.colorHex,n=e.width;return d.default.createElement("div",{key:t,className:"project_viz",style:{backgroundColor:r,width:n}})});return d.default.createElement("li",{key:r},d.default.createElement("div",{className:"project_colors"},a),n?d.default.createElement("span",{className:"short_date"},o):null,d.default.createElement("b",null,t))}},{key:"render",value:function(){var e=this,t=this.props,r=t.stat,n=t.idToColor,o=t.width,a=(0,u.compose)(l.sum,(0,l.map)(function(e){return e.completed})),i=[],s=!0,c=!1,f=void 0;try{for(var p,m=r[Symbol.iterator]();!(s=(p=m.next()).done);s=!0){var _=p.value,v=_.date,y=_.items,g=a(y),b=y.map(function(t){return{color:n[t.id],colorHex:h.getHex("project",n[t.id]),width:e.pxPerCount*t.completed}});b.sort(function(e,t){return e.color-t.color}),i.push(this.renderSingleBar(b,g,v))}}catch(e){c=!0,f=e}finally{try{!s&&m.return&&m.return()}finally{if(c)throw f}}var w={width:o,height:this.goalLineHeight,overflow:"hidden"};return d.default.createElement("div",{className:"completed_bar_chart",ref:function(t){return e.chartHolder=t}},d.default.createElement("ul",null,i),d.default.createElement("div",{className:"goalline",style:w},d.default.createElement("canvas",{ref:function(t){return e.canvas=t},width:o,height:this.goalLineHeight.height})))}}]),t}(d.default.PureComponent);T.propTypes={stat:p.default.arrayOf(p.default.shape({date:p.default.string,items:p.default.array})).isRequired,goal:p.default.number,idToColor:p.default.object.isRequired,width:p.default.number},T.defaultProps={width:225},r.default=T},{"../../models/Colors":161,"../../utils/fp":477,"../../utils/highDefCanvas":482,"../../utils/isoToDate":493,"prop-types":"prop-types",react:"react",redux:"redux"}],327:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("../../utils/format"),u=n(l),c=e("react"),d=n(c),f=e("prop-types"),p=n(f),m=e("./CompletedBarChart"),h=n(m),v=e("./ProgressRing"),y=n(v),g=e("./utils"),b=e("./MedalIcon"),w=n(b),E=e("./MotivatorCatelog"),k=n(E),S=e("../../utils"),j=e("../../constants/themes"),T=new k.default({p0:[_("What will you focus on first?"),_("Just take it one task at a time."),_("What\u2019s first on your list?")],p25:[_("You\u2019re off to a great start. Keep it up!"),_("Nice first steps. Keep moving forward!"),_("Getting started is the hardest part. Keep going!")],p75:[_("You\u2019re making great progress. Stay focused!"),_("You\u2019ve got some great momentum!"),_("You\u2019re on your way!"),_("Nothing can stop you!")],p100:[_("You\u2019re almost there. Keep going!"),_("It\u2019s the last stretch of the day!"),_("It\u2019s the final leg. You\u2019ve got this!")],p100plus:[_("Well done, {user_name}!"),_("You conquered the day, {user_name}!"),_("Nice work, {user_name}!"),_("Mischief managed. Well done!")]}),O=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),s(t,[{key:"renderStatus",value:function(){var e=this.props,t=e.goal,r=e.completed,n=_n("Daily goal: <b>{num_completed}/{num_goal} task</b>","Daily goal: <b>{num_completed}/{num_goal} tasks</b>",t),o=_n("Daily goal completed: <b>{num_completed}/{num_goal} task</b>","Daily goal completed: <b>{num_completed}/{num_goal} tasks</b>",t),a=_("Edit goal"),i=r<t?n:o;i=(0,u.default)(i,{num_completed:r,num_goal:t});var s=r/t,l=(0,u.default)(T.get(s),{user_name:(0,S.firstName)(this.props.userName)});return d.default.createElement("div",null,d.default.createElement("h4",{dangerouslySetInnerHTML:{__html:i}}),d.default.createElement("p",null,l),d.default.createElement("a",{className:"edit_link","data-track":"karma|tab_daily_edit_goal",onClick:this.props.onEditGoalClick},a))}},{key:"renderStreaks",value:function(){if((0,g.isNilStreakData)(this.props.currentStreak))return null;var e=this.props.currentStreak.count,t=_n("You've completed your goal 1 day in a row.","You've completed your goal {n} days in a row.",e);t=(0,u.default)(t,{n:e});var r=void 0;if(!(0,g.isNilStreakData)(this.props.maxStreak)){
var n=this.props.maxStreak.count,o=_n("Your longest streak: 1 day","Your longest streak: {n} days",n);o=(0,u.default)(o,{n:n});var a=this.props.maxStreak,i=a.start,s=a.end,l=(0,g.formatInterval)(i,s);r=d.default.createElement("p",{className:"sm"},o,d.default.createElement("br",null),"(",l,")")}return d.default.createElement("div",{className:"section_streak"},d.default.createElement("p",null,t),r)}},{key:"render",value:function(){var e=this.props,t=e.daysItems,r=e.projectColors,n=e.goal,o=e.completed,a=e.theme,i=e.disableAnimation,s=e.width,l=o/n,u=(0,j.colorInHex)(a);a!==j.THEME_SUNFLOWER&&a!==j.THEME_NEUTRAL||(u=(0,j.colorInHex)(j.THEME_NOIR)),a===j.THEME_DARK&&(u=j.DARK_THEME_ICON_COLOR);var c=a===j.THEME_DARK?j.DARK_THEME_ICON_COLOR_DARKER:"#B3B3B3",f=l<1?c:u,p=a===j.THEME_DARK?j.DARK_THEME_ICON_COLOR_DARKER:"#E6E6E6";return d.default.createElement("div",null,d.default.createElement("div",{className:"goal_status section_progress"},d.default.createElement(y.default,{className:"pie_chart",width:72,color:u,strokeColor:p,disableAnimation:i,progress:Math.min(l,1),animationStart:500,animationDuration:1200},d.default.createElement(w.default,{width:45,color:f})),this.renderStatus()),this.renderStreaks(),d.default.createElement("div",{className:"section_completebar"},d.default.createElement("h6",{className:"section_title"},_("Completed in the last 7 days")),d.default.createElement(h.default,{width:s,stat:t,idToColor:r,goal:n})))}}]),t}(d.default.PureComponent);O.propTypes={width:p.default.number,daysItems:p.default.arrayOf(p.default.shape({date:p.default.string,items:p.default.array})),maxStreak:p.default.shape({count:p.default.number,start:p.default.string,end:p.default.string}),currentStreak:p.default.object,projectColors:p.default.object,goal:p.default.number,completed:p.default.number,userName:p.default.string,color:p.default.string,theme:p.default.numbrer,disableAnimation:p.default.bool,onEditGoalClick:p.default.func},O.defaultProps={disableAnimation:!1},r.default=O},{"../../constants/themes":99,"../../utils":484,"../../utils/format":474,"./CompletedBarChart":326,"./MedalIcon":331,"./MotivatorCatelog":332,"./ProgressRing":334,"./utils":338,"prop-types":"prop-types",react:"react"}],328:[function(e,t,r){"use strict";function n(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=function(e){var t=e.level,r=e.color,a=e.width,s=n(e,["level","color","width"]),u=a;return i.default.createElement("svg",o({width:a,height:u,viewBox:"0 0 48 48"},s),i.default.createElement("defs",null,i.default.createElement("linearGradient",{x1:"50%",y1:"0%",x2:"50%",y2:"100%",id:"karma_gradient"},i.default.createElement("stop",{stopColor:r,stopOpacity:"0.7",offset:"0%"}),i.default.createElement("stop",{stopColor:r,offset:"100%"}))),i.default.createElement("g",{fill:"url(#karma_gradient)"},i.default.createElement("path",{d:l(t)})))},l=function(e){switch(e){case 0:return"M24,35.5 C23.4922575,34.6160564 17.4279735,29.0769802 15.5491755,24.6276455 C15.2124383,23.6024532 15,22.6896523 15,21.9834087 C15,13.6034107 20.4495689,12.5 24,12.5 C27.5504311,12.5 33,13.6034107 33,21.9834087 C33,22.7071186 32.7747552,23.6510549 32.4199381,24.7142173 C30.5057337,29.1627926 24.5069892,34.622891 24,35.5 L24,35.5 Z";case 1:return"M24,8.5 C27.5504311,8.5 33,9.22138793 33,17.5745 C33,20.8006862 28.6608354,26.3696799 27.0133088,30.4156594 C24.3939901,36.8483505 24,39.5 24,39.5 C24,39.5 23.6029966,36.8286695 20.9866912,30.4156594 C19.3293714,26.3552975 15,20.8135546 15,17.5745 C15,9.22138793 20.4495689,8.5 24,8.5 L24,8.5 Z";case 2:return"M34.3341908,22.1449031 C34.3341908,30.6167582 25.25,37.5 25.25,37.5 L25.25,34.1295334 L25.25,18.0254439 C25.25,9.55283987 30.9014098,10.5347691 33.577238,10.5347691 C36.2523093,10.5347691 34.3341908,13.6730481 34.3341908,22.1449031 Z M14.6658092,22.1449031 C14.6658092,13.6730481 12.7476907,10.5347691 15.422762,10.5347691 C18.0985902,10.5347691 23.75,9.55283987 23.75,18.0254439 L23.75,34.1295334 L23.75,37.5 C23.75,37.5 14.6658092,30.6167582 14.6658092,22.1449031 Z";case 3:return"M11.2039067,9 C14.9126968,9 21.4,9.51672416 21.4,18.0003 L21.4,33.0003 L21.4,39 C21.4,39 12.2039067,29.4829759 12.2039067,21.00015 C12.2039067,12.5173241 9.49511662,9 12.2039067,9 Z M35.7960933,9 C38.5048834,9 35.7960933,12.5173241 35.7960933,21.00015 C35.7960933,29.4829759 26.6,39 26.6,39 L26.6,33.0003 L26.6,18.0003 C26.6,9.51672416 33.0873032,9 35.7960933,9 Z";case 4:return"M8.73765498,11.0652174 C11.3560232,11.0652174 20.952381,17.6768433 20.952381,26.2826087 L20.952381,41.5 C20.952381,41.5 12.8049045,40.0483335 11.7911456,23.2392826 C11.2728156,14.6494947 6.11928675,11.0652174 8.73765498,11.0652174 Z M39.2364976,11.0652174 C41.9171215,11.0652174 36.7196515,14.6494947 36.1894684,23.2392826 C35.1511932,40.0483335 27.047619,41.5 27.047619,41.5 L27.047619,26.2826087 C27.047619,17.6768433 36.5558736,11.0652174 39.2364976,11.0652174 Z M24,6.5 C25.1835937,6.5 27,6.9975096 27,10.7796525 C27,14.5617954 24,20.1956522 24,20.1956522 C24,20.1956522 21,14.5617954 21,10.7796525 C21,6.9975096 22.8164062,6.5 24,6.5 Z";case 5:return"M6,19.6363636 C12.5502577,19.6363636 18.4900102,25.0448977 20.694,31.2730389 C22.5754726,36.5892127 23.6326531,37.091013 23.6326531,37.091013 C23.6326531,37.091013 23.6326531,35.8183312 23.6326531,40 C18.7655089,40 13.9747698,37.0488327 11.8773061,31.2730389 C8.2759868,21.3533932 6,22.4900799 6,19.6363636 Z M24.0003646,8 C24.0003646,8 27.2843944,9.21376761 29.8334549,10.9089697 C31.4258885,11.9678347 32.75,13.8179394 32.75,13.8179394 C32.75,13.8179394 29.1940023,16.6076413 26.9169097,19.6366061 C24.8272051,22.4153994 24.0003646,25.4545455 24.0003646,25.4545455 C24.0003646,25.4545455 23.2464376,22.5128498 21.0838194,19.6366061 C18.8723491,16.6956377 15.25,13.8179394 15.25,13.8179394 C15.25,13.8179394 16.6156723,11.9401995 18.1672743,10.9089697 C20.7272718,9.20649518 24.0003646,8 24.0003646,8 Z M42,19.6363636 C42,22.8173409 39.7240132,21.3533932 36.1226939,31.2730389 C34.0252302,37.0488327 29.2344911,40 24.3673469,40 C24.3673469,35.8183312 24.3673469,37.091013 24.3673469,37.091013 C24.3673469,37.091013 25.4245274,36.5892127 27.306,31.2730389 C29.5099898,25.0448977 35.4497423,19.6363636 42,19.6363636 Z";case 6:return"M30.9866785,26.31856 C32.837713,23.4054756 34.6740291,20.8399049 35.9673256,19.4937112 C44.7374194,10.3631561 40.9311693,24.5778132 38.9839734,28.3050478 C35.4253273,35.1146488 25.6142613,39.9058175 24.0979394,40.6151368 C24.0993101,40.6463881 24.1000004,40.6767717 24.1000004,40.706272 C24.1000004,40.706272 24.0637515,40.6918003 23.9946652,40.6631075 C23.9325212,40.6917468 23.8999996,40.706272 23.8999996,40.706272 C23.8999996,40.6796963 23.9005913,40.6523374 23.9017671,40.6242081 C22.3844859,39.9841274 12.5746114,35.6300737 9.01629119,28.6310582 C7.06832754,24.8011907 3.26289798,10.1910951 12.0328822,19.5752138 C13.3493838,20.9837268 15.2285682,23.6081896 17.1131724,26.5614364 L13,16.556599 L21.0668622,24.8577897 C21.0668622,24.8577897 22.5334311,26.3670971 24,26.3670971 C25.4665689,26.3670971 26.9331378,24.8577897 26.9331378,24.8577897 L35,16.556599 L30.9866785,26.31856 Z M24,7.5 L31.5,11.9997188 L24,19.5 L16.5,11.9997188 L24,7.5 Z";case 7:return"M21.0001875,18.8888348 C21.0001875,18.8888348 22.5000937,20.3702066 24,20.3702066 C25.4999063,20.3702066 26.9998125,18.8888348 26.9998125,18.8888348 L36,9.99986364 L26.9998125,27.7770653 C26.9998125,27.7770653 25.4249109,29.9998636 24,29.9998636 C22.431848,29.9998636 21.0001875,27.7770653 21.0001875,27.7770653 L12,9.99986364 L21.0001875,18.8888348 Z M23.75,40 C23.75,40 12.4318815,35.5474524 8.5377368,27.9997955 C6.57317123,24.1937185 2.73530912,9.67437844 11.5800373,19.0002045 C15.3623775,22.9877733 23.75,36.7818963 23.75,40 Z M23.75,40.072485 C23.75,36.8543812 32.1376225,23.0602582 35.9199627,19.0726895 C44.7646909,9.7468634 40.9268288,24.2662034 38.9622632,28.0722804 C35.0681185,35.6199373 23.75,40.072485 23.75,40.072485 Z M30,9.99986364 L24,16.0003409 L18,9.99986364 L24,7 L30,9.99986364 Z"}};r.default=s},{react:"react"}],329:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("./KarmaTrend"),p=n(f),m=e("./utils"),h=e("../../utils/format"),v=n(h),y=e("./ProgressRing"),g=n(y),b=e("./KarmaIcon"),w=n(b),E=e("../../constants/themes"),k=[_x("karma","You are a <b>Beginner</b>"),_x("karma","You are a <b>Novice</b>"),_x("karma","You are an <b>Intermediate</b>"),_x("karma","You are a <b>Professional</b>"),_x("karma","You are an <b>Expert</b>"),_x("karma","You are a <b>Master</b>"),_x("karma","You are a <b>Grand Master</b>"),_x("karma","You are <b>Enlightened</b>")],S=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.karma,r=e.theme,n=e.trendData,o=e.disableAnimation,a=(0,E.colorInHex)(r);r!==E.THEME_SUNFLOWER&&r!==E.THEME_NEUTRAL||(a=(0,E.colorInHex)(E.THEME_NOIR)),r===E.THEME_DARK&&(a=E.DARK_THEME_ICON_COLOR);var i=r===E.THEME_DARK?"#3e3e3e":"#E6E6E6",s=(0,m.toKarmaLevel)(t),l=k[s],c=s==m.karmaLevelSteps.length-1,d=null,f=1;if(!c){var h=m.karmaLevelSteps[s],y=m.karmaLevelSteps[s+1];f=(t-h)/(y-h);var b=y-t;_("{karma_num} left to get to {karma_level}");var S=_n("{karma_num} point required for next level","{karma_num} points required for next level",b);d=u.default.createElement("p",null,(0,v.default)(S,{karma_num:b}))}return u.default.createElement("div",null,u.default.createElement("div",{className:"section_progress"},u.default.createElement(g.default,{className:"pie_chart",width:72,color:a,strokeColor:i,progress:f,disableAnimation:o,animationStart:500,animationDuration:1200},u.default.createElement(w.default,{level:s,color:a,width:45})),u.default.createElement("h4",{dangerouslySetInnerHTML:{__html:l}}),d,u.default.createElement("a",{className:"edit_link","data-track":"karma|tab_karma_about_levels",onClick:this.props.onKarmaInfoClick},_("About Karma Levels"))),u.default.createElement("div",{className:"section_completebar"},u.default.createElement("h6",{className:"section_title"},_("Karma trend")),u.default.createElement(p.default,{trendData:n,colorHex:a,width:280})))}}]),t}(u.default.PureComponent);S.propTypes={color:d.default.string,karma:d.default.number,trendData:d.default.arrayOf(d.default.shape({date:d.default.string,karma_avg:d.default.number})),onKarmaInfoClick:d.default.func,disableAnimation:d.default.bool,theme:d.default.number},S.defaultProps={disableAnimation:!1},r.default=S},{"../../constants/themes":99,"../../utils/format":474,"./KarmaIcon":328,"./KarmaTrend":330,"./ProgressRing":334,"./utils":338,"prop-types":"prop-types",react:"react"}],330:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("../../utils/fp"),u=e("react"),c=n(u),d=e("prop-types"),f=n(d),p=e("../../utils/isoToDate"),m=n(p),h=e("../../utils/mapRange"),_=n(h),v=e("../../utils/hexToRGB"),y=n(v),g=e("../../utils/highDefCanvas"),b=n(g),w=window,E=w.IstTooltip,k=w.DateUtils,S=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=r.deriveGraphData(r.props);return Object.assign(r,n),r.canvas=null,r}return i(t,e),s(t,[{key:"deriveGraphData",value:function(){var e=this.props,t=e.trendData,r=e.width,n=e.height,o=e.paddingTop,a=e.paddingBottom,i=e.paddingLeft,s=e.paddingRight,u=i,c=r-s,d=o,f=n-a,p=(0,l.min)(t.map(function(e){return e.karma_avg})),h=(0,l.max)(t.map(function(e){return e.karma_avg}));p==h&&(h=p+1);var v=Math.ceil((c-u)/(t.length-1));return{points:t.map(function(e,t){return{x:u+v*t,y:(0,_.default)(p,h,d,f,e.karma_avg),yI:(0,_.default)(p,h,f,d,e.karma_avg),karma:e.karma_avg,date:(0,m.default)(e.date)}}),startX:u,endX:c,startY:d,endY:f}}},{key:"componentWillUpdate",value:function(e){var t=this.deriveGraphData(e);Object.assign(this,t),this.canvas=null}},{key:"componentDidUpdate",value:function(){this.updateCanvas()}},{key:"componentDidMount",value:function(){this.updateCanvas()}},{key:"updateCanvas",value:function(){var e=this.canvas.getContext("2d");(0,b.default)(this.canvas,e),this.drawCanvas(e,this.points,this.endY,this.props.colorHex,this.props.paddingBottom)}},{key:"drawCanvas",value:function(e,t,r,n,o){e.fillStyle="#eeeeee",e.translate(-2,0);var a=!0,i=!1,s=void 0;try{for(var l,u=t[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value,d=c.x,f=c.yI;e.beginPath(),e.fillStyle=n,e.arc(d,f,2,0,2*Math.PI,!1),e.fill(),e.closePath()}}catch(e){i=!0,s=e}finally{try{!a&&u.return&&u.return()}finally{if(i)throw s}}e.lineWidth=2,e.strokeStyle=n;for(var p=1;p<t.length;p++){var m=t[p-1],h=t[p];e.beginPath(),e.moveTo(m.x,m.yI),e.lineTo(h.x,h.yI),e.stroke(),e.closePath()}e.strokeStyle="#999999",e.lineWidth=.2;var _=!0,v=!1,g=void 0;try{for(var b,w=t[Symbol.iterator]();!(_=(b=w.next()).done);_=!0){var E=b.value,d=E.x,f=E.yI;e.beginPath(),e.moveTo(d,f),e.lineTo(d,r),e.stroke(),e.closePath()}}catch(e){v=!0,g=e}finally{try{!_&&w.return&&w.return()}finally{if(v)throw g}}e.beginPath();var S=t[0],j=t[t.length-1];e.moveTo(S.x,S.yI);var T=!0,O=!1,I=void 0;try{for(var P,C=t.slice(1)[Symbol.iterator]();!(T=(P=C.next()).done);T=!0){var D=P.value,d=D.x,f=D.yI;e.lineTo(d,f)}}catch(e){O=!0,I=e}finally{try{!T&&C.return&&C.return()}finally{if(O)throw I}}e.lineTo(j.x,r),e.lineTo(S.x,r),e.moveTo(S.x,S.yI),e.fillStyle=(0,y.default)(n,.1),e.fill(),e.closePath(),e.fillStyle="#999999";var A=!0,M=!1,x=void 0;try{for(var R,N=t[Symbol.iterator]();!(A=(R=N.next()).done);A=!0){var $=R.value,L=k.getWeekdayShort($.date);e.fillText(L,$.x-5,r+o)}}catch(e){M=!0,x=e}finally{try{!A&&N.return&&N.return()}finally{if(M)throw x}}}},{key:"renderDataPointTooltip",value:function(){return this.points.map(function(e,t){var r=e.x,n=e.yI,o=e.karma,a={position:"absolute",width:"20px",height:"20px",marginLeft:r-10+"px",marginTop:n-10+"px"},i=function(e){E.showSimpleText(e,o||"0",null,-5,2)};return c.default.createElement("div",{key:t,className:"fixed_pos",style:a,ref:i})})}},{key:"render",value:function(){var e=this;return c.default.createElement("div",null,this.renderDataPointTooltip(),c.default.createElement("canvas",{ref:function(t){return e.canvas=t},width:this.props.width,height:this.props.height}))}}]),t}(c.default.PureComponent);S.propTypes={trendData:f.default.arrayOf(f.default.shape({date:f.default.string,karma_avg:f.default.number})),colorHex:f.default.string,width:f.default.number,height:f.default.number,paddingTop:f.default.number,paddingBottom:f.default.number,paddingLeft:f.default.number,paddingRight:f.default.number},S.defaultProps={width:300,height:70,paddingTop:10,paddingBottom:10,paddingLeft:10,paddingRight:10},r.default=S},{"../../utils/fp":477,"../../utils/hexToRGB":481,"../../utils/highDefCanvas":482,"../../utils/isoToDate":493,"../../utils/mapRange":495,"prop-types":"prop-types",react:"react"}],331:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(0,d.default)(o.propType,e),r=e.width,n=e.color,i=r/p;n&&(n=(0,f.hexToRGB)(n,.85));var l={tick:n||"#B3B3B3",ring:n||"#E6E6E6",topLeft:n||"#CCC",topRight:n||"#E6E6E6"};return s.default.createElement("svg",a({width:r,height:i,viewBox:"0 0 48 48"},t),s.default.createElement("defs",null,s.default.createElement("linearGradient",{x1:"100%",y1:"0%",x2:"0%",y2:"100%",id:"b"},s.default.createElement("stop",{stopOpacity:"0",offset:"0%"}),s.default.createElement("stop",{offset:"100%"})),s.default.createElement("path",{d:"M34.6 14.7L40 4H28l-3.5 7a17 17 0 0 1 10.1 3.7z",id:"me_a"}),s.default.createElement("linearGradient",{x1:"0%",y1:"0%",y2:"100%",id:"d"},s.default.createElement("stop",{stopOpacity:"0",offset:"0%"}),s.default.createElement("stop",{offset:"100%"})),s.default.createElement("path",{d:"M23.5 11L20 4H8l5.4 10.7A17 17 0 0 1 23.5 11z",id:"c"})),s.default.createElement("g",{fill:"none",fillRule:"evenodd"},s.default.createElement("path",{d:"M0 0h48v48H0z"}),s.default.createElement("g",null,s.default.createElement("use",{fill:l.topRight,xlinkHref:"#me_a"}),s.default.createElement("use",{fillOpacity:".1",fill:"url(#b)",xlinkHref:"#me_a"})),s.default.createElement("g",null,s.default.createElement("use",{fill:l.topLeft,xlinkHref:"#c"}),s.default.createElement("use",{fillOpacity:".1",fill:"url(#d)",xlinkHref:"#c"})),s.default.createElement("path",{d:"M24 44a16 16 0 1 1 0-32 16 16 0 0 1 0 32zm0-4a12 12 0 1 0 0-24 12 12 0 0 0 0 24z",fill:l.ring}),s.default.createElement("path",{fill:l.tick,d:"M22 33l-5-5 1.8-1.7 3.2 3.2 7.3-7.2L31 24z"})))}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=o;var i=e("react"),s=n(i),l=e("prop-types"),u=n(l),c=e("../../utils/filterOtherProps"),d=n(c),f=e("../../utils");o.propType={color:u.default.string,width:u.default.number.isRequired};var p=1},{"../../utils":484,"../../utils/filterOtherProps":472,"prop-types":"prop-types",react:"react"}],332:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t){var r=t.p0,o=t.p25,a=t.p75,i=t.p100,s=t.p100plus,l=t.p100plusFri;n(this,e),this.p0=r,this.p25=o,this.p75=a,this.p100=i,this.p100plus=s,this.p100plusFri=l}return o(e,[{key:"get",value:function(e){var t=void 0;switch(!0){case e>=1:t=5===(new Date).getDay()&&this.p100plusFri?this.p100plusFri:this.p100plus;break;case e>.75:t=this.p100;break;case e>.25:t=this.p75;break;case e>0:t=this.p25;break;case 0==e:default:t=this.p0}return t[(new Date).getDate()%t.length]}}]),e}();r.default=a},{}],333:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=e("react"),d=n(c),f=e("prop-types"),p=n(f),m=e("../reactist/Tabs"),h=e("./DailyStat"),v=n(h),y=e("./WeeklyStat"),g=n(y),b=e("./KarmaStat"),w=n(b),E=e("./WeeklyPremiumOnly"),k=n(E),S=e("../../utils/format"),j=n(S),T=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={current:"daily",shown:{}},r.onTabChange=r.onTabChange.bind(r),r}return s(t,e),u(t,[{key:"onTabChange",value:function(e){var t=this.state,r=t.shown,n=t.current;this.setState({shown:l(o({},n,!0),r),current:e})}},{key:"render",value:function(){var e=this.props,t=e.isPremium,r=e.userName,n=e.hideKarma,o=e.theme,a=this.props.stat.goals,i=a.daily_goal,s=a.current_daily_streak,l=a.max_daily_streak,u=a.weekly_goal,c=a.current_weekly_streak,f=a.max_weekly_streak,p=this.props.stat,h=p.karma,y=p.days_items,b=p.week_items,E=p.project_colors,S=p.karma_graph_data,T=p.completed_count,O=(0,j.default)(_n("{count_num} completed tasks","{count_num} completed tasks",T),{count_num:T}),I=this.state.shown;return d.default.createElement("div",{className:"completed_quick_viz",style:{width:this.props.width+"px"}},d.default.createElement("div",{className:"total_stat"},d.default.createElement("span",null,O),d.default.createElement("a",{"data-track":"karma|view_completed_tasks",onClick:this.props.onViewAllCompletedClick},_("View all completed tasks"))),d.default.createElement(m.Tabs,{onChange:this.onTabChange,spreadLayout:!0},d.default.createElement(m.Tab,{value:"daily",title:_x("stat","Daily"),track:"karma|tab_daily"},d.default.createElement(v.default,{width:this.props.width,userName:r,daysItems:y,maxStreak:l,projectColors:E,completed:this.props.completedToday,goal:i,currentStreak:s,theme:o,disableAnimation:I.daily,onEditGoalClick:this.props.onSettingEditClick})),d.default.createElement(m.Tab,{value:"weekly",title:_x("stat","Weekly"),track:"karma|tab_weekly"},t?d.default.createElement(g.default,{width:this.props.width,userName:r,weekItems:b,maxStreak:f,projectColors:E,completed:this.props.completedThisWeek,goal:u,currentStreak:c,theme:o,disableAnimation:I.weekly,onEditGoalClick:this.props.onSettingEditClick}):d.default.createElement(k.default,null)),n?null:d.default.createElement(m.Tab,{value:"karma",title:_x("stat","Karma"),track:"karma|tab_karma"},d.default.createElement(w.default,{karma:h,theme:o,trendData:S,disableAnimation:I.karma,onKarmaInfoClick:this.props.onKarmaInfoClick}))),d.default.createElement("div",{className:"section_setting_link"},d.default.createElement("a",{"data-track":"karma|karma_goals_and_settings",onClick:this.props.onSettingEditClick},_("Karma Goals and Settings"))))}}]),t}(d.default.PureComponent);T.propTypes={stat:p.default.object.isRequired,completedToday:p.default.number.isRequired,completedThisWeek:p.default.number.isRequired,userName:p.default.string,onKarmaInfoClick:p.default.func,onSettingEditClick:p.default.func,onViewAllCompletedClick:p.default.func,isPremium:p.default.bool,hideKarma:p.default.bool,theme:p.default.number,width:p.default.number},T.defaultProps={width:300,isPremium:!1,theme:0,hideKarma:!1},r.default=T},{"../../utils/format":474,"../reactist/Tabs":344,"./DailyStat":327,"./KarmaStat":329,"./WeeklyPremiumOnly":336,"./WeeklyStat":337,"prop-types":"prop-types",react:"react"}],334:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../../utils/easing"),p=e("../../utils/tweening"),m=n(p),h=e("../../utils/format"),_=n(h),v=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.progressbarRef=null,r}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;if(!this.props.disableAnimation){var t=this.props,r=t.animationDuration,n=t.animationStart;(0,m.default)({from:0,to:this.props.progress,duration:r,easing:f.easeOutQuint,step:function(t){e.progressbarRef&&(e.progressbarRef.style.strokeDashoffset=e.deriveStrokeDashoffset(t))},startAfter:n})}}},{key:"deriveStrokeDashoffset",value:function(e){return 301.635*(1-e)}},{key:"render",value:function(){var e=this,t=this.props,r=t.color,n=t.width,o=t.strokeWidth,a=t.progress,i=t.disableAnimation,s={display:"block",width:n},l={strokeDasharray:"301.635, 301.635",strokeDashoffset:i?this.deriveStrokeDashoffset(a):301.635},c={position:"relative",height:n,width:n},d={position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",top:0,left:0,width:"100%",height:"100%"},f=50-o/2,p=(0,_.default)("M 50,50 m 0,-{radius} a {radius},{radius} 0 1 1 0,{radius2} a {radius},{radius} 0 1 1 0,-{radius2}",{radius:f,radius2:2*f});return u.default.createElement("div",{style:c},u.default.createElement("svg",{viewBox:"0 0 100 100",style:s},u.default.createElement("defs",null,u.default.createElement("linearGradient",{x1:"50%",y1:"0%",x2:"50%",y2:"100%",id:"progress_gradient"},u.default.createElement("stop",{stopColor:r,stopOpacity:"0.7",offset:"0%"}),u.default.createElement("stop",{stopColor:r,offset:"100%"}))),u.default.createElement("path",{d:p,stroke:this.props.strokeColor,strokeWidth:o,fillOpacity:"0"}),u.default.createElement("path",{ref:function(t){return e.progressbarRef=t},d:p,stroke:"url(#progress_gradient)",strokeWidth:o,fillOpacity:"0",style:l})),u.default.createElement("div",{style:d},this.props.children))}}]),t}(u.default.PureComponent);v.propTypes={progress:d.default.number,width:d.default.number,strokeWidth:d.default.number,color:d.default.string,strokeColor:d.default.string,children:d.default.node,disableAnimation:d.default.bool,animationDuration:d.default.number,animationStart:d.default.number},v.defaultProps={progress:.7,width:72,strokeWidth:6,disableAnimation:!1,animationDuration:1200,animationStart:500,color:"#316fea"},r.default=v},{"../../utils/easing":471,"../../utils/format":474,"../../utils/tweening":512,"prop-types":"prop-types",react:"react"}],335:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(0,d.default)(o.propType,e),r=e.width,n=e.color,i={ribbon:n?"#FFF":"#B3B3B3",body:n||"#E6E6E6"};return n!==f.DARK_THEME_ICON_COLOR_DARKER&&n!==f.DARK_THEME_ICON_COLOR||(i.ribbon=f.DARK_THEME_BG_LIGHTER),s.default.createElement("svg",a({width:r+"px",viewBox:"0 0 48 48"},t),s.default.createElement("defs",null,s.default.createElement("linearGradient",{x1:"0%",y1:"0%",y2:"100%",id:"a"},s.default.createElement("stop",{offset:"0%"}),s.default.createElement("stop",{stopOpacity:"0",offset:"100%"})),s.default.createElement("linearGradient",{x1:"100%",y1:"100%",x2:"0%",y2:"0%",id:"b"},s.default.createElement("stop",{stopOpacity:"0",offset:"0%"}),s.default.createElement("stop",{stopOpacity:"0",offset:"40%"}),s.default.createElement("stop",{offset:"100%"}))),s.default.createElement("g",{fill:"none",fillRule:"evenodd"},s.default.createElement("path",{d:"M12.09368 22.50672C8.71832 19.0911 7 16.29787 7 14c0-2.76142 2.23858-5 5-5v2c-1.65685 0-3 1.34315-3 3 0 1.32495.98894 3.173 3 5.47536V7h24v12.47536c2.01106-2.30237 3-4.1504 3-5.47536 0-1.65685-1.34315-3-3-3V9c2.76142 0 5 2.23858 5 5 0 2.29787-1.71832 5.0911-5.09368 8.50672C35.20599 28.09724 30.65986 32.492 25 32.95892V35h-2v-2.04107c-5.65986-.46693-10.206-4.8617-10.90632-10.45221zM16 39h16v5H16v-5zm3-2h10v2H19v-2zm2-2h6v2h-6v-2zM10 4h28v3H10V4zm16 3v12l3-3 3 3V7h-6z",fillOpacity:".8",fill:i.body}),s.default.createElement("path",{fillOpacity:".08",fill:"url(#a)",d:"M21 37h8v2h-6zM23 35h4v2h-2zM23 32.9h2v2z"}),s.default.createElement("path",{d:"M15 21c0 5.52285 4.47715 10 10 10s10-4.47715 10-10V7H15v14z",fillOpacity:".08",fill:"url(#b)"}),s.default.createElement("path",{fill:i.ribbon,d:"M26 7h6v12l-3-3-3 3z"})))}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=o;var i=e("react"),s=n(i),l=e("prop-types"),u=n(l),c=e("../../utils/filterOtherProps"),d=n(c),f=e("../../constants/themes");o.propType={color:u.default.string,width:u.default.number.isRequired}},{"../../constants/themes":99,"../../utils/filterOtherProps":472,"prop-types":"prop-types",react:"react"}],336:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.color,r=_("Weekly goals and streaks are Premium features. <a>Learn more</a>").replace("<a>",'<a href="https://get.todoist.help/hc/en-us/articles/206209959-Karma" target="_blank" rel="noopener noreferrer">'),n={marginTop:"1em"};return i.default.createElement("div",null,i.default.createElement("div",{className:"goal_status section_progress",style:{border:0}},i.default.createElement(c.default,{className:"pie_chart",width:72,iconType:"trophy",color:t,disableAnimation:!0,progress:0},i.default.createElement(f.default,{width:45})),i.default.createElement("h4",{style:n,dangerouslySetInnerHTML:{__html:r}})))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("react"),i=n(a),s=e("prop-types"),l=n(s),u=e("./ProgressRing"),c=n(u),d=e("./TrophyIcon"),f=n(d);o.propTypes={color:l.default.string}},{"./ProgressRing":334,"./TrophyIcon":335,"prop-types":"prop-types",react:"react"}],337:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),
t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("./CompletedBarChart"),p=n(f),m=e("../../utils/format"),h=n(m),v=e("./utils"),y=e("./ProgressRing"),g=n(y),b=e("./TrophyIcon"),w=n(b),E=e("./MotivatorCatelog"),k=n(E),S=e("../../utils"),j=e("../../constants/themes"),T=new k.default({p0:[_("Big things happen one task at a time."),_("Starting is the hardest part. You\u2019ve got this!"),_("Build momentum with one small task.")],p25:[_("You\u2019re on the right track!"),_("Nice start! Keep it up."),_("Keep up the momentum!")],p75:[_("Keep up the pace!"),_("Nothing can stop you!"),_("Your focus is unbreakable!")],p100:[_("It\u2019s the final stretch. You\u2019ve got this!"),_("The end is in sight. Go for it!"),_("Just a bit more to go!"),_("Your goal is within reach!")],p100plus:[_("You did it, {user_name}!"),_("Nice work, {user_name}!"),_("Nicely done, {user_name}!"),_("You conquered the week!"),_("Treat yourself. You deserve it, {user_name}!")]}),O=function(e){function t(e){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),s(t,[{key:"renderStatus",value:function(){var e=this.props,t=e.goal,r=e.completed,n=_n("Weekly goal: <b>{num_completed}/{num_goal} task</b>","Weekly goal: <b>{num_completed}/{num_goal} tasks</b>",t),o=_n("Weekly goal completed: <b>{num_completed}/{num_goal} task</b>","Weekly goal completed: <b>{num_completed}/{num_goal} tasks</b>",t),a=_("Edit goal"),i=r<t?n:o;i=(0,h.default)(i,{num_completed:r,num_goal:t});var s=r/t,l=(0,h.default)(T.get(s),{user_name:(0,S.firstName)(this.props.userName)});return u.default.createElement("div",null,u.default.createElement("h4",{dangerouslySetInnerHTML:{__html:i}}),u.default.createElement("p",null,l),u.default.createElement("a",{className:"edit_link","data-track":"karma|tab_weekly_edit_goal",onClick:this.props.onEditGoalClick},a))}},{key:"renderStreaks",value:function(){if((0,v.isNilStreakData)(this.props.currentStreak))return null;var e=this.props.currentStreak.count,t=_n("You've completed your goal 1 week in a row.","You've completed your goal {n} weeks in a row.",e);t=(0,h.default)(t,{n:e});var r=void 0;if(!(0,v.isNilStreakData)(this.props.maxStreak)){var n=this.props.maxStreak.count,o=_n("Your longest streak: 1 week","Your longest streak: {n} weeks",n);o=(0,h.default)(o,{n:n});var a=this.props.maxStreak,i=a.start,s=a.end,l=(0,v.formatInterval)(i,s);r=u.default.createElement("p",{className:"sm"},o,u.default.createElement("br",null),"(",l,")")}return u.default.createElement("div",{className:"section_streak"},u.default.createElement("p",null,t),r)}},{key:"render",value:function(){var e=this.props,t=e.weekItems,r=e.projectColors,n=e.completed,o=e.goal,a=e.theme,i=e.disableAnimation,s=e.width,l=n/o,c=(0,j.colorInHex)(a);a!==j.THEME_SUNFLOWER&&a!==j.THEME_NEUTRAL||(c=(0,j.colorInHex)(j.THEME_NOIR)),a===j.THEME_DARK&&(c=j.DARK_THEME_ICON_COLOR);var d=a===j.THEME_DARK?j.DARK_THEME_ICON_COLOR_DARKER:"#B3B3B3",f=l<1?d:c,m=a===j.THEME_DARK?j.DARK_THEME_ICON_COLOR_DARKER:"#E6E6E6";return u.default.createElement("div",null,u.default.createElement("div",{className:"goal_status section_progress"},u.default.createElement(g.default,{className:"pie_chart",width:72,iconType:"trophy",color:c,strokeColor:m,disableAnimation:i,progress:Math.min(n/o,1),animationStart:500,animationDuration:1200},u.default.createElement(w.default,{width:45,color:f})),this.renderStatus()),this.renderStreaks(),u.default.createElement("div",{className:"section_completebar"},u.default.createElement("h6",{className:"section_title"},_("Completed in the last 4 weeks")),u.default.createElement(p.default,{width:s,color:c,stat:t,idToColor:r,goal:o})))}}]),t}(u.default.PureComponent);O.propTypes={stat:d.default.object,completed:d.default.number,goal:d.default.number,weekItems:d.default.arrayOf(d.default.shape({items:d.default.array})),maxStreak:d.default.shape({count:d.default.number,start:d.default.string,end:d.default.string}),currentStreak:d.default.object,projectColors:d.default.object,color:d.default.string,userName:d.default.string,disableAnimation:d.default.bool,onEditGoalClick:d.default.func,theme:d.default.number,width:d.default.number},O.defaultProps={disableAnimation:!1},r.default=O},{"../../constants/themes":99,"../../utils":484,"../../utils/format":474,"./CompletedBarChart":326,"./MotivatorCatelog":332,"./ProgressRing":334,"./TrophyIcon":335,"./utils":338,"prop-types":"prop-types",react:"react"}],338:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=r.karmaLevelSteps=[0,500,2500,5e3,7500,1e4,2e4,5e4];r.toKarmaLevel=function(e){return n.reduce(function(t,r,n){return e>=r?n:t},-1)},r.formatInterval=function(e,t){return e=new Date(e),e.setSeconds(59),e=DateUtils.format(e,!1,{with_year:!0}),t=new Date(t),t.setSeconds(59),t=DateUtils.format(t,!1,{with_year:!0}),e+" - "+t},r.isNilStreakData=function(e){return""===e.start||""==e.end}},{}],339:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../side_panel/SidePanel"),p=n(f),m=e("../reactist/Tabs"),h=e("../icons/ProjectIcon"),v=n(h),y=e("../formatter/PlainText"),g=n(y),b=e("../activity_log"),w=n(b),E=e("../../containers/Notes"),k=n(E),S=e("../../reducers/notes/notesConstants"),j=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.project;return u.default.createElement("div",{className:"item_detail_header"},u.default.createElement("h4",{className:"project_name"},u.default.createElement(v.default,{color:e.color}),u.default.createElement(g.default,{text:e.name})))}}]),t}(u.default.Component);j.propTypes={project:d.default.object.isRequired};var T=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.handleOnClosed=function(){n.props.onClosed()},n.handleTabChange=function(e){n.setState({tab:e})},i=r,a(n,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.project;return u.default.createElement(p.default,{width:600,onClosed:this.handleOnClosed},u.default.createElement("div",{className:"item_detail"},u.default.createElement(j,{project:e}),u.default.createElement(m.Tabs,{className:"item_detail_tabs",onChange:this.onTabChange,spreadLayout:!0},u.default.createElement(m.Tab,{value:"comments",title:_("Comments"),className:"item_detail_tab"},u.default.createElement(k.default,{project:e,type:S.TYPE_PROJECT_NOTE,parentId:e.id,projectId:e.id})),u.default.createElement(m.Tab,{className:"item_detail_tab",value:"activity",title:_("Activity")},u.default.createElement(w.default,{filterBy:{parent_project_id:e.id}})))))}}]),t}(u.default.Component);T.propTypes={project:d.default.object.isRequired,onClosed:d.default.func.isRequired},r.default=T},{"../../containers/Notes":109,"../../reducers/notes/notesConstants":430,"../activity_log":224,"../formatter/PlainText":271,"../icons/ProjectIcon":292,"../reactist/Tabs":344,"../side_panel/SidePanel":395,"prop-types":"prop-types",react:"react"}],340:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=e("react"),d=n(c),f=e("prop-types"),p=n(f),m=e("classnames"),h=n(m),_=e("./transitions/Collapse"),v=n(_),y=e("./utils"),g=function(e){function t(){var e,r,n,o;a(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={expanded:!1},n.isControlled=null,n.handleChange=function(e){var t=n.props.onChange,r=!n.state.expanded;t&&t(e,r),n.isControlled||n.setState({expanded:r})},o=r,i(n,o)}return s(t,e),u(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.expanded,r=e.defaultExpanded;this.isControlled=null!=t,this.setState({expanded:this.isControlled?t:r})}},{key:"componentWillReceiveProps",value:function(e){this.isControlled&&this.setState({expanded:e.expanded})}},{key:"render",value:function(){var e=this,t=this.props,r=t.children,n=(t.classes,t.className),a=t.CollapseProps,i=(t.defaultExpanded,t.disabled),s=(t.expanded,t.onChange,o(t,["children","classes","className","CollapseProps","defaultExpanded","disabled","expanded","onChange"])),u=this.state.expanded,c=(0,h.default)("reactist","expansion_panel",u&&"expansion_panel__expanded",n),f=null,p=d.default.Children.map(r,function(t){return d.default.isValidElement(t)?(0,y.isMuiElement)(t,["ExpansionPanelSummary"])?(f=d.default.cloneElement(t,{disabled:i,expanded:u,onChange:e.handleChange}),null):t:null}),m=u?null:{"aria-hidden":"true"};return d.default.createElement("div",l({className:c},s),f,d.default.createElement(v.default,l({in:u,timeout:"auto"},m,a),p))}}]),t}(d.default.Component);g.propTypes={children:p.default.node.isRequired,className:p.default.string,CollapseProps:p.default.object,defaultExpanded:p.default.bool,disabled:p.default.bool,expanded:p.default.bool,onChange:p.default.func},g.defaultProps={defaultExpanded:!1,disabled:!1},r.default=g},{"./transitions/Collapse":347,"./utils":349,classnames:"classnames","prop-types":"prop-types",react:"react"}],341:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("classnames"),d=n(c),f=e("prop-types"),p=n(f),m=e("./icon/Arrow"),h=n(m),_=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.handleChange=function(){n.props.onChange()},i=r,a(n,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.expanded,r=e.track,n=(0,d.default)("reactist","panel_summary",t&&"panel_summary--expanded");return u.default.createElement("div",{className:n,"data-track":r,onClick:this.handleChange},u.default.createElement("div",{className:"panel_summary__icon"},u.default.createElement(h.default,null)),u.default.createElement("div",{className:"panel_summary__content"},this.props.children))}}]),t}(u.default.Component);r.default=_,_.propTypes={children:p.default.node,className:p.default.string,expanded:p.default.bool,track:p.default.string,onChange:p.default.func},_.muiName="ExpansionPanelSummary"},{"./icon/Arrow":346,classnames:"classnames","prop-types":"prop-types",react:"react"}],342:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("react-transition-group"),p=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.timerAutoHide=null,r.handleTransitionExited=function(){r.setState({exited:!0})},r.handleMouseEnter=function(e){r.props.onMouseEnter&&r.props.onMouseEnter(e),r.handlePause()},r.handleMouseLeave=function(e){r.props.onMouseLeave&&r.props.onMouseLeave(e),r.handleResume()},r.handlePause=function(){clearTimeout(r.timerAutoHide)},r.handleResume=function(){if(null!=r.props.autoHideDurationMs){if(void 0!==r.props.resumeHideDurationMs)return void r.setAutoHideTimer(r.props.resumeHideDurationMs);r.setAutoHideTimer(.5*(r.props.autoHideDurationMs||0))}},r.handleCloseClick=function(e){r.props.onClose&&(r.props.onClose(e,"clickicon"),e.stopPropagation())},r.state={exited:!1},r}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.props.opened||this.setState({exited:!0})}},{key:"componentDidMount",value:function(){this.props.opened&&this.setAutoHideTimer()}},{key:"componentWillReceiveProps",value:function(e){e.opened&&this.state.exited&&this.setState({exited:!1})}},{key:"componentDidUpdate",value:function(e){e.opened!==this.props.opened&&(this.props.opened?this.setAutoHideTimer():clearTimeout(this.timerAutoHide))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timerAutoHide)}},{key:"setAutoHideTimer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.props.onClose&&null!=this.props.autoHideDurationMs&&(clearTimeout(this.timerAutoHide),this.timerAutoHide=setTimeout(function(){e.props.onClose&&null!=e.props.autoHideDurationMs&&e.props.onClose(null,"timeout")},t||this.props.autoHideDurationMs||0))}},{key:"render",value:function(){var e=this,t=this.props,r=t.opened,n=t.transitionDurationMs;if(!r&&this.state.exited)return null;var o={in:r,appear:!0,timeout:n,onExited:this.handleTransitionExited};return u.default.createElement(f.Transition,o,function(t){return e.props.children(t,{onMouseEnter:e.handleMouseEnter,onMouseLeave:e.handleMouseLeave})})}}]),t}(u.default.Component);p.propTypes={opened:d.default.bool.isRequired,transitionDurationMs:d.default.number.isRequired,autoHideDurationMs:d.default.number.isRequired,resumeHideDurationMs:d.default.number.isRequired,onClose:d.default.func.isRequired},r.default=p},{"prop-types":"prop-types",react:"react","react-transition-group":"react-transition-group"}],343:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("react-dom"),p=n(f),m=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.layer=null,i=r,a(n,i)}return i(t,e),s(t,[{key:"componentDidMount",value:function(){p.default.createPortal||this.renderLayer()}},{key:"componentDidUpdate",value:function(){p.default.createPortal||this.renderLayer()}},{key:"componentWillUnmount",value:function(){this.unrenderLayer()}},{key:"getLayer",value:function(){return this.layer||(this.layer=document.createElement("div"),this.layer.setAttribute("data-mui-portal","true"),document.body&&this.layer&&document.body.appendChild(this.layer)),this.layer}},{key:"unrenderLayer",value:function(){this.layer&&(p.default.createPortal||p.default.unmountComponentAtNode(this.layer),document.body&&document.body.removeChild(this.layer),this.layer=null)}},{key:"renderLayer",value:function(){var e=this.props,t=e.children;if(e.open){var r=u.default.Children.only(t);p.default.unstable_renderSubtreeIntoContainer(this,r,this.getLayer())}else this.unrenderLayer()}},{key:"render",value:function(){var e=this.props,t=e.children,r=e.open;if(!p.default.createPortal)return null;if(r){var n=this.getLayer();return p.default.createPortal(t,n)}return this.unrenderLayer(),null}}]),t}(u.default.Component);m.propTypes={children:d.default.node,open:d.default.bool},m.defaultProps={open:!1},r.default=m},{"prop-types":"prop-types",react:"react","react-dom":"react-dom"}],344:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=e.title,r=e.disabled,n=e.active,o=e.track,a=e.onClick,i=(0,h.default)("reactist tabs__header--item",{active:n});return d.default.createElement("button",{role:"tab",className:i,"data-track":o,disabled:r,onClick:a},t)}Object.defineProperty(r,"__esModule",{value:!0}),r.Tab=r.Tabs=void 0;var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=e("react"),d=n(c),f=e("prop-types"),p=n(f),m=e("classnames"),h=n(m),_=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={activeTab:n.props.activeTab||d.default.Children.toArray(n.props.children)[0].props.value},n._switchActiveTab=function(e){n.setState({activeTab:e}),n.props.onChange&&n.props.onChange(e)},i=r,a(n,i)}return i(t,e),u(t,[{key:"render",value:function(){var e=this,t=this.props,r=t.spreadLayout,n=t.className,o=this.state.activeTab,a=d.default.Children.toArray(this.props.children),i=(0,h.default)("reactist","tabs",r?"tabs-spreadlayout":null,n);return d.default.createElement("div",{className:i},d.default.createElement("div",{className:"reactist tabs__header"},a.map(function(t){var r=t.props;return d.default.createElement(s,l({},r,{key:r.value,active:r.value===o,onClick:function(){return e._switchActiveTab(r.value)}}))})),d.default.createElement("div",{className:"reactist tabs__body"},a.map(function(e){return d.default.cloneElement(e,{key:e.props.value,active:e.props.value===o})})))}}]),t}(d.default.Component);_.propTypes={activeTab:p.default.string,spreadLayout:p.default.bool,onChange:p.default.func,className:p.default.string},_.defaultProps={spreadLayout:!1};var v=function(e){var t=e.children,r=e.className,n=e.active,o=void 0!==n&&n;return d.default.createElement("div",{className:(0,h.default)("reactist tabs__tab",r,{active:o})},t)};v.defaultProps={disabled:!1,active:!1},v.propTypes={value:p.default.string.isRequired,title:p.default.string.isRequired,disabled:p.default.bool,className:p.default.string,track:p.default.string,children:p.default.node,active:p.default.bool},r.Tabs=_,r.Tab=v},{classnames:"classnames","prop-types":"prop-types",react:"react"}],345:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=e("react"),d=n(c),f=e("prop-types"),p=n(f),m=e("react-transition-group"),h=e("./Portal"),_=n(h),v=e("../icons/Close"),y=n(v),g={transition:"all 300ms ease-out",top:"-10px",opacity:0},b={entering:{top:"20px",opacity:0},entered:{top:"50px",opacity:1}},w=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.timerAutoHide=null,r.handleTransitionExited=function(){r.setState({exited:!0})},r.handleMouseEnter=function(e){r.props.onMouseEnter&&r.props.onMouseEnter(e),r.handlePause()},r.handleMouseLeave=function(e){r.props.onMouseLeave&&r.props.onMouseLeave(e),r.handleResume()},r.handlePause=function(){clearTimeout(r.timerAutoHide)},r.handleResume=function(){if(null!=r.props.autoHideDuration){if(void 0!==r.props.resumeHideDuration)return void r.setAutoHideTimer(r.props.resumeHideDuration);r.setAutoHideTimer(.5*(r.props.autoHideDuration||0))}},r.handleCloseClick=function(e){r.props.onClose&&(r.props.onClose(e,"clickicon"),e.stopPropagation())},r.state={exited:!1},r}return s(t,e),u(t,[{key:"componentWillMount",value:function(){this.props.open||this.setState({exited:!0})}},{key:"componentDidMount",value:function(){this.props.open&&this.setAutoHideTimer()}},{key:"componentWillReceiveProps",value:function(e){e.open&&this.state.exited&&this.setState({exited:!1})}},{key:"componentDidUpdate",value:function(e){e.open!==this.props.open&&(this.props.open?this.setAutoHideTimer():clearTimeout(this.timerAutoHide))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timerAutoHide)}},{key:"setAutoHideTimer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.props.onClose&&null!=this.props.autoHideDuration&&(clearTimeout(this.timerAutoHide),this.timerAutoHide=setTimeout(function(){e.props.onClose&&null!=e.props.autoHideDuration&&e.props.onClose(null,"timeout")},t||this.props.autoHideDuration||0))}},{key:"render",value:function(){var e=this,t=this.props,r=t.open,n=(t.autoHideDuration,o(t,["open","autoHideDuration"]));if(!r&&this.state.exited)return null;var a={in:r,appear:!0,timeout:300,onExited:this.handleTransitionExited};return d.default.createElement(_.default,{open:!0},d.default.createElement(m.Transition,a,function(t){return d.default.createElement("div",l({onMouseEnter:e.handleMouseEnter,onMouseLeave:e.handleMouseLeave,className:"top_notifier",style:l({},g,b[t])},n),d.default.createElement(y.default,{onClick:e.handleCloseClick}),e.props.children)}))}}]),t}(d.default.Component);w.propTypes={open:p.default.bool,autoHideDuration:p.default.number,resumeHideDuration:p.default.number,onClose:p.default.func},w.defaultProps={autoHideDuration:null},r.default=w},{"../icons/Close":274,"./Portal":343,"prop-types":"prop-types",react:"react","react-transition-group":"react-transition-group"}],346:[function(e,t,r){"use strict";function n(){return a.default.createElement("svg",{width:"12px",height:"6px",viewBox:"0 0 12 6"},a.default.createElement("g",{transform:"translate(-396.000000, -235.000000)",fill:"#777777"},a.default.createElement("g",{transform:"translate(128.000000, 213.000000)"},a.default.createElement("path",{d:"M280,22.7581818 L279.1564,22 L273.9922,26.506 L273.4414,26.0254545 L273.4444,26.0281818 L268.8562,22.0245455 L268,22.7712727 C269.2678,23.878 272.8084,26.9674545 273.9922,28 C274.8718,27.2330909 274.0144,27.9809091 280,22.7581818"}))))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o)},{react:"react"}],347:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0}),r.duration=void 0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),d=e("react"),f=n(d),p=e("classnames"),m=n(p),h=e("prop-types"),_=n(h),v=e("react-transition-group"),y=e("./utils"),g=r.duration={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195},b=function(e){function t(){var e,r,n,o;i(this,t);for(var a=arguments.length,l=Array(a),u=0;u<a;u++)l[u]=arguments[u];return r=n=s(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.wrapper=null,n.autoTransitionDuration=void 0,n.timer=null,n.handleEnter=function(e){e.style.height=n.props.collapsedHeight,n.props.onEnter&&n.props.onEnter(e)},n.handleEntering=function(e){var t=n.props.timeout,r=n.wrapper?n.wrapper.clientHeight:0,o=(0,y.getTransitionProps)(n.props,{mode:"enter"}),a=o.duration;if("auto"===t){var i=(0,y.getAutoHeightDuration)(r);e.style.transitionDuration=i+"ms",n.autoTransitionDuration=i}else e.style.transitionDuration="string"==typeof a?a:a+"ms";e.style.height=r+"px",n.props.onEntering&&n.props.onEntering(e)},n.handleEntered=function(e){e.style.height="auto",n.props.onEntered&&n.props.onEntered(e)},n.handleExit=function(e){var t=n.wrapper?n.wrapper.clientHeight:0;e.style.height=t+"px",n.props.onExit&&n.props.onExit(e)},n.handleExiting=function(e){var t=n.props.timeout,r=n.wrapper?n.wrapper.clientHeight:0,o=(0,y.getTransitionProps)(n.props,{mode:"exit"}),a=o.duration;if("auto"===t){var i=(0,y.getAutoHeightDuration)(r);e.style.transitionDuration=i+"ms",n.autoTransitionDuration=i}else e.style.transitionDuration="string"==typeof a?a:a+"ms";e.style.height=n.props.collapsedHeight,n.props.onExiting&&n.props.onExiting(e)},n.addEndListener=function(e,t){"auto"===n.props.timeout&&(n.timer=setTimeout(t,n.autoTransitionDuration||0))},o=r,s(n,o)}return l(t,e),c(t,[{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"render",value:function(){var e=this,t=this.props,r=t.children,n=t.className,i=t.collapsedHeight,s=t.component,l=(t.onEnter,t.onEntered,t.onEntering,t.onExit,t.onExiting,t.style),c=t.timeout,d=a(t,["children","className","collapsedHeight","component","onEnter","onEntered","onEntering","onExit","onExiting","style","timeout"]);return f.default.createElement(v.Transition,u({onEntering:this.handleEntering,onEnter:this.handleEnter,onEntered:this.handleEntered,onExiting:this.handleExiting,onExit:this.handleExit,addEndListener:this.addEndListener,timeout:"auto"===c?null:c},d),function(t,a){return f.default.createElement(s,u({className:(0,m.default)("reactist","collapse",o({},"collapse--entered","entered"===t),n),style:u({},l,{minHeight:i})},a),f.default.createElement("div",{className:"collapse__wrapper",ref:function(t){e.wrapper=t}},f.default.createElement("div",{className:"collapse__wrapper_inner"},r)))})}}]),t}(f.default.Component);b.propTypes={children:_.default.node,className:_.default.string,collapsedHeight:_.default.string,
component:_.default.oneOfType([_.default.string,_.default.func]),in:_.default.bool,onEnter:_.default.func,onEntered:_.default.func,onEntering:_.default.func,onExit:_.default.func,onExiting:_.default.func,style:_.default.object,timeout:_.default.oneOfType([_.default.number,_.default.shape({enter:_.default.number,exit:_.default.number}),_.default.oneOf(["auto"])])},b.defaultProps={collapsedHeight:"0px",component:"div",timeout:g.standard},r.default=b},{"./utils":348,classnames:"classnames","prop-types":"prop-types",react:"react","react-transition-group":"react-transition-group"}],348:[function(e,t,r){"use strict";function n(e,t){var r=e.timeout,n=e.style,o=void 0===n?{}:n;return{duration:o.transitionDuration||"number"==typeof r?r:r[t.mode],delay:o.transitionDelay}}function o(e){if(!e)return 0;var t=e/36;return Math.round(10*(4+15*Math.pow(t,.25)+t/5))}Object.defineProperty(r,"__esModule",{value:!0}),r.getTransitionProps=n,r.getAutoHeightDuration=o;r.reflow=function(e){return e.scrollTop}},{}],349:[function(e,t,r){"use strict";function n(e,t){return a.default.isValidElement(e)&&-1!==t.indexOf(e.type.muiName)}Object.defineProperty(r,"__esModule",{value:!0}),r.isMuiElement=n;var o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o)},{react:"react"}],350:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("classnames"),p=n(f),m=e("../../models/DateExt"),h=n(m),v=e("./datePicker/icons/Delete"),y=n(v),g=e("../Dialog"),b=n(g),w=e("../tabbable/Tabbable"),E=n(w),k=e("./timePicker"),S=n(k),j=e("./utils"),T=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.addTimeLabel=u.default.createRef(),r.initialSelectedDate=e.selectedDate,r.handleSave=(0,j.wrapKeyboardEnterPress)(r.handleSave.bind(r)),r.handleTimeRemove=(0,j.wrapKeyboardEnterPress)(r.handleTimeRemove.bind(r)),r}return i(t,e),s(t,[{key:"handleSave",value:function(){this.props.onSave(this.props.selectedDate)}},{key:"handleTimeRemove",value:function(e){e.stopPropagation(),this.props.onTimeSelect(e)}},{key:"render",value:function(){var e=this.props,t=e.timeFormat,r=e.userTimezoneInfo,n=e.isTimePickerShown,o=e.selectedDate,a=e.onTimePickerToggle,i=e.onTimeSelect,s=(0,p.default)("scheduler-actions-save",{"scheduler-actions-save--disabled":n}),l=o&&o.with_time;return u.default.createElement("div",{className:"scheduler-actions"},l?u.default.createElement(u.default.Fragment,null,u.default.createElement("span",{className:"scheduler-actions-time"},u.default.createElement("span",{ref:this.addTimeLabel,className:"scheduler-actions-time-label",onClick:$p(a,!0),onKeyDown:$p(a,!0),"data-track":"scheduler|full_calendar_time",tabIndex:"7"},o.format({inTimezoneTime:!0,onlyTime:!0})),u.default.createElement("span",{className:"scheduler-actions-time-separator"}),u.default.createElement("span",{className:"scheduler-actions-time-remove",onClick:this.handleTimeRemove,onKeyDown:this.handleTimeRemove,tabIndex:"8"},u.default.createElement(y.default,null)))):u.default.createElement("span",{ref:this.addTimeLabel,className:"scheduler-actions-addtime",tabIndex:"7",onClick:$p(a,!0),onKeyDown:$p(a,!0),"data-track":"scheduler|full_calendar_time"},"+ "+_("Add time")),(l||this.initialSelectedDate&&this.initialSelectedDate.with_time)&&u.default.createElement("span",{className:s,tabIndex:"9",onClick:this.handleSave,onKeyDown:this.handleSave,"data-track":"scheduler|full_calendar_save"},_("Save")),n&&u.default.createElement(b.default,{className:"dialog-timepicker",anchor:this.addTimeLabel.current,onHide:$p(a,!1),position:"top",width:225,isPositionFluid:!0,hasUnderlay:!0},u.default.createElement(E.default,null,u.default.createElement(S.default,{selectedDate:o,timeFormat:t,userTimezoneInfo:r,onCancel:$p(a,!1),onSelect:i}))))}}]),t}(u.default.PureComponent);T.propTypes={timeFormat:d.default.number.isRequired,userTimezoneInfo:d.default.object.isRequired,isTimePickerShown:d.default.bool,selectedDate:d.default.instanceOf(h.default),onTimePickerToggle:d.default.func,onTimeSelect:d.default.func,onSave:d.default.func},T.defaultProps={onTimePickerToggle:function(){},onTimeSelect:function(){},onSave:function(){}},r.default=T},{"../../models/DateExt":164,"../Dialog":201,"../tabbable/Tabbable":402,"./datePicker/icons/Delete":361,"./timePicker":388,"./utils":394,classnames:"classnames","prop-types":"prop-types",react:"react"}],351:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("react"),c=n(u),d=e("prop-types"),f=n(d),p=e("../../models/DateExt"),m=n(p),h=e("../../utils"),_=e("./suggestions/constants"),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(_),y=e("./Actions"),g=n(y),b=e("./datePicker"),w=n(b),E=e("./dueDateInput"),k=n(E),S=e("./suggestions"),j=n(S),T=e("../tabbable/Tabbable"),O=n(T),I=e("../../utils/deps"),P=(0,I.defineDeps)("Scheduler",["SmartSchedule"]),C=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=e.selectedDate;return r.initialSelectedDate=n,r.state={selectedDate:n,isDueDateInputActive:!1,isTimePickerShown:!1},r.initialHeight=null,r.el=c.default.createRef(),r.handleDateSelect=r.handleDateSelect.bind(r),r.handleDueDateInputToggle=r.handleDueDateInputToggle.bind(r),r.handleKeyDown=r.handleKeyDown.bind(r),r.handleInputDateSelect=r.handleInputDateSelect.bind(r),r.handleSuggestionSelect=r.handleSuggestionSelect.bind(r),r.handleTimePickerToggle=r.handleTimePickerToggle.bind(r),r.handleTimeSelect=r.handleTimeSelect.bind(r),r}return s(t,e),l(t,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.handleKeyDown),this.initialHeight=this.el.current.clientHeight}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyDown)}},{key:"handleDateSelect",value:function(e){var t=this.state.selectedDate;if(this.props.selectedItems.length>1&&(!t||!t.with_time)){var r=this.props.selectedItems.map(function(t){return t.due?t.due.inheritDate({year:e.getFullYear(),month:e.getMonth(),day:e.getDate()}):m.default.fromDate(e)});return this.props.onDateSelect(r)}return t?t.with_time?void this.setState(function(t){return{selectedDate:t.selectedDate.inheritDate({year:e.getFullYear(),month:e.getMonth(),day:e.getDate()})}}):this.props.onDateSelect(t.inheritDate({year:e.getFullYear(),month:e.getMonth(),day:e.getDate()})):this.props.onDateSelect(m.default.fromDate(e))}},{key:"handleInputDateSelect",value:function(e,t){t||this.setState({selectedDate:null}),this.props.onDateSelect(e)}},{key:"handleTimePickerToggle",value:function(e,t){t.keyCode&&13!==t.keyCode||(t.nativeEvent?t.nativeEvent.stopImmediatePropagation():t.stopImmediatePropagation(),this.setState({isTimePickerShown:e}))}},{key:"handleTimeSelect",value:function(e,t,r){var n=this.state.selectedDate;e.nativeEvent.stopImmediatePropagation(),t?n=n?n.changeTime(t.getHours(),t.getMinutes(),t.getSeconds(),{timezone:r}):m.default.fromDate(t,{timezone:r,withTime:!0}):n&&(n=n.inheritDate({year:n.getFullYear(),month:n.getMonth(),day:n.getDate(),hours:23,minutes:59,seconds:59},{withTime:!0})),this.setState({selectedDate:n,isTimePickerShown:!1})}},{key:"handleDueDateInputToggle",value:function(e){this.el.current.style.height=e?"inherit":this.initialHeight+"px",this.setState({isDueDateInputActive:e})}},{key:"handleKeyDown",value:function(e){27===e.keyCode&&($$(".dialog",document.body).length>1?(e.preventDefault(),this.setState({isTimePickerShown:!1})):this.state.isDueDateInputActive||this.props.onClose())}},{key:"handleSuggestionSelect",value:function(e,t){if(e===v.SMART_SCHEDULER)return P.SmartSchedule.openSmartSchedule(this.props.selectedItems),this.props.onClose();if(e===v.POSTPONE||!t)return this.props.onDateSelect(t);var r=this.props.selectedItems.map(function(e){return e.due?e.due.inheritDate({year:t.getFullYear(),month:t.getMonth(),day:t.getDate()}):m.default.fromDate(t)});this.props.onDateSelect(r.length>1?r:r[0])}},{key:"render",value:function(){var e=this.props,t=e.currentDate,r=e.ignoredDays,n=e.items,a=e.karma,i=e.nextWeekDay,s=e.predictedDate,l=e.selectedItems,u=e.suggestions,d=e.timeFormat,f=e.userTimezoneInfo,p=e.weekStartDay,m=e.onDateSelect,_=this.state,y=_.selectedDate,b=_.isDueDateInputActive,E=_.isTimePickerShown;return c.default.createElement(O.default,null,c.default.createElement("div",{ref:this.el,className:"scheduler"},c.default.createElement(k.default,{currentDate:t,items:n,karma:a,selectedDate:y,userTimezoneInfo:f,tabIndex:"1",onActiveChange:this.handleDueDateInputToggle,onDateSelect:this.handleInputDateSelect}),!b&&c.default.createElement(c.default.Fragment,null,c.default.createElement(j.default,{currentDate:t,ignoredDays:r,nextWeekDay:i,predictedDate:s,types:this.initialSelectedDate||(0,h.some)(l,"due")?[].concat(o(u),[v.NO_DATE]):u,selectedDate:this.initialSelectedDate,tabIndex:"2",weekStartDay:p,onSuggestionSelect:this.handleSuggestionSelect}),c.default.createElement(w.default,{currentDate:t,ignoredDays:r,items:n,selectedDate:y,weekStartDay:p,onDateSelect:this.handleDateSelect}),c.default.createElement(g.default,{selectedDate:y,timeFormat:d,userTimezoneInfo:f,isTimePickerShown:E,onTimePickerToggle:this.handleTimePickerToggle,onTimeSelect:this.handleTimeSelect,onSave:m}))))}}]),t}(c.default.PureComponent);C.propTypes={currentDate:f.default.instanceOf(Date).isRequired,ignoredDays:f.default.array,items:f.default.array,karma:f.default.number.isRequired,nextWeekDay:f.default.number,predictedDate:f.default.oneOfType([f.default.instanceOf(Promise),f.default.instanceOf(m.default),f.default.arrayOf(f.default.instanceOf(m.default))]),selectedDate:f.default.instanceOf(m.default),selectedItems:f.default.array,suggestions:f.default.array,timeFormat:f.default.number,userTimezoneInfo:f.default.object,weekStartDay:f.default.number,onClose:f.default.func,onDateSelect:f.default.func},C.defaultProps={ignoredDays:[6,7],items:[],nextWeekDay:1,predictedDate:Promise.resolve(),selectedItems:[],suggestions:[],timeFormat:0,userTimezoneInfo:{},weekStartDay:7,onClose:function(){},onDateSelect:function(){}},r.default=C},{"../../models/DateExt":164,"../../utils":484,"../../utils/deps":470,"../tabbable/Tabbable":402,"./Actions":350,"./datePicker":364,"./dueDateInput":370,"./suggestions":385,"./suggestions/constants":375,"prop-types":"prop-types",react:"react"}],352:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(t,r){if(r===b.SUGGESTED){var n=e("../../models/SmartSchedule");return new Promise(function(e,r){n.predictItemDuedate(t[0],function(t,n){n&&r(),e(t)})})}if(r===b.POSTPONE)return 1===t.length?t[0].due.nextRecurrence()[0]:t.map(function(e){return e.due.nextRecurrence()[0]})}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!0,r=!0,n=e[0]&&e[0].due;return e.forEach(function(e){e.due&&e.due.is_recurring||(t=!1),e.due!==n&&(r=!1)}),t?b.POSTPONE:r?b.SUGGESTED:b.SMART_SCHEDULER}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("react-dom"),d=n(c),f=e("react-redux"),p=e("../Dialog"),m=n(p),h=e("../../models/ItemsModel"),_=n(h),v=e("../../stores/store"),y=n(v),g=e("./suggestions/constants"),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(g),w=e("./container"),E=n(w),k=function(){function e(){o(this,e)}return s(e,[{key:"show",value:function(e){var t=this,r=e.align,n=e.anchor,o=e.dialogClassName,s=e.hideMenus,l=void 0===s||s,c=e.holder,p=e.isDialogFixed,h=e.onDateSelect,v=e.onHide,g=e.selectedDate,w=e.selectedItems;if(l&&(IstTooltip.hide(),IstMenu.hide()),n===this.anchor)return this.anchor=null,d.default.unmountComponentAtNode(c);this.anchor=n;var k=i(w),S=a(w,k);d.default.render(u.default.createElement(f.Provider,{store:y.default},u.default.createElement(m.default,{align:r,anchor:n,className:o,isFixed:p,width:250,onHide:function(){v&&v(),t.anchor=null,d.default.unmountComponentAtNode(c)}},u.default.createElement(E.default,{currentDate:new Date,items:_.default.getAllOwn(),predictedDate:S,selectedDate:g,selectedItems:w,suggestions:[b.TODAY,b.TOMORROW,b.NEXT_WEEK,k],onClose:function(){v&&v(),t.anchor=null,d.default.unmountComponentAtNode(c)},onDateSelect:function(e){h&&h(e),t.anchor=null,d.default.unmountComponentAtNode(c)}}))),c)}}]),e}();r.default=new k},{"../../models/ItemsModel":167,"../../models/SmartSchedule":176,"../../stores/store":456,"../Dialog":201,"./container":353,"./suggestions/constants":375,react:"react","react-dom":"react-dom","react-redux":"react-redux"}],353:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("react-redux"),o=e("../../reducers/user"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o),i=e("./Scheduler"),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(e){return{ignoredDays:a.getDaysOff(e),karma:a.getKarma(e),nextWeekDay:a.getNextWeekDay(e),weekStartDay:a.getWeekStartDay(e),timeFormat:a.getTimeFormat(e),userTimezoneInfo:a.getTimezoneInfo(e)}};r.default=(0,n.connect)(l)(s.default)},{"../../reducers/user":451,"./Scheduler":351,"react-redux":"react-redux"}],354:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("classnames"),p=n(f),m=e("./constants"),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(m),_=e("./MonthList"),v=n(_),y=e("./MonthListHeader"),g=n(y),b=e("./icons/Next"),w=n(b),E=e("./icons/Previous"),k=n(E),S=e("../utils"),j=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.initialLabel=h.shortMonths[e.currentDate.getMonth()]+" "+e.currentDate.getFullYear(),r.state={hoverDate:null,scrollAction:null,topMonthLabel:r.initialLabel,hasHeaderBorder:!1},r.handleDayMouseEnter=r.handleDayMouseEnter.bind(r),r.handleDayMouseLeave=r.handleDayMouseLeave.bind(r),r.handleMonthListScroll=r.handleMonthListScroll.bind(r),r.handleScrollActionCompleted=r.handleScrollActionCompleted.bind(r),r.handleScrollNextMonth=(0,S.wrapKeyboardEnterPress)(r.handleScrollNextMonth.bind(r)),r.handleScrollPreviousMonth=(0,S.wrapKeyboardEnterPress)(r.handleScrollPreviousMonth.bind(r)),r.handleScrollTop=(0,S.wrapKeyboardEnterPress)(r.handleScrollTop.bind(r)),r.handleTopMonthChange=r.handleTopMonthChange.bind(r),r}return i(t,e),s(t,[{key:"handleDayMouseEnter",value:function(e){this.setState({hoverDate:e})}},{key:"handleDayMouseLeave",value:function(){this.setState({hoverDate:null})}},{key:"handleMonthListScroll",value:function(e){var t={};this.state.hoverDate&&(t.hoverDate=null),this.hasActionQueued?this.hasActionQueued=!1:t.hasHeaderBorder=0!==e,this.setState(t)}},{key:"handleScrollActionCompleted",value:function(){this.hasActionQueued=!0,this.setState({hasHeaderBorder:!1,scrollAction:null})}},{key:"handleScrollNextMonth",value:function(e){e.keyCode||e.currentTarget.blur(),this.setState({scrollAction:h.SCROLL_NEXT})}},{key:"handleScrollPreviousMonth",value:function(e){e.keyCode||e.currentTarget.blur(),this.setState({scrollAction:h.SCROLL_PREV})}},{key:"handleScrollTop",value:function(e){e.keyCode||e.currentTarget.blur(),this.setState({scrollAction:h.SCROLL_TOP})}},{key:"handleTopMonthChange",value:function(e){this.setState({topMonthLabel:e})}},{key:"render",value:function(){var e=this.props,t=e.currentDate,r=e.ignoredDays,n=e.items,o=e.selectedDate,a=e.weekStartDay,i=e.onDateSelect,s=this.state,l=s.hoverDate,c=s.scrollAction,d=s.topMonthLabel,f=s.hasHeaderBorder,m=this.initialLabel===d,h=(0,p.default)("scheduler-picker-header-action",{"scheduler-picker-header-action--disabled":m});return u.default.createElement("div",{ref:this.picker,className:"scheduler-picker"},u.default.createElement("div",{className:"scheduler-picker-header"},u.default.createElement("span",{className:"scheduler-picker-header-month"},d),u.default.createElement("div",{className:"scheduler-picker-header-actions"},u.default.createElement("div",{className:h,onClick:this.handleScrollPreviousMonth,onKeyDown:this.handleScrollPreviousMonth,tabIndex:m?"":"3"},u.default.createElement(k.default,null)),u.default.createElement("div",{className:"scheduler-picker-header-action",onClick:this.handleScrollTop,onKeyDown:this.handleScrollTop,tabIndex:"4"},u.default.createElement("div",null,u.default.createElement("div",{className:"outline-circle"}))),u.default.createElement("div",{className:"scheduler-picker-header-action",onClick:this.handleScrollNextMonth,onKeyDown:this.handleScrollNextMonth,tabIndex:"5"},u.default.createElement(w.default,null)))),u.default.createElement(g.default,{dueDate:l,items:n,weekStartDay:a,hasBorder:f}),u.default.createElement(v.default,{currentDate:t,ignoredDays:r,scrollAction:c,selectedDate:o,weekStartDay:a,onDayClick:i,onDayMouseEnter:this.handleDayMouseEnter,onDayMouseLeave:this.handleDayMouseLeave,onScroll:this.handleMonthListScroll,onScrollActionCompleted:this.handleScrollActionCompleted,onTopMonthChange:this.handleTopMonthChange}))}}]),t}(u.default.PureComponent);j.propTypes={currentDate:d.default.instanceOf(Date).isRequired,ignoredDays:d.default.array.isRequired,initialHeight:d.default.number,items:d.default.array,selectedDate:d.default.object,weekStartDay:d.default.number,onDateSelect:d.default.func,onFixedToggle:d.default.func,onScrollTopSet:d.default.func},j.defaultProps={initialHeight:0,items:[],weekStartDay:7,onDateSelect:function(){},onFixedToggle:function(){},onScrollTopSet:function(){}},r.default=j},{"../utils":394,"./MonthList":357,"./MonthListHeader":358,"./constants":360,"./icons/Next":362,"./icons/Previous":363,classnames:"classnames","prop-types":"prop-types",react:"react"}],355:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("classnames"),p=n(f),m=e("../utils"),h=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.day=u.default.createRef(),r.handleClick=(0,m.wrapKeyboardEnterPress)(r.handleClick.bind(r)),r.handleMouseEnter=r.handleMouseEnter.bind(r),r}return i(t,e),s(t,[{key:"handleClick",value:function(e){e.stopPropagation(),this.props.onClick(this.props.date)}},{key:"handleMouseEnter",value:function(){this.props.onMouseEnter(this.props.date)}},{key:"render",value:function(){var e=this.props,t=e.date,r=e.isIgnored,n=e.isSelected,o=e.onMouseLeave,a=t.getDate(),i=(0,p.default)("scheduler-picker-cell",{"scheduler-picker-cell--greyed":r&&!n,"scheduler-picker-cell--selected":n});return u.default.createElement("div",{ref:this.day,className:i,tabIndex:"-1",onClick:this.handleClick,onKeyDown:this.handleClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:o,"data-track":"scheduler|calendar_day"},u.default.createElement("span",{className:"scheduler-picker-cell-day"},a))}}]),t}(u.default.PureComponent);h.propTypes={date:d.default.instanceOf(Date).isRequired,isIgnored:d.default.bool,isSelected:d.default.bool,onClick:d.default.func,onMouseEnter:d.default.func,onMouseLeave:d.default.func},h.defaultProps={isIgnored:!1,isSelected:!1,onClick:function(){},onMouseEnter:function(){},onMouseLeave:function(){}},r.default=h},{"../utils":394,classnames:"classnames","prop-types":"prop-types",react:"react"}],356:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("react"),c=o(u),d=e("prop-types"),f=o(d),p=e("classnames"),m=o(p),h=e("./constants"),_=n(h),v=e("./utils"),y=n(v),g=e("./Day"),b=o(g),w=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.days=c.default.createRef(),r.handleKeyDown=r.handleKeyDown.bind(r),r}return s(t,e),l(t,[{key:"componentDidMount",value:function(){this.days.current.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){this.days.current.removeEventListener("keydown",this.handleKeyDown)}},{key:"handleKeyDown",value:function(e){if(9!==e.keyCode){e.preventDefault();var t=document.activeElement;switch(e.keyCode){case 38:for(var r=0;r<7;r++)if(!(t=t.previousSibling)||"scheduler-picker-month-spacer"===t.className){t=this.getPreviousMonthDay();break}break;case 40:for(var n=0;n<7;n++)(t=t.nextSibling)||(t=this.getNextMonthDay());break;case 37:t=t.previousSibling,t&&"scheduler-picker-month-spacer"!==t.className||(t=this.getPreviousMonthDay());break;case 39:t=t.nextSibling,t||(t=this.getNextMonthDay());break;default:return}t&&t.focus()}}},{key:"getNextMonthDay",value:function(){var e=this.days.current.parentNode.nextSibling;if(e){return $$(".scheduler-picker-cell",e)[0]}}},{key:"getPreviousMonthDay",value:function(){var e=this.days.current.parentNode.previousSibling;if(e){var t=$$(".scheduler-picker-cell",e);return t[t.length-1]}}},{key:"render",value:function(){var e=this.props,t=e.date,r=e.forwardRef,n=e.ignoredDays,o=e.selectedDate,a=e.weekStartDay,i=e.isFirstRowFilled,s=e.onDayClick,l=e.onDayMouseEnter,u=e.onDayMouseLeave,d=t.getFullYear(),f=t.getMonth(),p=t.getDate(),h=t.getDay(),v=void 0,g=void 0,w=void 0;o&&(v=o.getDate(),g=o.getMonth(),w=o.getFullYear());var E=y.getDaysInMonth(d,f),k=E-p,S=[],j=(h-a+7)%7,T=void 0;if(i){var O=f-1,I=d;T=p-j,T<1&&(O<0&&(O=11,I=d-1),T=y.getDaysInMonth(I,O)-j+1)}var P=void 0;for(P=0;P<j;P++)S.push(c.default.createElement("div",{key:"spacer-"+P,className:"scheduler-picker-month-spacer"},i&&T+P));for(P=0;P<=k;P++){var C=v===p&&g===f&&w===d,D=h-1<0?7:h,A=n.indexOf(D)>-1;S.push(c.default.createElement(b.default,{key:P,date:new Date(d,f,p++,23,59,59),isIgnored:A,isSelected:C,onClick:s,onMouseEnter:l,onMouseLeave:u})),h=(h+1)%7}var M=(0,m.default)("scheduler-picker-month",{"scheduler-picker-month--first":i});return c.default.createElement("div",{ref:r,className:M},!i&&c.default.createElement("div",{className:"scheduler-picker-month-header"},_.shortMonths[f]),c.default.createElement("div",{ref:this.days,className:"scheduler-picker-month-days",tabIndex:"-1"},S))}}]),t}(c.default.PureComponent);w.propTypes={date:f.default.instanceOf(Date).isRequired,forwardRef:f.default.func.isRequired,ignoredDays:f.default.array.isRequired,selectedDate:f.default.object,weekStartDay:f.default.number.isRequired,isFirstRowFilled:f.default.bool,onDayClick:f.default.func,onDayMouseEnter:f.default.func,onDayMouseLeave:f.default.func},w.defaultProps={isFirstRowFilled:!1,onDayClick:function(){},onDayMouseEnter:function(){},onDayMouseLeave:function(){}},r.default=w},{"./Day":355,"./constants":360,"./utils":365,classnames:"classnames","prop-types":"prop-types",react:"react"}],357:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=e("react"),d=o(c),f=e("prop-types"),p=o(f),m=e("../../../utils"),h=e("./constants"),_=n(h),v=e("./utils"),y=n(v),g=e("./Month"),b=o(g),w=function(e){function t(e){i(this,t);var r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=new Date(e.currentDate.getTime());return n.setDate(1),r.state={monthsInView:[e.currentDate].concat(a(y.getNextMonths(n,6))),topMonthIndex:0},r.shifted=!1,r.monthList=d.default.createRef(),r.monthsHeights={},r.lastTop=0,r.handleFocus=r.handleFocus.bind(r),r.handleDayMouseEnter=r.handleDayMouseEnter.bind(r),r.handleDayMouseLeave=r.handleDayMouseLeave.bind(r),r.handleScroll=(0,m.throttle)(r.handleScroll.bind(r),1,{trailing:!0}),r.handleScrollAction=r.handleScrollAction.bind(r),r}return l(t,e),u(t,[{key:"componentDidMount",value:function(){var e=this.monthList.current.childNodes,t=this.lastTop;e[0].style.top=t+"px";var r=void 0;for(r=1;r<e.length;r++)t+=e[r-1].clientHeight,e[r].style.top=t+"px";var n=this.monthList.current.parentElement,o=n.offsetWidth-n.clientWidth;n.style.marginRight="-"+(o||20)+"px",n.style.paddingRight=(o?0:20)+"px"}},{key:"componentDidUpdate",value:function(e){if(this.shifted){var t=this.monthList.current.childNodes,r=this.lastTop;this.topMonthEl.style.top=r+"px";for(var n=this.state.topMonthIndex+1;n<t.length;n++)r+=t[n-1].clientHeight,t[n].style.top=r+"px";r=this.lastTop;for(var o=this.state.topMonthIndex-1;o>=0;o--)r-=t[o].clientHeight,t[o].style.top=r+"px";this.shifted=!1}this.props.scrollAction&&this.props.scrollAction!==e.scrollAction&&(this.handleScrollAction(),this.props.onScrollActionCompleted())}},{key:"handleFocus",value:function(e){if(e.target===this.monthList.current){this.topMonthEl.getElementsByClassName("scheduler-picker-cell")[0].focus()}}},{key:"handleScroll",value:function(){var e=this,t=this.monthList.current.parentElement.scrollTop;if(clearTimeout(this.scrollEndTimeout),this.scrollEndTimeout=setTimeout(function(){e.scrollEndTimeout=null},150),this.props.onScroll(t),!this.shifted){var r=this.state,n=r.monthsInView,o=r.topMonthIndex,i=this.props,s=i.currentDate,l=i.weekStartDay,u=this.topMonthEl.offsetTop,c=this.topMonthEl.scrollHeight;if(t<=0)return this.props.onTopMonthChange(_.shortMonths[s.getMonth()]+" "+s.getFullYear()),this.lastTop=0,this.shifted=!0,this.setState({monthsInView:[s].concat(a(y.getNextMonths(s,6))),topMonthIndex:0});var d=0;if(t>u+c){var f=new Date(n[o].getTime());f.setDate(1);for(var p=void 0,m=!0;m;){var h=f.getTime(),v=f.getFullYear(),g=f.getMonth();this.monthsHeights[h]?p=this.monthsHeights[h]:v<=s.getFullYear()&&g<=s.getMonth()?(p=this.monthList.current.childNodes[0].clientHeight,this.monthsHeights[s.getTime()]=p):(p=24*y.getWeeksInMonth(v,g,1,l)+32,this.monthsHeights[h]=p);var b=this.lastTop+p;b>t?m=!1:(d++,this.lastTop=b,f.setMonth(g+1))}}else if(t<u){var w=new Date(n[o].getTime());w.setMonth(w.getMonth()-1);for(var E=void 0,k=!0;k;){
var S=w.getTime(),j=w.getFullYear(),T=w.getMonth();this.monthsHeights[S]?E=this.monthsHeights[S]:j<=s.getFullYear()&&T<=s.getMonth()?(E=24*y.getWeeksInMonth(j,T,s.getDate(),l),this.monthsHeights[s.getTime()]=E):(E=24*y.getWeeksInMonth(j,T,1,l)+32,this.monthsHeights[S]=E);var O=this.lastTop-E;O<t&&(k=!1),d--,this.lastTop=O,w.setMonth(T-1)}}if(d){var I=o+d,P=void 0,C=new Date(n[o].getTime());if(C.setDate(1),C.setMonth(C.getMonth()+d),d>0&&I>3){var D=y.getPreviousMonths(s,C,3);P=[].concat(a(D),[C],a(y.getNextMonths(C,3-D.length+3))),this.shifted=!0,I=3,this.setState({topMonthIndex:I,monthsInView:P,isScrolling:!0})}else if(d<0&&I<3){var A=void 0;C.getMonth()<=s.getMonth()&&C.getFullYear()<=s.getFullYear()?(C=s,A=[]):A=y.getPreviousMonths(s,C,3),P=[].concat(a(A),[C],a(y.getNextMonths(C,3-A.length+3))),this.shifted=!0,I=3-(3-A.length),this.setState({topMonthIndex:I,monthsInView:P,isScrolling:!0})}else this.setState({topMonthIndex:I,isScrolling:!0});var M=P&&P[I]||n[I];this.props.onTopMonthChange(_.shortMonths[M.getMonth()]+" "+M.getFullYear())}}}},{key:"handleScrollAction",value:function(){var e=this.monthList.current.parentElement;switch(this.props.scrollAction){case _.SCROLL_PREV:var t=this.topMonthEl.previousSibling;if(!t)return;e.scrollTop=0===t.offsetTop?0:t.offsetTop+32;break;case _.SCROLL_TOP:e.scrollTop=0;break;case _.SCROLL_NEXT:var r=this.topMonthEl.nextSibling;if(!r)return;e.scrollTop=r.offsetTop+32}}},{key:"handleDayMouseEnter",value:function(e){this.scrollEndTimeout||this.props.onDayMouseEnter(e)}},{key:"handleDayMouseLeave",value:function(){this.scrollEndTimeout||this.props.onDayMouseLeave()}},{key:"render",value:function(){var e=this,t=this.props,r=t.currentDate,n=t.ignoredDays,o=t.selectedDate,a=t.weekStartDay,i=t.onDayClick,s=this.state.monthsInView.map(function(t,s){return d.default.createElement(b.default,{key:t.getTime(),date:t,forwardRef:function(t){s===e.state.topMonthIndex&&(e.topMonthEl=t)},ignoredDays:n,selectedDate:o,weekStartDay:a,isFirstRowFilled:0===s&&r.getTime()===t.getTime(),onDayClick:i,onDayMouseEnter:e.handleDayMouseEnter,onDayMouseLeave:e.handleDayMouseLeave})});return d.default.createElement("div",{className:"scheduler-picker-monthlist-wrapper",onScroll:this.handleScroll},d.default.createElement("div",{className:"scheduler-picker-monthlist",ref:this.monthList,tabIndex:"6",onFocus:this.handleFocus},s))}}]),t}(d.default.PureComponent);w.propTypes={currentDate:p.default.instanceOf(Date).isRequired,ignoredDays:p.default.array.isRequired,selectedDate:p.default.object,scrollAction:p.default.string,weekStartDay:p.default.number.isRequired,onDayClick:p.default.func,onDayMouseEnter:p.default.func,onDayMouseLeave:p.default.func,onTopMonthChange:p.default.func,onScrollActionCompleted:p.default.func,onScroll:p.default.func},w.defaultProps={onDayClick:function(){},onDayMouseEnter:function(){},onDayMouseLeave:function(){},onTopMonthChange:function(){}},r.default=w},{"../../../utils":484,"./Month":356,"./constants":360,"./utils":365,"prop-types":"prop-types",react:"react"}],358:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("classnames"),p=n(f),m=e("./constants"),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(m),_=e("./TasksDue"),v=n(_),y=e("./utils"),g=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={days:r.getDays(e.weekStartDay)},r}return i(t,e),s(t,[{key:"componentDidUpdate",value:function(e){e.weekStartDay!==this.props.weekStartDay&&this.setState({days:this.getDays(this.props.weekStartDay)})}},{key:"getDays",value:function(e){for(var t=[],r=0;r<h.shortDays.length;r++)t.push(h.shortDays[(e+r)%7]);return t}},{key:"render",value:function(){var e=this.props,t=e.dueDate,r=e.items,n=e.hasBorder,o=void 0;o=t?u.default.createElement(v.default,{date:t,tasks:(0,y.getTasksDue)(r,t)}):u.default.createElement("div",{className:"scheduler-picker-monthlistheader-labels"},this.state.days.map(function(e,t){return u.default.createElement("div",{key:t},e)}));var a=(0,p.default)("scheduler-picker-monthlistheader",{"scheduler-picker-monthlistheader--bordered":n});return u.default.createElement("div",{className:a},o)}}]),t}(u.default.PureComponent);g.propTypes={dueDate:d.default.instanceOf(Date),items:d.default.array,weekStartDay:d.default.number.isRequired,hasBorder:d.default.bool},g.defaultProps={items:[]},r.default=g},{"./TasksDue":359,"./constants":360,"./utils":365,classnames:"classnames","prop-types":"prop-types",react:"react"}],359:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../../../utils/format"),p=n(f),m=e("../../../containers/TasksDueBar"),h=n(m),_=window,v=_.DateUtils,y=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.tasks,t=v.format(this.props.date,!1,{with_time:!1,with_weekday:!0}),r=(0,p.default)(_n("{count} task due","{count} tasks due",e.length),{count:e.length}),n=e.length>0&&8*e.length>200?200/e.length:8;return u.default.createElement("div",{className:"scheduler-picker-tasksdue"},u.default.createElement("div",{className:"scheduler-picker-tasksdue-info"},u.default.createElement("span",{className:"scheduler-picker-tasksdue-info-date"},t+" \u2022 "),u.default.createElement("span",{className:"scheduler-picker-tasksdue-info-tasks"},r)),u.default.createElement(h.default,{className:"scheduler-picker-tasksdue-colors",blockWidth:n,blockHeight:3,items:e}))}}]),t}(u.default.PureComponent);y.propTypes={date:d.default.object.isRequired,tasks:d.default.array.isRequired},r.default=y},{"../../../containers/TasksDueBar":116,"../../../utils/format":474,"prop-types":"prop-types",react:"react"}],360:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.shortDays=[_x("weekday_sunday","S"),_x("weekday_monday","M"),_x("weekday_tuesday","T"),_x("weekday_wednesday","W"),_x("weekday_thursday","T"),_x("weekday_friday","F"),_x("weekday_saturday","S")],r.daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31],r.shortMonths=[_("Jan"),_("Feb"),_("Mar"),_("Apr"),_x("short_month","May"),_("Jun"),_("Jul"),_("Aug"),_("Sep"),_("Oct"),_("Nov"),_("Dec")],r.fullMonths=[_("January"),_("February"),_("March"),_("April"),_("May"),_("June"),_("July"),_("August"),_("September"),_("October"),_("November"),_("December")],r.SCROLL_PREV="SCROLL_PREV",r.SCROLL_TOP="SCROLL_TOP",r.SCROLL_NEXT="SCROLL_NEXT"},{}],361:[function(e,t,r){"use strict";function n(e){return i.default.createElement("svg",o({width:16,height:16},e,{viewBox:"0 0 24 24"}),i.default.createElement("path",{fill:"gray",fillRule:"evenodd",d:"M12 10.62l4.833-4.834a.976.976 0 1 1 1.381 1.38L13.381 12l4.833 4.833a.976.976 0 0 1-1.38 1.381L12 13.381l-4.833 4.833a.976.976 0 0 1-1.381-1.38L10.619 12 5.786 7.167a.976.976 0 1 1 1.38-1.381L12 10.619z"}))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=n;var a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},{react:"react"}],362:[function(e,t,r){"use strict";function n(e){return i.default.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},e),i.default.createElement("g",{fill:"none",fillRule:"evenodd"},i.default.createElement("path",{d:"M0 24V0h24v24z"}),i.default.createElement("path",{fill:"currentColor",fillRule:"nonzero",d:"M13.293 12L9.646 8.354a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 12z"})))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=n;var a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},{react:"react"}],363:[function(e,t,r){"use strict";function n(e){return i.default.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24"},e),i.default.createElement("g",{fill:"none",fillRule:"evenodd"},i.default.createElement("path",{d:"M24 0v24H0V0z"}),i.default.createElement("path",{fill:"currentColor",fillRule:"nonzero",d:"M10.707 12l3.647 3.646a.5.5 0 0 1-.708.708l-4-4a.5.5 0 0 1 0-.708l4-4a.5.5 0 0 1 .708.708L10.707 12z"})))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=n;var a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},{react:"react"}],364:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./DatePicker"),o=function(e){return e&&e.__esModule?e:{default:e}}(n);r.default=o.default},{"./DatePicker":354}],365:[function(e,t,r){"use strict";function n(e,t,r){var n=new Date(e,0,1);return Math.ceil((Math.round((t-n)/864e5)+n.getDay()+1-r)/7)}Object.defineProperty(r,"__esModule",{value:!0}),r.getTasksDue=r.getWeeksInMonth=r.getDaysInMonth=r.getPreviousMonths=r.getNextMonths=r.getPreviousMonthDate=r.getNextMonthDate=void 0;var o=e("./constants"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o),i=e("../../../utils"),s=r.getNextMonthDate=function(e){var t=e.getMonth(),r=new Date(e.getFullYear(),e.getMonth(),1);return r.setMonth(t+1),r},l=r.getPreviousMonthDate=function(e,t){var r=e.getMonth(),n=new Date(e.getFullYear(),e.getMonth(),1);return n.setMonth(r-1),t&&n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()?t:n};r.getNextMonths=function(e,t){for(var r=[],n=0;n<t;n++)e=s(e),r.push(e);return r},r.getPreviousMonths=function(e,t,r){var n=[];if(t.getTime()===e.getTime())return n;for(var o=0;o<r;o++){if((t=l(t,e))===e)return[e].concat(n);n.unshift(t)}return n},r.getDaysInMonth=function(e,t){return 1==t?e%4==0?29:28:a.daysInMonth[t]},r.getWeeksInMonth=function(e,t,r,o){var a=new Date(e,t,r),i=n(e,a,o);return n(e,new Date(e,t+1,0),o)-i+1},r.getTasksDue=function(e,t){return t?e.filter(function(e){return!!e.due&&(0,i.isOnSameDate)(e.due,t)}):[]}},{"../../../utils":484,"./constants":360}],366:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../../../models/DateExt"),p=n(f),m=e("../timezoneSelector/constants"),h=e("./utils"),v=e("../datePicker/icons/Delete"),y=n(v),g=e("./DueDatePreview"),b=n(g),w=e("./icons/TimezoneIcon"),E=n(w),k=e("../utils"),S=window,j=S.DateUtils,T=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=e.currentDate,i=e.selectedDate;return r.state={dateResult:null,inputValue:(0,h.getInputValue)(i),timezone:i&&i.timezone,isSubmitted:!1},r.initialDate=e.selectedDate,r.parsingDate=e.selectedDate?e.selectedDate.inheritDate({year:n.getFullYear(),month:n.getMonth(),day:n.getDate()}):null,r.handleFocus=r.handleFocus.bind(r),r.handleInputChange=r.handleInputChange.bind(r),r.handleInputKeyDown=r.handleInputKeyDown.bind(r),r.handleInputReset=r.handleInputReset.bind(r),r.handleSubmit=r.handleSubmit.bind(r),r.handleTimezoneIconClick=(0,k.wrapKeyboardEnterPress)(r.handleTimezoneIconClick.bind(r)),r.handleTimezoneSelect=r.handleTimezoneSelect.bind(r),r}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;window.requestAnimationFrame(function(){e.input.focus()})}},{key:"componentDidUpdate",value:function(e){var t={};this.initialDate&&(!this.initialDate||this.initialDate.is_recurring)||this.props.selectedDate===e.selectedDate||(t.inputValue=(0,h.getInputValue)(this.props.selectedDate)),this.props.selectedDate!==e.selectedDate&&(t.timezone=this.props.selectedDate.timezone),this.setState(t)}},{key:"handleFocus",value:function(){this.input.select()}},{key:"handleInputChange",value:function(e){var t=e.target.value;if(""===t)return this.handleInputReset(e);var r={dateResult:j.parse(t,this.parsingDate),inputValue:t};this.state.isSubmitted&&(r.isSubmitted=!1),this.state.dateResult||this.props.onActiveChange(!0),this.setState(r)}},{key:"handleInputKeyDown",value:function(e){13===e.keyCode?this.handleSubmit(e):27===e.keyCode&&this.handleInputReset(e)}},{key:"handleInputReset",value:function(e){!this.state.inputValue&&!this.state.dateResult||e.keyCode&&13!==e.keyCode&&27!==e.keyCode||(e.nativeEvent.stopImmediatePropagation(),this.setState({dateResult:null,inputValue:"",isSubmitted:!1}),this.input.focus(),this.props.onActiveChange(!1))}},{key:"handleSubmit",value:function(){var e=this.state,t=e.dateResult,r=e.inputValue,n=e.timezone;if(this.setState({isSubmitted:!0}),!t||t.due_date){var o=void 0;if(t)if(t.due_date instanceof p.default)o=n!==t.due_date.timezone?t.due_date.changeTimezone(n):t.due_date;else{var a=t.all_day?{}:{timezone:n};o=p.default.fromDateist(t,a)}else o=r?this.props.selectedDate:null;track("scheduler","enter","type_a_date"),this.props.onDateSelect(o)}}},{key:"handleTimezoneIconClick",value:function(e){e.stopPropagation();var t=this.state.inputValue||(0,h.getInputValue)(this.props.selectedDate),r=j.parse(t,this.parsingDate);r.due_date=this.props.selectedDate,this.setState({dateResult:r}),this.input.focus(),this.props.onActiveChange(!0)}},{key:"handleTimezoneSelect",value:function(e){var t=void 0;switch(e){case m.FIXED_DATE:t=this.props.userTimezoneInfo.timezone;break;case m.TASK_DATE:t=this.props.selectedDate.timezone;break;case m.FLOATING_DATE:default:t=null}this.setState({timezone:t}),this.input.focus()}},{key:"render",value:function(){var e=this,t=this.state,r=t.dateResult,n=t.inputValue,o=t.timezone,a=t.isSubmitted,i=this.props,s=i.karma,l=i.items,c=i.selectedDate,d=i.userTimezoneInfo,f=i.tabIndex;return u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:"scheduler-input"},u.default.createElement("input",{ref:function(t){e.input=t},placeholder:_("Type a due date"),value:n,tabIndex:f,onChange:this.handleInputChange,onFocus:this.handleFocus,onKeyDown:this.handleInputKeyDown}),r?n.length>0&&u.default.createElement(y.default,{className:"scheduler-input-close",tabIndex:"2",onClick:this.handleInputReset,onKeyDown:this.handleInputReset}):o&&u.default.createElement(E.default,{tabIndex:"2",onClick:this.handleTimezoneIconClick,onKeyDown:this.handleTimezoneIconClick})),r&&u.default.createElement(b.default,{dateResult:r,karma:s,items:l,selectedDate:c,userTimezoneInfo:d,timezone:o,isSubmitted:a,onClick:this.handleSubmit,onTimezoneSelect:this.handleTimezoneSelect}))}}]),t}(u.default.PureComponent);T.propTypes={currentDate:d.default.instanceOf(Date).isRequired,karma:d.default.number.isRequired,items:d.default.array,selectedDate:d.default.instanceOf(p.default),tabIndex:d.default.string,userTimezoneInfo:d.default.object.isRequired,onActiveChange:d.default.func,onDateSelect:d.default.func},T.defaultProps={items:[],onActiveChange:function(){},onDateSelect:function(){}},r.default=T},{"../../../models/DateExt":164,"../datePicker/icons/Delete":361,"../timezoneSelector/constants":391,"../utils":394,"./DueDatePreview":367,"./icons/TimezoneIcon":369,"./utils":371,"prop-types":"prop-types",react:"react"}],367:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../../../models/DateExt"),p=n(f),m=e("../../../utils/format"),h=n(m),v=e("../datePicker/utils"),y=e("./HelpText"),g=n(y),b=e("../timezoneSelector"),w=n(b),E=window,k=E.DateUtils,S=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleClick=r.handleClick.bind(r),r}return i(t,e),s(t,[{key:"handleClick",value:function(e){e.stopPropagation(),this.props.onClick(e)}},{key:"render",value:function(){var e=this.props,t=e.dateResult,r=e.karma,n=e.items,o=e.userTimezoneInfo,a=e.timezone,i=e.isSubmitted,s=e.onTimezoneSelect;if(i&&!t.due_date)return u.default.createElement("div",{className:"scheduler-preview scheduler-preview--invalid"},u.default.createElement("div",{className:"scheduler-preview-content"},u.default.createElement("img",{src:"https://d3ptyyxy2at9ui.cloudfront.net/search-d96071.svg",width:"24",height:"24"}),u.default.createElement("div",{className:"scheduler-preview-date"},_("No results"),r<2500&&u.default.createElement(g.default,{isValid:!1}))));if(t.due_date){var l=t.is_recurring?"https://d3ptyyxy2at9ui.cloudfront.net/recurring-a3554a.svg":"https://d3ptyyxy2at9ui.cloudfront.net/valid-74cb73.svg",c=k.format(t.due_date,!1,{with_time:!1,with_weekday:!0}),d=(0,v.getTasksDue)(n,t.due_date),f=void 0,m=void 0,y=void 0,b=void 0;return t.all_day||(y=t.due_date instanceof p.default?t.due_date.format({inTimezoneTime:!0,onlyTime:!0}):k.getHourAndMin(t.due_date)),d.length>0?(m=_n("1 task","{n} tasks",d.length),m=(0,h.default)(m,{n:d.length})):m=_("No tasks"),t.is_recurring?(f=t.end_date?k.format(t.end_date,!1,{with_time:!1,with_weekday:!0}):_("Forever"),b=(0,h.default)(_("Repeats {recurring_date_pattern}"),{recurring_date_pattern:t.start_string||t.date_string})):b=m,u.default.createElement("div",{className:"scheduler-preview scheduler-preview--valid"},u.default.createElement("div",{className:"scheduler-preview-content",onClick:this.handleClick},u.default.createElement("img",{src:l,width:24,height:24}),u.default.createElement("div",{className:"scheduler-preview-date"},u.default.createElement("div",{className:"scheduler-preview-date-info"},u.default.createElement("span",null,c),f&&u.default.createElement("span",null," \u2192 "+f),u.default.createElement("span",{className:"scheduler-preview-date-info-time"},y)),u.default.createElement("span",{className:"scheduler-preview-date-tasks"},b))),(!t.all_day||a)&&u.default.createElement(w.default,{userTimezoneInfo:o,timezone:a,tabIndex:"3",onSelect:s}),r<2500&&u.default.createElement(g.default,null))}return null}}]),t}(u.default.PureComponent);S.propTypes={dateResult:d.default.object.isRequired,karma:d.default.number.isRequired,items:d.default.array,userTimezoneInfo:d.default.object.isRequired,selectedDate:d.default.instanceOf(p.default),isSubmitted:d.default.bool,onClick:d.default.func,onTimezoneSelect:d.default.func,timezone:d.default.string},S.defaultProps={isSubmitted:!1,items:[],onClick:function(){},onTimezoneSelect:function(){}},r.default=S},{"../../../models/DateExt":164,"../../../utils/format":474,"../datePicker/utils":365,"../timezoneSelector":393,"./HelpText":368,"prop-types":"prop-types",react:"react"}],368:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=void 0,t=void 0,r=void 0;return this.props.isValid?(e=_("You can also type in recurring due dates like <b>every day</b>, <b>every 2 weeks</b>, and <b>every last Fri of the month</b>."),t=_("More about recurring due dates"),r="https://support.todoist.com/hc/en-us/articles/360000636289"):(e=_("Did you know you can type in due dates like <b>Jan 15 at 9am</b>, <b>2 months from now</b>, or <b>every Friday</b>?"),t=_("More about due dates"),r="https://support.todoist.com/hc/en-us/articles/205325931"),u.default.createElement("div",{className:"scheduler-preview-help"},u.default.createElement("p",{dangerouslySetInnerHTML:{__html:e}}),u.default.createElement("p",null,u.default.createElement("a",{href:r,rel:"noopener noreferrer",className:"scheduler-preview-help-link",target:"_blank"},t)))}}]),t}(u.default.PureComponent);f.propTypes={isValid:d.default.bool},f.defaultProps={isValid:!0},r.default=f},{"prop-types":"prop-types",react:"react"}],369:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.onClick,r=e.onKeyDown,n=e.tabIndex;return i.default.createElement("svg",{className:"scheduler-input-timezone",width:24,height:24,viewBox:"0 0 24 24",onClick:t,onKeyDown:r,tabIndex:n},i.default.createElement("path",{d:"M12 4c-4.4 0-8 3.6-8 8s3.6 8 8 8 8-3.6 8-8-3.6-8-8-8zm7 8.7v.3c0 .1 0 .3-.1.4 0 .1-.1.3-.1.4 0 .1 0 .2-.1.3 0 .1-.1.3-.1.4 0 .1 0 .1-.1.2-.1.2-.1.3-.2.5 0 0 0 .1-.1.1-.1.2-.2.3-.3.5v.1c-.1.2-.2.3-.3.5-.1.2-.3.3-.4.5-.2-.7-.9-1.2-1.7-1.2h-.9v-2.6c0-.5-.4-.9-.9-.9H8.5v-1.8h1.8c.5 0 .9-.4.9-.9V7.6H13c1 0 1.8-.8 1.8-1.8v-.3c.3.1.6.3.9.5.6.3 1.1.8 1.6 1.3.4.5.8 1 1.1 1.6 0 0 0 .1.1.1.3.6.5 1.2.6 1.8v.2c0 .3.1.6.1 1 0-.3 0-.6-.1-1 0 .3.1.6.1 1-.2.2-.2.5-.2.7zm0 0v.2c-.1 0 0-.1 0-.2zm-.1.7c0 .1 0 .2-.1.3 0-.1 0-.2.1-.3zm-.2.6c0 .1-.1.2-.1.3 0-.1.1-.2.1-.3zm-.2.6c0 .1-.1.2-.1.3 0-.1 0-.2.1-.3zm-.3.6c-.1.1-.1.2-.2.3.1-.1.1-.2.2-.3zm-.3.6c-.1.1-.1.2-.2.3 0-.1.1-.2.2-.3zm-.4.5c-.1.1-.1.2-.2.3 0-.1.1-.2.2-.3zM14.7 5.5c.3.1.6.3.8.4-.3-.1-.6-.3-.8-.4zM18.3 9c.1.3.2.5.3.8 0-.2-.1-.5-.3-.8zm.4.9c.1.3.2.6.2.9-.1-.3-.1-.6-.2-.9zm-1-1.9c-.2-.2-.3-.5-.5-.7.2.2.4.5.5.7zm.5.8c-.1-.3-.3-.5-.5-.8.3.3.4.6.5.8zm-1.1-1.6c-.2-.2-.4-.4-.7-.6.2.2.5.4.7.6zM15.6 6c.2.1.5.3.7.5-.2-.2-.4-.3-.7-.5zM5 11.2v.8c0-.5.1-1.1.2-1.6l4.2 4.2v.9c0 1 .8 1.8 1.8 1.8V19c-1-.1-2-.5-2.9-1 0 0-.1 0-.1-.1-.1-.1-.2-.2-.3-.2-.1 0-.1-.1-.2-.1-.1-.1-.2-.2-.3-.2l-.2-.2c-.1-.2-.2-.3-.3-.4-.1-.1-.1-.2-.2-.2-.1-.1-.1-.2-.2-.3-.1-.1-.1-.2-.2-.3-.1-.1-.1-.2-.2-.3-.1-.1-.1-.2-.2-.3-.1-.1-.1-.2-.2-.3-.1-.1-.1-.2-.1-.3 0-.1-.1-.2-.1-.3 0-.1-.1-.2-.1-.3 0-.1-.1-.2-.1-.3 0-.1-.1-.2-.1-.4 0-.1 0-.2-.1-.3 0-.1 0-.3-.1-.4V11.2zm.2-.7c0 .2-.1.3-.1.5 0-.2 0-.3.1-.5zm5.6 8.4h-.3.3zm-.7-.2c-.1 0-.2 0-.2-.1.1.1.2.1.2.1zm-.7-.2c-.1 0-.2-.1-.3-.1.1 0 .2 0 .3.1zm-.7-.3c-.1 0-.2-.1-.3-.2.1.1.2.1.3.2zm-.6-.4c-.1-.1-.2-.1-.3-.2.2.1.3.2.3.2zm-.5-.3c-.1-.1-.2-.1-.2-.2.1 0 .1.1.2.2zm-.9-.9c-.1-.1-.1-.2-.2-.2.1 0 .1.1.2.2zm-.4-.6c-.1-.1-.1-.2-.2-.2.1.1.1.2.2.2zm-.4-.5c0-.1-.1-.2-.1-.3 0 .1.1.2.1.3zm-.3-.6c0-.1-.1-.2-.1-.3.1.1.1.2.1.3zm-.2-.6c0-.1-.1-.2-.1-.3 0 .1.1.2.1.3zm-.2-.7c0-.1 0-.2-.1-.2.1 0 .1.1.1.2zm-.1-.7v-.2c-.1.1 0 .1 0 .2zm1.8 3.9l.2.2-.2-.2z",fill:"#b2b2b2"}))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s);o.propTypes={onClick:l.default.func,onKeyDown:l.default.func,tabIndex:l.default.string},r.default=o},{"prop-types":"prop-types",react:"react"}],370:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./DueDateInput"),o=function(e){return e&&e.__esModule?e:{default:e}}(n);r.default=o.default},{"./DueDateInput":366}],371:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.getInputValue=function(e){return e?e.is_recurring?e.string:e.format({inTimezoneTime:!0}):""}},{}],372:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("classnames"),p=n(f),m=e("../../../models/DateExt"),h=n(m),v=e("../../../utils"),y=e("./constants"),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(y),b=e("./SuggestionIcon"),w=n(b),E=e("../utils"),k=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.isUnmounted=!1,r.handleClick=(0,E.wrapKeyboardEnterPress)(r.handleClick.bind(r)),r.state=r.getSuggestionInfo(e),r}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){e.type===this.props.type&&e.ignoredDays===this.props.ignoredDays||this.setState(this.getSuggestionInfo(e))}},{key:"componentWillUnmount",value:function(){this.isUnmounted=!0}},{key:"handleClick",value:function(){var e=this.props,t=e.predictedDate,r=e.type,n=e.onClick;if(r!==g.SUGGESTED||this.state.suggestedDate)return r===g.NO_DATE?n(r,null):r===g.SMART_SCHEDULER?n(r):r===g.POSTPONE?n(r,t):void n(r,this.state.suggestedDate)}},{key:"getSuggestionInfo",value:function(e){var t=this,r=e.currentDate,n=e.ignoredDays,o=e.nextWeekDay,a=e.predictedDate,i=e.selectedDate,s=e.type,l=e.weekStartDay,u=void 0,c=void 0,d=void 0,f=void 0,p=void 0,h=void 0,v=i&&i.timezone?(0,m.getOffsetDate)(r,-r.getTimezoneOffset(),-i.timezone_offset):new Date(r.getTime());switch(v.setHours(23,59,59),s){case g.TODAY:h=_("Today");break;case g.TOMORROW:h=_("Tomorrow"),v.setDate(v.getDate()+1);break;case g.NEXT_WEEK:h=_("Next week"),f=l-(0===v.getDay()?7:v.getDay()),f<=0&&(f+=7),u=o-l,u<0&&(u+=7),d=f+u,v.setDate(v.getDate()+d);break;case g.NEXT_WEEKEND:h=_("Next weekend"),p=n.reduce(function(e,t){return Math.min(e,t)}),c=p-v.getDay(),c<=0&&(c+=7),v.setDate(v.getDate()+c);break;case g.IN_THE_MORNING:h=_("In the morning"),v.setDate(v.getDate()+1),v.setHours(9,0,0);break;case g.SUGGESTED:a.then(function(e){t.isUnmounted||(e.setSeconds(59),t.setState({suggestedDate:e,suggestionLabel:_x("scheduler_suggested_date","Suggested")}))}).catch(function(){t.isUnmounted||t.setState({hasError:!0,suggestionLabel:_x("scheduler_suggested_date_error","Suggested error")})}),v=null,h=_x("scheduler_suggested_date_loading","Suggesting...");break;case g.POSTPONE:a instanceof Array?v=null:(v.setSeconds(59),v=a),h=_("Postpone");break;case g.SMART_SCHEDULER:v=null,h=_("Open Smart Schedule"),h=_("Open Smart Scheduler");break;case g.NO_DATE:v=null,h=_("No Date")}return{hasError:void 0,suggestedDate:v,suggestionLabel:h}}},{key:"render",value:function(){var e=this.state,t=e.hasError,r=e.suggestedDate,n=e.suggestionLabel,o=this.props,a=o.tabIndex,i=o.type,s=r&&r.getDay(),l=null===r&&i===g.SUGGESTED,c=(0,p.default)("scheduler-suggestions-item",{"scheduler-suggestions-item--disabled":l});return u.default.createElement("div",{className:c,onClick:this.handleClick,onKeyDown:this.handleClick,"data-track":"scheduler|"+g.trackingActions[i],tabIndex:l?"-1":a},u.default.createElement(w.default,{hasError:t,date:r,type:i}),u.default.createElement("div",{className:"scheduler-suggestions-item-label"},n),(0,v.isNumber)(s)&&u.default.createElement("div",{className:"scheduler-suggestions-item-weekday"},g.shortWeekdays[s]))}}]),t}(u.default.PureComponent);k.propTypes={currentDate:d.default.object.isRequired,ignoredDays:d.default.array.isRequired,nextWeekDay:d.default.number.isRequired,predictedDate:d.default.oneOfType([d.default.instanceOf(Promise),d.default.instanceOf(h.default),d.default.arrayOf(d.default.instanceOf(h.default))]),selectedDate:d.default.instanceOf(h.default),tabIndex:d.default.string,type:d.default.string.isRequired,weekStartDay:d.default.number.isRequired,
onClick:d.default.func.isRequired},k.defaultProps={predictedDate:Promise.resolve(),onClick:function(){}},r.default=k},{"../../../models/DateExt":164,"../../../utils":484,"../utils":394,"./SuggestionIcon":373,"./constants":375,classnames:"classnames","prop-types":"prop-types",react:"react"}],373:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("./constants"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(f),m=e("./icons/Today"),h=n(m),_=e("./icons/Tomorrow"),v=n(_),y=e("./icons/Morning"),g=n(y),b=e("./icons/NextWeek"),w=n(b),E=e("./icons/NextWeekend"),k=n(E),S=e("./icons/NoDate"),j=n(S),T=e("./icons/Postpone"),O=n(T),I=e("./icons/Suggested"),P=n(I),C=e("./icons/SuggestedError"),D=n(C),A=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.date,r=e.hasError,n=e.type,o=void 0,a=void 0;switch(n){case p.TODAY:o=u.default.createElement(h.default,null),a=t.getDate();break;case p.TOMORROW:o=u.default.createElement(v.default,null);break;case p.NEXT_WEEK:o=u.default.createElement(w.default,null);break;case p.NEXT_WEEKEND:o=u.default.createElement(k.default,null);break;case p.NO_DATE:o=u.default.createElement(j.default,null);break;case p.IN_THE_MORNING:o=u.default.createElement(g.default,null);break;case p.SMART_SCHEDULER:case p.SUGGESTED:o=r?u.default.createElement(D.default,null):u.default.createElement(P.default,null),a=t&&t.getDate();break;case p.POSTPONE:o=u.default.createElement(O.default,null)}var i=n===p.SUGGESTED?"scheduler-suggestions-item-icon--suggested":"";return u.default.createElement("div",{className:"scheduler-suggestions-item-icon"},o,a&&u.default.createElement("span",{className:i},a))}}]),t}(u.default.PureComponent);A.propTypes={date:d.default.object,hasError:d.default.bool,type:d.default.string.isRequired},A.defaultProps={hasError:!1},r.default=A},{"./constants":375,"./icons/Morning":376,"./icons/NextWeek":377,"./icons/NextWeekend":378,"./icons/NoDate":379,"./icons/Postpone":380,"./icons/Suggested":381,"./icons/SuggestedError":382,"./icons/Today":383,"./icons/Tomorrow":384,"prop-types":"prop-types",react:"react"}],374:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../../../models/DateExt"),p=n(f),m=e("./Suggestion"),h=n(m),_=function(e){function t(){return o(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.currentDate,r=e.ignoredDays,n=e.nextWeekDay,o=e.predictedDate,a=e.selectedDate,i=e.tabIndex,s=e.types,l=e.weekStartDay,c=e.onSuggestionSelect;return u.default.createElement("div",{className:"scheduler-suggestions"},s.map(function(e){return u.default.createElement(h.default,{key:e,type:e,currentDate:t,ignoredDays:r,nextWeekDay:n,predictedDate:o,selectedDate:a,tabIndex:i,weekStartDay:l,onClick:c})}))}}]),t}(u.default.PureComponent);_.propTypes={currentDate:d.default.object.isRequired,types:d.default.array,ignoredDays:d.default.array.isRequired,nextWeekDay:d.default.number.isRequired,predictedDate:d.default.oneOfType([d.default.instanceOf(Promise),d.default.instanceOf(p.default),d.default.arrayOf(d.default.instanceOf(p.default))]),selectedDate:d.default.instanceOf(p.default),tabIndex:d.default.string,weekStartDay:d.default.number.isRequired,onSuggestionSelect:d.default.func},_.defaultProps={types:[],onSuggestionSelect:function(){}},r.default=_},{"../../../models/DateExt":164,"./Suggestion":372,"prop-types":"prop-types",react:"react"}],375:[function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0});var o,a=r.TODAY="today",i=r.TOMORROW="tomorrow",s=r.NEXT_WEEK="nextWeek",l=r.NEXT_WEEKEND="nextWeekend",u=r.IN_THE_MORNING="inTheMorning",c=r.SUGGESTED="suggested",d=r.POSTPONE="postpone",f=r.SMART_SCHEDULER="smartScheduler",p=r.NO_DATE="noDate";r.trackingActions=(o={},n(o,a,"date_shortcut_today"),n(o,i,"date_shortcut_tomorrow"),n(o,s,"date_shortcut_nextweek"),n(o,l,"date_shortcut_nextweekend"),n(o,u,"date_shortcut_morning"),n(o,c,"date_shortcut_suggested"),n(o,d,"date_shortcut_postpone"),n(o,f,"date_shortcut_smartscheduler"),n(o,p,"date_shortcut_nodate"),o),r.shortWeekdays=[_("Sun"),_("Mon"),_("Tue"),_("Wed"),_("Thu"),_("Fri"),_("Sat")]},{}],376:[function(e,t,r){"use strict";function n(e){return i.default.createElement("svg",o({width:24,height:24},e),i.default.createElement("path",{fill:"gray",fillRule:"evenodd",d:"M8.535 14a4 4 0 1 1 6.93 0h-6.93zm.02-10.315a.5.5 0 0 1 .654.27l.765 1.848a.5.5 0 1 1-.923.383l-.766-1.848a.5.5 0 0 1 .27-.653zm6.89 0a.5.5 0 0 1 .27.653l-.766 1.848a.5.5 0 0 1-.923-.383l.765-1.847a.5.5 0 0 1 .653-.27zm4.87 4.87a.5.5 0 0 1-.27.654l-1.848.765a.5.5 0 0 1-.383-.923l1.848-.766a.5.5 0 0 1 .653.27zm-16.63 0a.5.5 0 0 1 .653-.27l1.848.766a.5.5 0 0 1-.383.923L3.956 9.21a.5.5 0 0 1-.27-.653zM9.5 17h5a.5.5 0 1 1 0 1h-5a.5.5 0 1 1 0-1zm-4-2h13a.5.5 0 1 1 0 1h-13a.5.5 0 1 1 0-1z"}))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=n;var a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},{react:"react"}],377:[function(e,t,r){"use strict";function n(e){return i.default.createElement("svg",o({width:24,height:24},e),i.default.createElement("g",{fill:"gray",fillRule:"evenodd"},i.default.createElement("rect",{width:2,height:1,x:8,y:13,rx:.5,strokeWidth:0}),i.default.createElement("path",{d:"M20 8v9.436c0 .892-.093 1.215-.267 1.54a1.81 1.81 0 0 1-.756.757c-.326.174-.65.267-1.54.267H6.563c-.892 0-1.215-.093-1.54-.267a1.817 1.817 0 0 1-.757-.756c-.174-.326-.267-.65-.267-1.54V6a2 2 0 0 1 2-2h1V2.5a.5.5 0 0 1 1 0V4h8V2.5a.5.5 0 1 1 1 0V4h1a2 2 0 0 1 2 2v2zM6.564 8c-.662 0-.864.039-1.07.149a.818.818 0 0 0-.345.346C5.039 8.7 5 8.902 5 9.564v7.872c0 .662.039.864.149 1.07a.818.818 0 0 0 .346.345c.205.11.407.149 1.069.149h10.872c.662 0 .864-.039 1.07-.149a.818.818 0 0 0 .345-.346c.11-.205.149-.407.149-1.069V9.564c0-.662-.039-.864-.149-1.07a.818.818 0 0 0-.346-.345C18.3 8.039 18.098 8 17.436 8H6.564z"}),i.default.createElement("path",{d:"M15.043 13l-1.897-1.896a.5.5 0 0 1 .708-.708l2.828 2.829a.498.498 0 0 1 0 .707l-2.828 2.828a.5.5 0 1 1-.708-.707L15.2 14h-3.7a.5.5 0 1 1 0-1h3.543z"})))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=n;var a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},{react:"react"}],378:[function(e,t,r){"use strict";function n(e){return i.default.createElement("svg",o({width:24,height:24},e),i.default.createElement("g",{fill:"gray",fillRule:"evenodd"},i.default.createElement("path",{d:"M17 15v-3a2 2 0 1 1 4 0v4.436c0 .892-.093 1.215-.267 1.54a1.81 1.81 0 0 1-.756.757c-.326.174-.65.267-1.54.267H5.563c-.892 0-1.215-.093-1.54-.267a1.817 1.817 0 0 1-.757-.756c-.174-.326-.267-.65-.267-1.54V12a2 2 0 1 1 4 0v3h10z"}),i.default.createElement("path",{d:"M19 9a3 3 0 0 0-3 3v2H8v-2a3 3 0 0 0-3-3v-.436c0-.892.093-1.215.267-1.54a1.81 1.81 0 0 1 .756-.757c.326-.174.65-.267 1.54-.267h8.873c.892 0 1.215.093 1.54.267.327.174.583.43.757.756.174.326.267.65.267 1.54V9z"})))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=n;var a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},{react:"react"}],379:[function(e,t,r){"use strict";function n(e){return i.default.createElement("svg",o({width:24,height:24},e),i.default.createElement("path",{fill:"gray",d:"M17.657 17.657A8 8 0 1 1 6.343 6.343a8 8 0 0 1 11.314 11.314zm-.707-.707a7 7 0 1 0-9.9-9.9 7 7 0 0 0 9.9 9.9zm-8.096-1.096a.5.5 0 0 1-.708-.708l7-7a.5.5 0 0 1 .708.708l-7 7z"}))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=n;var a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},{react:"react"}],380:[function(e,t,r){"use strict";function n(e){return i.default.createElement("svg",o({width:24,height:24},e),i.default.createElement("path",{fill:"gray",d:"M18.121 4l-1.939-1.94a.5.5 0 0 1 .707-.706l2.829 2.828a.5.5 0 0 1 0 .707l-2.829 2.829a.5.5 0 0 1-.707-.708L18.192 5H12a7 7 0 1 0 6.929 8h1.009A8 8 0 1 1 12 4h6.121z"}))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=n;var a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},{react:"react"}],381:[function(e,t,r){"use strict";function n(e){return i.default.createElement("svg",o({width:24,height:24},e),i.default.createElement("g",{fill:"gray",fillRule:"evenodd"},i.default.createElement("path",{d:"M11.488 5.018a7 7 0 1 0 7.495 7.47h1.002a8 8 0 1 1-8.497-8.472v1.002zm7.494 6.47a6.995 6.995 0 0 0-3.072-5.295l.502-.868a7.995 7.995 0 0 1 3.572 6.163h-1.002zm-6.494-6.471V4.015a7.954 7.954 0 0 1 3.057.811l-.501.869a6.958 6.958 0 0 0-2.556-.678z"})))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=n;var a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},{react:"react"}],382:[function(e,t,r){"use strict";function n(e){return i.default.createElement("svg",o({width:24,height:24},e),i.default.createElement("g",{fill:"gray",fillRule:"evenodd"},i.default.createElement("path",{d:"M19 12a6.993 6.993 0 0 0-3.09-5.807l.502-.868A7.993 7.993 0 0 1 20 12h-1zm-7-7V4c1.273 0 2.477.297 3.545.826l-.501.869A6.972 6.972 0 0 0 12 5zm-1 .07A7.002 7.002 0 0 0 12 19a7.002 7.002 0 0 0 6.93-6h1.008A8.001 8.001 0 0 1 4 12a8.001 8.001 0 0 1 7-7.938V5.07z"}),i.default.createElement("path",{d:"M10.88 7.41h2.345l-.195 5.923h-1.954L10.88 7.41zm-.073 7.914c0-.709.458-1.118 1.246-1.118s1.252.41 1.252 1.118c0 .702-.464 1.11-1.252 1.11s-1.246-.408-1.246-1.11z"})))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=n;var a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},{react:"react"}],383:[function(e,t,r){"use strict";function n(e){return i.default.createElement("svg",o({width:24,height:24},e,{viewBox:"0 0 24 24"}),i.default.createElement("g",{fill:"gray",fillRule:"evenodd"},i.default.createElement("path",{d:"M20 8v9.436c0 .892-.093 1.215-.267 1.54a1.81 1.81 0 0 1-.756.757c-.326.174-.65.267-1.54.267H6.563c-.892 0-1.215-.093-1.54-.267a1.817 1.817 0 0 1-.757-.756c-.174-.326-.267-.65-.267-1.54V6a2 2 0 0 1 2-2h1V2.5a.5.5 0 0 1 1 0V4h8V2.5a.5.5 0 1 1 1 0V4h1a2 2 0 0 1 2 2v2zM6.564 8c-.662 0-.864.039-1.07.149a.818.818 0 0 0-.345.346C5.039 8.7 5 8.902 5 9.564v7.872c0 .662.039.864.149 1.07a.818.818 0 0 0 .346.345c.205.11.407.149 1.069.149h10.872c.662 0 .864-.039 1.07-.149a.818.818 0 0 0 .345-.346c.11-.205.149-.407.149-1.069V9.564c0-.662-.039-.864-.149-1.07a.818.818 0 0 0-.346-.345C18.3 8.039 18.098 8 17.436 8H6.564z"})))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=n;var a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},{react:"react"}],384:[function(e,t,r){"use strict";function n(e){return i.default.createElement("svg",o({width:24,height:24},e),i.default.createElement("g",{fill:"none",fillRule:"evenodd"},i.default.createElement("rect",{width:2e3,height:1952,rx:8,transform:"translate(-520 -902)"}),i.default.createElement("path",{fill:"gray",d:"M12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zM8.556 3.685a.5.5 0 0 1 .653.27l.765 1.848a.5.5 0 1 1-.923.383l-.766-1.848a.5.5 0 0 1 .27-.653zm6.888 0a.5.5 0 0 1 .27.653l-.765 1.848a.5.5 0 0 1-.923-.383l.765-1.847a.5.5 0 0 1 .653-.27zm4.87 4.87a.5.5 0 0 1-.27.654l-1.847.765a.5.5 0 0 1-.383-.923l1.848-.766a.5.5 0 0 1 .653.27zm0 6.89a.5.5 0 0 1-.652.27l-1.848-.766a.5.5 0 0 1 .383-.923l1.847.765a.5.5 0 0 1 .27.653zm-4.87 4.87a.5.5 0 0 1-.653-.27l-.765-1.848a.5.5 0 0 1 .923-.383l.766 1.848a.5.5 0 0 1-.27.653zm-6.888 0a.5.5 0 0 1-.27-.653l.765-1.848a.5.5 0 0 1 .923.383l-.765 1.847a.5.5 0 0 1-.653.27zm-4.87-4.87a.5.5 0 0 1 .27-.654l1.847-.765a.5.5 0 0 1 .383.923l-1.848.766a.5.5 0 0 1-.653-.27zm0-6.89a.5.5 0 0 1 .652-.27l1.848.766a.5.5 0 0 1-.383.923L3.956 9.21a.5.5 0 0 1-.27-.653z"})))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=n;var a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},{react:"react"}],385:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./Suggestions"),o=function(e){return e&&e.__esModule?e:{default:e}}(n);r.default=o.default},{"./Suggestions":374}],386:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("classnames"),p=n(f),m=e("../../../models/DateExt"),h=n(m),v=e("@doist/reactist/lib/Tooltip"),y=n(v),g=e("./icons/Invalid"),b=n(g),w=e("../timezoneSelector"),E=n(w),k=e("../timezoneSelector/constants"),S=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(k),j=e("../utils"),T=window,O=T.DateUtils,I=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=r.props.selectedDate;if(n&&n.with_time){var i=new Date;i.setHours(n.getTimezoneHours(),n.getTimezoneMinutes(),n.getTimezoneSeconds()),r.state={selectedTime:i,timezone:n.timezone,timeInputValue:n.format({inTimezoneTime:!0,onlyTime:!0}),iisAddButtonDisabled:!1,isErrorShown:!1}}else r.state={selectedTime:null,timezone:null,timeInputValue:"",iisAddButtonDisabled:!0,isErrorShown:!1};return r.timeInputEl=u.default.createRef(),r.handleCancelKeyDown=(0,j.wrapKeyboardEnterPress)(r.handleCancelKeyDown.bind(r)),r.handleInputChange=r.handleInputChange.bind(r),r.handleKeyDown=r.handleKeyDown.bind(r),r.handleSubmit=(0,j.wrapKeyboardEnterPress)(r.handleSubmit.bind(r)),r.handleTimezoneSelect=r.handleTimezoneSelect.bind(r),r.showError=r.showError.bind(r),r}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;window.requestAnimationFrame(function(){return e.timeInputEl.current.focus()})}},{key:"handleCancelKeyDown",value:function(e){this.props.onCancel(e)}},{key:"handleInputChange",value:function(e){var t=e.target.value,r=this.props.selectedDate,n=O.parse(t.replace(" ","")),o=n.due_date,a=n.has_only_time;return""===t?(clearTimeout(this.errorTimeout),this.errorTimeout=null,this.setState({timeInputValue:t,selectedTime:null,isAddButtonDisabled:!(r&&r.with_time),isErrorShown:!1})):o&&a?(clearTimeout(this.errorTimeout),this.errorTimeout=null,void this.setState({timeInputValue:t,selectedTime:o,isAddButtonDisabled:!1,isErrorShown:!1})):(this.errorTimeout||(this.errorTimeout=setTimeout(this.showError,500)),this.setState({timeInputValue:t,isAddButtonDisabled:!0}))}},{key:"handleKeyDown",value:function(e){27===e.keyCode&&this.props.onCancel(e)}},{key:"handleSubmit",value:function(e){e.stopPropagation();var t=this.state,r=t.selectedTime,n=t.timezone;t.isAddButtonDisabled||this.props.onSelect(e,r,n)}},{key:"handleTimezoneSelect",value:function(e){var t=this.props,r=t.selectedDate,n=t.userTimezoneInfo,o=void 0;switch(e){case S.FIXED_DATE:o=n.timezone;break;case S.TASK_DATE:o=r.timezone;break;case S.FLOATING_DATE:default:o=null}this.setState({timezone:o})}},{key:"showError",value:function(){this.setState({isErrorShown:!0})}},{key:"render",value:function(){var e=this.props,t=e.selectedDate,r=e.userTimezoneInfo,n=e.timeFormat,o=this.state,a=o.timeInputValue,i=o.timezone,s=o.isAddButtonDisabled,l=o.isErrorShown,c=(0,p.default)("scheduler-timepicker-actions-add",{"scheduler-timepicker-actions-add--disabled":s}),d=t&&t.with_time;return u.default.createElement("div",{className:"scheduler-timepicker",onKeyDown:this.handleKeyDown},u.default.createElement("div",{className:"scheduler-timepicker-controls"},u.default.createElement("div",{className:"scheduler-timepicker-input"},u.default.createElement("div",{className:"scheduler-timepicker-input-label"},u.default.createElement("span",null,_("Time")),l&&u.default.createElement(y.default,{delayShow:0,text:u.default.createElement(u.default.Fragment,null,u.default.createElement("div",null,_("Invalid Time")),u.default.createElement("div",null,_("Use 13:00 or 1PM format"))),position:"bottom",tooltipClassName:"scheduler-timepicker-tooltip"},u.default.createElement(b.default,{className:"tip_item"}))),u.default.createElement("div",{className:"scheduler-timepicker-input-controls"},u.default.createElement("input",{ref:this.timeInputEl,placeholder:n?_("eg, 2pm"):_("eg, 14:00"),value:a,tabIndex:"1",onChange:this.handleInputChange,onKeyDown:this.handleSubmit}))),u.default.createElement(E.default,{timezone:i,userTimezoneInfo:r,tabIndex:"2",onSelect:this.handleTimezoneSelect})),u.default.createElement("div",{className:"scheduler-timepicker-actions"},u.default.createElement("span",{className:c,tabIndex:s?"":"3",onClick:this.handleSubmit,onKeyDown:this.handleSubmit},d?_x("scheduler_change_time_button","Change"):_x("scheduler_add_time_button","Add")),u.default.createElement("span",{onClick:this.props.onCancel,onKeyDown:this.handleCancelKeyDown,tabIndex:"4"},_("Cancel"))))}}]),t}(u.default.PureComponent);I.propTypes={selectedDate:d.default.instanceOf(h.default),userTimezoneInfo:d.default.object.isRequired,timeFormat:d.default.number,onCancel:d.default.func,onSelect:d.default.func},I.defaultProps={timeFormat:0,onCancel:function(){},onSelect:function(){}},r.default=I},{"../../../models/DateExt":164,"../timezoneSelector":393,"../timezoneSelector/constants":391,"../utils":394,"./icons/Invalid":387,"@doist/reactist/lib/Tooltip":189,classnames:"classnames","prop-types":"prop-types",react:"react"}],387:[function(e,t,r){"use strict";function n(){return a.default.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24"},a.default.createElement("g",{fill:"#979797",fillRule:"evenodd"},a.default.createElement("path",{d:"M12 9a1 1 0 0 1 1 1v4a1 1 0 0 1-2 0v-4a1 1 0 0 1 1-1zm0 7a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"}),a.default.createElement("path",{d:"M13.73 4.96L20.75 17A2 2 0 0 1 19.02 20H4.98a2 2 0 0 1-1.73-3l7.02-12.04a2 2 0 0 1 3.46 0zm-.7.55a1.2 1.2 0 0 0-2.07 0L4.15 17.2A1.2 1.2 0 0 0 5.18 19h13.64a1.2 1.2 0 0 0 1.03-1.8L13.04 5.5z"})))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var o=e("react"),a=function(e){return e&&e.__esModule?e:{default:e}}(o)},{react:"react"}],388:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./TimePicker"),o=function(e){return e&&e.__esModule?e:{default:e}}(n);r.default=o.default},{"./TimePicker":386}],389:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("../../Dialog"),p=n(f),m=e("./constants"),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(m),v=e("./icons/RightArrow"),y=n(v),g=e("../../tabbable/Tabbable"),b=n(g),w=e("./TimezoneSelectorItem"),E=n(w),k=e("../utils"),S=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.selectorLabel=u.default.createRef(),r.state={isItemListShown:!1},r.handleClick=(0,k.wrapKeyboardEnterPress)(r.handleClick.bind(r)),r.handleHide=r.handleHide.bind(r),r.handleItemClick=r.handleItemClick.bind(r),r}return i(t,e),s(t,[{key:"handleClick",value:function(){this.setState(function(e){return{isItemListShown:!e.isItemListShown}})}},{key:"handleHide",value:function(e){e.stopPropagation(),this.setState({isItemListShown:!1})}},{key:"handleItemClick",value:function(e){this.setState({isItemListShown:!1}),this.props.onSelect(e)}},{key:"render",value:function(){var e=this.state.isItemListShown,t=this.props,r=t.timezone,n=t.userTimezoneInfo,o=t.tabIndex,a=r||_("Time Zone");return u.default.createElement("div",{className:"scheduler-timezone"},u.default.createElement("div",{ref:this.selectorLabel,className:"scheduler-timezone-label",tabIndex:o,onClick:this.handleClick,onKeyDown:this.handleClick},u.default.createElement("span",null,a),u.default.createElement(y.default,null)),e&&u.default.createElement(p.default,{anchor:this.selectorLabel.current,anchorGap:2,className:"dialog-timezone",contentClassName:"scheduler-timezone-list",width:225,hasUnderlay:!0,onHide:this.handleHide},u.default.createElement(b.default,null,u.default.createElement(E.default,{value:h.FLOATING_DATE,tabIndex:"1",isSelected:null===r,onClick:this.handleItemClick},u.default.createElement("div",{className:"scheduler-timezone-item-header"},_("Floating Time")),u.default.createElement("div",{className:"scheduler-timezone-item-description"},_("Due time stays the same across time zones"))),u.default.createElement(E.default,{value:h.FIXED_DATE,tabIndex:"2",isSelected:r===n.timezone,onClick:this.handleItemClick},u.default.createElement("div",{className:"scheduler-timezone-item-header"},n.timezone),u.default.createElement("div",{className:"scheduler-timezone-item-description"},_("Your current time zone"))),r&&r!==n.timezone&&u.default.createElement(E.default,{value:h.TASK_DATE,tabIndex:"3",isSelected:r&&r!==n.timezone,onClick:this.handleItemClick},u.default.createElement("div",{className:"scheduler-timezone-item-header"},r),u.default.createElement("div",{className:"scheduler-timezone-item-description"},_("This task's current time zone"))),u.default.createElement("div",{className:"scheduler-timezone-help"},u.default.createElement("a",{href:"https://get.todoist.help/hc/articles/360001450039",target:"_blank",rel:"noopener noreferrer",tabIndex:"4"},_("Time Zones Help"))))))}}]),t}(u.default.PureComponent);S.propTypes={userTimezoneInfo:d.default.object.isRequired,tabIndex:d.default.string.isRequired,timezone:d.default.string,onSelect:d.default.func},S.defaultProps={onSelect:function(){}},r.default=S},{"../../Dialog":201,"../../tabbable/Tabbable":402,"../utils":394,"./TimezoneSelectorItem":390,"./constants":391,"./icons/RightArrow":392,"prop-types":"prop-types",react:"react"}],390:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("classnames"),p=n(f),m=e("../utils"),h=function(e){function t(e){o(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.handleClick=(0,m.wrapKeyboardEnterPress)(r.handleClick.bind(r)),r}return i(t,e),s(t,[{key:"handleClick",value:function(e){e.nativeEvent.stopImmediatePropagation(),this.props.onClick(this.props.value)}},{key:"render",value:function(){var e=this.props,t=e.isSelected,r=e.tabIndex,n=e.children,o=(0,p.default)("scheduler-timezone-item",{"scheduler-timepicker-item--selected":t});return u.default.createElement("div",{className:o,tabIndex:r,onClick:this.handleClick,onKeyDown:this.handleClick},n)}}]),t}(u.default.PureComponent);h.propTypes={value:d.default.string.isRequired,tabIndex:d.default.string.isRequired,isSelected:d.default.bool,onClick:d.default.func,children:d.default.node},h.defaultProps={onClick:function(){}},r.default=h},{"../utils":394,classnames:"classnames","prop-types":"prop-types",react:"react"}],391:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.FLOATING_DATE="floating",r.FIXED_DATE="fixed",r.TASK_DATE="task"},{}],392:[function(e,t,r){"use strict";function n(e){return i.default.createElement("svg",o({width:24,height:24},e),i.default.createElement("path",{d:"M14.243 12L9.646 7.404a.5.5 0 1 1 .708-.707l4.95 4.95a.5.5 0 0 1 0 .707l-4.95 4.95a.5.5 0 0 1-.708-.708L14.243 12z",fill:"currentColor",fillRule:"evenodd"}))}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=n;var a=e("react"),i=function(e){return e&&e.__esModule?e:{default:e}}(a)},{react:"react"}],393:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./TimezoneSelector"),o=function(e){return e&&e.__esModule?e:{default:e}}(n);r.default=o.default},{"./TimezoneSelector":389}],394:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.wrapKeyboardEnterPress=function(e){return function(t){t.keyCode&&13!==t.keyCode||e(t)}}},{}],395:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("react"),c=n(u),d=e("prop-types"),f=n(d),p=e("react-transition-group"),m=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.state={on:!0},n.handleKeyPress=function(e){"Escape"===e.key&&"BODY"===e.target.tagName&&n.state.on&&n.setState({on:!1})},n.handleClickOutside=function(){n.setState({on:!1})},n.handleTransitionExited=function(){n.props.onClosed()},i=r,a(n,i)}return i(t,e),l(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyPress)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyPress)}},{key:"render",value:function(){var e=this,t=this.props,r=t.transitionDuration,n=t.width,o={width:n,height:"100%",top:0,
right:"-"+n+"px",transition:"all "+r+"ms cubic-bezier(0.4, 0, 0.2, 1) 0ms"},a={entering:{right:"-"+n+"px"},entered:{right:"0px"}},i={in:this.state.on,appear:!0,timeout:r,onExited:this.handleTransitionExited};return c.default.createElement(p.Transition,i,function(t){var r=s({},o,a[t]);return c.default.createElement("div",{className:"side_panel"},c.default.createElement("div",{className:"side_panel_overlay",onClick:e.handleClickOutside}),c.default.createElement("div",{className:"side_panel_content",style:r},e.props.children))})}}]),t}(c.default.Component);m.propTypes={transitionDuration:f.default.number,width:f.default.number.isRequired,onClosed:f.default.func.isRequired},m.defaultProps={transitionDuration:225},r.default=m},{"prop-types":"prop-types",react:"react","react-transition-group":"react-transition-group"}],396:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=e.getBoundingClientRect();return{height:t.height,width:t.width,left:t.left,top:t.top}}function l(e){var t=(0,g.createSortableItemClass)(e),r=(0,b.createSortableDragLayerClass)(e),n=function(e){function n(e){o(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.deriveRectTo=function(){var e=t.rectFrom[t.state.itemsFrom[0].id].top;return(0,f.keyBy)("id",t.state.itemsTo.map(function(r){var n=t.rectFrom[r.id],o={id:r.id,height:n.height,width:n.width,top:e,left:n.left};return e+=n.height,o}))},t.dragBegin=function(e){t.rectFrom=(0,f.mapValues)(function(e){return s(e.current)},t.itemRefs),t.setState({isDragging:!0}),t.props.onDragStart&&t.props.onDragStart(e)},t.dragIng=function(){},t.dragEnd=function(){t.props.onDragEnd&&t.props.onDragEnd(),t.props.onChange&&t.props.onChange(t.state.itemsTo),t.setState({isDragging:!1})},t.itemDrop=function(){return{dropInSortable:!0}},t.itemHover=function(e,r,n){var o=t.deriveRectTo(),a=e.y,i=t.state.itemsTo.findIndex(function(e){return e.id===r.id}),s=t.state.itemsFrom.findIndex(function(e){return e.id===r.id}),l=t.state.itemsFrom[s],u=o[l.id],c=t.state.itemsTo.findIndex(function(e,t){var r=o[e.id];if(i===t)return!1;if(r.height>u.height){if(t<i){var n=r.height-u.height;return a>r.top&&a<r.top+r.height-n}if(t>i){var s=r.height-u.height;return a>r.top+s&&a<r.top+r.height}}return a>r.top&&a<r.top+r.height});if(-1===i&&-1!==c)return void t.addItem(r,c,n);i!=c&&-1!=i&&-1!=c&&t.moveItem(i,c)},t.styleCache={},t.createTransformStyle=function(e){var r=e.x,n=e.y,o="translate("+r+"px, "+n+"px)";if(t.styleCache[o])return t.styleCache[o];var a={transform:o};return t.styleCache[o]=a,a},t.scheduleStateUpdate=function(e){t.pendingUpdateFn=e,t.frameRequest||(t.frameRequest=requestAnimationFrame(t.drawFrame))},t.drawFrame=function(){var e=u({},t.state,t.pendingUpdateFn);t.setState(e),t.pendingUpdateFn=null,t.frameRequest=null},t.state={isDragging:!1},t}return i(n,e),c(n,[{key:"shouldComponentUpdate",value:function(){return!0}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.frameRequest)}},{key:"moveItem",value:function(e,t){var r=(0,d.move)(e,t,this.state.itemsTo);this.scheduleStateUpdate({itemsTo:r})}},{key:"deriveTransforms",value:function(){var e=this;if(!this.rectFrom)return null;var t=this.rectFrom[this.state.itemsFrom[0].id].top,r=(0,h.compose)((0,f.keyBy)("id"),(0,f.map)(function(r){var n=t;return t+=e.rectFrom[r.id].height,{id:r.id,top:n}}))(this.state.itemsTo);return this.state.itemsFrom.map(function(t){var n=e.rectFrom[t.id].top;return{x:0,y:r[t.id].top-n}})}},{key:"render",value:function(){var e=this;this.itemRefs&&this.itemRefsFingerprint===this.state.itemsFrom||(this.itemRefs=this.state.itemsFrom.reduce(function(e,t){return e[t.id]=m.default.createRef(),e},{}),this.itemRefsFingerprint=this.state.itemsFrom,this.rectFrom=null);var n=this.props,o=n.connectDropTarget,a=n.deriveItemProps,i=this.deriveTransforms(),s=this.state.itemsFrom.map(function(r,n){var o=i?e.createTransformStyle(i[n]):E,s=a?a(r):{},l=e.itemRefs[r.id],c=u({render:e.props.renderListItem,id:r.id,item:r,style:o,dragBegin:e.dragBegin,dragIng:e.dragIng,dragEnd:e.dragEnd,forwardedRef:l},s);return m.default.createElement(t,u({key:r.id},c))});return o(m.default.createElement("div",null,s,m.default.createElement(r,{render:this.props.renderDragLayer})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(t.itemsFrom!==e.items&&!t.isDragging){return u({},t,{itemsFrom:e.items,itemsTo:e.items})}return t}}]),n}(m.default.Component);return n.propTypes={items:y.default.arrayOf(y.default.shape({id:y.default.any})),render:y.default.func,renderDragLayer:y.default.func,onDragStart:y.default.func,onDragEnd:y.default.func,onChange:y.default.func,additionalProps:y.default.string,connectDropTarget:y.default.func,isOver:y.default.bool,dropResult:y.default.object},(0,d.flow)((0,_.DropTarget)(e,w,function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),dropResult:t.getDropResult()}},{arePropsEqual:function(e,t){return(0,d.shallowEqual)(e,t)}}))(n)}Object.defineProperty(r,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r.createSortableClass=l;var d=e("../../utils"),f=e("../../utils/fp"),p=e("react"),m=n(p),h=e("redux"),_=e("react-dnd"),v=e("prop-types"),y=n(v),g=e("./SortableItem"),b=e("./SortableDragLayer"),w={hover:function(e,t,r){var n=t.getItem();r.itemHover(t.getClientOffset(),n.item,n.rect)},drop:function(e,t,r){return r.itemDrop()}},E={}},{"../../utils":484,"../../utils/fp":477,"./SortableDragLayer":397,"./SortableItem":398,"prop-types":"prop-types",react:"react","react-dnd":"react-dnd",redux:"redux"}],397:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t=e.initialOffset,r=e.currentOffset;if(!t||!r)return{};var n={x:r.x,y:r.y},o=n.x,a=n.y,i="translate("+o+"px, "+a+"px)";return{transform:i,WebkitTransform:i,width:e.dragItem.componentWidth}}function l(e){var t=function(t){function r(){return o(this,r),a(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return i(r,t),u(r,[{key:"shouldComponentUpdate",value:function(){var e=this;return!this.frameRequest&&(this.frameRequest=requestAnimationFrame(function(){e.forceUpdate(),e.frameRequest=null}),!1)}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.frameRequest)}},{key:"render",value:function(){if(!this.props.isDragging||this.props.itemType!==e)return null;var t=(0,m.default)(["list_item_draglayer"]);return f.default.createElement("div",{style:v},f.default.createElement("div",{className:t,style:s(this.props)},this.props.render(this.props.dragItem.item)))}}]),r}(f.default.Component);return t.propTypes={render:_.default.func,initialOffset:_.default.shape({x:_.default.number.isRequired,y:_.default.number.isRequired}),currentOffset:_.default.shape({x:_.default.number.isRequired,y:_.default.number.isRequired}),isDragging:_.default.bool.isRequired,itemType:_.default.string,dragItem:_.default.object},(0,c.DragLayer)(y)(t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r.createSortableDragLayerClass=l;var c=e("react-dnd"),d=e("react"),f=n(d),p=e("classnames"),m=n(p),h=e("prop-types"),_=n(h),v={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"},y=function(e){return{dragItem:e.getItem(),itemType:e.getItemType(),initialOffset:e.getInitialSourceClientOffset(),currentOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}}},{classnames:"classnames","prop-types":"prop-types",react:"react","react-dnd":"react-dnd"}],398:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){var t=function(e){function t(e){return a(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return s(t,e),u(t,[{key:"render",value:function(){var e=this.props,t=e.item,r=e.render,n=e.connectDragSource,a=e.isDragging,i=e.style,s=e.forwardedRef;e.dragBegin,e.dragEnd,e.dragIng;return r(t,o(e,["item","render","connectDragSource","isDragging","style","forwardedRef","dragBegin","dragEnd","dragIng"]),n,a,i,s)}}]),t}(f.default.PureComponent);return t.propTypes={forwardedRef:h.default.object,render:h.default.func,item:h.default.object,style:h.default.object,id:h.default.oneOfType([h.default.number,h.default.string]).isRequired,dragBegin:h.default.func,dragEng:h.default.func,connectDragSource:h.default.func,isDragging:h.default.bool},(0,c.flow)((0,_.DragSource)(e,g,function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}},{arePropsEqual:function(e,t){return(0,y.default)(e,t)}}))(t)}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r.createSortableItemClass=l;var c=e("../../utils"),d=e("react"),f=n(d),p=e("react-dom"),m=e("prop-types"),h=n(m),_=e("react-dnd"),v=e("../../utils/shallowEqual"),y=n(v),g=function(e){return(0,c.mapValues)(e,function(e){return function(){try{return e.apply(void 0,arguments)}catch(e){console.log(e)}}})}({beginDrag:function(e,t,r){var n=(0,p.findDOMNode)(r),o=n.getBoundingClientRect();return e.dragBegin(e.item),{id:e.id,item:e.item,rect:o,componentWidth:o.width}},isDragging:function(e,t){return e.id==t.getItem().id&&!t.didDrop()&&(e.dragIng(e.item),!0)},endDrag:function(e,t){e.dragEnd(t.getDropResult())}})},{"../../utils":484,"../../utils/shallowEqual":503,"prop-types":"prop-types",react:"react","react-dnd":"react-dnd","react-dom":"react-dom"}],399:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.size,r=void 0===t?"small":t;return i.default.createElement("div",{className:"spinner spinner--"+r},i.default.createElement("div",{className:"bounce1"}),i.default.createElement("div",{className:"bounce2"}),i.default.createElement("div",{className:"bounce3"}))}Object.defineProperty(r,"__esModule",{value:!0});var a=e("react"),i=n(a),s=e("prop-types"),l=n(s);o.propTypes={size:l.default.oneOf(["small"])},r.default=o},{"prop-types":"prop-types",react:"react"}],400:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("react"),s=n(i),l=e("prop-types"),u=n(l),c=e("../../constants/themes"),d=e("../../utils"),f=function(e){var t=e.theme,r=o(e,["theme"]),n=(0,c.colorInHex)(t);t!==c.THEME_NEUTRAL&&t!=c.THEME_NOIR||(n="#848484");var i=(0,d.hexToRGB)(n,.2);return s.default.createElement("svg",a({className:"ring_spinner",width:"24",height:"24",viewBox:"0 0 24 24"},r),s.default.createElement("g",{fill:"none",fillRule:"nonzero"},s.default.createElement("path",{fill:n,d:"M17.945 3.958A9.955 9.955 0 0 0 12 2c-2.19 0-4.217.705-5.865 1.9L5.131 2.16A11.945 11.945 0 0 1 12 0c2.59 0 4.99.82 6.95 2.217l-1.005 1.741z"}),s.default.createElement("path",{fill:i,d:"M5.13 2.16L6.136 3.9A9.987 9.987 0 0 0 2 12c0 5.523 4.477 10 10 10s10-4.477 10-10a9.986 9.986 0 0 0-4.055-8.042l1.006-1.741A11.985 11.985 0 0 1 24 12c0 6.627-5.373 12-12 12S0 18.627 0 12c0-4.073 2.029-7.671 5.13-9.84z"})))};f.propTypes={theme:u.default.number},f.defaultProps={theme:c.THEME_NEUTRAL},r.default=f},{"../../constants/themes":99,"../../utils":484,"prop-types":"prop-types",react:"react"}],401:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./RingSpinner");Object.defineProperty(r,"RingSpinner",{enumerable:!0,get:function(){return n(o).default}});var a=e("./DotsSpinner");Object.defineProperty(r,"DotsSpinner",{enumerable:!0,get:function(){return n(a).default}})},{"./DotsSpinner":399,"./RingSpinner":400}],402:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("react"),u=n(l),c=e("prop-types"),d=n(c),f=e("./TabbableManager"),p=n(f),m=function(e){function t(){var e,r,n,i;o(this,t);for(var s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];return r=n=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),n.tabbable=u.default.createRef(),i=r,a(n,i)}return i(t,e),s(t,[{key:"componentDidMount",value:function(){document.activeElement.blur(),p.default.add(this.tabbable.current)}},{key:"componentWillUnmount",value:function(){p.default.remove(this.tabbable.current)}},{key:"render",value:function(){return u.default.createElement("div",{ref:this.tabbable,className:"tabbable"},this.props.children)}}]),t}(u.default.Component);m.propTypes={children:d.default.node},r.default=m},{"./TabbableManager":403,"prop-types":"prop-types",react:"react"}],403:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("./utils"),i=e("../../utils/"),s=function(){function e(){return n(this,e),this.handleKeyDown=this.handleKeyDown.bind(this),this.getNextElement=this.getNextElement.bind(this),e.instance||(this.tabbables=[],e.instance=this),e.instance}return o(e,[{key:"add",value:function(e){0===this.tabbables.length&&window.addEventListener("keydown",this.handleKeyDown),this.tabbables.push({tabbable:e,currentTabIndex:null})}},{key:"handleKeyDown",value:function(e){var t=this.tabbables[this.tabbables.length-1],r=t.tabbable;if(9===e.keyCode&&r&&(e.target===document.body||(0,a.isDescendant)(r,e.target))){e.preventDefault(),document.activeElement&&(0,a.isDescendant)(r,document.activeElement)&&document.activeElement.tabIndex>-1?t.currentTabIndex=document.activeElement.tabIndex:e.target===document.body&&(t.currentTabIndex=0);var n=this.getNextElement(t,e.target);n&&n.focus()}}},{key:"getNextElement",value:function(e,t){var r=void 0,n=e.tabbable.querySelectorAll('[tabindex="'+(e.currentTabIndex||"1")+'"]:not([tabindex="-1"])');if(n.length)if(1===n.length)n=e.tabbable.querySelectorAll('[tabindex="'+ ++e.currentTabIndex+'"]:not([tabindex="-1"])'),r=n[0];else{for(var o=0;o<n.length;o++)if(n[o]===t){r=n[o+1];break}r||(n=e.tabbable.querySelectorAll('[tabindex="'+ ++e.currentTabIndex+'"]:not([tabindex="-1"])'),r=n[0])}else{if(n=e.tabbable.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex=""]'),!n.length)return;n=(0,i.sortBy)(n,function(e){return e.tabIndex});for(var a=0;a<n.length;a++)if(n[a].tabIndex>e.currentTabIndex){r=n[a];break}r||(r=n[0]),e.currentTabIndex=r.tabIndex}return r||this.getNextElement(e,document.body)}},{key:"remove",value:function(e){this.tabbables=this.tabbables.filter(function(t){return t.tabbable!==e}),0===this.tabbables.length&&window.removeEventListener("keydown",this.handleKeyDown)}}]),e}(),l=new s;r.default=l},{"../../utils/":484,"./utils":404}],404:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.isDescendant=function(e,t){for(var r=t.parentNode;null!=r;){if(r==e)return!0;r=r.parentNode}return!1}},{}],405:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.vocationMode,r=e.completed,n=e.goal,o=e.counter,a=e.theme,s=e.onClick,c=(0,i.isUndefined)(n)||(0,i.isUndefined)(r);c&&(r=0,n=1);var f=Math.min(r/n,1),_=(0,u.topIconColor)(a),v=(0,u.colorInHex)(a),y=void 0;return y=t?l.default.createElement(d.default,{className:"icon_vocation",color:_}):0===f?l.default.createElement(m,{color:_,bgColor:v}):f<1?l.default.createElement(p,{progress:f,color:_}):l.default.createElement(h,{color:_,bgColor:v}),l.default.createElement("span",{id:"top_completed_holder"},l.default.createElement("a",{href:"#completed",className:"fixed_pos"},l.default.createElement("span",{id:"top_completed",className:"completed_pie_stat","data-track":"navigation|karma",onClick:s},y,c?null:l.default.createElement("span",{className:"count"},o||null))))}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r.default=o;var i=e("../../utils"),s=e("react"),l=n(s),u=e("../../constants/themes"),c=e("../icons/VocationModeIcon"),d=n(c),f=function(e){return[Math.cos(2*Math.PI*e),Math.sin(2*Math.PI*e)]},p=function(e){var t=e.progress,r=e.color,n=f(0),o=a(n,2),i=o[0],s=o[1],u=f(t),c=a(u,2),d=c[0],p=c[1],m=t>.5?1:0,h=["M "+i+" "+s,"A 1 1 0 "+m+" 1 "+d+" "+p,"L 0 0"].join(" "),_={transform:"rotate(-90deg)",width:"24px",height:"24px"};return l.default.createElement("svg",{viewBox:"-2 -2 4 4",style:_},l.default.createElement("circle",{cx:"0",cy:"0",r:"1.4",fill:"none",visibility:"visible",stroke:r,strokeWidth:"0.2"}),l.default.createElement("path",{fill:r,d:h}))},m=l.default.memo(function(e){var t=e.color;return l.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},l.default.createElement("defs",null),l.default.createElement("g",{fill:"none",fillRule:"evenodd",transform:"translate(3 3)"},l.default.createElement("mask",{id:"4ZtaWA",fill:"#fff"},l.default.createElement("path",{id:"a",d:"M12.3 5L7 10.3 5.4 8.6a.5.5 0 0 0-.8 0l-3.9 4a9 9 0 1 1 .5.9L5 9.7l1.6 1.7a.5.5 0 0 0 .8 0L13 5.7v3.8a.5.5 0 1 0 1 0v-5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.8z"})),l.default.createElement("g",{mask:"url(#4ZtaWA)"},l.default.createElement("path",{fill:t,d:"M-3-3h24v24H-3z"}))))}),h=l.default.memo(function(e){var t=e.color;return l.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},l.default.createElement("g",{fill:"none",fillRule:"evenodd",transform:"translate(3 3)"},l.default.createElement("mask",{id:"y8QpGa",fill:"#fff"},l.default.createElement("path",{id:"a",d:"M9 18A9 9 0 1 1 9 0a9 9 0 0 1 0 18zm4.9-12.9l-6.7 6.7-3.1-3.2a.5.5 0 1 0-.7.8l3.5 3.5a.5.5 0 0 0 .7 0l7-7a.5.5 0 0 0-.7-.8z"})),l.default.createElement("g",{mask:"url(#y8QpGa)"},l.default.createElement("path",{fill:t,d:"M-3-3h24v24H-3z"}))))})},{"../../constants/themes":99,"../../utils":484,"../icons/VocationModeIcon":298,react:"react"}],406:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.tick=r.CLOCK_TICK=void 0;var n=e("../utils"),o=r.CLOCK_TICK="CLOCK_TICK",a=(r.tick=function(){return{type:o}},function(e,t){if(!e)return(0,n.todayISO)();if(t.type===o){var r=(0,n.todayISO)();return e===r?e:r}return e});r.default=a},{"../utils":484}],407:[function(e,t,r){"use strict";function n(e){var t=(0,l.createSelector)((0,a.get)("collaborators.all"),(0,a.get)("user"),function(t,r){var n=o({},t);return r&&(n[r.id]=r),e.indexOf("@")>0?(0,i.compose)((0,a.pickBy)(function(t){return t.email===e}))(n):(0,i.compose)((0,a.pickBy)(function(t){return(0,u.partialMatchName)(e,t.full_name)}))(n)});return 1===arguments.length?t:t(arguments[1])}Object.defineProperty(r,"__esModule",{value:!0}),r.isShared=r.isSharedProject=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.searchCollaborators=n;var a=e("../utils/fp"),i=e("redux"),s=e("../reducers/modelbridge"),l=e("reselect"),u=e("../utils"),c=e("../reducers/sync"),d={all:{},byPID:{},invitedByPID:{}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments[1];switch(t.type){case c.SYNC_UPDATE:var r=t.payload.projects;if(!r||0===r.length)return e;var n=e.byPID,i=e.invitedByPID,l=r.filter(function(e){return!e.shared||e.is_archived||e.is_deleted}).map(function(e){return e.id});if(0===l.length)return e;var u=!0,f=!1,p=void 0;try{for(var m,h=l[Symbol.iterator]();!(u=(m=h.next()).done);u=!0){var _=m.value;n[_]&&(n=(0,a.omit)(_)(n)),i[_]&&(i=(0,a.omit)(_)(i))}}catch(e){f=!0,p=e}finally{try{!u&&h.return&&h.return()}finally{if(f)throw p}}return o({},e,{byPID:n,invitedByPID:i});case s.MODEL_BRIDGE_UPDATE:var v=t.payload.collaborators;return v?{all:o({},v.all),byPID:o({},v.byPID),invitedByPID:o({},v.invitedByPID)}:e;default:return e}};r.default=f;var p=r.isSharedProject=(0,l.createSelector)((0,a.get)("collaborators.byPID"),function(e){return e?function(t){return!!e[t]}:function(){return!1}});r.isShared=function(e,t){return p(e)(t)}},{"../reducers/modelbridge":427,"../reducers/sync":447,"../utils":484,"../utils/fp":477,redux:"redux",reselect:"reselect"}],408:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.countOverdue=r.countSevenDays=r.countToday=r.countByFilter=r.partialStateForFilter=r.countByLabel=r.countByProject=void 0;var n=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=e("../utils/fp"),a=e("redux"),i=e("../filterist"),s=e("reselect"),l=e("../utils"),u=e("./selectors"),c=e("./items/selectors"),d=(0,o.mapValues)(function(){return 0}),f=(r.countByProject=(0,l.memoizeReturn)((0,s.createSelector)(c.getUncompletedExcludeSection,function(e){return e.projects},function(e,t){if(!e||!t)return{};var r=d(t),n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value,u=l.project_id;r[u]||(r[u]=0),r[u]++}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r})),r.countByLabel=(0,l.memoizeReturn)((0,s.createSelector)(c.getUncompletedExcludeSection,function(e){return e.labels},function(e,t){if(!e||!t)return{};var r=d(t),n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value;if(l.labels){var u=!0,c=!1,f=void 0;try{for(var p,m=l.labels[Symbol.iterator]();!(u=(p=m.next()).done);u=!0){var h=p.value;r[h]||(r[h]=0),r[h]++}}catch(e){c=!0,f=e}finally{try{!u&&m.return&&m.return()}finally{if(c)throw f}}}}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r})),r.partialStateForFilter=(0,s.createSelector)(c.getUncompletedExcludeSection,function(e){return e.user},function(e){return e.projects},function(e){return e.labels},function(e){return e.collaborators},u.dataLoaded,function(e){return e.clock},function(e,t,r,n,o,a){var i=t||{},s=i.date_format,l=i.time_format;return{uncompleted:e,user:t,projects:r,labels:n,collaborators:o,dataLoaded:a,filteristOpts:{lang:window.LANG,isUSDate:s,isAMPM:l}}})),p=(r.countByFilter=(0,l.memoizeReturn)((0,s.createSelector)(f,function(e){return e.filters},function(e,t){var r=e.uncompleted,s=e.dataLoaded,l=e.filteristOpts;if(!s)return{};var u=d(t),c=(0,a.compose)((0,o.map)(function(e){var t=n(e,2),r=t[0],o=t[1];return[r,o,(0,i.createFilterFunc)(o.query,l)]}),(0,o.filter)(function(e){var t=n(e,2);t[0];return t[1].is_favorite}),o.toPairs)(t),f=!0,p=!1,m=void 0;try{for(var h,_=r[Symbol.iterator]();!(f=(h=_.next()).done);f=!0){var v=h.value,y=!0,g=!1,b=void 0;try{for(var w,E=c[Symbol.iterator]();!(y=(w=E.next()).done);y=!0){var k=n(w.value,3),S=k[0];k[1];(0,k[2])(v,e)&&u[S]++}}catch(e){g=!0,b=e}finally{try{!y&&E.return&&E.return()}finally{if(g)throw b}}}}catch(e){p=!0,m=e}finally{try{!f&&_.return&&_.return()}finally{if(p)throw m}}return u})),function(e){return(0,s.createSelector)(f,function(t){var r=t.dataLoaded,n=t.uncompleted,o=t.filteristOpts;if(!r)return 0;var a=(0,i.createFilterFunc)(e,o);return n.filter(function(e){return a(e,t)}).length})});r.countToday=p("today & !assigned to: other"),r.countSevenDays=p("7 days & !assigned to: other"),r.countOverdue=p("overdue & !assigned to: other")},{"../filterist":133,"../utils":484,"../utils/fp":477,"./items/selectors":419,"./selectors":444,redux:"redux",reselect:"reselect"}],409:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("../reducers/load"),a=e("../reducers/sync"),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case o.LOAD_LOCAL_DATA:var r=t.payload.items;if(!r)return e;var i={};for(var s in r)if(r.hasOwnProperty(s)){var l=r[s].due;l&&(i[l.lang]=1)}return i;case a.SYNC_FULL_UPDATE:case a.SYNC_UPDATE:var u=t.payload.items;if(!u)return e;var c=n({},e),d=!1;return u.forEach(function(e){var t=e.due;t&&!c[t.lang]&&(d=1,c[t.lang]=1)}),d?c:e;default:return e}};r.default=i},{"../reducers/load":425,"../reducers/sync":447}],410:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.detailViewClose=r.detailViewShowProject=r.detailViewShowItem=void 0;var n=e("../models/TemporaryIds"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case"DETAIL_VIEW_SHOW_ITEM":case"DETAIL_VIEW_SHOW_PROJECT":return t.payload;case"DETAIL_VIEW_CLOSE":return null;default:return e}};r.default=a;r.detailViewShowItem=function(e){return e=o.default.getRealId(e),{type:"DETAIL_VIEW_SHOW_ITEM",payload:{type:"item",id:e}}},r.detailViewShowProject=function(e){return e=o.default.getRealId(e),{type:"DETAIL_VIEW_SHOW_PROJECT",payload:{type:"project",id:e}}},r.detailViewClose=function(){return{type:"DETAIL_VIEW_CLOSE"}}},{"../models/TemporaryIds":184}],411:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.filterRemove=r.filterUpdateOrders=r.filterUpdate=r.filterAdd=r.FILTER_REMOVE=r.FILTER_UPDATE=r.FILTER_ADD=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("../../utils"),s=e("../../models/SyncEngine"),l=n(s),u=e("../../models/TemporaryIds"),c=n(u),d=r.FILTER_ADD="FILTER_ADD",f=r.FILTER_UPDATE="FILTER_UPDATE",p=r.FILTER_REMOVE="FILTER_REMOVE",m=function(e){return e.replace(/[<>"=#+]+/g,"_")};r.filterAdd=function(e,t,r){return function(n,a){var s=c.default.generate("filter"),u=Math.max.apply(Math,o((0,i.values)(a().filters).map(function(e){return e.item_order}))),f={id:s,name:m(e).trim(),item_order:u+1,query:t,color:r};return l.default.queueUpdate({type:"filter_add",temp_id:s,args:f}),n({type:d,payload:f}),f}},r.filterUpdate=function(e,t){return function(r,n){e=c.default.getRealId(e);var o=n().filters[e];if(o)return o=a({},o,t),o.name=m(o.name).trim(),l.default.queueUpdate({type:"filter_update",args:o}),r({type:f,payload:o}),o}},r.filterUpdateOrders=function(e){return function(t){var r=e.reduce(function(e,t){return e[t.id]=t.item_order,e},{});l.default.queueUpdate({type:"filter_update_orders",args:{id_order_mapping:JSON.stringify(r)}}),t({type:f,payload:e})}},r.filterRemove=function(e){return function(t,r){e=c.default.getRealId(e);var n=r().filters[e];n&&(l.default.queueUpdate({type:"filter_delete",args:{id:n.id}}),t({type:p,payload:n.id}))}}},{"../../models/SyncEngine":181,"../../models/TemporaryIds":184,"../../utils":484}],412:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.filterGetByName=r.filterGetAll=r.filterGetByID=r.filterGetFavorite=r.filterRemove=r.filterUpdateOrders=r.filterUpdate=r.filterAdd=r.FILTER_REMOVE=r.FILTER_UPDATE=r.FILTER_ADD=void 0;var n=e("./actions");Object.defineProperty(r,"FILTER_ADD",{enumerable:!0,get:function(){return n.FILTER_ADD}}),Object.defineProperty(r,"FILTER_UPDATE",{enumerable:!0,get:function(){return n.FILTER_UPDATE}}),Object.defineProperty(r,"FILTER_REMOVE",{enumerable:!0,get:function(){return n.FILTER_REMOVE}}),Object.defineProperty(r,"filterAdd",{enumerable:!0,get:function(){
return n.filterAdd}}),Object.defineProperty(r,"filterUpdate",{enumerable:!0,get:function(){return n.filterUpdate}}),Object.defineProperty(r,"filterUpdateOrders",{enumerable:!0,get:function(){return n.filterUpdateOrders}}),Object.defineProperty(r,"filterRemove",{enumerable:!0,get:function(){return n.filterRemove}});var o=e("./selectors");Object.defineProperty(r,"filterGetFavorite",{enumerable:!0,get:function(){return o.filterGetFavorite}}),Object.defineProperty(r,"filterGetByID",{enumerable:!0,get:function(){return o.filterGetByID}}),Object.defineProperty(r,"filterGetAll",{enumerable:!0,get:function(){return o.filterGetAll}}),Object.defineProperty(r,"filterGetByName",{enumerable:!0,get:function(){return o.filterGetByName}});var a=e("./reducers"),i=function(e){return e&&e.__esModule?e:{default:e}}(a);r.default=i.default},{"./actions":411,"./reducers":413,"./selectors":414}],413:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("../../utils"),a=e("../load"),i=e("../sync"),s=e("../utils"),l=e("./actions"),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case a.LOAD_LOCAL_DATA:return t.payload.filters?t.payload.filters:e;case i.SYNC_UPDATE:var r=t.payload,u=r.filters,c=r.temp_id_mapping;return c&&(e=(0,s.resolveTempID)(e,c)),u&&(e=(0,s.mergeSyncUpdate)(e,u)),e;case i.SYNC_FULL_UPDATE:return(0,o.keyBy)(t.payload.filters,"id");case l.FILTER_ADD:var d=Object.assign({},e),f=t.payload;return d[f.id]=f,d;case l.FILTER_UPDATE:var p=$isArray(t.payload)?t.payload:[t.payload];p=p.filter(function(t){return!!e[t.id]}).map(function(t){return n({},e[t.id],t)});var m=(0,o.keyBy)(p,"id");return n({},e,m);case l.FILTER_REMOVE:var h=t.payload,_=Object.assign({},e);return delete _[h],_;default:return e}};r.default=u},{"../../utils":484,"../load":425,"../sync":447,"../utils":452,"./actions":411}],414:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.filterGetByName=r.filterGetAll=r.filterGetByID=r.filterGetFavorite=void 0;var o=e("../../utils"),a=e("../../utils/fp"),i=e("reselect"),s=e("../../models/TemporaryIds"),l=n(s),u=e("redux"),c=e("../../utils/partialMatchIndex"),d=n(c);r.filterGetFavorite=(0,i.createSelector)(function(e){return e.filters},(0,u.compose)((0,a.sortBy)(["item_order"]),(0,a.filter)(function(e){return e.is_favorite}),o.values)),r.filterGetByID=function(e,t){return t=l.default.getRealId(t),e.filters[t]},r.filterGetAll=(0,i.createSelector)(function(e){return e.filters},(0,u.compose)((0,a.sortBy)("item_order"),o.values,function(e){return e||{}})),r.filterGetByName=function(e,t){return(0,u.compose)((0,a.map)(function(e){return e.x}),(0,a.sortBy)(["i","x.item_order","x.id"]),(0,a.filter)(function(e){return-1!==e.i}),(0,a.map)(function(e){return{i:(0,d.default)(t,e.name),x:e}}),o.values)(e.filters)}},{"../../models/TemporaryIds":184,"../../utils":484,"../../utils/fp":477,"../../utils/partialMatchIndex":499,redux:"redux",reselect:"reselect"}],415:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../../logger/Logger"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),a=function(e,t){return function(r,n){try{return e(r,n)}catch(e){return o.captureError(e,t),r}}};r.default=a},{"../../logger/Logger":141}],416:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.itemUpdateDayOrder=r.itemDuplicate=r.itemSortProjectItems=r.itemUpdateDayOrderUndo=r.itemUpdateDueUndo=r.itemUpdateDue=r.itemMoveAndReorderUndo=r.itemMoveAndReorder=r.itemMoveMultiple=r.itemUnarchive=r.itemUncomplete=r.itemArchiveUndo=r.itemArchive=r.itemCompleteRecurringUndo=r.itemCompleteUndo=r.completeNonRecurring=r.itemComplete=r.itemUpdate=r.itemDelete=r.itemAdd=r.ITEM_UPDATE_DUE_UNDO=r.ITEM_UPDATE_DUE=r.ITEM_UPDATE_DAY_ORDER_UNDO=r.ITEM_UPDATE_DAY_ORDER=r.ITEM_UPDATE=r.ITEM_UNCOMPLETE=r.ITEM_UNARCHIVE=r.ITEM_MOVE_MULTIPLE_UNDO=r.ITEM_MOVE_MULTIPLE=r.ITEM_MOVE_AND_REORDER_UNDO=r.ITEM_MOVE_AND_REORDER=r.ITEM_DUPLICATE=r.ITEM_DELETE=r.ITEM_COMPLETE_UNDO=r.ITEM_COMPLETE_RECURRING_UNDO=r.ITEM_COMPLETE_RECURRING=r.ITEM_COMPLETE=r.ITEM_ARCHIVE_UNDO=r.ITEM_ARCHIVE=r.ITEM_ADD=void 0;var i=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l=e("../../utils"),u=e("../../utils/fp"),c=e("redux"),d=e("../../models/SyncEngine"),f=n(d),p=e("../../models/TemporaryIds"),m=n(p),h=e("../../models/DateExt"),_=n(h),v=e("./selectors"),y=e("../collaborators"),g=e("../utils"),b=e("../counts"),w=e("../user"),E=e("../../models/Reminders.js"),k=e("../../utils/deps"),S=e("../notes/notesConstants"),j=e("./utils"),T=(0,k.defineDeps)("reducers/items/actions",["notesActions"]),O=r.ITEM_ADD="ITEM_ADD",I=r.ITEM_ARCHIVE="ITEM_ARCHIVE",P=r.ITEM_ARCHIVE_UNDO="ITEM_ARCHIVE_UNDO",C=r.ITEM_COMPLETE="ITEM_COMPLETE",D=r.ITEM_COMPLETE_RECURRING="ITEM_COMPLETE_RECURRING",A=r.ITEM_COMPLETE_RECURRING_UNDO="ITEM_COMPLETE_RECURRING_UNDO",M=r.ITEM_COMPLETE_UNDO="ITEM_COMPLETE_UNDO",x=r.ITEM_DELETE="ITEM_DELETE",R=r.ITEM_DUPLICATE="ITEM_DUPLICATE",N=r.ITEM_MOVE_AND_REORDER="ITEM_MOVE_AND_REORDER",$=r.ITEM_MOVE_AND_REORDER_UNDO="ITEM_MOVE_AND_REORDER_UNDO",L=r.ITEM_MOVE_MULTIPLE="ITEM_MOVE_MULTIPLE",U=(r.ITEM_MOVE_MULTIPLE_UNDO="ITEM_MOVE_MULTIPLE_UNDO",r.ITEM_UNARCHIVE="ITEM_UNARCHIVE"),V=r.ITEM_UNCOMPLETE="ITEM_UNCOMPLETE",F=r.ITEM_UPDATE="ITEM_UPDATE",B=r.ITEM_UPDATE_DAY_ORDER="ITEM_UPDATE_DAY_ORDER",H=r.ITEM_UPDATE_DAY_ORDER_UNDO="ITEM_UPDATE_DAY_ORDER_UNDO",G=r.ITEM_UPDATE_DUE="ITEM_UPDATE_DUE",z=r.ITEM_UPDATE_DUE_UNDO="ITEM_UPDATE_DUE_UNDO";_n("For performance reasons a task can only have one character.","For performance reasons a task can only have {n} characters.",1);var q=function(e,t){return(0,l.isEqual)((0,u.pick)((0,l.keys)(e),t),e)},W=(r.itemAdd=function(e,t){return function(r,n){var o=n(),a=(0,b.countByProject)(o)[e.project_id],i=(0,w.isPremium)(o.user)?300:150;if(a>i){var c=(0,l.format)(_n("For performance reasons you can add at most one task per project. Please try re-organizing your tasks into multiple projects.","For performance reasons you can add at most {n} tasks per project. Please try re-organizing your tasks into multiple projects.",i),{n:i});return t.return_as_error?{error:c}:void alert(c)}var d=s({id:m.default.generate("item"),due:e.due||null,section_id:null,parent_id:null,checked:0,user_id:o.user.id,in_history:0,collapsed:0,date_added:new Date,assigned_by_uid:null,responsible_uid:null},e);if(d.content=$strip(d.content),0===d.content.length)throw new Error("item.add(): content cannot be empty");return d.labels=d.labels||[],d.child_order=d.child_order||(0,v.itemGetMaxTopLevelChildOrder)((0,u.pick)(["section_id","project_id"],e),o)+1,d.responsible_uid&&(0,y.isShared)(o,d.project_id)&&(d.assigned_by_uid=o.user.id),d=(0,g.resolveTempIDFields)(["section_id","project_id","parent_id"],d),delete d.note,f.default.queueUpdate({type:"item_add",temp_id:d.id,args:te(d)}),r({type:O,payload:d}),e.note&&r(T.notesActions.add({parentId:d.id,type:S.TYPE_ITEM_NOTE,content:e.note})),o=n(),re(d.id,o),d}},r.itemDelete=function(e){var t=(0,l.isArray)(e)?e:[e];return t=t.map(function(e){return m.default.getRealId(e)}),t.forEach(function(e){f.default.queueUpdate({type:"item_delete",args:{id:e}})}),{type:x,payload:{ids:t}}},r.itemUpdate=function(e){return function(t,r){e=(0,g.resolveTempIDFields)(["id","project_id","parent_id","labels"],e);var n=e,o=n.id,a=n.parent_id,i=n.child_order,l=r(),u=l.items[e.id];if(q(e,u))return u;if(a){if(a===o)throw Error("item parent_id cannot be itself");f.default.queueUpdate({type:"item_move",args:{id:o,parent_id:a}})}if(i&&f.default.queueUpdate({type:"item_reorder",args:{items:[{id:o,child_order:i}]}}),e.content&&(e.content=$strip(e.content),0===e.content.length))return u;e.project_id&&u.project_id!==e.project_id&&(t(Q([o],e.project_id)),l=r(),u=l.items[o],delete e.project_id),(e.due&&(!u.due||u.due.isSameDate(e.due))||e.priority&&e.priority!==u.priority)&&(e.day_order=-1);var c=s({},e);return c.due&&(c.due=c.due.toAPIFormat()),f.default.queueUpdate({type:"item_update",args:c}),t({type:F,payload:e}),l=r(),re(u.id,l),l=r(),l.items[o]}},r.itemComplete=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.force_history,n=void 0===r?0:r;return e=m.default.getRealId(e),function(t,r){var o=r().items[e];return o.due&&o.due.is_recurring&&0===o.in_history&&!n?Y(o,t,r):W(o,n,t,r)}},r.completeNonRecurring=function(e,t,r,n){var o=(0,l.toISODateString)(new Date,{toUTC:!0}),i=[e].concat(a((0,v.itemGetChildren)(e.id,n())));f.default.queueUpdate({type:"item_complete",args:{id:e.id,date_completed:o,force_history:t}}),r({type:C,payload:{id:e.id,force_history:t,date_completed:o}});var u=void 0;if(t||null===e.parent_id)u=i.map(function(e){return s({},e,{in_history:1,checked:1})});else{var c=n();u=i.map(function(e){return c.items[e.id]})}return u}),Y=function(e,t,r){var n=Array.from(e.due.nextRecurrence()),o=i(n,2),a=o[0];return o[1]?W(e,1,t,r):(f.default.queueUpdate({type:"item_update_date_complete",args:{id:e.id,due:a.toAPIFormat(),is_forward:1}}),t({type:D,payload:{id:e.id,nextRecurrence:a}}),e=r().items[e.id],[e])},K=(r.itemCompleteUndo=function(){return function(e,t){var r=t().undo,n=r.type,o=r.id,a=r.prevState;if(n===M){o=m.default.getRealId(o);var i=(0,c.compose)((0,u.map)((0,u.pick)(["id","checked"])),(0,u.filter)(function(e){return e.id!==o}),l.values)(a.items);f.default.queueUpdate({type:"item_complete_undo",args:{id:o,descendants:i}}),e({type:M}),Signals.sendSignal("instant_refresh_interface")}}},r.itemCompleteRecurringUndo=function(){return function(e,t){var r=t().undo,n=r.type,o=r.id,a=r.duePrev;n===A&&(o=m.default.getRealId(o),f.default.queueUpdate({type:"item_update_date_complete",args:{id:o,due:a,is_forward:0}}),e({type:A}),Signals.sendSignal("instant_refresh_interface"))}},r.itemArchive=function(e){return function(t,r){var n=(0,l.isArray)(e)?e:[e];n=n.map(function(e){return m.default.getRealId(e)});var o=r(),i=(0,l.toISODateString)(new Date,{toUTC:!0}),s=!0,d=!1,p=void 0;try{for(var h,_=n[Symbol.iterator]();!(s=(h=_.next()).done);s=!0){var y=h.value,g=o.items[y];f.default.queueUpdate({type:"item_complete",args:{id:y,force_history:1,date_completed:g.date_completed||i}})}}catch(e){d=!0,p=e}finally{try{!s&&_.return&&_.return()}finally{if(d)throw p}}return t({type:I,payload:{ids:n}}),(0,c.compose)(u.flatten,(0,u.map)(function(e){return[o.items[e]].concat(a((0,v.itemGetChildren)(e,o)))}))(n)}},r.itemArchiveUndo=function(){return function(e,t){var r=t().undo,n=r.type,o=r.ids,a=r.prevState;if(n===P){o=o.map(function(e){return m.default.getRealId(e)});var i=!0,s=!1,d=void 0;try{for(var p,h=o[Symbol.iterator]();!(i=(p=h.next()).done);i=!0)!function(){var e=p.value,t=a.items[e],r=(0,c.compose)((0,u.map)((0,u.pick)(["id","checked"])),(0,u.filter)(function(t){return t.id!==e}),l.values)(a.items);f.default.queueUpdate({type:"item_archive_undo",args:{id:e,checked:t.checked,descendants:r}})}()}catch(e){s=!0,d=e}finally{try{!i&&h.return&&h.return()}finally{if(s)throw d}}e({type:P}),Signals.sendSignal("instant_refresh_interface")}}},r.itemUncomplete=function(e){return e=m.default.getRealId(e),f.default.queueUpdate({type:"item_uncomplete",args:{id:e}}),{type:V,payload:e}},r.itemUnarchive=function(e){return e=(0,j.deserializeItemFields)(e),f.default.queueUpdate({type:"item_unarchive",args:{id:e.id}}),{type:U,payload:e}},function(e,t){var r=!0,n=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var l=i.value;if(t[l])return o({},l,t[l])}}catch(e){n=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw a}}return{}}),J=function(e){return s({id:e.id},K(["parent_id","section_id","project_id"],e))},Q=r.itemMoveMultiple=function(e,t){return function(r,n){var o=n();e=e.map(function(e){return m.default.getRealId(e)}),t=m.default.getRealId(t);var a=(0,c.compose)(function(e){return new Set(e)},(0,u.map)(function(e){return e.id}),u.flatten,(0,u.map)(function(e){return(0,v.itemGetChildren)(e,o)}))(e);e=e.filter(function(e){return!a.has(e)});var i=!0,s=!1,l=void 0;try{for(var d,p=e[Symbol.iterator]();!(i=(d=p.next()).done);i=!0){var h=d.value;f.default.queueUpdate({type:"item_move",args:{id:h,project_id:t}})}}catch(e){s=!0,l=e}finally{try{!i&&p.return&&p.return()}finally{if(s)throw l}}r({type:L,payload:{ids:e,destPID:t}})}},X=r.itemMoveAndReorder=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.allowUndo,o=void 0===n||n;return function(r,n){var a=n().items;if(e){if(e=(0,g.resolveTempIDFields)(["id","parent_id","section_id","project_id"],e),e.parent_id===e.id)throw Error("item parent_id cannot be itself");var i=n().items[e.id];q(e,i)?e=null:(e=J(e),f.default.queueUpdate({type:"item_move",args:e}))}if(t&&(t=t.map((0,g.resolveTempIDFields)("id")).filter(function(e){var t=e.id,r=e.child_order;return a[t].child_order!==r}),t.length>0?f.default.queueUpdate({type:"item_reorder",args:{items:t}}):t=null),e||t)return r({type:N,payload:{moveTo:e,orders:t,allowUndo:o}})}},Z=(r.itemMoveAndReorderUndo=function(){return function(e,t){var r=t().undo,n=r.type,o=r.moveTo,a=r.orders;n===$&&(o&&(o=(0,g.resolveTempIDFields)(["id","parent_id","section_id","project_id"],o),o=J(o),f.default.queueUpdate({type:"item_move",args:o})),a&&(a=a.map((0,g.resolveTempIDFields)("id")),f.default.queueUpdate({type:"item_reorder",args:{items:a}})),e({type:$,payload:{moveTo:o,orders:a}}),Signals.sendSignal("instant_refresh_interface"))}},r.itemUpdateDue=function(e){return function(t,r){var n=r(),o=n.items;e=(0,l.mapKeys)(e,function(e,t){return m.default.getRealId(t)}),(0,u.toPairs)(e).forEach(function(t){var r=i(t,2),n=r[0],a=r[1];a instanceof Date&&(a=o[n].due?o[n].due.inheritDate({year:a.getFullYear(),month:a.getMonth(),day:a.getDate()}):_.default.fromDate(a),e[n]=a),f.default.queueUpdate({type:"item_update",args:{id:n,due:a?a.toAPIFormat():null}})}),t({type:G,payload:e}),Signals.sendSignal("instant_refresh_interface")}},r.itemUpdateDueUndo=function(){return function(e,t){var r=t(),n=r.undo;if(n.type===z){var o=(0,l.mapKeys)(n.idToDue,function(e,t){return m.default.getRealId(t)});(0,u.toPairs)(o).forEach(function(e){var t=i(e,2),r=t[0],n=t[1];f.default.queueUpdate({type:"item_update",args:{id:r,due:n?n.toAPIFormat():null}})}),e({type:z}),Signals.sendSignal("instant_refresh_interface")}}},r.itemUpdateDayOrderUndo=function(){return function(e,t){var r=t(),n=r.undo;n.type===H&&(f.default.queueUpdate({type:"item_update_day_orders",args:{ids_to_orders:n.orders}}),e({type:H}),Signals.sendSignal("instant_refresh_interface"))}},(0,l.curry)(function(e,t){return(0,c.compose)(u.flatten,l.values,(0,u.mapValues)(function(e){return e.map(function(e,t){return{id:e.id,child_order:t+1}})}),(0,u.mapValues)(function(t){return t.sort(e),t}),(0,u.groupBy)("parent_id"))(t)})),ee=(r.itemSortProjectItems=function(e,t){return function(r,n){e=m.default.getRealId(e);var o=n(),a=(0,v.itemGetByPID)(o)[e],i=(0,c.compose)((0,u.filter)(function(e){var t=e.id,r=e.child_order;return o.items[t].child_order!==r}),u.flatten,l.values,(0,u.mapValues)(Z(t)),(0,u.groupBy)("section_id"))(a);r(X(null,i))}},r.itemDuplicate=function(e){return function(t,r){e=e.map(function(e){return m.default.getRealId(e)});var n=r(),o=[],s=[];e.forEach(function(e){var t,r,l=ee(e,n),u=i(l,3),c=u[0],d=u[1],f=u[2];o=(t=o).concat.apply(t,a(d)),s=(r=s).concat.apply(r,a(f)),n=c}),(0,l.uniq)(o).forEach(function(e){f.default.queueUpdate({type:"item_add",temp_id:e,args:te(n.items[e])})}),s.length>0&&f.default.queueUpdate({type:"item_reorder",args:{items:(0,l.uniq)(s).map(function(e){return{id:e,child_order:n.items[e].child_order}})}}),t({type:R,payload:{state:n}}),Signals.sendSignal("instant_refresh_interface")}},r.itemUpdateDayOrder=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.withUndo,n=void 0!==r&&r;return e=(0,l.mapKeys)(e,function(e,t){return m.default.getRealId(t)}),f.default.queueUpdate({type:"item_update_day_orders",args:{ids_to_orders:e}}),{type:B,payload:{orders:e,withUndo:n}}},function(e,t){var r=t.items[e],n=(0,v.itemGetChildren)(e,t),o=[r].concat(a(n)).map(l.cloneDeep),i=o.reduce(function(e,t){var r=m.default.generate("item");return e[t.id]=r,e},{}),u=(0,l.toISODateString)(new Date,{toUTC:!0});o=o.map(function(e){return s({},e,{id:i[e.id],parent_id:i[e.parent_id]||e.parent_id,checked:0,date_added:u})});var c=r.child_order;o[0]=s({},o[0],{child_order:c+1});var d=void 0;if(r.parent_id){var f=t.items[r.parent_id];d=(0,v.itemGetChildren)(f.id,t).filter(function(e){return e.child_order>c}).map(function(e){return s({},e,{child_order:e.child_order+1})})}else{d=(0,v.itemGetByPID)(t)[r.project_id].filter(function(e){return!e.parent_id}).filter(function(e){return e.child_order>c}).map(function(e){return s({},e,{child_order:e.child_order+1})})}var p=s({},t.items,(0,l.byID)(o),(0,l.byID)(d));return[s({},t,{items:p}),o.map(function(e){return e.id}),d.map(function(e){return e.id})]}),te=function(e){var t=s({},e,{due:e.due?e.due.toAPIFormat():null});return delete t.sync_id,t},re=function(e,t){var r=t.items[e];if(r.due){if(!r.due.with_time)return void E.RemindersModel.removeRelative(r.id);var n=t.user,o=n.auto_reminder,a=n.default_reminder;if(-1!==o&&(0,w.isPremium)(n)&&r.due&&r.due.with_time){var i=(0,l.values)(t.reminders).filter(function(e){return e.item_id===r.id});if(i=i.concat(E.BufferedRemindersModel.reminders),!(i.length>0)){var s=r.responsible_uid||n.id;E.RemindersModel.add({item_id:r.id,service:a,minute_offset:o,notify_uid:s,type:"relative"})}}}}},{"../../models/DateExt":164,"../../models/Reminders.js":173,"../../models/SyncEngine":181,"../../models/TemporaryIds":184,"../../utils":484,"../../utils/deps":470,"../../utils/fp":477,"../collaborators":407,"../counts":408,"../notes/notesConstants":430,"../user":451,"../utils":452,"./selectors":419,"./utils":420,redux:"redux"}],417:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.itemsCaseReducer=r.deserializeItemFields=r.annotateWithIndent=r.itemGetByName=r.itemGetOwn=r.itemGetBySyncID=r.itemGetUncompleted=r.itemGetMaxTopLevelChildOrder=r.itemGetSectionGroups=r.itemGetByPID=r.itemGetByID=r.itemGetAncestors=r.itemGetChildren=r.itemUpdateDueUndo=r.itemUpdateDue=r.itemUpdateDayOrderUndo=r.itemUpdateDayOrder=r.itemUpdate=r.itemUncomplete=r.itemUnarchive=r.itemSortProjectItems=r.itemMoveMultiple=r.itemMoveAndReorderUndo=r.itemMoveAndReorder=r.itemDuplicate=r.itemDelete=r.itemCompleteUndo=r.itemCompleteRecurringUndo=r.itemComplete=r.itemArchiveUndo=r.itemArchive=r.itemAdd=r.ITEM_UPDATE_DAY_ORDER_UNDO=r.ITEM_UPDATE_DUE_UNDO=r.ITEM_UPDATE_DUE=r.ITEM_UPDATE=r.ITEM_UNCOMPLETE=r.ITEM_UNARCHIVE=r.ITEM_MOVE_MULTIPLE_UNDO=r.ITEM_MOVE_MULTIPLE=r.ITEM_MOVE_AND_REORDER_UNDO=r.ITEM_MOVE_AND_REORDER=r.ITEM_DELETE=r.ITEM_COMPLETE_UNDO=r.ITEM_COMPLETE_RECURRING_UNDO=r.ITEM_COMPLETE_RECURRING=r.ITEM_COMPLETE=r.ITEM_ARCHIVE_UNDO=r.ITEM_ARCHIVE=void 0;var n=e("./actions");Object.defineProperty(r,"ITEM_ARCHIVE",{enumerable:!0,get:function(){return n.ITEM_ARCHIVE}}),Object.defineProperty(r,"ITEM_ARCHIVE_UNDO",{enumerable:!0,get:function(){return n.ITEM_ARCHIVE_UNDO}}),Object.defineProperty(r,"ITEM_COMPLETE",{enumerable:!0,get:function(){return n.ITEM_COMPLETE}}),Object.defineProperty(r,"ITEM_COMPLETE_RECURRING",{enumerable:!0,get:function(){return n.ITEM_COMPLETE_RECURRING}}),Object.defineProperty(r,"ITEM_COMPLETE_RECURRING_UNDO",{enumerable:!0,get:function(){return n.ITEM_COMPLETE_RECURRING_UNDO}}),Object.defineProperty(r,"ITEM_COMPLETE_UNDO",{enumerable:!0,get:function(){return n.ITEM_COMPLETE_UNDO}}),Object.defineProperty(r,"ITEM_DELETE",{enumerable:!0,get:function(){return n.ITEM_DELETE}}),Object.defineProperty(r,"ITEM_MOVE_AND_REORDER",{enumerable:!0,get:function(){return n.ITEM_MOVE_AND_REORDER}}),Object.defineProperty(r,"ITEM_MOVE_AND_REORDER_UNDO",{enumerable:!0,get:function(){return n.ITEM_MOVE_AND_REORDER_UNDO}}),Object.defineProperty(r,"ITEM_MOVE_MULTIPLE",{enumerable:!0,get:function(){return n.ITEM_MOVE_MULTIPLE}}),Object.defineProperty(r,"ITEM_MOVE_MULTIPLE_UNDO",{enumerable:!0,get:function(){return n.ITEM_MOVE_MULTIPLE_UNDO}}),Object.defineProperty(r,"ITEM_UNARCHIVE",{enumerable:!0,get:function(){return n.ITEM_UNARCHIVE}}),Object.defineProperty(r,"ITEM_UNCOMPLETE",{enumerable:!0,get:function(){return n.ITEM_UNCOMPLETE}}),Object.defineProperty(r,"ITEM_UPDATE",{enumerable:!0,get:function(){return n.ITEM_UPDATE}}),Object.defineProperty(r,"ITEM_UPDATE_DUE",{enumerable:!0,get:function(){return n.ITEM_UPDATE_DUE}}),Object.defineProperty(r,"ITEM_UPDATE_DUE_UNDO",{enumerable:!0,get:function(){return n.ITEM_UPDATE_DUE_UNDO}}),Object.defineProperty(r,"ITEM_UPDATE_DAY_ORDER_UNDO",{enumerable:!0,get:function(){return n.ITEM_UPDATE_DAY_ORDER_UNDO}}),Object.defineProperty(r,"itemAdd",{enumerable:!0,get:function(){return n.itemAdd}}),Object.defineProperty(r,"itemArchive",{enumerable:!0,get:function(){return n.itemArchive}}),Object.defineProperty(r,"itemArchiveUndo",{enumerable:!0,get:function(){return n.itemArchiveUndo}}),Object.defineProperty(r,"itemComplete",{enumerable:!0,get:function(){return n.itemComplete}}),Object.defineProperty(r,"itemCompleteRecurringUndo",{enumerable:!0,get:function(){return n.itemCompleteRecurringUndo}}),Object.defineProperty(r,"itemCompleteUndo",{enumerable:!0,get:function(){return n.itemCompleteUndo}}),Object.defineProperty(r,"itemDelete",{enumerable:!0,get:function(){return n.itemDelete}}),Object.defineProperty(r,"itemDuplicate",{enumerable:!0,get:function(){return n.itemDuplicate}}),Object.defineProperty(r,"itemMoveAndReorder",{enumerable:!0,get:function(){return n.itemMoveAndReorder}}),Object.defineProperty(r,"itemMoveAndReorderUndo",{enumerable:!0,get:function(){return n.itemMoveAndReorderUndo}}),Object.defineProperty(r,"itemMoveMultiple",{enumerable:!0,get:function(){return n.itemMoveMultiple}}),Object.defineProperty(r,"itemSortProjectItems",{enumerable:!0,get:function(){return n.itemSortProjectItems}}),Object.defineProperty(r,"itemUnarchive",{enumerable:!0,get:function(){return n.itemUnarchive}}),Object.defineProperty(r,"itemUncomplete",{enumerable:!0,get:function(){return n.itemUncomplete}}),Object.defineProperty(r,"itemUpdate",{enumerable:!0,get:function(){return n.itemUpdate}}),Object.defineProperty(r,"itemUpdateDayOrder",{enumerable:!0,get:function(){return n.itemUpdateDayOrder}}),Object.defineProperty(r,"itemUpdateDayOrderUndo",{enumerable:!0,get:function(){return n.itemUpdateDayOrderUndo}}),Object.defineProperty(r,"itemUpdateDue",{enumerable:!0,get:function(){return n.itemUpdateDue}}),Object.defineProperty(r,"itemUpdateDueUndo",{enumerable:!0,get:function(){return n.itemUpdateDueUndo}});var o=e("./selectors");Object.defineProperty(r,"itemGetChildren",{enumerable:!0,get:function(){return o.itemGetChildren}}),Object.defineProperty(r,"itemGetAncestors",{enumerable:!0,get:function(){return o.itemGetAncestors}}),Object.defineProperty(r,"itemGetByID",{enumerable:!0,get:function(){return o.itemGetByID}}),Object.defineProperty(r,"itemGetByPID",{enumerable:!0,get:function(){return o.itemGetByPID}}),Object.defineProperty(r,"itemGetSectionGroups",{enumerable:!0,get:function(){return o.itemGetSectionGroups}}),Object.defineProperty(r,"itemGetMaxTopLevelChildOrder",{enumerable:!0,get:function(){return o.itemGetMaxTopLevelChildOrder}}),Object.defineProperty(r,"itemGetUncompleted",{enumerable:!0,get:function(){return o.itemGetUncompleted}}),Object.defineProperty(r,"itemGetBySyncID",{enumerable:!0,get:function(){return o.itemGetBySyncID}}),Object.defineProperty(r,"itemGetOwn",{enumerable:!0,get:function(){return o.itemGetOwn}}),Object.defineProperty(r,"itemGetByName",{enumerable:!0,get:function(){return o.itemGetByName}}),Object.defineProperty(r,"annotateWithIndent",{enumerable:!0,get:function(){return o.annotateWithIndent}});var a=e("./utils");Object.defineProperty(r,"deserializeItemFields",{enumerable:!0,get:function(){return a.deserializeItemFields}});var i=e("./reducers");Object.defineProperty(r,"itemsCaseReducer",{enumerable:!0,get:function(){return i.itemsCaseReducer}});var s=function(e){return e&&e.__esModule?e:{default:e}}(i);r.default=s.default},{"./actions":416,"./reducers":418,"./selectors":419,"./utils":420}],418:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0}),r.resolveFields=r.itemsCaseReducer=void 0;var a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("../../utils"),l=e("../../utils/fp"),u=e("redux"),c=e("../modelbridge"),d=e("../utils"),f=e("../undo"),p=e("../load"),m=e("./actions"),h=e("../sync"),_=e("./selectors"),v=e("./utils"),y=e("../notes/notesUtils"),g=e("../../logger/Logger"),b=function(e){return e&&e.__esModule?e:{default:e}}(g),w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case p.LOAD_LOCAL_DATA:var r=t.payload.items;return r?(0,l.mapValues)(v.deserializeItemFields,r):e;case m.ITEM_ADD:var n=t.payload;return i({},e,o({},n.id,n));case m.ITEM_UNARCHIVE:var a=i({},t.payload),s=(0,_.itemGetMaxTopLevelChildOrder)({project_id:a.project_id,section_id:null},{items:e})+1;return a=i({},a,{checked:0,in_history:0,child_order:s}),i({},e,o({},a.id,a));case c.MODEL_BRIDGE_UPDATE:return t.payload.items?i({},t.payload.items):e;default:return e}};r.default=w;var E=(r.itemsCaseReducer=function(e,t){switch(t.type){case h.SYNC_FULL_UPDATE:var r=t.payload.items||[];return r=(0,s.byID)(r.map(v.deserializeItemFields)),i({},e,{items:r});case h.SYNC_UPDATE:var c=t.payload,p=c.day_orders,g=c.items,b=c.temp_id_mapping,w=c.notes,k=c.reminders;g&&(g=g.map(v.deserializeItemFields)),w&&(w=w.map(y.deserializeNote));var S=i({},e);if(b&&(S.items=(0,d.resolveTempID)(S.items,b)),p&&(0,s.toPairs)(p).forEach(function(e){var t=a(e,2),r=t[0],n=t[1],o=S.items[r];o&&n!==o.day_order&&(S.items[r]=i({},o,{day_order:n}))}),!g||0===g.length)return S;S.items=(0,d.mergeSyncUpdate)(S.items,g,{removeArchived:!1}),S=E(S,{temp_id_mapping:b,items:g,reminders:k,notes:w});var P=(0,u.compose)((0,l.map)(function(e){return e.id}),l.flatten,(0,l.map)(function(e){return[e].concat(n((0,_.itemGetChildren)(e.id,S)))}),(0,l.filter)(function(e){return e.in_history||e.is_deleted}))(g);return S=O(P,S)[0];case m.ITEM_UPDATE_DUE:var C=t.payload,D=(0,u.compose)((0,l.mapValues)(function(e){return i({},e,{due:C[e.id]})}),(0,l.pick)((0,s.keys)(C)))(e.items),A=i({},e,{items:i({},e.items,D)}),M=(0,u.compose)((0,l.mapValues)(function(e){return e.due}),(0,l.pick)((0,s.keys)(C)))(e.items);return A=(0,f.setUndo)({type:m.ITEM_UPDATE_DUE_UNDO,idToDue:M},A);case m.ITEM_UPDATE_DUE_UNDO:var x=e.undo.idToDue,R=(0,u.compose)((0,l.mapValues)(function(e){return i({},e,{due:x[e.id]})}),(0,l.pick)((0,s.keys)(x)))(e.items);return i({},e,{items:i({},e.items,R),undo:null});case m.ITEM_COMPLETE:var N=t.payload,$=N.id,L=N.force_history,U=N.date_completed,V=e.items[$],F=(0,_.itemGetChildren)($,e),B=[V].concat(n(F)),H=B.map(function(e){return e.id}),G=I(H,e),z=G.notes,q=G.reminders;if(e=(0,f.setUndo)({type:m.ITEM_COMPLETE_UNDO,id:$,prevState:{items:(0,s.toIDMap)(B),notes:(0,l.pick)(z,e.notes),reminders:(0,l.pick)(q,e.reminders)},force_history:L},e),L||null===V.parent_id)e=(0,u.compose)((0,d.removeFromSlice)("items",H),(0,d.removeFromSlice)("notes",z),(0,d.removeFromSlice)("reminders",q))(e);else{var W=(0,u.compose)(s.toIDMap,(0,l.map)(function(e){return i({},e,{checked:1,date_completed:U})}))(B);e=i({},e,{items:i({},e.items,W)})}return e;case m.ITEM_COMPLETE_UNDO:var Y=e.undo.prevState;return i({},e,{items:i({},e.items,Y.items),notes:i({},e.notes,Y.notes),reminders:i({},e.reminders,Y.reminders),undo:null});case m.ITEM_COMPLETE_RECURRING:var K=t.payload,J=K.id,Q=K.nextRecurrence,X=e,Z=X.items;e=(0,f.setUndo)({type:m.ITEM_COMPLETE_RECURRING_UNDO,id:J,due:Q,duePrev:Z[J].due},e);var ee=i({},Z[J],{due:Q});return i({},e,{items:i({},Z,o({},J,ee))});case m.ITEM_COMPLETE_RECURRING_UNDO:var te=e.undo,re=te.id,ne=te.duePrev,oe=i({},e.items[re],{due:ne});return i({},e,{items:i({},e.items,o({},re,oe)),undo:null});case m.ITEM_UNCOMPLETE:var ae=t.payload,ie=e.items[ae],se=[ie].concat(n((0,_.itemGetAncestors)(ae,e))),le=(0,u.compose)(s.toIDMap,(0,l.map)(function(e){return i({},e,{checked:0,date_completed:null})}),(0,l.filter)(function(e){return e.checked}))(se);if(0===(0,s.values)(le).length)return e;var ue=i({},e.items,le),ce=e,de=ce.reminders,fe=(0,u.compose)((0,l.mapValues)((0,l.unset)("lprocessed")),(0,l.pickBy)(function(e){return le[e.item_id]&&e.lprocessed}))(de);return(0,s.values)(fe).length>0&&(de=i({},de,fe)),i({},e,{items:ue,reminders:de});case m.ITEM_DELETE:case m.ITEM_ARCHIVE:var pe=t.payload.ids,me=(0,u.compose)(l.flatten,(0,l.map)(function(t){return[e.items[t]].concat(n((0,_.itemGetChildren)(t,e)))}))(pe),he=me.map(function(e){return e.id}),_e=I(he,e),ve=_e.notes,ye=_e.reminders;return t.type===m.ITEM_ARCHIVE&&(e=(0,f.setUndo)({type:m.ITEM_ARCHIVE_UNDO,ids:he,prevState:{items:(0,s.toIDMap)(me),notes:(0,l.pick)(ve,e.notes),reminders:(0,l.pick)(ye,e.reminders)}},e)),e=(0,u.compose)((0,d.removeFromSlice)("items",he),(0,d.removeFromSlice)("notes",ve),(0,d.removeFromSlice)("reminders",ye))(e);case m.ITEM_ARCHIVE_UNDO:var ge=e.undo.prevState;return i({},e,{items:i({},e.items,ge.items),notes:i({},e.notes,ge.notes),reminders:i({},e.reminders,ge.reminders),undo:null});case m.ITEM_MOVE_MULTIPLE:var be=t.payload,we=be.ids,Ee=be.destPID,ke=(0,f.setUndo)({type:m.ITEM_MOVE_MULTIPLE_UNDO,prevState:{items:(0,l.pick)(we,e.items)},destProject:e.projects[Ee]},e),Se=(0,_.itemGetMaxTopLevelChildOrder)({project_id:Ee,section_id:null},e),je=!0,Te=!1,Oe=void 0;try{for(var Ie,Pe=we[Symbol.iterator]();!(je=(Ie=Pe.next()).done);je=!0){var Ce=Ie.value;Se++,ke=T({id:Ce,project_id:Ee},ke),ke.items[Ce].child_order=Se}}catch(e){Te=!0,Oe=e}finally{try{!je&&Pe.return&&Pe.return()}finally{if(Te)throw Oe}}return ke;case m.ITEM_MOVE_AND_REORDER:var De=t.payload,Ae=De.moveTo,Me=De.orders,xe=De.allowUndo,Re=i({},e);return Ae&&(Re=T(Ae,e)),Me&&(Re.items=(0,l.merge)(Re.items,(0,s.byID)(Me))),xe&&(Re=(0,f.setUndo)({type:m.ITEM_MOVE_AND_REORDER_UNDO,moveTo:Ae?(0,
l.pick)(["id","parent_id","section_id","project_id"],e.items[Ae.id]):null,orders:Me?Me.map(function(t){var r=t.id;return(0,l.pick)(["id","child_order"],e.items[r])}):null},Re)),Re;case m.ITEM_MOVE_AND_REORDER_UNDO:var Ne=t.payload,$e=Ne.moveTo,Le=Ne.orders,Ue=i({},e);return $e&&(Ue=T($e,e)),Le&&(Ue.items=(0,l.merge)(Ue.items,(0,s.byID)(Le))),Ue.undo=null,Ue;case m.ITEM_DUPLICATE:return t.payload.state;case m.ITEM_UPDATE:var Ve=t.payload,Fe=Ve.id,Be=Ve.due,He=e.items[Fe];return He.due&&Be&&(e=j(He.id,e)),He=i({},He,t.payload),i({},e,{items:i({},e.items,o({},Fe,He))});case m.ITEM_UPDATE_DAY_ORDER:var Ge=t.payload,ze=Ge.orders,qe=Ge.withUndo,We=i({},e,{items:i({},e.items)});if((0,s.keys)(ze).forEach(function(e){var t=ze[e];We.items[e]=i({},We.items[e],{day_order:t})}),qe){var Ye={};(0,s.keys)(ze).forEach(function(t){Ye[t]=e.items[t].day_order}),We=(0,f.setUndo)({type:m.ITEM_UPDATE_DAY_ORDER_UNDO,orders:Ye},We)}return We;case m.ITEM_UPDATE_DAY_ORDER_UNDO:var Ke=e.undo.orders,Je=i({},e,{items:i({},e.items),undo:null});return(0,s.keys)(Ke).forEach(function(e){var t=Ke[e];Je.items[e]=i({},Je.items[e],{day_order:t})}),Je;default:return e}},function(e,t){try{var r=e.undo;if(!r)return e;var n=t.temp_id_mapping;switch(r.type){case m.ITEM_ARCHIVE_UNDO:case m.ITEM_COMPLETE_UNDO:var o=i({},r.prevState);o=k("items",o,t,["checked","in_history"]),o=k("notes",o,t,["is_archived"]),o=k("reminders",o,t);var a=i({},r,{prevState:o});return r.type===m.ITEM_ARCHIVE_UNDO&&(a.ids=a.ids.map(function(e){return n[e]||e})),r.type===m.ITEM_COMPLETE_UNDO&&(a.id=n[a.id]||a.id),i({},e,{undo:a});case m.ITEM_UPDATE_DUE_UNDO:var s=r.idToDue;return s=(0,l.mapKeys)(function(e){return n[e]||e},s),i({},e,{undo:i({},r,{idToDue:s})});case m.ITEM_MOVE_AND_REORDER_UNDO:var u=r.moveTo,c=r.orders;return u&&(u=S(["id","parent_id","section_id","project_id"],u,n)),c&&(c=c.map(function(e){return S(["id","child_order"],e,n)})),i({},e,{undo:i({},r,{moveTo:u,orders:c})});case m.ITEM_COMPLETE_RECURRING_UNDO:var d=n[r.id]||r.id;return i({},e,{undo:i({},r,{id:d})});default:return e}}catch(t){return b.default.captureError(t),e}}),k=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=r.temp_id_mapping;if(!a&&!r[e])return t;var u=(0,d.resolveTempID)(t[e],a),c=(0,s.byID)(r[e]);return u=(0,l.mapValues)(function(e){return c[e.id]?i({},e,(0,l.omit)(n,c[e.id])):e})(u),i({},t,o({},e,u))},S=r.resolveFields=function(e,t,r){var n=i({},t),o=!1;return e.forEach(function(e){var a=n[e];if(t.hasOwnProperty(e)){var i=r[a];i&&a!==i&&(o=!0,n[e]=i)}}),o?n:t},j=function(e,t){var r=t.reminders,n=(0,s.values)(r).filter(function(t){return t.item_id===e&&t.lprocessed});return 0===n.length?t:(n=(0,u.compose)(s.byID,(0,l.map)((0,l.omit)("lprocessed")))(n),r=i({},r,n),i({},t,{reminders:r}))},T=function(e,t){var r=t.items,n=t.sections,a=e.id,c=e.parent_id,d=void 0===c?null:c,f=e.section_id,p=void 0===f?null:f,m=e.project_id,h=void 0===m?null:m;if(d)p=r[d].section_id,h=r[d].project_id;else if(p)h=n[p].project_id;else if(!h)return t;var v=i({},r[a],{parent_id:d,section_id:p,project_id:h}),y=(0,u.compose)(s.byID,(0,l.map)(function(e){return i({},e,{section_id:p,project_id:h})}))((0,_.itemGetChildren)(a,t));return i({},t,{items:i({},r,o({},a,v),y)})},O=function(e,t){var r=I(e,t),n=r.notes,o=r.reminders;return t=(0,u.compose)((0,d.removeFromSlice)("items",e),(0,d.removeFromSlice)("notes",n),(0,d.removeFromSlice)("reminders",o))(t),[t,{items:e,notes:n,reminders:o}]},I=function(e,t){e=new Set(e);var r=function(e){return(0,u.compose)(function(e){return new Set(e)},(0,l.map)(function(e){return e.id}),(0,l.filter)(e),s.values)},o=r(function(t){return e.has(t.item_id)})(t.notes),a=r(function(t){return e.has(t.item_id)})(t.reminders);return{notes:[].concat(n(o)),reminders:[].concat(n(a))}}},{"../../logger/Logger":141,"../../utils":484,"../../utils/fp":477,"../load":425,"../modelbridge":427,"../notes/notesUtils":433,"../sync":447,"../undo":449,"../utils":452,"./actions":416,"./selectors":419,"./utils":420,redux:"redux"}],419:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.annotateWithIndent=r.itemGetMaxTopLevelChildOrder=r.itemGetSectionGroups=r.itemGetAncestors=r.itemGetChildren=r.itemGetByName=r.itemGetBySyncID=r.itemGetByPID=r.itemGetByID=r.itemGetOwn=r.getUncompletedExcludeSection=r.itemGetUncompleted=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("../../utils"),i=e("../../utils/fp"),s=e("redux"),l=e("reselect"),u=e("../../models/TemporaryIds"),c=function(e){return e&&e.__esModule?e:{default:e}}(u),d=e("../collaborators"),f=r.itemGetUncompleted=(0,l.createSelector)(function(e){return e.items},function(e){return e.projects},function(e,t){return e&&t?(0,a.values)(e).filter(function(e){return!(e.in_history||e.checked||!t[e.project_id])}):null}),p=(r.getUncompletedExcludeSection=(0,l.createSelector)(f,(0,i.filter)(function(e){return!(0,a.isSection)(e.content)})),r.itemGetOwn=(0,l.createSelector)(f,d.isSharedProject,function(e){return e.user},function(e,t,r){return e.filter(function(e){return!t(e.project_id)||!e.responsible_uid||e.responsible_uid===r.id})}),(0,l.createSelector)(function(e){return e.items},(0,i.filter)(function(e){return!e.in_history}))),m=(r.itemGetByID=function(e,t){return t=c.default.getRealId(t),e.items[t]},r.itemGetByPID=(0,l.createSelector)(p,(0,i.groupBy)("project_id"))),h=(r.itemGetBySyncID=function(e,t){return(0,a.values)(t.items).find(function(t){return t.sync_id===e})},r.itemGetByName=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=f(t),o=n.reduce(function(t,r){var n=(0,a.partialMatchIndex)(e,r.content);return-1!==n&&t.push({item:r,index:n}),t},[]);return o=(0,i.sortBy)(["index","id"],o).slice(0,r).map(function(e){return e.item})},r.itemGetChildren=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.sorted,a=void 0!==o&&o;e=c.default.getRealId(e);var l=t.items[e];if(!l)throw new Error("itemGetChildren() called with non-exist item id");var u=m(t)[l.project_id],d=(0,i.groupBy)("parent_id")(u),f=function e(t){var r=d[t.id];return a&&(r=(0,i.sortBy)("child_order",r)),[t].concat(n((0,s.compose)(i.flatten,(0,i.map)(function(t){return e(t)}))(r)))}(l);return f.splice(0,1),f},r.itemGetAncestors=function e(t,r){var o=r.items[t].parent_id;return o?[r.items[o]].concat(n(e(o,r))):[]},r.itemGetSectionGroups=(0,a.curry)(function(e,t){var r=m(t)[e],o=(0,i.groupBy)("section_id",r),a=(0,i.groupBy)("parent_id",r),l=function(e){return o[e]?o[e].filter(function(e){return null===e.parent_id}):[]},u=function e(t){var r=a[t.id];return[t].concat(n((0,s.compose)(i.flatten,(0,i.map)(function(t){return e(t)}),(0,i.sortBy)("child_order"))(r)))},c=function(e){var t=(0,s.compose)(i.flatten,(0,i.map)(u),(0,i.sortBy)("child_order"))(l(e));return _(t)},d=(0,s.compose)((0,i.mapValues)(function(e){return c(e.id)}),(0,i.pickBy)(function(t){return t.project_id===e}),(0,i.get)("sections"))(t);return d[null]=c(null),d}),r.itemGetMaxTopLevelChildOrder=function(e,t){var r=e.project_id,n=e.section_id;return r||(r=t.sections[n].project_id),n||(n=null),(0,s.compose)((0,i.get)("child_order"),i.last,(0,i.sortBy)("child_order"),(0,i.filter)(function(e){return e.section_id===n&&null===e.parent_id}),(0,i.get)(r),m)(t)||0},function e(t,r){var n=r.items[t];return n&&n.parent_id?e(n.parent_id,r)+1:1}),_=(r.annotateWithIndent=function(e,t){return o({},e,{indent:h(e.id,t)})},function(e){var t={};return e.forEach(function(e,r){e.item_order=r+1,null===e.parent_id?e.indent=1:e.indent=(t[e.parent_id]||1)+1,t[e.id]=e.indent}),e})},{"../../models/TemporaryIds":184,"../../utils":484,"../../utils/fp":477,"../collaborators":407,redux:"redux",reselect:"reselect"}],420:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deserializeItemFields=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("../../models/DateExt"),a=function(e){return e&&e.__esModule?e:{default:e}}(o),i=e("../../utils");r.deserializeItemFields=function(e){var t=n({},e),r=!1;return t.due&&t.due instanceof Object&&(t.due=new a.default(t.due),r=!0),(0,i.isString)(t.date_added)&&(t.date_added=new Date(t.date_added),r=!0),r?t:e}},{"../../models/DateExt":164,"../../utils":484}],421:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.labelUpdateOrders=r.labelUpdate=r.labelRemove=r.labelAdd=r.LABEL_UPDATE=r.LABEL_REMOVE=r.LABEL_ADD=void 0;var o=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("../../utils"),s=e("../../models/TemporaryIds"),l=n(s),u=e("../../models/SyncEngine"),c=n(u),d=r.LABEL_ADD="LABEL_ADD",f=r.LABEL_REMOVE="LABEL_REMOVE",p=r.LABEL_UPDATE="LABEL_UPDATE",m=function(e){return $isString(e)&&0==e.indexOf("_")},h=function(e){return e.replace(/[<>"=#+\s%!?~:@,()&]+/g,"_").trim()};r.labelAdd=function(e){var t=e.name,r=e.color,n=void 0===r?7:r,o=e.item_order;return function(e){if(void 0===t||void 0===n||void 0===o)throw new Error("Missing required parameters");t=h(t);var r=l.default.generate("label"),i={id:r,name:t,color:n,item_order:o};return c.default.queueUpdate({type:"label_register",temp_id:r,args:a({},i)}),e({type:d,payload:i}),i}},r.labelRemove=function(e){return function(t){m(e)&&(e=l.default.getRealId(e)),c.default.queueUpdate({type:"label_delete",args:{id:e}}),t({type:f,payload:e})}},r.labelUpdate=function(e,t){var r=t.name,n=t.color,o=t.item_order,a=t.is_favorite;return function(t){m(e)&&(e=l.default.getRealId(e));var s={id:e,name:r,color:n,item_order:o,is_favorite:a};s=(0,i.omitBy)(s,function(e){return void 0===e}),s.name&&(s.name=h(s.name)),c.default.queueUpdate({type:"label_update",args:s}),t({type:p,payload:s})}},r.labelUpdateOrders=function(e){return function(t){if(0!==$values(e).length){e=(0,i.mapKeys)(e,function(e,t){return m(t)?l.default.getRealId(t):t}),c.default.queueUpdate({type:"label_update_orders",args:{id_order_mapping:JSON.stringify(e)}});var r=(0,i.toPairs)(e).map(function(e){var t=o(e,2),r=t[0],n=t[1];return{id:m(r)?r:parseInt(r),item_order:n}});t({type:p,payload:r})}}}},{"../../models/SyncEngine":181,"../../models/TemporaryIds":184,"../../utils":484}],422:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.labelGetCount=r.labelGetMaxOrder=r.labelGetBySearch=r.labelGetAll=r.labelGetByName=r.labelGetByID=r.labelGetFavorite=r.labelRemove=r.labelUpdateOrders=r.labelUpdate=r.labelAdd=r.LABEL_UPDATE=r.LABEL_REMOVE=r.LABEL_ADD=void 0;var n=e("./actions");Object.defineProperty(r,"LABEL_ADD",{enumerable:!0,get:function(){return n.LABEL_ADD}}),Object.defineProperty(r,"LABEL_REMOVE",{enumerable:!0,get:function(){return n.LABEL_REMOVE}}),Object.defineProperty(r,"LABEL_UPDATE",{enumerable:!0,get:function(){return n.LABEL_UPDATE}}),Object.defineProperty(r,"labelAdd",{enumerable:!0,get:function(){return n.labelAdd}}),Object.defineProperty(r,"labelUpdate",{enumerable:!0,get:function(){return n.labelUpdate}}),Object.defineProperty(r,"labelUpdateOrders",{enumerable:!0,get:function(){return n.labelUpdateOrders}}),Object.defineProperty(r,"labelRemove",{enumerable:!0,get:function(){return n.labelRemove}});var o=e("./selectors");Object.defineProperty(r,"labelGetFavorite",{enumerable:!0,get:function(){return o.labelGetFavorite}}),Object.defineProperty(r,"labelGetByID",{enumerable:!0,get:function(){return o.labelGetByID}}),Object.defineProperty(r,"labelGetByName",{enumerable:!0,get:function(){return o.labelGetByName}}),Object.defineProperty(r,"labelGetAll",{enumerable:!0,get:function(){return o.labelGetAll}}),Object.defineProperty(r,"labelGetBySearch",{enumerable:!0,get:function(){return o.labelGetBySearch}}),Object.defineProperty(r,"labelGetMaxOrder",{enumerable:!0,get:function(){return o.labelGetMaxOrder}}),Object.defineProperty(r,"labelGetCount",{enumerable:!0,get:function(){return o.labelGetCount}});var a=e("./reducers"),i=function(e){return e&&e.__esModule?e:{default:e}}(a);r.default=i.default},{"./actions":421,"./reducers":423,"./selectors":424}],423:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("../../utils"),a=e("../load"),i=e("../sync"),s=e("../utils"),l=e("./actions"),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case a.LOAD_LOCAL_DATA:return t.payload.labels?t.payload.labels:e;case i.SYNC_UPDATE:var r=t.payload,u=r.labels,c=r.temp_id_mapping;return c&&(e=(0,s.resolveTempID)(e,c)),u&&(e=(0,s.mergeSyncUpdate)(e,u)),e;case i.SYNC_FULL_UPDATE:return(0,o.keyBy)(t.payload.labels,"id");case l.LABEL_ADD:var d=t.payload,f=n({},e);return f[d.id]=d,f;case l.LABEL_REMOVE:var p=t.payload,m=n({},e);return delete m[p],m;case l.LABEL_UPDATE:var h=$isArray(t.payload)?t.payload:[t.payload],_=n({},e),v=!0,y=!1,g=void 0;try{for(var b,w=h[Symbol.iterator]();!(v=(b=w.next()).done);v=!0){var E=b.value,k=E.id;_[k]&&(_[k]=n({},_[k],E))}}catch(e){y=!0,g=e}finally{try{!v&&w.return&&w.return()}finally{if(y)throw g}}return _;default:return e}};r.default=u},{"../../utils":484,"../load":425,"../sync":447,"../utils":452,"./actions":421}],424:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){var n=t.caseSensitive;if(arguments.length<2)throw new Error("First two arguments are required");n||(e=e.toLowerCase());var o=(0,l.createSelector)(function(e){return e.labels},function(t){return(0,d.compose)((0,s.find)(function(t){return n?t.name===e:t.name.toLowerCase()===e}),i.values)(t)});return 2===arguments.length?o:o(r)}function a(e,t){e=e.toLowerCase();var r=(0,l.createSelector)(function(e){return e.labels},function(t){return(0,d.compose)((0,s.find)(function(t){return t.name.toLowerCase()===e}),i.values)(t)});return 1===arguments.length?r:r(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.labelGetCount=r.labelGetMaxOrder=r.labelGetBySearch=r.labelGetAll=r.labelGetByID=r.labelGetFavorite=void 0,r.labelGetByName=o,r.get=a;var i=e("../../utils"),s=e("../../utils/fp"),l=e("reselect"),u=e("../../models/TemporaryIds"),c=n(u),d=e("redux"),f=e("../../utils/partialMatchIndex"),p=n(f);r.labelGetFavorite=(0,l.createSelector)(function(e){return e.labels},(0,d.compose)((0,s.sortBy)(["item_order"]),(0,s.filter)(function(e){return e.is_favorite}),i.values)),r.labelGetByID=function(e,t){var r=e.labels;return t=c.default.getRealId(t),r[t]},r.labelGetAll=(0,l.createSelector)(function(e){return e.labels},(0,s.sortBy)(["item_order"])),r.labelGetBySearch=function(e,t){var r=e.labels;return(0,d.compose)((0,s.map)(function(e){return e.p}),(0,s.sortBy)(["i","p.item_order","p.id"]),(0,s.filter)(function(e){return-1!==e.i}),(0,s.map)(function(e){return{i:(0,p.default)(t,e.name),p:e}}),i.values)(r)},r.labelGetMaxOrder=function(e){var t=e.labels,r=$values(t);return 0==r.length?1:r.reduce(function(e,t){return Math.max(e,t.item_order)},Number.NEGATIVE_INFINITY)},r.labelGetCount=function(e){var t=e.labels;return $values(t).length}},{"../../models/TemporaryIds":184,"../../utils":484,"../../utils/fp":477,"../../utils/partialMatchIndex":499,redux:"redux",reselect:"reselect"}],425:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=r.LOAD_LOCAL_DATA="LOAD_LOCAL_DATA";r.loadLocalData=function(e){return{type:n,payload:e}}},{}],426:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.show7DaysView=r.showTodayView=r.showActivityView=r.showQueryView=r.showFilterView=r.showLabelView=r.showProjectView=r.VIEW_SHOW_7_DAYS=r.VIEW_SHOW_TODAY=r.VIEW_SHOW_FILTER=r.VIEW_SHOW_LABEL=r.VIEW_SHOW_ACTIVITY_LOG=r.VIEW_SHOW_QUERY=r.VIEW_SHOW_PROJECT=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("./sync"),s=e("../constants/constants"),l=e("./projects"),u=e("./utils"),c=e("../components/agenda/AgendaUtils"),d=n(c),f=e("../utils/isTempID"),p=n(f),m=window,h=m.Signals,_=r.VIEW_SHOW_PROJECT="VIEW_SHOW_PROJECT",v=r.VIEW_SHOW_QUERY="VIEW_SHOW_QUERY",y=r.VIEW_SHOW_ACTIVITY_LOG="VIEW_SHOW_ACTIVITY_LOG",g=r.VIEW_SHOW_LABEL="VIEW_SHOW_LABEL",b=r.VIEW_SHOW_FILTER="VIEW_SHOW_FILTER",w=r.VIEW_SHOW_TODAY="VIEW_SHOW_TODAY",E=r.VIEW_SHOW_7_DAYS="VIEW_SHOW_7_DAYS",k=function(){e("../components/projects_list/ProjectList").deselectCurrent()},S=(r.showProjectView=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.bottomListSelected,a=void 0!==n&&n,i=r.withChildren,s=void 0!==i&&i;return function(r,n){a||k();var i=n();t=t.map((0,u.toUniqueID)(i));var c=e("../components/project_editor/ProjectEditorManager");if(1===t.length&&s){var d=(0,l.projectGetChildren)(t[0],n()).map(function(e){return e.id});c.showProjects([].concat(o(t),o(d)),null,{hideEmptyState:d.length>0})}else c.showProjects(t);if(1===t.length){var f=s?"project/"+t[0]+"/full":"project/"+t[0];h.sendSignal("change_location",f)}return r({type:_,payload:{ids:t,bottomListSelected:a,withChildren:s}})}},r.showLabelView=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.bottomListSelected,n=void 0!==r&&r;return n||k(),function(t,r){r().labels[e]&&t({type:g,payload:{id:e,bottomListSelected:n}})}},r.showFilterView=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.bottomListSelected,n=void 0!==r&&r;return n||k(),function(t,r){if(!r().filters[e])throw new Error("Cannot show filter view for non-exist filter id: "+e);t({type:b,payload:{id:e,bottomListSelected:n}})}},r.showQueryView=function(e){return k(),d.default.query(e,!0,!1),{type:v,payload:e}},r.showActivityView=function(){return k(),{type:y}},r.showTodayView=function(){return k(),{type:w}},r.show7DaysView=function(){return k(),{type:E}},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case _:return a({type:s.MAIN_VIEW_TYPE_PROJECT},t.payload);case v:return{type:s.MAIN_VIEW_TYPE_QUERY,query:t.payload};case y:return{type:s.MAIN_VIEW_TYPE_ACTIVITY_LOG};case g:return a({type:s.MAIN_VIEW_TYPE_LABEL},t.payload);case b:return a({type:s.MAIN_VIEW_TYPE_FILTER},t.payload);case w:return{type:s.MAIN_VIEW_TYPE_TODAY};case E:return{type:s.MAIN_VIEW_TYPE_7_DAYS};case i.SYNC_UPDATE:var r=t.payload.temp_id_mapping;return(0,p.default)(e.id)&&r[e.id]?a({},e,{id:r[e.id]}):e;default:return e}});r.default=S},{"../components/agenda/AgendaUtils":8,"../components/project_editor/ProjectEditorManager":61,"../components/projects_list/ProjectList":70,"../constants/constants":98,"../utils/isTempID":491,"./projects":435,"./sync":447,"./utils":452}],427:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.modelBridgeMiddleware=r.ModelBridge=r.MODEL_BRIDGE_UPDATE=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("../utils"),s=e("../utils/fp"),l=e("../logger/Logger"),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=window,d=c.Signals,f=r.MODEL_BRIDGE_UPDATE="MODEL_BRIDGE_UPDATE",p=function(e){return{type:f,payload:e}},m=function(){function e(){var t=this;n(this,e),this.handleModelUpdate=function(e){try{if(1===(0,i.keys)(e)||0===(0,i.keys)(e))throw new Error("Assertion error: update should be a single key object");t.dispatchBridgeUpdate(e)}catch(e){u.default.captureError(e,{tags:{critical:"model_bridge"}})}},this.dispatchBridgeUpdate=function(e){t.store.dispatch(p(e))},this.dispatchBridgeUpdateDebounced=(0,i.debounce)(this.dispatchBridgeUpdate,30)}return a(e,[{key:"init",value:function(e){this.store=e,d.connect("bridge:model_update",this.handleModelUpdate)}}]),e}(),h=(r.ModelBridge=new m,function(e,t){var r={},n=!0,o=!1,a=void 0;try{for(var s,l=(0,i.keys)(e)[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value;e[u]!==t[u]&&(r[u]=e[u])}}catch(e){o=!0,a=e}finally{try{!n&&l.return&&l.return()}finally{if(o)throw a}}return r}),_=(0,s.mapValues)(function(e){return o({},e)});r.modelBridgeMiddleware=function(e){return function(t){return function(r){var n=e.getState(),o=t(r),a=e.getState(),i=h(a,n);return i=_(i),d.sendSignal("bridge:redux_update",i),o}}}},{"../logger/Logger":141,"../utils":484,"../utils/fp":477}],428:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.notesCaseReducer=void 0;var n=e("./notesReducer");Object.defineProperty(r,"notesCaseReducer",{enumerable:!0,get:function(){return n.notesCaseReducer}});var o=function(e){return e&&e.__esModule?e:{default:e}}(n);r.default=o.default},{"./notesReducer":431}],429:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){var t={},r=void 0;return e.file_server_info?(t.file_server_info=e.file_server_info,r=!1):(t.file_server_info={file_name:e.file.name,file_type:e.file.type,file_size:e.file.size,upload_state:"pending"},r=!0),{file_info:t,is_buffer_obj:r}}Object.defineProperty(r,"__esModule",{value:!0}),r.fetchNotesFromProject=r.fetchNotesFromItem=r.removeReaction=r.addReaction=r.insert=r.remove=r.addNoteWithFiles=r.update=r.add=void 0;var a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("../../models/TemporaryIds"),l=n(s),u=e("../../models/SyncEngine"),c=n(u),d=e("../user"),f=e("./notesConstants"),p=e("./notesSelectors"),m=e("../../utils/deps"),h=e("./notesUtils"),_=e("../items"),v=(0,m.defineDeps)("notesActions",["ProjectsModel"]),y=r.add=function(e){var t=e.parentId,r=e.content,n=e.type,o=e.usersToNotify,a=e.file,s=e.additionalProperties,u=void 0===s?{}:s;return function(e,s){if(n!==f.TYPE_ITEM_NOTE&&n!==f.TYPE_PROJECT_NOTE)throw new Error("Programming error: incorrect note type. (note_type="+n+")");var d=s(),p=d.user.id,m=i({content:r,posted_uid:p},u);n===f.TYPE_ITEM_NOTE?m.item_id=t:m.project_id=t,o&&(m.uids_to_notify=o),a&&a.file_server_info&&(m.file_attachment=a.file_server_info);var h=i({},m,{id:l.default.generate("note"),posted:new Date});return c.default.queueUpdate({type:"note_add",temp_id:h.id,args:m}),e({type:f.NOTE_ADD,payload:h}),h}},g=r.update=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(o,a){e=l.default.getRealId(e);var s=a(),u=s.notes[e];if(u){var d={note_id:u.id};t&&(d.content=t),r&&(d.file_attachment=r),c.default.queueUpdate({type:"note_update",args:d});var p=i({},u,d,n);return delete p.note_id,o({type:f.NOTE_UPDATE,payload:p}),p}}};r.addNoteWithFiles=function(e){var t=e.parentId,r=e.content,n=e.type,a=e.usersToNotify,i=e.files;return function(e){if(0===i.length)return e(y({parentId:t,content:r,type:n,usersToNotify:a}));i.forEach(function(i,s){var l=o(i),u=l.file_info,c=l.is_buffer_obj,d=e(y({parentId:t,content:0===s?r:"",type:n,usersToNotify:a,file:u,additionalProperties:{is_buffer_obj:c}}));i.addCallback(function(t){if(t.success&&!t.instant){var r=t.file_server_info;r.upload_state="completed",e(g(d.id,null,r,{is_buffer_obj:!1}))}})})}},r.remove=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.shouldSync,n=void 0===r||r;return function(t,r){e=l.default.getRealId(e);var o=r(),a=o.notes[e];a&&(n&&c.default.queueUpdate({type:"note_delete",args:{note_id:a.id}}),t({type:f.NOTE_REMOVE,payload:a.id}))}},r.insert=function(e){if(e&&e.id)return e=(0,h.deserializeNote)(e),{type:f.NOTE_UPDATE,payload:e}},r.addReaction=function(e,t){return function(r,n){e=l.default.getRealId(e);var o=n(),a=o.user.id;o.notes[e]&&(c.default.queueUpdate({type:"note_reaction_add",args:{id:e,reaction:t}}),r({type:f.NOTE_ADD_REACTION,payload:{id:e,userId:a,reaction:t}}))}},r.removeReaction=function(e,t){return function(r,n){e=l.default.getRealId(e);var o=n(),a=o.user.id,i=o.notes[e];i&&i.reactions&&(c.default.queueUpdate({type:"note_reaction_remove",args:{id:e,reaction:t}}),r({type:f.NOTE_REMOVE_REACTION,payload:{id:e,userId:a,reaction:t}}))}},r.fetchNotesFromItem=function(e,t){return function(r,n){e=l.default.getRealId(e);var o=n();return fetch("/API/"+c.default.api_version+"/get_item",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:(0,d.getToken)(o),item_id:e,sync_id:t,all_data:1})}).then(function(e){return e.json().then(function(t){return[e.status,t]})}).then(function(e){var t=a(e,2),n=t[0],o=t[1];if(200!==n)throw o;return o.notes=o.notes.map(h.deserializeNote),r({type:f.NOTE_FETCH,payload:o.notes}),o.item=(0,_.deserializeItemFields)(o.item),o})}},r.fetchNotesFromProject=function(e){return function(t,r){e=l.default.getRealId(e);var n=r();return fetch("/API/"+c.default.api_version+"/get_project",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:(0,d.getToken)(n),project_id:e,all_data:1})}).then(function(e){return e.json().then(function(t){return[e.status,t]})}).then(function(e){var r=a(e,2),n=r[0],o=r[1];if(200!==n)throw o;return t({type:f.NOTE_FETCH,payload:o.notes}),v.ProjectsModel.archivedFeteched(i({},o.project,{has_more_notes:!1})),o})}};$queryArgument("print_mode")&&(window.NotesModel={},window.NotesModel.TYPE_ITEM_NOTE=f.TYPE_ITEM_NOTE,window.NotesModel.TYPE_PROJECT_NOTE=f.TYPE_PROJECT_NOTE,window.NotesModel.getNotes=function(t,r){var n=e("../../stores/store").default;return(0,p.getNotes)(n.getState(),t,r)})},{"../../models/SyncEngine":181,"../../models/TemporaryIds":184,"../../stores/store":456,"../../utils/deps":470,"../items":417,"../user":451,"./notesConstants":430,"./notesSelectors":432,"./notesUtils":433}],430:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.NOTES_COMPONENT="notes",r.TYPE_PROJECT_NOTE="project_note",r.TYPE_ITEM_NOTE="item_note",r.NOTE_ADD="NOTE_ADD",r.NOTE_UPDATE="NOTE_UPDATE",r.NOTE_REMOVE="NOTE_REMOVE",r.NOTE_FETCH="NOTE_FETCH",r.NOTE_ADD_REACTION="NOTE_ADD_REACTION",r.NOTE_REMOVE_REACTION="NOTE_REMOVE_REACTION"},{}],431:[function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.notesCaseReducer=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("../../utils"),s=e("../../utils/fp"),l=e("../load"),u=e("../sync"),c=e("../items"),d=e("./notesConstants"),f=e("../utils"),p=e("./notesUtils"),m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case l.LOAD_LOCAL_DATA:return t.payload.notes?(0,s.compose)((0,s.keyBy)("id"),(0,s.map)(p.deserializeNote))((0,s.values)(t.payload.notes)):e;case u.SYNC_UPDATE:var r=t.payload,m=r.notes,h=r.project_notes,_=r.temp_id_mapping;_&&(e=(0,f.resolveTempID)(e,_));var v=[];return m&&(v=m),h&&(v=[].concat(o(v),o(h))),v=v.map(function(e){return e.posted?(0,p.deserializeNote)(e):e}),v.length>0&&(e=(0,f.mergeSyncUpdate)(e,v)),Signals.sendSignal("notes_updated",v),e;case u.SYNC_FULL_UPDATE:var y=t.payload,g=y.notes,b=y.project_notes;return g=g||[],b=b||[],(0,s.compose)((0,s.keyBy)("id"),(0,s.map)(p.deserializeNote))([].concat(o(g),o(b)));case d.NOTE_ADD:case d.NOTE_UPDATE:return a({},e,n({},t.payload.id,t.payload));case d.NOTE_REMOVE:var w=a({},e);return delete w[t.payload],w;case d.NOTE_ADD_REACTION:var E=t.payload,k=E.id,S=E.reaction,j=E.userId,T=e[k],O=T.reactions||{},I=O[S]||[];return I.indexOf(j)>-1?e:(I=[].concat(o(I),[j]),O=a({},O,n({},S,I)),a({},e,n({},k,a({},e[k],{reactions:O}))));case d.NOTE_REMOVE_REACTION:var P=t.payload,C=P.id,D=P.reaction,A=P.userId,M=e[C],x=M.reactions;if(!x[D]||-1===x[D].indexOf(A))return e;return 0===x[D].filter(function(e){return e!==A}).length&&(x=(0,i.omit)(x,D)),0===Object.keys(x).length&&(x=null),a({},e,n({},C,a({},e[C],{reactions:x})));case c.ITEM_UNCOMPLETE:var R=(0,s.compose)((0,s.map)(function(e){return a({},e,{is_archived:0})}),(0,s.filter)(function(e){return e.item_id===t.payload}),s.values)(e);return R.length?a({},e,(0,s.keyBy)("id",R)):e;default:return e}};r.default=m;r.notesCaseReducer=function(e,t){switch(t.type){case d.NOTE_FETCH:var r=(0,s.compose)((0,s.map)(p.deserializeNote),(0,s.filter)(function(t){return!e.notes[t.id]}))(t.payload);if(0===r.length)return e;var n=a({},e,{notes:a({},e.notes,(0,s.keyBy)("id",r))}),o=r[0];if(o.item_id){var i=e.items[o.item_id];i&&(n=(0,s.set)("items."+i.id+".has_more_notes",!1,n))}else{var l=e.projects[o.project_id];l&&(n=(0,s.set)("projects."+l.id+".has_more_notes",!1,n))}return n;default:return e}}},{"../../utils":484,"../../utils/fp":477,"../items":417,"../load":425,"../sync":447,"../utils":452,"./notesConstants":430,"./notesUtils":433}],432:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getNotesSorted=r.getNotes=r.getProjectNotesSorted=r.getProjectNotes=r.getItemNotesSorted=r.getItemNotes=r.getNotesbyParentId=r.getNoteById=r.getAllNotes=void 0;var n=e("../../utils"),o=e("reselect"),a=e("../../models/TemporaryIds"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=e("./notesConstants"),l=e("./notesUtils"),u=r.getAllNotes=(0,o.createSelector)(function(e){return e.notes},function(e){return(0,n.values)(e)}),c=(r.getNoteById=function(e,t){return e.notes[i.default.getRealId(t)]},r.getNotesbyParentId=(0,o.createSelector)(u,function(e){var t={},r={};return e.forEach(function(e){e.item_id?(r[e.item_id]||(r[e.item_id]=[]),r[e.item_id].push(e)):(t[e.project_id]||(t[e.project_id]=[]),t[e.project_id].push(e))}),{itemNotes:r,projectNotes:t}})),d=r.getItemNotes=function(e,t){return c(e).itemNotes[t]||[]},f=(r.getItemNotesSorted=function(e,t){return d(e,t).sort(l.sortByPostedTimeFn)},r.getProjectNotes=function(e,t){return c(e).projectNotes[t]||[]}),p=(r.getProjectNotesSorted=function(e,t){return f(e,t).sort(l.sortByPostedTimeFn)},r.getNotes=function(e,t,r){
return t=i.default.getRealId(t),r===s.TYPE_ITEM_NOTE?d(e,t):r===s.TYPE_PROJECT_NOTE?f(e,t):void 0});r.getNotesSorted=function(e,t,r){return p(e,t,r).sort(l.sortByPostedTimeFn)}},{"../../models/TemporaryIds":184,"../../utils":484,"./notesConstants":430,"./notesUtils":433,reselect:"reselect"}],433:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.sortByPostedTimeFn=r.deserializeNote=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("../../utils");r.deserializeNote=function(e){return n({},e,{posted:new Date(e.posted)})},r.sortByPostedTimeFn=function(e,t){return(0,o.isString)(e.posted)&&(e.posted=new Date(e.posted)),(0,o.isString)(t.posted)&&(t.posted=new Date(t.posted)),e.posted.getTime()===t.posted.getTime()?e.id-t.id:e.posted.getTime()-t.posted.getTime()}},{"../../utils":484}],434:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0}),r.projectArchive=r.projectArchivedFeteched=r.projectFetchArchived=r.projectUnarchive=r.projectMoveAndReorderUndo=r.projectMoveAndReorder=r.projectUpdateLocalFields=r.projectUpdate=r.projectRemove=r.projectAdd=r.PROJECT_UPDATE_LOCAL=r.PROJECT_UPDATE=r.PROJECT_UNARCHIVE=r.PROJECT_REMOVE=r.PROJECT_MOVE_AND_REORDER_UNDO=r.PROJECT_MOVE_AND_REORDER=r.PROJECT_ARCHIVED_FETCHED=r.PROJECT_ARCHIVE=r.PROJECT_ADD=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("../../utils"),s=e("../../utils/fp"),l=e("../utils"),u=e("../../models/SyncEngine"),c=n(u),d=e("../../models/TemporaryIds"),f=n(d),p=e("../../logger/Logger"),m=n(p),h=e("../../reducers/items"),_=r.PROJECT_ADD="PROJECT_ADD",v=r.PROJECT_ARCHIVE="PROJECT_ARCHIVE",y=r.PROJECT_ARCHIVED_FETCHED="PROJECT_ARCHIVED_FETCHED",g=r.PROJECT_MOVE_AND_REORDER="PROJECT_MOVE_AND_REORDER",b=r.PROJECT_MOVE_AND_REORDER_UNDO="PROJECT_MOVE_AND_REORDER_UNDO",w=r.PROJECT_REMOVE="PROJECT_REMOVE",E=r.PROJECT_UNARCHIVE="PROJECT_UNARCHIVE",k=r.PROJECT_UPDATE="PROJECT_UPDATE",S=r.PROJECT_UPDATE_LOCAL="PROJECT_UPDATE_LOCAL",j=(r.projectAdd=function(e){var t=e.name,r=e.color,n=void 0===r?1:r;return function(e){if(!t||""==t.trim())throw new Error("project name cannot be empty");var r=f.default.generate("project"),o={name:t.trim(),collapsed:0,color:n,id:r};return c.default.queueUpdate({type:"project_add",temp_id:o.id,args:o}),e({type:_,payload:o}),o}},r.projectRemove=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t=t.map(function(e){return f.default.getRealId(e)}),t.find(function(e){return(0,i.isRealID)(e)&&(0,l.isNonUniqueID)(e)}))return void m.default.captureMessage("Attempt to delete project with non-unique ID",{level:"error",extra:{ids:t}});var n=!0,o=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var d=s.value;c.default.queueUpdate({type:"project_delete",args:{id:d}})}}catch(e){o=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(o)throw a}}return{type:w,payload:t}},r.projectUpdate=function(e,t){return function(r){e=f.default.getRealId(e),t=a({},t),(t.hasOwnProperty("indent")||t.hasOwnProperty("item_order")||t.hasOwnProperty("parent_id")||t.hasOwnProperty("child_order"))&&(console.log("[warning] ordering structure should not be updated by PROJECT_UPDATE action"),t=(0,i.omit)(t,["indent","item_order","parent_id","child_order"])),t.name&&(t.name=t.name.trim()),c.default.queueUpdate({type:"project_update",args:a({id:e},t)}),r({type:k,payload:o({},e,t)})}},r.projectUpdateLocalFields=function(e){return{type:S,payload:e}},r.projectMoveAndReorder=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{noUndo:!1},r=t.noUndo;return function(t,n){var o=n(),i=o.projects;e=e.map((0,l.resolveTempIDFields)(["id","parend_id"]));var u=(0,s.compose)((0,s.filter)(function(e){return void 0!==e.parent_id||void 0!==e.child_order}),(0,s.map)(function(e){e=a({},e);var t=i[e.id];return t.parent_id===e.parent_id&&delete e.parent_id,t.child_order===e.child_order&&delete e.child_order,e}))(e),d=!0,f=!1,p=void 0;try{for(var m,h=u[Symbol.iterator]();!(d=(m=h.next()).done);d=!0){var _=m.value,v=_.id,y=_.parent_id;void 0!==y&&c.default.queueUpdate({type:"project_move",args:{id:v,parent_id:y}})}}catch(e){f=!0,p=e}finally{try{!d&&h.return&&h.return()}finally{if(f)throw p}}var b=(0,s.compose)((0,s.map)((0,s.pick)(["id","child_order"])),(0,s.filter)(function(e){return void 0!==e.child_order}))(u);0!==b.length&&c.default.queueUpdate({type:"project_reorder",args:{projects:b}}),u.length>0&&t({type:g,payload:{orders:u,noUndo:r}})}},r.projectMoveAndReorderUndo=function(){return function(e,t){var r=t(),n=r.undo;if(n.type===b){var o=(0,i.values)(n.projects),a=!0,l=!1,u=void 0;try{for(var d,f=o[Symbol.iterator]();!(a=(d=f.next()).done);a=!0){var p=d.value,m=p.id,h=p.parent_id;void 0!==h&&c.default.queueUpdate({type:"project_move",args:{id:m,parent_id:h}})}}catch(e){l=!0,u=e}finally{try{!a&&f.return&&f.return()}finally{if(l)throw u}}var _=o.filter(function(e){return void 0!==e.child_order}).map((0,s.pick)(["id","child_order"]));_.length>0&&c.default.queueUpdate({type:"project_reorder",args:{projects:_}}),e({type:b}),Signals.sendSignal("instant_refresh_interface")}}},r.projectUnarchive=function(e){return function(t){e.is_archived=!1,c.default.queueUpdate({type:"project_unarchive",args:{id:e.id}}),t({type:E,payload:e})}},r.projectFetchArchived=function(e){return function(t,r){var n=r().user.token;return fetch("/API/"+c.default.api_version+"/projects/get_data",{method:"post",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:"project_id="+e+"&token="+n}).then(function(e){if(200===e.status)return e.json();throw e}).then(function(e){return e.project.has_more_notes=!0,t(j(e.project)),e.items=e.items.map(function(e){return(0,h.deserializeItemFields)(e)}),e})}},r.projectArchivedFeteched=function(e){if(e=(0,i.isArray)(e)?e:[e],c.default.uniqueIdOn){var t=e.filter(function(e){return(0,i.isRealID)(e.id)&&(0,l.isNonUniqueID)(e.id)});if(t.length>0)return m.default.captureMessageWithTrace("Fetched non-unique projects",{extra:{bads:t},tags:{critical:"unique_id"}}),{type:y,payload:[]}}return{type:y,payload:e}});r.projectArchive=function(t){return function(r){return e("../../models/SyncEngine").queueUpdate({type:"project_archive",args:{id:t}}),r({type:v,payload:t})}}},{"../../logger/Logger":141,"../../models/SyncEngine":181,"../../models/TemporaryIds":184,"../../reducers/items":417,"../../utils":484,"../../utils/fp":477,"../utils":452}],435:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.projectGetTeamInbox=r.projectGetParent=r.projectGetMaxTopLevelChildOrder=r.projectGetInbox=r.projectGetFavorite=r.projectGetChildren=r.projectGetByNameSearch=r.projectGetByID=r.projectGetActiveWithIndent=r.projectGetActiveSorted=r.projectGetActive=r.PROJECT_UPDATE_LOCAL=r.PROJECT_UPDATE=r.PROJECT_UNARCHIVE=r.PROJECT_REMOVE=r.PROJECT_MOVE_AND_REORDER_UNDO=r.PROJECT_MOVE_AND_REORDER=r.PROJECT_ARCHIVED_FETCHED=r.PROJECT_ARCHIVE=r.PROJECT_ADD=r.projectUpdateLocalFields=r.projectUpdate=r.projectUnarchive=r.projectRemove=r.projectMoveAndReorderUndo=r.projectMoveAndReorder=r.projectFetchArchived=r.projectArchivedFeteched=r.projectArchive=r.projectAdd=r.projectsCases=void 0;var n=e("./reducers");Object.defineProperty(r,"projectsCases",{enumerable:!0,get:function(){return n.projectsCases}});var o=e("./actions");Object.defineProperty(r,"projectAdd",{enumerable:!0,get:function(){return o.projectAdd}}),Object.defineProperty(r,"projectArchive",{enumerable:!0,get:function(){return o.projectArchive}}),Object.defineProperty(r,"projectArchivedFeteched",{enumerable:!0,get:function(){return o.projectArchivedFeteched}}),Object.defineProperty(r,"projectFetchArchived",{enumerable:!0,get:function(){return o.projectFetchArchived}}),Object.defineProperty(r,"projectMoveAndReorder",{enumerable:!0,get:function(){return o.projectMoveAndReorder}}),Object.defineProperty(r,"projectMoveAndReorderUndo",{enumerable:!0,get:function(){return o.projectMoveAndReorderUndo}}),Object.defineProperty(r,"projectRemove",{enumerable:!0,get:function(){return o.projectRemove}}),Object.defineProperty(r,"projectUnarchive",{enumerable:!0,get:function(){return o.projectUnarchive}}),Object.defineProperty(r,"projectUpdate",{enumerable:!0,get:function(){return o.projectUpdate}}),Object.defineProperty(r,"projectUpdateLocalFields",{enumerable:!0,get:function(){return o.projectUpdateLocalFields}}),Object.defineProperty(r,"PROJECT_ADD",{enumerable:!0,get:function(){return o.PROJECT_ADD}}),Object.defineProperty(r,"PROJECT_ARCHIVE",{enumerable:!0,get:function(){return o.PROJECT_ARCHIVE}}),Object.defineProperty(r,"PROJECT_ARCHIVED_FETCHED",{enumerable:!0,get:function(){return o.PROJECT_ARCHIVED_FETCHED}}),Object.defineProperty(r,"PROJECT_MOVE_AND_REORDER",{enumerable:!0,get:function(){return o.PROJECT_MOVE_AND_REORDER}}),Object.defineProperty(r,"PROJECT_MOVE_AND_REORDER_UNDO",{enumerable:!0,get:function(){return o.PROJECT_MOVE_AND_REORDER_UNDO}}),Object.defineProperty(r,"PROJECT_REMOVE",{enumerable:!0,get:function(){return o.PROJECT_REMOVE}}),Object.defineProperty(r,"PROJECT_UNARCHIVE",{enumerable:!0,get:function(){return o.PROJECT_UNARCHIVE}}),Object.defineProperty(r,"PROJECT_UPDATE",{enumerable:!0,get:function(){return o.PROJECT_UPDATE}}),Object.defineProperty(r,"PROJECT_UPDATE_LOCAL",{enumerable:!0,get:function(){return o.PROJECT_UPDATE_LOCAL}});var a=e("./selectors");Object.defineProperty(r,"projectGetActive",{enumerable:!0,get:function(){return a.projectGetActive}}),Object.defineProperty(r,"projectGetActiveSorted",{enumerable:!0,get:function(){return a.projectGetActiveSorted}}),Object.defineProperty(r,"projectGetActiveWithIndent",{enumerable:!0,get:function(){return a.projectGetActiveWithIndent}}),Object.defineProperty(r,"projectGetByID",{enumerable:!0,get:function(){return a.projectGetByID}}),Object.defineProperty(r,"projectGetByNameSearch",{enumerable:!0,get:function(){return a.projectGetByNameSearch}}),Object.defineProperty(r,"projectGetChildren",{enumerable:!0,get:function(){return a.projectGetChildren}}),Object.defineProperty(r,"projectGetFavorite",{enumerable:!0,get:function(){return a.projectGetFavorite}}),Object.defineProperty(r,"projectGetInbox",{enumerable:!0,get:function(){return a.projectGetInbox}}),Object.defineProperty(r,"projectGetMaxTopLevelChildOrder",{enumerable:!0,get:function(){return a.projectGetMaxTopLevelChildOrder}}),Object.defineProperty(r,"projectGetParent",{enumerable:!0,get:function(){return a.projectGetParent}}),Object.defineProperty(r,"projectGetTeamInbox",{enumerable:!0,get:function(){return a.projectGetTeamInbox}});var i=function(e){return e&&e.__esModule?e:{default:e}}(n);r.default=i.default},{"./actions":434,"./reducers":436,"./selectors":437}],436:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0}),r.projectsCases=void 0;var a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s=e("../../utils"),l=e("../../utils/fp"),u=e("../load"),c=e("../../utils/deleteUndefinedProperties"),d=function(e){return e&&e.__esModule?e:{default:e}}(c),f=e("../sync"),p=e("./actions"),m=e("./selectors"),h=e("../utils"),v=e("../undo"),y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case u.LOAD_LOCAL_DATA:if(!t.payload.projects)return e;return(0,l.mapValues)(function(e){return e=i({},e),e.inbox_project&&(e.name=_("Inbox")),e.team_inbox&&(e.name=_("Team Inbox")),e},t.payload.projects);case f.SYNC_FULL_UPDATE:return(0,s.keyBy)(t.payload.projects,"id");case p.PROJECT_ADD:return i({},e,o({},t.payload.id,t.payload));case p.PROJECT_UPDATE_LOCAL:case p.PROJECT_UPDATE:var r=i({},e),n=!0,c=!1,h=void 0;try{for(var v,y=(0,s.toPairs)(t.payload)[Symbol.iterator]();!(n=(v=y.next()).done);n=!0){var g=a(v.value,2),b=g[0],w=g[1],E=r[b];E&&(E=i({},E,w),E=(0,d.default)(E),r[b]=E)}}catch(e){c=!0,h=e}finally{try{!n&&y.return&&y.return()}finally{if(c)throw h}}return r;case p.PROJECT_UNARCHIVE:var k=t.payload;return k=i({},k,{is_archived:0,parent_id:null,child_order:(0,m.projectGetMaxTopLevelChildOrder)({projects:e})+1}),i({},e,o({},k.id,k));case p.PROJECT_ARCHIVED_FETCHED:var S=(0,l.compose)(s.toIDMap,(0,l.map)(function(e){return i({},e,{_fetched_at:Date.now()})}))(t.payload);return i({},e,S);default:return e}},g=function(e){if(!e)return e;var t=!1,r=i({},e),n=Date.now(),o=!0,a=!1,l=void 0;try{for(var u,c=(0,s.values)(e)[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var d=u.value;d.is_archived&&d._fetched_at&&n-d._fetched_at>864e5&&(delete r[d.id],t=!0)}}catch(e){a=!0,l=e}finally{try{!o&&c.return&&c.return()}finally{if(a)throw l}}return t?r:e};r.default=(0,l.compose)(g,y);var b=function(e,t){e=new Set(e);var r=function(e){return(0,l.compose)(function(e){return new Set(e)},(0,l.map)(function(e){return e.id}),(0,l.filter)(e),s.values)},n=r(function(t){return e.has(t.project_id)})(t.items),o=r(function(t){return!t.item_id?e.has(t.project_id):n.has(t.item_id)})(t.notes),a=r(function(e){return n.has(e.item_id)})(t.reminders),i=r(function(t){return e.has(t.project_id)})(t.sections);return{items:n,notes:o,reminders:a,sections:i}},w=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.includeSubprojects;if(void 0!==o&&o){var a=(0,l.compose)((0,l.map)(function(e){return e.id}),l.flatten,(0,l.map)(function(e){return(0,m.projectGetChildren)(e,t)}))(e);e=new Set([].concat(n(e),n(a)))}else e=new Set(e);var i=b(e,t),s=i.items,u=i.notes,c=i.reminders,d=i.sections;return(0,l.compose)((0,h.removeFromSlice)("projects",e),(0,h.removeFromSlice)("sections",d),(0,h.removeFromSlice)("items",s),(0,h.removeFromSlice)("notes",u),(0,h.removeFromSlice)("reminders",c))(t)},E=(r.projectsCases=function(e,t){switch(t.type){case p.PROJECT_MOVE_AND_REORDER:var r=t.payload,n=r.orders,o=r.noUndo,a=i({},e.projects),u={},c=!0,d=!1,m=void 0;try{for(var y,g=n[Symbol.iterator]();!(c=(y=g.next()).done);c=!0){var b=y.value,k=b.id,S=b.parent_id,j=b.child_order,T=i({},a[k]);u[k]={id:k},void 0!==S&&(u[k].parent_id=T.parent_id,T.parent_id=S),void 0!==j&&(u[k].child_order=T.child_order,T.child_order=j),a[k]=T}}catch(e){d=!0,m=e}finally{try{!c&&g.return&&g.return()}finally{if(d)throw m}}var O=i({},e,{projects:a});return o||(O=(0,v.setUndo)({type:p.PROJECT_MOVE_AND_REORDER_UNDO,projects:u},O)),O;case p.PROJECT_MOVE_AND_REORDER_UNDO:var I=(0,l.merge)(e.projects,e.undo.projects);return i({},e,{projects:I,undo:null});case p.PROJECT_ARCHIVE:var P=t.payload,C=e.projects[P],D=w([P],e,{includeSubprojects:!0});return D=(0,v.pushMessage)((0,s.format)(_("{project_name} archived"),{project_name:C.name}),D);case p.PROJECT_REMOVE:var A=t.payload;return w(A,e,{includeSubprojects:!1});case f.SYNC_UPDATE:var M=t.payload,x=M.projects,R=M.temp_id_mapping;if(R&&(e=i({},e,{projects:(0,h.resolveTempID)(e.projects,R)}),e=E(e,t.payload)),!x)return e;e=i({},e,{projects:(0,h.mergeSyncUpdate)(e.projects,x)});var N=(0,l.compose)((0,l.map)(function(e){return e.id}),(0,l.filter)(function(e){return e.is_deleted||e.is_archived}))(x);return e=w(N,e,{includeSubprojects:!1})}return e},function(e,t){try{var r=e.undo;if(!r)return e;var n=t.temp_id_mapping;switch(r.type){case p.PROJECT_MOVE_AND_REORDER_UNDO:var o=r.projects;return o=(0,l.compose)((0,l.mapValues)(function(e){return i({},e,{parent_id:n[e.parent_id]||e.parent_id})}),(0,l.mapKeys)(function(e){return n[e]||e}))(o),i({},e,{undo:i({},r,{projects:o})});default:return e}}catch(t){return e}})},{"../../utils":484,"../../utils/deleteUndefinedProperties":469,"../../utils/fp":477,"../load":425,"../sync":447,"../undo":449,"../utils":452,"./actions":434,"./selectors":437}],437:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){e=e.toLowerCase().trim();var r=(0,p.createSelector)(function(e){return e.projects},function(t){return""===e?[]:(0,s.compose)((0,i.map)(function(e){return e.p}),(0,i.sortBy)(["i","p.item_order","p.id"]),(0,i.filter)(function(e){return-1!==e.i}),(0,i.map)(function(t){return{i:(0,f.default)(e,t.name),p:t}}),(0,i.filter)(function(e){return!e.is_archived}),a.values)(t)});return 1===arguments.length?r:r(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.projectGetMaxTopLevelChildOrder=r.projectGetFavorite=r.projectGetParent=r.projectGetChildren=r.projectGetActiveWithIndent=r.projectGetActiveSorted=r.projectGetActive=r.projectGetTeamInbox=r.projectGetInbox=r.projectGetByID=void 0,r.projectGetByNameSearch=o;var a=e("../../utils"),i=e("../../utils/fp"),s=e("redux"),l=e("../utils"),u=e("../../models/TemporaryIds"),c=n(u),d=e("../../utils/partialMatchIndex"),f=n(d),p=e("reselect"),m=(r.projectGetByID=function(e,t){return t=c.default.getRealId(t),e.projects[t]},r.projectGetInbox=function(e){return e.projects[e.user.inbox_project]},r.projectGetTeamInbox=function(e){return e.projects[e.user.team_inbox]},r.projectGetActive=(0,p.createSelector)(function(e){return e.projects},(0,i.filter)(function(e){return!e.is_archived}))),h=(0,p.createSelector)(m,(0,i.groupBy)("parent_id")),_=r.projectGetActiveSorted=(0,p.createSelector)(h,function(e){return(0,l.descendentsSorted)(null,e)});r.projectGetActiveWithIndent=(0,p.createSelector)(h,function(e){return(0,l.annotateIndentOrder)((0,l.descendentsSorted)(null,e))}),r.projectGetChildren=function(e,t){return(0,l.descendentsSorted)(e,h(t))},r.projectGetParent=function(e,t){var r=e.projects[t];return e.projects[r.parent_id]},r.projectGetFavorite=(0,p.createSelector)(_,(0,i.filter)(function(e){return e.is_favorite})),r.projectGetMaxTopLevelChildOrder=(0,p.createSelector)(_,(0,s.compose)((0,i.getOr)(1,"child_order"),i.last,(0,i.filter)(function(e){return null===e.parent_id})))},{"../../models/TemporaryIds":184,"../../utils":484,"../../utils/fp":477,"../../utils/partialMatchIndex":499,"../utils":452,redux:"redux",reselect:"reselect"}],438:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getRemindersByItemID=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("../utils/fp"),a=e("../reducers/modelbridge"),i=e("./items/actions"),s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case a.MODEL_BRIDGE_UPDATE:var r=t.payload.reminders;return r?n({},r):e;case i.ITEM_COMPLETE_RECURRING:var s=t.payload.id,l=(0,o.values)(e).filter(function(e){return e.item_id===s&&e.lprocessed});return 0===l.length?e:(l=(0,o.compose)(o.byID,(0,o.map)((0,o.omit)("lprocessed")))(l),n({},e,l));default:return e}};r.getRemindersByItemID=function(e,t){return(0,o.compose)((0,o.filter)(function(t){return t.item_id===e}),o.values,(0,o.get)("reminders"))(t)};r.default=s},{"../reducers/modelbridge":427,"../utils/fp":477,"./items/actions":416}],439:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("redux"),a=e("./user"),i=n(a),s=e("./items"),l=n(s),u=e("./projects"),c=n(u),d=e("./filters"),f=n(d),p=e("./labels"),m=n(p),h=e("./notes"),_=n(h),v=e("./reminders"),y=n(v),g=e("./tooltip"),b=n(g),w=e("./mainView"),E=n(w),k=e("./collaborators"),S=n(k),j=e("./stats"),T=n(j),O=e("./clock"),I=n(O),P=e("./settings"),C=n(P),D=e("./uniqueIDCheck"),A=n(D),M=e("./undo"),x=n(M),R=e("./dateistLangs"),N=n(R),$=e("./detailView"),L=n($),U=e("./sections"),V=n(U),F=(0,o.combineReducers)({user:i.default,notes:_.default,reminders:y.default,items:l.default,sections:V.default,projects:c.default,labels:m.default,filters:f.default,collaborators:S.default,tooltip:b.default,mainView:E.default,detailView:L.default,stats:T.default,settings:C.default,clock:I.default,undo:x.default,dateistLangs:N.default});r.default=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e,r){return t.reduce(function(e,t){return t(e,r)},e)}}(F,h.notesCaseReducer,s.itemsCaseReducer,U.sectionsCaseReducer,u.projectsCases,A.default)},{"./clock":406,"./collaborators":407,"./dateistLangs":409,"./detailView":410,"./filters":412,"./items":417,"./labels":422,"./mainView":426,"./notes":428,"./projects":435,"./reminders":438,"./sections":441,"./settings":445,"./stats":446,"./tooltip":448,"./undo":449,"./uniqueIDCheck":450,"./user":451,redux:"redux"}],440:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.sectionReorderUndo=r.sectionReorder=r.sectionMoveUndo=r.sectionMove=r.sectionUpdate=r.sectionArchive=r.sectionRemove=r.sectionAdd=r.SECTION_UPDATE=r.SECTION_REOREDER_UNDO=r.SECTION_REOREDER=r.SECTION_REMOVE=r.SECTION_MOVE_UNDO=r.SECTION_MOVE=r.SECTION_ARCHIVE=r.SECTION_ADD=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=e("../../models/TemporaryIds"),i=n(a),s=e("../../models/SyncEngine"),l=n(s),u=e("../../utils"),c=e("../utils"),d=e("./selectors"),f=r.SECTION_ADD="SECTION_ADD",p=r.SECTION_ARCHIVE="SECTION_ARCHIVE",m=r.SECTION_MOVE="SECTION_MOVE",h=r.SECTION_MOVE_UNDO="SECTION_MOVE_UNDO",_=r.SECTION_REMOVE="SECTION_REMOVE",v=r.SECTION_REOREDER="SECTION_REOREDER",y=r.SECTION_REOREDER_UNDO="SECTION_REOREDER_UNDO",g=r.SECTION_UPDATE="SECTION_UPDATE";r.sectionAdd=function(e){return function(t){var r=o({id:i.default.generate("section"),date_added:(0,u.toISODateString)(new Date,{toUTC:!0})},e);return l.default.queueUpdate({type:"section_add",temp_id:r.id,args:r}),t({type:f,payload:r}),r}},r.sectionRemove=function(e){return function(t){e=i.default.getRealId(e),l.default.queueUpdate({type:"section_delete",args:{id:e}}),t({type:_,payload:e}),Signals.sendSignal("instant_refresh_interface")}},r.sectionArchive=function(e){return function(t){e=i.default.getRealId(e),l.default.queueUpdate({type:"section_archive",args:{id:e,date_archived:(0,u.toISODateString)(new Date,{toUTC:!0})}}),t({type:p,payload:e}),Signals.sendSignal("instant_refresh_interface")}},r.sectionUpdate=function(e){return e=o({},e,{id:i.default.getRealId(e.id)}),l.default.queueUpdate({type:"section_update",args:e}),{type:g,payload:e}},r.sectionMove=function(e){return function(t,r){var n=r();e=(0,c.resolveTempIDFields)(["id","project_id"],e),l.default.queueUpdate({type:"section_move",args:e}),e.section_order=(0,d.sectionGetMaxOrder)(e.project_id,n)+1,l.default.queueUpdate({type:"section_reorder",args:{sections:[{id:e.id,section_order:e.section_order}]}}),t({type:m,payload:e}),Signals.sendSignal("instant_refresh_interface")}},r.sectionMoveUndo=function(){return function(e,t){var r=t();if(r.undo.type===h){var n=r.undo.section,o=n.id,a=n.section_order,i=n.project_id;l.default.queueUpdate({type:"section_move",args:{id:o,project_id:i}}),l.default.queueUpdate({type:"section_reorder",args:{sections:[{id:o,section_order:a}]}}),e({type:h}),Signals.sendSignal("instant_refresh_interface")}}},r.sectionReorder=function(e){return function(t,r){e=e.map((0,c.resolveTempIDFields)("id"));var n=r(),o=n.sections;if(e=e.filter(function(e){var t=e.id,r=e.section_order;return o[t].section_order!==r}),0!==e.length)return l.default.queueUpdate({type:"section_reorder",args:{sections:e}}),t({type:v,payload:e})}},r.sectionReorderUndo=function(){return function(e,t){var r=t(),n=r.undo,o=r.sections;if(n.type===y){var a=n.orders;a=a.filter(function(e){var t=e.id,r=e.section_order;return o[t].section_order!==r}),0!==a.length&&(l.default.queueUpdate({type:"section_reorder",args:{sections:a}}),e({type:y,payload:a}),Signals.sendSignal("instant_refresh_interface"))}}}},{"../../models/SyncEngine":181,"../../models/TemporaryIds":184,"../../utils":484,"../utils":452,"./selectors":443}],441:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.sectionsCaseReducer=r.sectionGetMaxOrder=r.sectionGetByPID=r.sectionUpdate=r.sectionReorderUndo=r.sectionReorder=r.sectionRemove=r.sectionMoveUndo=r.sectionMove=r.sectionArchive=r.sectionAdd=r.SECTION_UPDATE=r.SECTION_REOREDER_UNDO=r.SECTION_REMOVE=r.SECTION_MOVE_UNDO=r.SECTION_MOVE=r.SECTION_ARCHIVE=r.SECTION_ADD=void 0;var n=e("./actions");Object.defineProperty(r,"SECTION_ADD",{enumerable:!0,get:function(){return n.SECTION_ADD}}),Object.defineProperty(r,"SECTION_ARCHIVE",{enumerable:!0,get:function(){return n.SECTION_ARCHIVE}}),Object.defineProperty(r,"SECTION_MOVE",{enumerable:!0,get:function(){return n.SECTION_MOVE}}),Object.defineProperty(r,"SECTION_MOVE_UNDO",{enumerable:!0,get:function(){return n.SECTION_MOVE_UNDO}}),Object.defineProperty(r,"SECTION_REMOVE",{enumerable:!0,get:function(){return n.SECTION_REMOVE}}),Object.defineProperty(r,"SECTION_REOREDER_UNDO",{enumerable:!0,get:function(){return n.SECTION_REOREDER_UNDO}}),Object.defineProperty(r,"SECTION_UPDATE",{enumerable:!0,get:function(){return n.SECTION_UPDATE}}),Object.defineProperty(r,"sectionAdd",{enumerable:!0,get:function(){return n.sectionAdd}}),Object.defineProperty(r,"sectionArchive",{enumerable:!0,get:function(){return n.sectionArchive}}),Object.defineProperty(r,"sectionMove",{enumerable:!0,get:function(){return n.sectionMove}}),Object.defineProperty(r,"sectionMoveUndo",{enumerable:!0,get:function(){return n.sectionMoveUndo}}),Object.defineProperty(r,"sectionRemove",{enumerable:!0,get:function(){return n.sectionRemove}}),Object.defineProperty(r,"sectionReorder",{enumerable:!0,get:function(){return n.sectionReorder}}),Object.defineProperty(r,"sectionReorderUndo",{enumerable:!0,get:function(){return n.sectionReorderUndo}}),Object.defineProperty(r,"sectionUpdate",{enumerable:!0,get:function(){return n.sectionUpdate}});var o=e("./selectors");Object.defineProperty(r,"sectionGetByPID",{enumerable:!0,get:function(){return o.sectionGetByPID}}),Object.defineProperty(r,"sectionGetMaxOrder",{enumerable:!0,get:function(){return o.sectionGetMaxOrder}});var a=e("./reducers");Object.defineProperty(r,"sectionsCaseReducer",{enumerable:!0,get:function(){return a.sectionsCaseReducer}});var i=function(e){return e&&e.__esModule?e:{default:e}}(a);r.default=i.default},{"./actions":440,"./reducers":442,"./selectors":443}],442:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0}),r.sectionsCaseReducer=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("../../utils/fp"),s=e("../../utils"),l=e("../load"),u=e("../sync"),c=e("./actions"),d=e("../utils"),f=e("../undo"),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case l.LOAD_LOCAL_DATA:var r=t.payload.sections;return r?(0,i.mapValues)(m)(r):e;case u.SYNC_FULL_UPDATE:var n=t.payload.sections;return n?(0,i.compose)(s.toIDMap,(0,i.map)(m))(n):e;case c.SECTION_ADD:return a({},e,o({},t.payload.id,t.payload));case c.SECTION_UPDATE:var d=t.payload,f=e[d.id];return a({},e,o({},f.id,a({},f,d)));default:return e}};r.default=p;var m=(r.sectionsCaseReducer=function(e){return function(t,r){var n=e(t,r);if(void 0===t||t.sections===n.sections)return n;var o=(0,i.compose)((0,i.map)(function(e){return e.id}),(0,i.filter)(function(e){return e.is_archived||e.is_deleted}),(0,i.get)("sections"))(n);return _(o,n)}}(function(e,t){switch(t.type){case c.SECTION_ARCHIVE:case c.SECTION_REMOVE:var r=t.payload,n=(0,d.updateObjects)(r,{is_archived:!0},e.sections);return a({},e,{sections:n});case c.SECTION_MOVE:var l=t.payload,p=l.id,h=l.project_id,_=l.section_order,g=e.sections,b=g[p],w=a({},b,{project_id:h,section_order:_}),E=a({},e,{sections:a({},g,o({},p,w))});return E=v([p],E),E=(0,f.setUndo)({type:c.SECTION_MOVE_UNDO,section:b,destProject:e.projects[h]},E);case c.SECTION_MOVE_UNDO:var k=e.undo.section,S=k.id,j=k.project_id,T=k.section_order,O=e.sections,I=O[S],P=a({},I,{project_id:j,section_order:T}),C=a({},e,{sections:a({},O,o({},S,P)),undo:null});return C=v([S],C);case u.SYNC_UPDATE:var D=t.payload,A=D.temp_id_mapping,M=D.sections,x=a({},e);if(A&&(x.sections=(0,d.resolveTempID)(x.sections,A),x=y(x,A)),!M||0==M.length)return x;M=(0,i.compose)(s.toIDMap,(0,i.map)(m))(M),x.sections=a({},x.sections,M);var R=(0,i.compose)((0,i.map)(function(e){return e.id}),(0,i.filter)(function(e){return M[e.id].project_id!==e.project_id}),i.values,(0,i.pick)((0,s.keys)(M)),(0,i.get)("sections"))(e);return R.length>0&&(x=v(R,x)),x;case c.SECTION_REOREDER:var N=t.payload,$=N.map(function(t){var r=t.id;return{id:r,section_order:e.sections[r].section_order}}),L=a({},e);return L.sections=(0,i.merge)(L.sections,(0,i.byID)(N)),L=(0,f.setUndo)({type:c.SECTION_REOREDER_UNDO,orders:$},L);case c.SECTION_REOREDER_UNDO:var U=e.undo.orders;return a({},e,{sections:(0,i.merge)(e.sections,(0,i.byID)(U)),undo:null})}return e}),function(e){return a({},e,{date_added:new Date(e.date_added)})}),h=function(e,t){e=new Set(e);var r=function(e){return(0,i.compose)(function(e){return new Set(e)},(0,i.map)(function(e){return e.id}),(0,i.filter)(e),i.values)},o=r(function(t){return e.has(t.section_id)})(t.items),a=r(function(e){return o.has(e.item_id)})(t.notes),s=r(function(e){return o.has(e.item_id)})(t.reminders);return(0,i.mapValues)(function(e){return[].concat(n(e))},{items:o,notes:a,reminders:s})},_=function(e,t){e=new Set(e);var r=h(e,t),n=r.items,o=r.notes,a=r.reminders;return(0,i.compose)((0,d.removeFromSlice)("sections",e),(0,d.removeFromSlice)("items",n),(0,d.removeFromSlice)("notes",o),(0,d.removeFromSlice)("reminders",a))(t)},v=function(e,t){var r=h(e,t),n=r.items,o=r.notes;return n=(0,i.compose)(s.toIDMap,(0,i.map)(function(e){return a({},e,{project_id:t.sections[e.section_id].project_id})}),(0,i.map)(function(e){return t.items[e]}))(n),o=(0,i.compose)(s.toIDMap,(0,i.map)(function(e){return a({},e,{project_id:n[e.item_id].project_id})}),(0,i.map)(function(e){return t.notes[e]}))(o),a({},t,{items:a({},t.items,n),notes:a({},t.notes,o)})},y=function(e,t){var r=e.undo;if(!r)return e;switch(r.type){case c.SECTION_MOVE_UNDO:var n=r.section;return n=(0,d.resolveTempIDPaths)(["id","project_id"],t,n),a({},e,{undo:a({},r,{section:n})});case c.SECTION_REOREDER_UNDO:var o=r.orders;return o=o.map((0,d.resolveTempIDPaths)(["id"],t)),a({},e,{undo:a({},r,{orders:o})});default:return e}}},{"../../utils":484,"../../utils/fp":477,"../load":425,"../sync":447,"../undo":449,"../utils":452,"./actions":440}],443:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.sectionGetMaxOrder=r.sectionGetByPID=void 0;var n=e("../../utils/fp");r.sectionGetByPID=function(e){return(0,n.compose)((0,n.sortBy)("section_order"),(0,
n.filter)(function(t){return t.project_id===e}),n.values,(0,n.get)("sections"))},r.sectionGetMaxOrder=function(e,t){return(0,n.compose)(function(e){return e||0},n.last,(0,n.sortBy)(function(e){return e}),(0,n.map)(function(e){return e.section_order}),(0,n.filter)(function(t){return t.project_id===e}),n.values,(0,n.get)("sections"))(t)}},{"../../utils/fp":477}],444:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.sortedProjects=r.dataLoaded=void 0;var o=e("../utils"),a=e("../utils/fp");r.dataLoaded=function(e){return e.user&&e.items&&e.projects},r.sortedProjects=function(e){var t=e.projects,r=t,i=(0,a.compose)((0,a.groupBy)("parent_id"),o.values)(t);return function e(t){var o=r[t],s=i[t];if(!s||0===s.length)return[o];var l=(0,a.compose)(a.flatten,(0,a.map)(function(t){return e(t.id)}),(0,a.sortBy)("child_order"))(s);return null===t?l:[o].concat(n(l))}(null)}},{"../utils":484,"../utils/fp":477}],445:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getTheme=void 0;var n=e("../utils/fp"),o=e("./load"),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];if(t.type===o.LOAD_LOCAL_DATA){var r=t.payload["settings.theme"];return 0===r||r?{theme:r}:e}return e};r.getTheme=function(e){var t=$queryArgument("theme");if(t)try{return parseInt(t)}catch(e){}var r=(0,n.get)("settings.theme",e);return 0===r||r?r:(0,n.get)("user.theme",e)};r.default=a},{"../utils/fp":477,"./load":425}],446:[function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0}),r.totalCompleted=r.weekGoal=r.completedThisWeek=r.dailyGoal=r.completedToday=r.removeOldWeekItems=r.removeOldDayItems=r.thisWeek=r.weekItemsKey=r.today=r.resetThisWeekCount=r.resetTodayCount=r.fetchStats=void 0;var o=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=e("../utils"),s=e("../utils/fp"),l=e("redux"),u=e("./load"),c=e("../reducers/sync"),d=e("../reducers/items"),f=e("./higherorder/catchAndLogError"),p=function(e){return e&&e.__esModule?e:{default:e}}(f),m=(r.fetchStats=function(){return function(e){return fetch("/API/v7.4/completed/get_stats?as_karma_graph=0",{credentials:"include"}).then(function(e){if(200!=e.status){var t=new Error(e.statusText);throw t.jsonRes=e,t}return e.json()}).then(function(t){return e({type:"STATS_FETCHED",payload:t}),t})}},r.resetTodayCount=function(e){return{type:"STATS_RESET_TODAY_COUNT",payload:e}},r.resetThisWeekCount=function(e){return{type:"STATS_RESET_THIS_WEEK_COUNT",payload:e}},r.today=function(){return(0,i.toISODateString)(new Date,{dateOnly:!0})}),h=function(e){var t=new Date(e);return t.setDate(e.getDate()+(1-e.getDay()-7)%7),t},_=r.weekItemsKey=function(e){var t=h(e),r=new Date(e);return r.setDate(t.getDate()+6),t=(0,i.toISODateString)(t,{dateOnly:!0}),r=(0,i.toISODateString)(r,{dateOnly:!0}),t+"/"+r},v=r.thisWeek=function(){return _(new Date)},y=function(e,t,r){var o=e[t];return o||(o={total_completed:0,date:t}),o=a({},o,{total_completed:Math.max(o.total_completed+r,0)}),a({},e,n({},t,o))},g=function(e,t,r){var i=e[t];if(!i){var s=t.split("/"),l=o(s,2);i={total_completed:0,from:l[0],to:l[1]}}return i=a({},i,{total_completed:Math.max(i.total_completed+r,0)}),a({},e,n({},t,i))},b=r.removeOldDayItems=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,r=[0,1,2,3,4,5,6].map(function(e){var r=new Date(t);return r.setDate(t.getDate()-e),(0,i.toISODateString)(r,{dateOnly:!0})});return(0,i.keys)(e).find(function(e){return-1===r.indexOf(e)})?(0,s.pick)(r,e):e},w=r.removeOldWeekItems=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,r=[0,1,2,3].map(function(e){var r=new Date(t);return r.setDate(r.getDate()-7*e),_(r)});return(0,i.keys)(e).find(function(e){return-1===r.indexOf(e)})?(0,s.pick)(r,e):e},E=(0,l.compose)((0,s.keyBy)("date"),(0,s.map)((0,s.pick)(["total_completed","date"]))),k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],r=arguments[2];switch(t.type){case u.LOAD_LOCAL_DATA:var l=t.payload.stats;if(!l)return e;return(0,i.mapValues)(l.days_items,function(e){return e.goal_first_reached_at?a({},e,{goal_first_reached_at:new Date(e.goal_first_reached_at)}):e});case"STATS_FETCHED":return E(t.payload.days_items);case c.SYNC_FULL_UPDATE:case c.SYNC_UPDATE:var f=(0,s.get)("stats.days_items")(t.payload);if(!f)return e;f=E(f);var p=a({},e),h=!1,_=!0,v=!1,g=void 0;try{for(var b,w=(0,s.toPairs)(f)[Symbol.iterator]();!(_=(b=w.next()).done);_=!0){var k=o(b.value,2),S=k[0],j=k[1];(0,s.get)(S+".total_completed")(e)!==j.total_completed&&(p[S]=a({},p[S],j),h=!0)}}catch(e){v=!0,g=e}finally{try{!_&&w.return&&w.return()}finally{if(v)throw g}}return h?p:e;case d.ITEM_COMPLETE:case d.ITEM_COMPLETE_RECURRING:var T=y(e,m(),1),O=(0,s.getOr)(0,m()+".total_completed",e)<r,I=(0,s.getOr)(0,m()+".total_completed",T)>=r;return!(0,s.get)(m()+".goal_first_reached_at",T)&&O&&I&&(T[m()].goal_first_reached_at=new Date),T;case d.ITEM_UNCOMPLETE:case d.ITEM_COMPLETE_UNDO:case d.ITEM_COMPLETE_RECURRING_UNDO:return y(e,m(),-1);case"STATS_RESET_TODAY_COUNT":var P=t.payload,C=e[m()];return C?(C=a({},C,{total_completed:P}),delete C.goal_first_reached_at,a({},e,n({},m(),C))):e;default:return e}},S=(0,l.compose)((0,s.keyBy)(function(e){return e.from+"/"+e.to}),(0,s.map)((0,s.pick)(["total_completed","to","from"]))),j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],r=arguments[2];switch(t.type){case u.LOAD_LOCAL_DATA:var l=t.payload.stats;if(!l)return e;return(0,i.mapValues)(l.week_items,function(e){return e.goal_first_reached_at?a({},e,{goal_first_reached_at:new Date(e.goal_first_reached_at)}):e});case"STATS_FETCHED":return S(t.payload.week_items);case c.SYNC_FULL_UPDATE:case c.SYNC_UPDATE:var f=(0,s.get)("stats.week_items")(t.payload);if(!f)return e;f=S(f);var p=a({},e),m=!1,h=!0,_=!1,y=void 0;try{for(var b,w=(0,s.toPairs)(f)[Symbol.iterator]();!(h=(b=w.next()).done);h=!0){var E=o(b.value,2),k=E[0],j=E[1];(0,s.get)(k+".total_completed")(e)!==j.total_completed&&(p[k]=a({},p[k],j),m=!0)}}catch(e){_=!0,y=e}finally{try{!h&&w.return&&w.return()}finally{if(_)throw y}}return m?p:e;case d.ITEM_COMPLETE:case d.ITEM_COMPLETE_RECURRING:var T=v(),O=g(e,T,1),I=(0,s.getOr)(0,T+".total_completed",e)<r,P=(0,s.getOr)(0,T+".total_completed",O)>=r;return!(0,s.get)(T+".goal_first_reached_at",O)&&I&&P&&(O[T].goal_first_reached_at=new Date),O;case d.ITEM_UNCOMPLETE:case d.ITEM_COMPLETE_UNDO:case d.ITEM_COMPLETE_RECURRING_UNDO:return g(e,v(),-1);case"STATS_RESET_THIS_WEEK_COUNT":var C=t.payload,D=e[v()];return D?(D=a({},D,{total_completed:C}),delete D.goal_first_reached_at,a({},e,n({},v(),D))):e;default:return e}},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{daily_goal:1,ignore_days:[]},t=arguments[1];switch(t.type){case u.LOAD_LOCAL_DATA:var r=t.payload.stats;return r?r.goals:e;case"STATS_FETCHED":var n=t.payload.goals.daily_goal,o=t.payload.goals.ignore_days,a=t.payload.goals.weekly_goal;return n===e.daily_goal&&a===e.weekly_goal&&(0,i.isEqual)(o,e.ignore_days)?e:{daily_goal:n,ignore_days:o,weekly_goal:a};case c.SYNC_FULL_UPDATE:case c.SYNC_UPDATE:var s=t.payload.user;if(!s)return e;var l=s.daily_goal,d=s.weekly_goal,f=s.ignore_days;return l===e.daily_goal&&d===e.weekly_goal&&(0,i.isEqual)(f,e.ignore_days)?e:{daily_goal:l,ignore_days:f,weekly_goal:d};default:return e}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments[1];switch(t.type){case u.LOAD_LOCAL_DATA:if(!t.payload.user&&!t.payload.stats)return e;var r=(0,s.get)("user.completed_count")(t.payload);return r||(0,s.getOr)(0,"stats.completed_count")(t.payload);case"STATS_FETCHED":return t.payload.completed_count;case c.SYNC_FULL_UPDATE:case c.SYNC_UPDATE:var n=(0,s.get)("stats.completed_count")(t.payload);return n||e;case d.ITEM_COMPLETE:case d.ITEM_COMPLETE_RECURRING:return e+1;case d.ITEM_UNCOMPLETE:case d.ITEM_COMPLETE_UNDO:case d.ITEM_COMPLETE_RECURRING_UNDO:return e-1;default:return e}},I=function(e,t){var r=e&&e.goals,n=e&&e.days_items,o=e&&e.week_items,a=e&&e.completed_count;return r=T(r,t),n=k(n,t,r.daily_goal),o=j(o,t,r.weekly_goal),a=O(a,t),e?e.goals===r&&e.days_items===n&&e.week_items===o&&e.completed_count===a?e:(n=b(n),o=w(o),{days_items:n,week_items:o,goals:r,completed_count:a}):{days_items:n,week_items:o,goals:r,completed_count:a}};r.default=(0,p.default)(I,{tags:{reducer:"stats"}});r.completedToday=function(e){return(0,s.getOr)(0,"stats.days_items."+m()+".total_completed",e)},r.dailyGoal=function(e){return(0,s.get)("stats.goals.daily_goal",e)},r.completedThisWeek=function(e){return(0,s.getOr)(0,"stats.week_items."+v()+".total_completed",e)},r.weekGoal=function(e){return(0,s.get)("stats.goals.weekly_goal",e)},r.totalCompleted=function(e){return(0,s.getOr)(0,"stats.completed_count",e)}},{"../reducers/items":417,"../reducers/sync":447,"../utils":484,"../utils/fp":477,"./higherorder/catchAndLogError":415,"./load":425,redux:"redux"}],447:[function(e,t,r){"use strict";function n(e){return{type:i,payload:e}}function o(e){return{type:a,payload:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.receiveSyncUpdate=n,r.receiveFullSyncUpdate=o;var a=r.SYNC_FULL_UPDATE="SYNC_FULL_UPDATE",i=r.SYNC_UPDATE="SYNC_UPDATE"},{}],448:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(){return i(g,b),E(g)}function a(){return i(g,w),E(g)}function i(e,t){fetch("/API/v6/tooltips/mark_event?token="+window.User.token+"&name="+e+"&event="+t).catch(function(e){p.captureError(e)})}function s(e,t){var r=(0,h.createSelector)(T,function(t){return null===t||-1!==t.indexOf(e)});return 1===arguments.length?r:arguments.length>1?r(arguments[1]):void 0}function l(e,t){var r=(0,h.createSelector)(O,function(t){return null!==t&&-1!==t.indexOf(e)});return 1===arguments.length?r:arguments.length>1?r(arguments[1]):void 0}Object.defineProperty(r,"__esModule",{value:!0}),r.markUnseen=r.markSeen=r.scheduledUpdated=r.seenUpdated=r.EVENT_CLOSE=r.EVENT_FOLLOW=r.EVENT_PREMIUM_EXPIRING_CLOSE=r.EVENT_PREMIUM_EXPIRING_FOLLOW=r.EVENT_PREMIUM_TRIAL_CLOSE=r.EVENT_PREMIUM_TRIAL_FOLLOW=r.TOOLTIP_GOOGLE_ASSISTANT=r.TOOLTIP_CHECKBOX_PRIORITY=r.TOOLTIP_EMPTY_STATE_NEXT_7DAYS=r.TOOLTIP_EMPTY_STATE_INBOX=r.TOOLTIP_DARK_THEME=r.TOOLTIP_FIRST_TASK_COMPLETED=r.TOOLTIP_COMPLETE_FIRST_TASK=r.TOOLTIP_PREMIUM_EXPIRING=r.TOOLTIP_PREMIUM_TRIAL=r.TOOLTIP_SHARING=r.TOOLTIP_SMART_SCHEDULE=r.TOOLTIP_MARK_UNSEEN=r.TOOLTIP_RECEIVED_UPDATE=r.TOOLTIP_MARK_AS_SEEN=r.TOOLTIP_UPDATED=void 0,r.acceptPremiumTrial=o,r.rejectPremiumTrial=a,r.markEvent=i,r.hasSeen=s,r.isScheduled=l;var u=e("../utils"),c=e("../utils/fp"),d=e("redux"),f=e("../logger/Logger"),p=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(f),m=e("./load"),h=e("reselect"),_=r.TOOLTIP_UPDATED="TOOLTIP_UPDATED",v=r.TOOLTIP_MARK_AS_SEEN="TOOLTIP_MARK_AS_SEEN",y=(r.TOOLTIP_RECEIVED_UPDATE="TOOLTIP_RECEIVED_UPDATE",r.TOOLTIP_MARK_UNSEEN="TOOLTIP_MARK_UNSEEN"),g=(r.TOOLTIP_SMART_SCHEDULE="smart_schedule",r.TOOLTIP_SHARING="sharing",r.TOOLTIP_PREMIUM_TRIAL="premium_trial"),b=(r.TOOLTIP_PREMIUM_EXPIRING="premium_expiring",r.TOOLTIP_COMPLETE_FIRST_TASK="web_complete_first_task",r.TOOLTIP_FIRST_TASK_COMPLETED="web_first_task_completed",r.TOOLTIP_DARK_THEME="dark_theme",r.TOOLTIP_EMPTY_STATE_INBOX="empty_state_inbox_first",r.TOOLTIP_EMPTY_STATE_NEXT_7DAYS="empty_state_next7days_first",r.TOOLTIP_CHECKBOX_PRIORITY="checkboxes_priority",r.TOOLTIP_GOOGLE_ASSISTANT="assistant_intro",r.EVENT_PREMIUM_TRIAL_FOLLOW="follow"),w=r.EVENT_PREMIUM_TRIAL_CLOSE="close",E=(r.EVENT_PREMIUM_EXPIRING_FOLLOW="follow",r.EVENT_PREMIUM_EXPIRING_CLOSE="close",r.EVENT_FOLLOW="follow",r.EVENT_CLOSE="close",r.seenUpdated=function(e){return{type:_,payload:{seen:e}}},r.scheduledUpdated=function(e){return{type:_,payload:{scheduled:e}}},r.markSeen=function(e,t){return function(r,n){return r({type:v,payload:e}),t&&i(e,t),fetch("/API/v6/tooltips/mark_as_seen?token="+n().user.token+"&name="+e).catch(function(){})}}),k=(r.markUnseen=function(e){return function(t,r){return t({type:y,payload:e}),fetch("/API/v6/tooltips/reset_seen?token="+r().user.token+"&name="+e)}},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case m.LOAD_LOCAL_DATA:return t.payload["tooltip.seen"]||e;case _:var r=t.payload.seen;if(void 0===r)return e;if(null===e)return r;var o=(0,c.difference)(r,e);return 0===o.length?e:[].concat(n(e),n(o));case v:if(null===e)return e;var a=t.payload;return(0,u.uniq)([].concat(n(e),[a]));case y:return null===e?e:(0,u.without)(e,t.payload);default:return e}}),S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case m.LOAD_LOCAL_DATA:return t.payload["tooltip.scheduled"]||e;case _:var r=t.payload.scheduled;if(void 0===r)return e;if(null===e)return r;var o=(0,c.difference)(r,e);return 0===o.length?e:[].concat(n(e),n(o));case v:return null===e?e:(0,u.without)(e,t.payload);default:return e}},j=(0,d.combineReducers)({seen:k,scheduled:S});r.default=j;var T=(0,c.get)("tooltip.seen"),O=(0,c.get)("tooltip.scheduled")},{"../logger/Logger":141,"../utils":484,"../utils/fp":477,"./load":425,redux:"redux",reselect:"reselect"}],449:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=r.UNDO_CLEAR="UNDO_CLEAR",a=r.UNDO_PUSH_MESSAGE="UNDO_PUSH_MESSAGE",i=r.NOTIFY_ADD_TO_PROJECT="NOTIFY_ADD_TO_PROJECT",s=(r.undoClear=function(){return{type:o}},r.undoPushMessage=function(e){return{type:a,payload:e}},r.notifyAddToProject=function(e,t){return function(r,n){var o=n().projects[t];r({type:i,payload:{itemID:e,project:o}})}},r.setUndo=function(e,t){var r=new Date,o=n({createdAt:r},e);return n({},t,{undo:o})},r.pushMessage=function(e,t){var r=new Date;return n({},t,{undo:{createdAt:r,message:e}})},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case o:return null;case a:return{createdAt:new Date,message:t.payload};case i:return n({type:t.type,createdAt:new Date},t.payload);default:return e}});r.default=s},{}],450:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.createNonUniqueIDsRemover=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e("../logger/Logger"),s=n(i),l=e("../utils"),u=e("./utils.js"),c=e("../models/SyncEngine"),d=n(c),f=function(e,t){if(!d.default.uniqueIdOn||window.ENV_JEST)return e;var r=m(e.projects),n=a(r,2),i=n[0],l=n[1],u=h(e.labels),c=a(u,2),f=c[0],p=c[1];return 0===i.length&&0===f.length?e:(s.default.captureMessageWithTrace("Non-unique id objects detected",{extra:{badLids:f,badPids:i,action:t},tags:{critical:"unique_id"}}),o({},e,{projects:l,labels:p}))};r.default=f;var p=r.createNonUniqueIDsRemover=function(){return(0,l.memoize)(function(e){if(!d.default.uniqueIdOn||window.ENV_JEST)return[[],e];var t=(0,l.keys)(e).filter(function(e){return(0,l.isRealID)(e)&&(0,u.isNonUniqueID)(e)});return 0===t.length?[[],e]:[t,(0,l.omit)(e,t)]})},m=p(),h=p()},{"../logger/Logger":141,"../models/SyncEngine":181,"../utils":484,"./utils.js":452}],451:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getToken=r.getTimezoneInfo=r.getTimeFormat=r.getWeekStartDay=r.getNextWeekDay=r.getDaysOff=r.getKarma=r.getUser=r.isDoistUser=r.isDayOff=r.isPremium=r.daysSinceJoin=r.receivedUserUpdate=r.USER_RECEIVED_UPDATE=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("../utils"),a=e("./load"),i=e("../reducers/sync"),s=e("../utils/fp"),l=r.USER_RECEIVED_UPDATE="USER_RECEIVED_UPDATE",u=(r.receivedUserUpdate=function(e){return{type:l,payload:e}},function(e){return e.join_date instanceof Date?e:n({},e,{join_date:new Date(e.join_date)})}),c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case a.LOAD_LOCAL_DATA:return t.payload.user?u(t.payload.user):e;case i.SYNC_FULL_UPDATE:case i.SYNC_UPDATE:var r=t.payload.user;return r?(r=u(r),e&&(0,o.isEqual)(r.days_off,e.days_off)&&(r.days_off=e.days_off),r):e;case l:return n({},e,t.payload);default:return e}};r.default=c;r.daysSinceJoin=function(e){var t=e.user;return Math.round(((new Date).getTime()-t.join_date.getTime())/864e5)},r.isPremium=function(e){if(!e)return!1;if(e.is_premium)return!0;var t=void 0;return e.premium_until?t=new Date(e.premium_until):e.free_trail_expires&&(t=new Date(e.free_trail_expires)),!!(t&&t>new Date)},r.isDayOff=function(e){var t=e.user.days_off,r=(new Date).getDay(),n=0===r?7:r;return-1!==t.indexOf(n)},r.isDoistUser=function(e){var t=(0,s.get)("user.email",e);return t&&t.endsWith("@doist.com")},r.getUser=function(e){return e.user},r.getKarma=function(e){return e.user.karma},r.getDaysOff=function(e){return e.user.days_off},r.getNextWeekDay=function(e){return e.user.next_week},r.getWeekStartDay=function(e){return e.user.start_day},r.getTimeFormat=function(e){return e.user.time_format},r.getTimezoneInfo=function(e){return e.user.tz_info},r.getToken=function(e){return e.user.token}},{"../reducers/sync":447,"../utils":484,"../utils/fp":477,"./load":425}],452:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(r,"__esModule",{value:!0}),r.resolveTempIDPaths=r.resolveTempIDFields=r.updateObjects=r.annotateIndentOrder=r.descendentsSorted=r.toUniqueID=r.isNonUniqueID=r.isUniqueID=r.mergeSyncUpdate=r.removeFromSlice=r.resolveTempID=void 0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=e("../utils/fp"),l=e("../utils"),u=e("../models/TemporaryIds"),c=function(e){return e&&e.__esModule?e:{default:e}}(u),d=(r.resolveTempID=function(e,t){var r=void 0,n=!0,o=!1,s=void 0;try{for(var u,c=(0,l.toPairs)(t)[Symbol.iterator]();!(n=(u=c.next()).done);n=!0){var d=i(u.value,2),f=d[0],p=d[1],m=e[f];m&&(r||(r=a({},e)),m=a({},m,{id:p}),delete r[f],r[m.id]=m)}}catch(e){o=!0,s=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw s}}return r||e},r.removeFromSlice=(0,l.curry)(function(e,t,r){(0,l.isIterable)(t)&&(t=new Set(t));var n=t instanceof Set?function(e){return t.has(e.id)}:t,i=new Set((0,s.compose)((0,s.map)(function(e){return e.id}),(0,s.filter)(n),s.values,(0,s.get)(e))(r));if(0===i.size)return r;var u=a({},r[e]),c=!0,d=!1,f=void 0;try{for(var p,m=i[Symbol.iterator]();!(c=(p=m.next()).done);c=!0){delete u[p.value]}}catch(e){d=!0,f=e}finally{try{!c&&m.return&&m.return()}finally{if(d)throw f}}return a({},r,o({},e,u))}),r.mergeSyncUpdate=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.removeArchived,o=void 0===n||n;if(!t||0==t.length)return e;var i=a({},e),s=!0,l=!1,u=void 0;try{for(var c,d=t[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value,p=f.id,m=f.is_deleted,h=f.is_archived;if(o&&(m||h))delete i[p];else if(i[p]){var _=e[p];i[p]=a({},_,f)}else i[p]=f}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}return i},Math.pow(2,28)-1),f=r.isUniqueID=function(e){return e>d};r.isNonUniqueID=function(e){return e<=d},r.toUniqueID=(0,l.curry)(function(e,t){return(0,l.isTempID)(t)||f(t)?t:e.user.unique_prefix<<28|t}),r.descendentsSorted=function e(t,r){var o=r[t];return o?(0,s.compose)(s.flatten,(0,s.map)(function(t){return[t].concat(n(e(t.id,r)))}),(0,s.sortBy)("child_order"))(o):[]},r.annotateIndentOrder=function(e){var t={};return e.map(function(e,r){var n=r+1,o=null===e.parent_id?1:(t[e.parent_id]||1)+1;return t[e.id]=o,a({},e,{item_order:n,indent:o})})},r.updateObjects=function(e,t,r){(0,l.isArray)(e)||(e=[e]);var n=(0,s.compose)((0,s.mapValues)(function(e){return a({},e,t)}),(0,s.pick)(e))(r);return a({},r,n)},r.resolveTempIDFields=(0,l.curry)(function(e,t){e=(0,l.isArray)(e)?e:[e];var r=a({},t),n=!1;return e.forEach(function(e){if(t.hasOwnProperty(e)){var o=r[e];if((0,l.isArray)(o))r[e]=o.map(function(e){var t=c.default.getRealId(e);return e!==t&&(n=!0),t});else{var a=c.default.getRealId(o);o!==a&&(n=!0),r[e]=a}}}),n?r:t}),r.resolveTempIDPaths=(0,l.curry)(function(e,t,r){e=(0,l.isArray)(e)?e:[e];var n=a({},r),o=!1;return e.forEach(function(e){if(r.hasOwnProperty(e)){var a=n[e];if((0,l.isArray)(a))n[e]=a.map(function(e){var r=t[e]||e;return e!==r&&(o=!0),r});else{var i=t[a]||a;a!==i&&(o=!0),n[e]=i}}}),o?n:r})},{"../models/TemporaryIds":184,"../utils":484,"../utils/fp":477}],453:[function(e,t,r){"use strict";function n(){if(navigator.onLine){return a.global_error||a.getQueueErrorLength()||!i.fetched_data_from_server}return!0}function o(){var e=/(iPhone)/i.test(navigator.userAgent),t=!!navigator.userAgent.match(/Version\/[\d.]+.*Safari/);return e&&t}Object.defineProperty(r,"__esModule",{value:!0}),r.isOffline=n,r.isMobileSafari=o;var a=e("../models/SyncEngine"),i=e("../models/LoadEngine")},{"../models/LoadEngine":169,"../models/SyncEngine":181}],454:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../logger/Logger"),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(n),a=e("../reducers/mainView"),i=e("../reducers/modelbridge"),s=new Set([i.MODEL_BRIDGE_UPDATE,a.VIEW_SHOW_PROJECT,a.VIEW_SHOW_QUERY,a.VIEW_SHOW_ACTIVITY_LOG,a.VIEW_SHOW_LABEL,a.VIEW_SHOW_FILTER,a.VIEW_SHOW_TODAY,a.VIEW_SHOW_7_DAYS]),l=function(){return function(e){return function(t){try{s.has(t.type)||o.captureBreadcrumb({message:t.type,category:"redux_action",level:"debug"})}catch(e){}return e(t)}}};r.default=l},{"../logger/Logger":141,"../reducers/mainView":426,"../reducers/modelbridge":427}],455:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o=e("../logger/Logger"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(o),i=e("../reducers/modelbridge"),s=e("../reducers/sync"),l=function(){return function(e){return function(t){try{return e(t)}catch(e){throw t=n({},t),t.type!=i.MODEL_BRIDGE_UPDATE&&t.type!=s.SYNC_FULL_UPDATE||delete t.payload,a.captureError(e,{tags:{where:"redux"},extra:{action:t}}),e}}}};r.default=l},{"../logger/Logger":141,"../reducers/modelbridge":427,"../reducers/sync":447}],456:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("redux"),a=e("redux-thunk"),i=n(a),s=e("../reducers/root"),l=n(s),u=e("./crashReporter"),c=n(u),d=e("./actionLogger"),f=n(d),p=e("../reducers/modelbridge"),m=e("../models/DateistDefLoader"),h=n(m),_=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.compose,v=[c.default,i.default,p.modelBridgeMiddleware,f.default],y=(0,o.createStore)(l.default,_(o.applyMiddleware.apply(void 0,v)));p.ModelBridge.init(y),h.default.init(y),r.default=y},{"../models/DateistDefLoader":165,"../reducers/modelbridge":427,"../reducers/root":439,"./actionLogger":454,"./crashReporter":455,redux:"redux","redux-thunk":"redux-thunk"}],457:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}Object.defineProperty(r,"__esModule",{value:!0});var o=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];if(r.length<2)throw new Error("subscribeSelected error: missing required argument");var a=r.slice(0,-1),i=r[r.length-1],s=a.map(function(t){return t(e.getState())});return e.subscribe(function(){var t=e.getState(),r=!1,o=a.map(function(e,n){var o=e(t);return s[n]!==o&&(r=!0),o});r&&(s=o,i.apply(void 0,n(o)))})};r.subscribeSelectedPromise=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return new Promise(function(t){var a=r.slice(0,-1),i=r[r.length-1],s=o.apply(void 0,[e].concat(n(a),[function(){i.apply(void 0,arguments)&&(s(),t.apply(void 0,arguments))}]))})};r.default=o},{}],458:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","BS","TAB","LF","VT","FF","CR","SO","SI","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","EM","SUB","ESC","FS","GS","RS","US"," ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~"],o=n.reduce(function(e,t,r){return e[t]=r,e},{});r.default=o},{}],459:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.idbs=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e("idbstorage"),s=n(i),l=e("../logger/Logger"),u=n(l),c="localStorage",d=/.*quota*./i,f=function(e){return d.test(e.name)||d.test(e.message)},p=r.idbs=new s.default({name:"todoist.cellstorage"}),m=function(){function e(t){o(this,e),this.key=t,this.driverType=localStorage.getItem(this.key+"/driver")||c}return a(e,[{key:"get",value:function(){if(this.checkDriverType(),this.usingLocalStorage){var e=localStorage.getItem(this.key+"/data");return void 0===e?Promise.resolve(e):Promise.resolve(JSON.parse(e))}return p.getItem(this.key)}},{key:"set",value:function(e){if(this.checkDriverType(),this.usingLocalStorage)try{return void 0===e?this.clear():(localStorage.setItem(this.key+"/data",JSON.stringify(e)),Promise.resolve())}catch(t){return f(t)?(this.switchToIDBDriver(),this.set(e)):Promise.reject(t)}return p.setItem(this.key,e)}},{key:"clear",value:function(){return this.checkDriverType(),this.usingLocalStorage?(localStorage.removeItem(this.key+"/data"),Promise.resolve()):p.clear()}},{key:"switchToIDBDriver",value:function(){localStorage.removeItem(this.key+"/data"),this.driverType="indexedDB",localStorage.setItem(this.key+"/driver","indexedDB")}},{key:"checkDriverType",value:function(){if(this.driverType!==c&&"indexedDB"!==this.driverType){var e=new Error("CellStorage: invalid driver '"+this.driverType+"'");throw u.default.captureError(e,{tags:{where:"cellstroage"}}),Signals.sendSignal("clean_reload"),e}}},{key:"_DEBUG_forceSwtichIndexedDB",value:function(){var e=JSON.parse(localStorage.getItem(this.key+"/data"));this.switchToIDBDriver(),this.set(e)}},{key:"usingLocalStorage",get:function(){return this.driverType===c}},{key:"usingIndexedDB",get:function(){return"indexedDB"===this.driverType}}]),e}();r.default=m},{"../logger/Logger":141,idbstorage:"idbstorage"}],460:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.isWindowApp=-1!=window.location.hostname.indexOf("win.todoist"),r.isOutlookApp=-1!=window.location.hostname.indexOf("outlook.todoist"),r.isChromeApp=-1!=window.location.hostname.indexOf("chrome.todoist"),r.isMacApp=-1!=window.location.hostname.indexOf("macstore.todoist")},{}],461:[function(e,t,r){"use strict";function n(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],462:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e){this.size=0,this.limit="number"==typeof e?e:10,this.map={},this.head=null,this.tail=null}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o;var a=e("lodash/isNumber"),i=n(a),s=e("lodash/isString"),l=n(s),u=e("lodash/values"),c=n(u),d=e("lodash/keys"),f=n(d);o.prototype.lrunode=function(e,t){void 0!==e&&null!==e&&(this.key=e),void 0!==t&&null!==t&&(this.value=t),this.prev=null,this.next=null},o.prototype.setHead=function(e){e.next=this.head,e.prev=null,null!==this.head&&(this.head.prev=e),this.head=e,null===this.tail&&(this.tail=e),this.size++,this.map[e.key]=e},o.prototype.set=function(e,t){if(!(0,i.default)(e)&&!(0,l.default)(e))throw new Error("Invalid arguemnt. key has to be string or number, but "+e+" is received");var r=new o.prototype.lrunode(e,t);return this.map[e]?(this.map[e].value=r.value,this.delete(r.key)):this.size>=this.limit&&(delete this.map[this.tail.key],this.size--,this.tail=this.tail.prev,this.tail.next=null),this.setHead(r),this},o.prototype.get=function(e){if(this.map[e]){var t=this.map[e].value,r=new o.prototype.lrunode(e,t);return this.delete(e),this.setHead(r),t}},o.prototype.has=function(e){return!!this.map[e]},o.prototype.delete=function(e){if(!this.has(e))return!1;var t=this.map[e];return null!==t.prev?t.prev.next=t.next:this.head=t.next,null!==t.next?t.next.prev=t.prev:this.tail=t.prev,delete this.map[e],this.size--,!0},o.prototype.clear=function(e){this.size=0,this.map={},this.head=null,this.tail=null,"number"==typeof e&&(this.limit=e)},o.prototype.forEach=function(e){for(var t=this.head,r=0;t;)e.apply(this,[t,r,this]),r++,t=t.next},o.prototype.values=function(){return(0,c.default)(this.map).map(function(e){
return e.value})},o.prototype.keys=function(){return(0,f.default)(this.map)}},{"lodash/isNumber":"lodash/isNumber","lodash/isString":"lodash/isString","lodash/keys":"lodash/keys","lodash/values":"lodash/values"}],463:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t,r,o){n(this,e),this.jobFn=t,this.resolve=r,this.reject=o}return o(e,[{key:"exec",value:function(){try{var e=this.jobFn();return e instanceof Promise?e.then(this.resolve.bind(this),this.reject.bind(this)):(this.resolve(e),Promise.resolve(e))}catch(e){return Promise.reject(e)}}}]),e}(),i=function(){function e(){n(this,e),this.queue=[],this.isExecuting=!1}return o(e,[{key:"put",value:function(e){var t=this;return new Promise(function(r,n){var o=new a(e,r,n);t.queue.push(o),t.startNextJob()})}},{key:"clear",value:function(){this.queue=[]}},{key:"startNextJob",value:function(){if(0!=this.length&&!this.isExecuting){var e=this.queue[0];this.queue=this.queue.slice(1),this.isExecuting=!0,e.exec().then(this.onExecComplete.bind(this),this.onExecComplete.bind(this))}}},{key:"onExecComplete",value:function(){this.isExecuting=!1,this.startNextJob()}},{key:"length",get:function(){return this.queue.length}}]),e}();r.default=i},{}],464:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,t){var r=new Date;e.addEventListener("compositionstart",function(){r=new Date}),e.addEventListener("compositionend",function(e){var n=new Date;setTimeout(function(){r&&r>=n&&r.getTime()-n.getTime()<50||t(e)},10)})};r.default=n},{}],465:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return e.reduce(function(e,t){return e[t.id]=t,e},{})}},{}],466:[function(e,t,r){"use strict";function n(){var e=function(e,t,r,n,o){arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&void 0!==arguments[6]&&arguments[6];r.lang=t;try{return Dateist.parse(e,r)}catch(e){return null}},t=(0,a.default)(e),r=(0,a.default)(e);return function(e,o,a){var i=n.now(),s=t(e,o,a,i.getMonth(),i.getDate());return s&&"hour"===s.unit&&(s=r(e,o,a,i.getMonth(),i.getDate(),i.getHours(),i.getMinutes())),s?s.due_date:null}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var o=e("./memoize"),a=function(e){return e&&e.__esModule?e:{default:e}}(o);n.defaultNow=function(){return new Date},n.now=n.defaultNow},{"./memoize":496}],467:[function(e,t,r){"use strict";function n(e){return e=new Date(e.getTime()),e.setHours(23),e.setMinutes(59),e.setSeconds(59),e.setMilliseconds(999),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],468:[function(e,t,r){"use strict";function n(e){return e=new Date(e.getTime()),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],469:[function(e,t,r){"use strict";function n(e){var t=(0,s.default)(e).filter(function(e){var t=a(e,2);t[0];return void 0===t[1]}).map(function(e){return a(e,1)[0]});if(0===t.length)return e;var r=o({},e),n=!0,i=!1,l=void 0;try{for(var u,c=t[Symbol.iterator]();!(n=(u=c.next()).done);n=!0){delete r[u.value]}}catch(e){i=!0,l=e}finally{try{!n&&c.return&&c.return()}finally{if(i)throw l}}return r}Object.defineProperty(r,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r.default=n;var i=e("lodash/toPairs"),s=function(e){return e&&e.__esModule?e:{default:e}}(i)},{"lodash/toPairs":"lodash/toPairs"}],470:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){return new y(e,t)}function i(e){for(var t in e){if(!v[t])throw new Error("Undefined dep: cannot inject dependencies "+t+" that is not defined yet");var r=e[t];v[t].inject(r)}}function s(){var e=g(v);if(e.length>0){var t=e.map(function(e){var t=l(e,2);return t[0]+": ["+t[1].join(", ")+"]"}).join("\n");throw new Error("Following deps was not injected:\n"+t)}}Object.defineProperty(r,"__esModule",{value:!0}),r.Deps=r._clearRegistry=void 0;var l=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r.defineDeps=a,r.inject=i,r.checkIfAllInjected=s;var c=e("redux"),d=e("lodash/fp/toPairs"),f=n(d),p=e("lodash/fp/filter"),m=n(p),h=e("lodash/fp/map"),_=n(h),v={},y=(r._clearRegistry=function(){for(var e in v)delete v[e]},r.Deps=function(){function e(t,r){if(o(this,e),v[t])throw new Error("Name collision error: Deps for module "+t+" has already defined. (try use different ID)");this.id=t,this.expectedDeps=r,v[t]=this}return u(e,[{key:"inject",value:function(e){for(var t in e)this[t]=e[t]}},{key:"missingDeps",get:function(){var e=this;return this.expectedDeps.filter(function(t){return!e[t]})}},{key:"hasMissingDeps",get:function(){return 0===this.missingDeps.length}}]),e}()),g=(0,c.compose)((0,m.default)(function(e){var t=l(e,2);t[0];return t[1].length>0}),(0,_.default)(function(e){var t=l(e,2);return[t[0],t[1].missingDeps]}),f.default)},{"lodash/fp/filter":"lodash/fp/filter","lodash/fp/map":"lodash/fp/map","lodash/fp/toPairs":"lodash/fp/toPairs",redux:"redux"}],471:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.linear=function(e){return e},r.easeInQuad=function(e){return Math.pow(e,2)},r.easeOutQuad=function(e){return-(Math.pow(e-1,2)-1)},r.easeInOutQuad=function(e){return(e/=.5)<1?.5*Math.pow(e,2):-.5*((e-=2)*e-2)},r.easeInCubic=function(e){return Math.pow(e,3)},r.easeOutCubic=function(e){return Math.pow(e-1,3)+1},r.easeInOutCubic=function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},r.easeInQuart=function(e){return Math.pow(e,4)},r.easeOutQuart=function(e){return-(Math.pow(e-1,4)-1)},r.easeInOutQuart=function(e){return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},r.easeInQuint=function(e){return Math.pow(e,5)},r.easeOutQuint=function(e){return Math.pow(e-1,5)+1}},{}],472:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r=(0,u.default)(e);return(0,s.default)(a({},t),r)}Object.defineProperty(r,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};r.default=o;var i=e("lodash/omit"),s=n(i),l=e("lodash/keys"),u=n(l)},{"lodash/keys":"lodash/keys","lodash/omit":"lodash/omit"}],473:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e){return e.split(" ")[0]};r.default=n},{}],474:[function(e,t,r){"use strict";function n(e,t){var r=e,n=!0,o=!1,a=void 0;try{for(var i,s=Object.keys(t)[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value,u=new RegExp("\\{\\s*"+l+"\\s*\\}","g"),c=t[l];r=r.replace(u,c)}}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],475:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var r=(0,i.compose)((0,c.default)(function(e){var t=a(e,2),r=t[0];return{name:r,value:t[1],re:new RegExp("\\{\\s*"+r+"\\s*\\}","g")}}),l.default)(t),n=(0,i.compose)((0,m.default)("startIndex"),(0,f.default)(function(e){return e}),_.default,(0,c.default)(function(t){for(var r=t.name,n=t.value,o=t.re,a=[],i=void 0;null!==(i=o.exec(e));)a.push({name:r,value:n,re:o,startIndex:i.index,endIndex:i.index+i[0].length});return a}))(r),o=[],s=0,u=!0,d=!1,p=void 0;try{for(var h,v=n[Symbol.iterator]();!(u=(h=v.next()).done);u=!0){var g=h.value,b=g.startIndex,w=g.endIndex,E=g.value,k=document.createTextNode(e.slice(s,b)),S=E;(0,y.default)(E)||E instanceof Element||(S=document.createTextNode(E)),o.push(k),o.push(S),s=w}}catch(e){d=!0,p=e}finally{try{!u&&v.return&&v.return()}finally{if(d)throw p}}var j=document.createTextNode(e.slice(s,e.length));return o.push(j),o}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r.default=o;var i=e("redux"),s=e("lodash/toPairs"),l=n(s),u=e("lodash/fp/map"),c=n(u),d=e("lodash/fp/filter"),f=n(d),p=e("lodash/fp/sortBy"),m=n(p),h=e("lodash/flatten"),_=n(h),v=e("lodash/isElement"),y=n(v)},{"lodash/flatten":"lodash/flatten","lodash/fp/filter":"lodash/fp/filter","lodash/fp/map":"lodash/fp/map","lodash/fp/sortBy":"lodash/fp/sortBy","lodash/isElement":"lodash/isElement","lodash/toPairs":"lodash/toPairs",redux:"redux"}],476:[function(e,t,r){"use strict";function n(e){return function(t){return e?console.log(e,t):console.log(t),t}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],477:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("redux");Object.defineProperty(r,"compose",{enumerable:!0,get:function(){return o.compose}});var a=e("reselect");Object.defineProperty(r,"createSelector",{enumerable:!0,get:function(){return a.createSelector}});var i=e("../toIDMap");Object.defineProperty(r,"byID",{enumerable:!0,get:function(){return n(i).default}});var s=e("./consoleLog");Object.defineProperty(r,"consoleLog",{enumerable:!0,get:function(){return n(s).default}});var l=e("lodash/fp/difference");Object.defineProperty(r,"difference",{enumerable:!0,get:function(){return n(l).default}});var u=e("lodash/fp/filter");Object.defineProperty(r,"filter",{enumerable:!0,get:function(){return n(u).default}});var c=e("lodash/fp/find");Object.defineProperty(r,"find",{enumerable:!0,get:function(){return n(c).default}});var d=e("lodash/fp/findLast");Object.defineProperty(r,"findLast",{enumerable:!0,get:function(){return n(d).default}});var f=e("lodash/fp/flatten");Object.defineProperty(r,"flatten",{enumerable:!0,get:function(){return n(f).default}});var p=e("lodash/fp/get");Object.defineProperty(r,"get",{enumerable:!0,get:function(){return n(p).default}});var m=e("lodash/fp/getOr");Object.defineProperty(r,"getOr",{enumerable:!0,get:function(){return n(m).default}});var h=e("lodash/fp/groupBy");Object.defineProperty(r,"groupBy",{enumerable:!0,get:function(){return n(h).default}});var _=e("lodash/fp/head");Object.defineProperty(r,"head",{enumerable:!0,get:function(){return n(_).default}});var v=e("lodash/fp/keyBy");Object.defineProperty(r,"keyBy",{enumerable:!0,get:function(){return n(v).default}});var y=e("lodash/keys");Object.defineProperty(r,"keys",{enumerable:!0,get:function(){return n(y).default}});var g=e("lodash/fp/last");Object.defineProperty(r,"last",{enumerable:!0,get:function(){return n(g).default}});var b=e("lodash/fp/map");Object.defineProperty(r,"map",{enumerable:!0,get:function(){return n(b).default}});var w=e("lodash/fp/mapValues");Object.defineProperty(r,"mapValues",{enumerable:!0,get:function(){return n(w).default}});var E=e("lodash/fp/mapKeys");Object.defineProperty(r,"mapKeys",{enumerable:!0,get:function(){return n(E).default}});var k=e("lodash/fp/max");Object.defineProperty(r,"max",{enumerable:!0,get:function(){return n(k).default}});var S=e("lodash/fp/merge");Object.defineProperty(r,"merge",{enumerable:!0,get:function(){return n(S).default}});var j=e("lodash/fp/min");Object.defineProperty(r,"min",{enumerable:!0,get:function(){return n(j).default}});var T=e("lodash/fp/omit");Object.defineProperty(r,"omit",{enumerable:!0,get:function(){return n(T).default}});var O=e("lodash/fp/pick");Object.defineProperty(r,"pick",{enumerable:!0,get:function(){return n(O).default}});var I=e("lodash/fp/pickBy");Object.defineProperty(r,"pickBy",{enumerable:!0,get:function(){return n(I).default}});var P=e("lodash/fp/set");Object.defineProperty(r,"set",{enumerable:!0,get:function(){return n(P).default}});var C=e("lodash/fp/sortBy");Object.defineProperty(r,"sortBy",{enumerable:!0,get:function(){return n(C).default}});var D=e("lodash/fp/sum");Object.defineProperty(r,"sum",{enumerable:!0,get:function(){return n(D).default}});var A=e("lodash/fp/toPairs");Object.defineProperty(r,"toPairs",{enumerable:!0,get:function(){return n(A).default}});var M=e("lodash/fp/unset");Object.defineProperty(r,"unset",{enumerable:!0,get:function(){return n(M).default}});var x=e("lodash/values");Object.defineProperty(r,"values",{enumerable:!0,get:function(){return n(x).default}})},{"../toIDMap":507,"./consoleLog":476,"lodash/fp/difference":"lodash/fp/difference","lodash/fp/filter":"lodash/fp/filter","lodash/fp/find":"lodash/fp/find","lodash/fp/findLast":"lodash/fp/findLast","lodash/fp/flatten":"lodash/fp/flatten","lodash/fp/get":"lodash/fp/get","lodash/fp/getOr":"lodash/fp/getOr","lodash/fp/groupBy":"lodash/fp/groupBy","lodash/fp/head":"lodash/fp/head","lodash/fp/keyBy":"lodash/fp/keyBy","lodash/fp/last":"lodash/fp/last","lodash/fp/map":"lodash/fp/map","lodash/fp/mapKeys":"lodash/fp/mapKeys","lodash/fp/mapValues":"lodash/fp/mapValues","lodash/fp/max":"lodash/fp/max","lodash/fp/merge":"lodash/fp/merge","lodash/fp/min":"lodash/fp/min","lodash/fp/omit":"lodash/fp/omit","lodash/fp/pick":"lodash/fp/pick","lodash/fp/pickBy":"lodash/fp/pickBy","lodash/fp/set":"lodash/fp/set","lodash/fp/sortBy":"lodash/fp/sortBy","lodash/fp/sum":"lodash/fp/sum","lodash/fp/toPairs":"lodash/fp/toPairs","lodash/fp/unset":"lodash/fp/unset","lodash/keys":"lodash/keys","lodash/values":"lodash/values",redux:"redux",reselect:"reselect"}],478:[function(e,t,r){"use strict";function n(e){var t=0,r=0,n=e;do{t+=n.offsetTop||0,r+=n.offsetLeft||0,n=n.offsetParent}while(n);return{top:t,left:r}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],479:[function(e,t,r){"use strict";function n(e,t){return(0,a.default)(e,t)&&e.getHours()==t.getHours()&&e.getMinutes()==t.getMinutes()}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var o=e("./isOnSameDate"),a=function(e){return e&&e.__esModule?e:{default:e}}(o)},{"./isOnSameDate":488}],480:[function(e,t,r){"use strict";function n(e){return!(59===e.getMinutes()&&59===e.getSeconds())}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],481:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){var r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return"rgba("+parseInt(r[1],16)+", "+parseInt(r[2],16)+", "+parseInt(r[3],16)+", "+t+")"}},{}],482:[function(e,t,r){"use strict";function n(e,t){var r=window.devicePixelRatio;if(r){var n=e.width,o=e.height;e.width=n*r,e.height=o*r,e.style.width=n+"px",e.style.height=o+"px",t.scale(r,r)}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],483:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./isTempID"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=function(e){return e=e.map(function(e){return(0,o.default)(e)?-1*parseInt(e.substring(1)):e}),e.reduce(function(e,t){return e^t},0)};r.default=a},{"./isTempID":491}],484:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./ASCII");Object.defineProperty(r,"ASCII",{enumerable:!0,get:function(){return n(o).default}});var a=e("./Env");Object.defineProperty(r,"Env",{enumerable:!0,get:function(){return n(a).default}});var i=e("./SeqJobQueue");Object.defineProperty(r,"SeqJobQueue",{enumerable:!0,get:function(){return n(i).default}});var s=e("./addDeferCompositionEndListener");Object.defineProperty(r,"addDeferCompositionEndListener",{enumerable:!0,get:function(){return n(s).default}});var l=e("./easing");Object.defineProperty(r,"easing",{enumerable:!0,get:function(){return n(l).default}});var u=e("./filterOtherProps");Object.defineProperty(r,"filterOtherProps",{enumerable:!0,get:function(){return n(u).default}});var c=e("./format");Object.defineProperty(r,"format",{enumerable:!0,get:function(){return n(c).default}});var d=e("./hexToRGB");Object.defineProperty(r,"hexToRGB",{enumerable:!0,get:function(){return n(d).default}});var f=e("./highDefCanvas");Object.defineProperty(r,"highDefCanvas",{enumerable:!0,get:function(){return n(f).default}});var p=e("./isCompositionEscEvent");Object.defineProperty(r,"isCompositionEscEvent",{enumerable:!0,get:function(){return n(p).default}});var m=e("./isTempID");Object.defineProperty(r,"isTempID",{enumerable:!0,get:function(){return n(m).default}});var h=e("./isRealID");Object.defineProperty(r,"isRealID",{enumerable:!0,get:function(){return n(h).default}});var _=e("./isoToDate");Object.defineProperty(r,"isoToDate",{enumerable:!0,get:function(){return n(_).default}});var v=e("./mapRange");Object.defineProperty(r,"mapRange",{enumerable:!0,get:function(){return n(v).default}});var y=e("./partialMatchName");Object.defineProperty(r,"partialMatchName",{enumerable:!0,get:function(){return n(y).default}});var g=e("./partialMatchIndex");Object.defineProperty(r,"partialMatchIndex",{enumerable:!0,get:function(){return n(g).default}});var b=e("./shallowEqual");Object.defineProperty(r,"shallowEqual",{enumerable:!0,get:function(){return n(b).default}});var w=e("./toISODateString");Object.defineProperty(r,"toISODateString",{enumerable:!0,get:function(){return n(w).default}});var E=e("./todayISO");Object.defineProperty(r,"todayISO",{enumerable:!0,get:function(){return n(E).default}});var k=e("./tweening");Object.defineProperty(r,"tweening",{enumerable:!0,get:function(){return n(k).default}});var S=e("./firstName");Object.defineProperty(r,"firstName",{enumerable:!0,get:function(){return n(S).default}});var j=e("./toIDMap");Object.defineProperty(r,"toIDMap",{enumerable:!0,get:function(){return n(j).default}});var T=e("./intID");Object.defineProperty(r,"intID",{enumerable:!0,get:function(){return n(T).default}});var O=e("./idHash");Object.defineProperty(r,"idHash",{enumerable:!0,get:function(){return n(O).default}});var I=e("./uploadJSON");Object.defineProperty(r,"uploadJSON",{enumerable:!0,get:function(){return n(I).default}});var P=e("./isSection");Object.defineProperty(r,"isSection",{enumerable:!0,get:function(){return n(P).default}});var C=e("./isIterable");Object.defineProperty(r,"isIterable",{enumerable:!0,get:function(){return n(C).default}});var D=e("./looseMatch");Object.defineProperty(r,"looseMatch",{enumerable:!0,get:function(){return n(D).default}});var A=e("./shortName");Object.defineProperty(r,"shortName",{enumerable:!0,get:function(){return n(A).default}});var M=e("./formatToDOM");Object.defineProperty(r,"formatToDOM",{enumerable:!0,get:function(){return n(M).default}});var x=e("./memoize");Object.defineProperty(r,"memoize",{enumerable:!0,get:function(){return n(x).default}});var R=e("./memoizeReturn");Object.defineProperty(r,"memoizeReturn",{enumerable:!0,get:function(){return n(R).default}});var N=e("./isOnSameDate");Object.defineProperty(r,"isOnSameDate",{enumerable:!0,get:function(){return n(N).default}});var $=e("./hasSameDateAndTime");Object.defineProperty(r,"hasSameDateAndTime",{enumerable:!0,get:function(){return n($).default}});var L=e("./dayMax");Object.defineProperty(r,"dayMax",{enumerable:!0,get:function(){return n(L).default}});var U=e("./dayMin");Object.defineProperty(r,"dayMin",{enumerable:!0,get:function(){return n(U).default}});var V=e("./hasTime");Object.defineProperty(r,"hasTime",{enumerable:!0,get:function(){return n(V).default}});var F=e("./range");Object.defineProperty(r,"range",{enumerable:!0,get:function(){return n(F).default}});var B=e("./move");Object.defineProperty(r,"move",{enumerable:!0,get:function(){return n(B).default}});var H=e("./traverseTracking");Object.defineProperty(r,"traverseTracking",{enumerable:!0,get:function(){return n(H).default}});var G=e("./getElementOffset");Object.defineProperty(r,"getElementOffset",{enumerable:!0,get:function(){return n(G).default}});var z=e("./GUID");Object.defineProperty(r,"GUID",{enumerable:!0,get:function(){return n(z).default}});var q=e("./LRU");Object.defineProperty(r,"LRU",{enumerable:!0,get:function(){return n(q).default}});var W=e("./CellStorage");Object.defineProperty(r,"CellStorage",{enumerable:!0,get:function(){return n(W).default}});var Y=e("./createMemoizedDateParser");Object.defineProperty(r,"createMemoizedDateParser",{enumerable:!0,get:function(){return n(Y).default}});var K=e("./timezones");Object.defineProperty(r,"timezones",{enumerable:!0,get:function(){return n(K).default}});var J=e("lodash/memoize");Object.defineProperty(r,"LMemoize",{enumerable:!0,get:function(){return n(J).default}});var Q=e("./byID");Object.defineProperty(r,"byID",{enumerable:!0,get:function(){return n(Q).default}});var X=e("./shuffle");Object.defineProperty(r,"shuffle",{enumerable:!0,get:function(){return n(X).default}});var Z=e("./recursiveTraverse");Object.defineProperty(r,"recursiveTraverse",{enumerable:!0,get:function(){return n(Z).default}});var ee=e("./isUniqueID");Object.defineProperty(r,"isUniqueID",{enumerable:!0,get:function(){return n(ee).default}});var te=e("./toUniqueID");Object.defineProperty(r,"toUniqueID",{enumerable:!0,get:function(){return n(te).default}});var re=e("lodash/cloneDeep");Object.defineProperty(r,"cloneDeep",{enumerable:!0,get:function(){return n(re).default}});var ne=e("lodash/debounce");Object.defineProperty(r,"debounce",{enumerable:!0,get:function(){return n(ne).default}});var oe=e("lodash/findIndex");Object.defineProperty(r,"findIndex",{enumerable:!0,get:function(){return n(oe).default}});var ae=e("lodash/flatten");Object.defineProperty(r,"flatten",{enumerable:!0,get:function(){return n(ae).default}});var ie=e("lodash/flow");Object.defineProperty(r,"flow",{enumerable:!0,get:function(){return n(ie).default}});var se=e("lodash/zipObject");Object.defineProperty(r,"zipObject",{enumerable:!0,get:function(){return n(se).default}});var le=e("lodash/groupBy");Object.defineProperty(r,"groupBy",{enumerable:!0,get:function(){return n(le).default}});var ue=e("lodash/intersection");Object.defineProperty(r,"intersection",{enumerable:!0,get:function(){return n(ue).default}});var ce=e("lodash/isArray");Object.defineProperty(r,"isArray",{enumerable:!0,get:function(){return n(ce).default}});var de=e("lodash/isString");Object.defineProperty(r,"isString",{enumerable:!0,get:function(){return n(de).default}});var fe=e("lodash/isElement");Object.defineProperty(r,"isElement",{enumerable:!0,get:function(){return n(fe).default}});var pe=e("lodash/isNumber");Object.defineProperty(r,"isNumber",{enumerable:!0,get:function(){return n(pe).default}});var me=e("lodash/isUndefined");Object.defineProperty(r,"isUndefined",{enumerable:!0,get:function(){return n(me).default}});var he=e("lodash/isEqual");Object.defineProperty(r,"isEqual",{enumerable:!0,get:function(){return n(he).default}});var _e=e("lodash/keyBy");Object.defineProperty(r,"keyBy",{enumerable:!0,get:function(){return n(_e).default}});var ve=e("lodash/keys");Object.defineProperty(r,"keys",{enumerable:!0,get:function(){return n(ve).default}});var ye=e("lodash/mapKeys");Object.defineProperty(r,"mapKeys",{enumerable:!0,get:function(){return n(ye).default}});var ge=e("lodash/mapValues");Object.defineProperty(r,"mapValues",{enumerable:!0,get:function(){return n(ge).default}});var be=e("lodash/max");Object.defineProperty(r,"max",{enumerable:!0,get:function(){return n(be).default}});var we=e("lodash/merge");Object.defineProperty(r,"merge",{enumerable:!0,get:function(){return n(we).default}});var Ee=e("lodash/omit");Object.defineProperty(r,"omit",{enumerable:!0,get:function(){return n(Ee).default}});var ke=e("lodash/omitBy");Object.defineProperty(r,"omitBy",{enumerable:!0,get:function(){return n(ke).default}});var Se=e("lodash/pick");Object.defineProperty(r,"pick",{enumerable:!0,get:function(){return n(Se).default}});var je=e("lodash/without");Object.defineProperty(r,"without",{enumerable:!0,get:function(){return n(je).default}});var Te=e("lodash/sortBy");Object.defineProperty(r,"sortBy",{enumerable:!0,get:function(){return n(Te).default}});var Oe=e("lodash/sortedUniq");Object.defineProperty(r,"sortedUniq",{enumerable:!0,get:function(){return n(Oe).default}});var Ie=e("lodash/toPairs");Object.defineProperty(r,"toPairs",{enumerable:!0,get:function(){return n(Ie).default}});var Pe=e("lodash/throttle");Object.defineProperty(r,"throttle",{enumerable:!0,get:function(){return n(Pe).default}});var Ce=e("lodash/uniq");Object.defineProperty(r,"uniq",{enumerable:!0,get:function(){return n(Ce).default}});var De=e("lodash/values");Object.defineProperty(r,"values",{enumerable:!0,get:function(){return n(De).default}});var Ae=e("lodash/curry");Object.defineProperty(r,"curry",{enumerable:!0,get:function(){return n(Ae).default}});var Me=e("lodash/some");Object.defineProperty(r,"some",{enumerable:!0,get:function(){return n(Me).default}})},{"./ASCII":458,"./CellStorage":459,"./Env":460,"./GUID":461,"./LRU":462,"./SeqJobQueue":463,"./addDeferCompositionEndListener":464,"./byID":465,"./createMemoizedDateParser":466,"./dayMax":467,"./dayMin":468,"./easing":471,"./filterOtherProps":472,"./firstName":473,"./format":474,"./formatToDOM":475,"./getElementOffset":478,"./hasSameDateAndTime":479,"./hasTime":480,"./hexToRGB":481,"./highDefCanvas":482,"./idHash":483,"./intID":485,"./isCompositionEscEvent":486,"./isIterable":487,"./isOnSameDate":488,"./isRealID":489,"./isSection":490,"./isTempID":491,"./isUniqueID":492,"./isoToDate":493,"./looseMatch":494,"./mapRange":495,"./memoize":496,"./memoizeReturn":497,"./move":498,"./partialMatchIndex":499,"./partialMatchName":500,"./range":501,"./recursiveTraverse":502,"./shallowEqual":503,"./shortName":504,"./shuffle":505,"./timezones":506,"./toIDMap":507,"./toISODateString":508,"./toUniqueID":509,"./todayISO":510,"./traverseTracking":511,"./tweening":512,"./uploadJSON":513,"lodash/cloneDeep":"lodash/cloneDeep","lodash/curry":"lodash/curry","lodash/debounce":"lodash/debounce","lodash/findIndex":"lodash/findIndex","lodash/flatten":"lodash/flatten","lodash/flow":"lodash/flow","lodash/groupBy":"lodash/groupBy","lodash/intersection":"lodash/intersection","lodash/isArray":"lodash/isArray","lodash/isElement":"lodash/isElement","lodash/isEqual":"lodash/isEqual","lodash/isNumber":"lodash/isNumber","lodash/isString":"lodash/isString","lodash/isUndefined":"lodash/isUndefined","lodash/keyBy":"lodash/keyBy","lodash/keys":"lodash/keys","lodash/mapKeys":"lodash/mapKeys","lodash/mapValues":"lodash/mapValues","lodash/max":"lodash/max","lodash/memoize":"lodash/memoize","lodash/merge":"lodash/merge","lodash/omit":"lodash/omit","lodash/omitBy":"lodash/omitBy","lodash/pick":"lodash/pick","lodash/some":"lodash/some","lodash/sortBy":"lodash/sortBy","lodash/sortedUniq":"lodash/sortedUniq","lodash/throttle":"lodash/throttle","lodash/toPairs":"lodash/toPairs","lodash/uniq":"lodash/uniq","lodash/values":"lodash/values","lodash/without":"lodash/without","lodash/zipObject":"lodash/zipObject"}],485:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./isTempID"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=function(e){if((0,o.default)(e))return e;try{return parseInt(e)}catch(e){}return e};r.default=a},{"./isTempID":491}],486:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=void 0,o=void 0;document.addEventListener("compositionend",function(){n=new Date,o=!1}),document.addEventListener("compositionstart",function(){o=!0});var a=function(e){var t=new Date,r=n&&t.getTime()-n.getTime()<500;return 27==e.keyAscii&&(o||r)};r.default=a},{}],487:[function(e,t,r){"use strict";function n(e){return null!==e&&void 0!==e&&"function"==typeof e[Symbol.iterator]}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],488:[function(e,t,r){"use strict";function n(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],489:[function(e,t,r){"use strict";function n(e){return!(0,a.default)(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var o=e("./isTempID"),a=function(e){return e&&e.__esModule?e:{default:e}}(o)},{"./isTempID":491}],490:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return e&&(0===e.indexOf("* ")||e.lastIndexOf(":")===e.length-1)}},{}],491:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e){return $isString(e)&&0==e.indexOf("_")};r.default=n},{}],492:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Math.pow(2,28)-1,o=function(e){return e>n};r.default=o},{}],493:[function(e,t,r){"use strict";function n(e){var t=o.exec(e);if(!t)return new Date;try{var r=[parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3])],n=r[0],a=r[1],i=r[2];return new Date(n,a,i)}catch(e){return new Date}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var o=/\s*(\d\d\d\d)-(\d\d)-(\d\d)\s*/i},{}],494:[function(e,t,r){"use strict";function n(e){var t=e.toLowerCase().split(" ").filter(function(e){return!!e}),r=function(e){return e=e.toLowerCase(),-1===t.map(function(t){return e.indexOf(t)}).indexOf(-1)};return 1===arguments.length?r:arguments.length>1?r(arguments[1]):void 0}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],495:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r,n,o){return r+(n-r)*(o-e)/(t-e)}},{}],496:[function(e,t,r){"use strict";function n(e,t){return e===t}function o(e,t,r){if(null===t||null===r||t.length!==r.length)return!1;for(var n=t.length,o=0;o<n;o++)if(!e(t[o],r[o]))return!1;return!0}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,r=null,a=null;return function(){return o(t,r,arguments)||(a=e.apply(null,arguments)),r=arguments,a}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=a},{}],497:[function(e,t,r){"use strict";function n(e){var t=void 0;return function(){var r=e.apply(null,arguments);return t===r||(0,a.default)(t,r)?t:(t=r,r)}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var o=e("lodash/isEqual"),a=function(e){return e&&e.__esModule?e:{default:e}}(o)},{"lodash/isEqual":"lodash/isEqual"}],498:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){
for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t){var r=function(r){if(e<0||t<0||e>=r.length||t>=r.length)throw new Error("Invalid array index");var o=[].concat(n(r));return o.splice(e,1),o.splice(t,0,r[e]),o};return 3===arguments.length?r(arguments[2]):r}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o},{}],499:[function(e,t,r){"use strict";function n(e,t){e=e.toLowerCase(),t=t.toLowerCase();var r=a(t),n=t.indexOf(e),o=r.indexOf(e);return-1!==n?n:-1!==o?o:-1}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n;var o=void 0!="".normalize,a=function(e){return o?e.normalize("NFD").replace(/[\u0300-\u036e\u1dc0-\u1dfe\u20d0-\u20fe\ufe20-\ufe2e\u3099-\u309a]+/g,""):e}},{}],500:[function(e,t,r){"use strict";function n(e,t){return!(!e||!t)&&(t=t.trim().toLowerCase(),e=e.trim().toLowerCase(),e.split(" ").filter(function(e){return""!==e}).length>1?0===t.indexOf(e):t.split(" ").filter(function(e){return""!==e}).filter(function(t){return 0===t.indexOf(e)}).length>0)}Object.defineProperty(r,"__esModule",{value:!0});var o=e("lodash/curry"),a=function(e){return e&&e.__esModule?e:{default:e}}(o);r.default=(0,a.default)(n)},{"lodash/curry":"lodash/curry"}],501:[function(e,t,r){"use strict";function n(){var e=void 0,t=void 0;if(1==arguments.length)e=0,t=arguments[0];else{if(2!=arguments.length)throw new Error("Invalid arguments");e=arguments[0],t=arguments[1]}for(var r=[],n=e;n<t;n++)r.push(n);return r}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],502:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=e("lodash/toPairs"),i=function(e){return e&&e.__esModule?e:{default:e}}(a),s=function e(t,r,a){var s=!0,l=!1,u=void 0;try{for(var c,d=(0,i.default)(t)[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=o(c.value,2),p=f[0],m=f[1],h=a?a+"."+p:p;r(h,m),"object"===(void 0===m?"undefined":n(m))&&e(m,r,h)}}catch(e){l=!0,u=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw u}}},l=function(e,t){s(e,t,null)};r.default=l},{"lodash/toPairs":"lodash/toPairs"}],503:[function(e,t,r){"use strict";function n(e,t){if(e===t)return!0;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var o=Object.prototype.hasOwnProperty,a=0;a<r.length;a+=1){if(!o.call(t,r[a])||e[r[a]]!==t[r[a]])return!1;if(e[r[a]]!==t[r[a]])return!1}return!0}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],504:[function(e,t,r){"use strict";function n(e){var t=e.split(" ");return t.length>1?t[0]+" "+t[1].substring(0,1)+".":t[0]}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],505:[function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e){e=[].concat(n(e));for(var t,r,o=e.length;0!==o;)r=Math.floor(Math.random()*o),o-=1,t=e[o],e[o]=e[r],e[r]=t;return e}Object.defineProperty(r,"__esModule",{value:!0}),r.default=o},{}],506:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.getTimezoneName=r.getTimezoneOffset=void 0;var o=e("./toISODateString"),a=n(o),i=e("moment-timezone"),s=n(i),l={"GMT -12:00":"Etc/GMT+12","GMT -11:00":"Etc/GMT+11","GMT -10:00":"Etc/GMT+10","GMT -9:00":"Etc/GMT+9","GMT -8:00":"Etc/GMT+8","GMT -7:00":"Etc/GMT+7","GMT -6:00":"Etc/GMT+6","GMT -5:00":"Etc/GMT+5","GMT -4:00":"Etc/GMT+4","GMT -3:00":"Etc/GMT+3","GMT -2:00":"Etc/GMT+2","GMT -1:00":"Etc/GMT+1",GMT:"Etc/GMT+0",UTC:"Etc/GMT+0","GMT +1:00":"Etc/GMT-1","GMT +2:00":"Etc/GMT-3","GMT +3:00":"Etc/GMT-3","GMT +4:00":"Etc/GMT-4","GMT +5:00":"Etc/GMT-5","GMT +6:00":"Etc/GMT-6","GMT +7:00":"Etc/GMT-7","GMT +8:00":"Etc/GMT-8","GMT +9:00":"Etc/GMT-9","GMT +10:00":"Etc/GMT-10","GMT +11:00":"Etc/GMT-11","GMT +12:00":"Etc/GMT-12","GMT +13:00":"Etc/GMT-13"},u=r.getTimezoneOffset=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.useUTC,o=void 0!==n&&n;try{return-s.default.tz(o?t:(0,a.default)(t),c(e)).utcOffset()}catch(e){return 0}},c=r.getTimezoneName=function(e){return l[e]?l[e]:e};r.default={getTimezoneName:c,getTimezoneOffset:u}},{"./toISODateString":508,"moment-timezone":"moment-timezone"}],507:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e){return e.reduce(function(e,t){if(t.id)return e[t.id]=t,e},{})};r.default=n},{}],508:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../logger/Logger"),o=function(e){return e<10?"0"+e:e},a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.toUTC,a=void 0!==r&&r,i=t.dateOnly,s=void 0!==i&&i,l=t.withOffset,u=void 0!==l&&l;a&&s&&(0,n.captureMessageWithTrace)("warning (toISODateString): might not need a dateOnly string to be in UTC");var c=a?e.getUTCFullYear():e.getFullYear(),d=o(a?e.getUTCMonth()+1:e.getMonth()+1),f=o(a?e.getUTCDate():e.getDate());if(s)return c+"-"+d+"-"+f;var p=o(a?e.getUTCHours():e.getHours()),m=o(a?e.getUTCMinutes():e.getMinutes()),h=o(a?e.getUTCSeconds():e.getSeconds());if(a)return c+"-"+d+"-"+f+"T"+p+":"+m+":"+h+"Z";if(!u)return c+"-"+d+"-"+f+"T"+p+":"+m+":"+h;var _=e.getTimezoneOffset(),v=o(Math.abs(Math.floor(_/60))),y=o(Math.abs(_%60));return c+"-"+d+"-"+f+"T"+p+":"+m+":"+h+(_>0?"-":"+")+v+":"+y};r.default=a},{"../logger/Logger":141}],509:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=e("./isTempID"),a=n(o),i=e("./isUniqueID"),s=n(i),l=e("lodash/curry"),u=n(l),c=(0,u.default)(function(e,t){return(0,a.default)(t)||(0,s.default)(t)?t:e.user.unique_prefix<<28|t});r.default=c},{"./isTempID":491,"./isUniqueID":492,"lodash/curry":"lodash/curry"}],510:[function(e,t,r){"use strict";function n(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}Object.defineProperty(r,"__esModule",{value:!0}),r.default=n},{}],511:[function(e,t,r){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click";if(e.getAttribute){var r=e.getAttribute("data-track");if(r){var a=r.split("|"),i=o(a,2),s=i[0],l=i[1];track(s,t,l)}}e.parentNode&&n(e.parentNode)}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();r.default=n},{}],512:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./mapRange"),o=function(e){return e&&e.__esModule?e:{default:e}}(n),a=function(e){var t=e.from,r=e.to,n=e.duration,a=e.easing,i=e.step,s=e.startAfter,l=void 0===s?0:s,u=Date.now()+l,c=u+n,d=void 0,f=new Promise(function(e){d=e}),p=function e(){var n=Date.now();if(n<u)return void requestAnimationFrame(e);if(n>=c)return void d();var s=(0,o.default)(u,c,0,1,n);s=a(s);var l=(0,o.default)(0,1,t,r,s);i(l),requestAnimationFrame(e)};return requestAnimationFrame(p),f};r.default=a},{"./mapRange":495}],513:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,t){return new Promise(function(r,n){var o=new Blob([e],{type:"application/json"}),a=new File([o],t),i="/API/v7/upload_file?token="+window.User.token+"&file_name="+t,s=new XMLHttpRequest,l=new FormData;l.append("file",o),l.append("file_name",t),l.append("file_size",a.size|a.fileSize),l.append("file_type","application/json"),s.addEventListener("error",function(e){n(e.errors)}),s.addEventListener("load",function(e){var t=JSON.parse(e.currentTarget.responseText);t.error?n(t.error):r(t.file_url)}),s.open("POST",i,!0),s.send(l)})};r.default=n},{}]},{},[138]);
//# sourceMappingURL=/generated/Col_AppCollection.map.js
